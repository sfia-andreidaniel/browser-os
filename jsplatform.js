console.warn('You are using an automatically generated javascript code with the help of the Closure Compiler\n'+
'Code was compiled on Monday 2nd of December 2013 10:31:47 AM\n\n');

(function(){var c=Node.prototype.addEventListener,a=Node.prototype.removeEventListener;Node.prototype.addEventListener=function(a,b,i){try{i=!!i,this._events=this._events||{},this._events[a]=this._events[a]||[],this._events[a].push({phase:i,callback:b})}catch(h){console.warn("Error adding event listener: ",a," from: ",this)}return c.call(this,a,b,i)};Node.prototype.removeEventListener=function(b,c,i){try{var i=!!i,h=false;if(this._events&&this._events[b]){for(var j=0,k=this._events[b].length;j<k;j++)if(this._events[b][j].phase==
i&&this._events[b][j].callback==c){this._events[b].splice(j,1);h=true;this._events[b].length||delete this._events[b];break}h||console.warn("Error removing event listener ",b," from ",this)}}catch(l){console.warn("Error removing event listener ",b," from ",this,": "+l)}return a.call(this,b,c,i)};Node.prototype.insertTop=function(a,b,i){if(typeof this.topIncrement=="undefined")this.topIncrement=0;this.topIncrement+=b||0;var c=this;return function(){return typeof c.insert=="function"?c.insert(a).chain(function(){this.style.top=
c.topIncrement+"px"}):a}().chain(function(){typeof i!="undefined"&&(c.topIncrement+=i)})};var b={};Node.prototype.purge=function(){for(var c=this.querySelectorAll("*"),g=0,i=0,h=c.length;i<h;i++){if(c[i]._events){for(var j in c[i]._events)c[i]._events.propertyIsEnumerable(j)&&c[i]._events.hasOwnProperty(j)&&function(b,i){for(var c=0,f=i._events[b].length;c<f;c++)a.call(i,b,i._events[b][c].callback,i._events[b][c].phase),g++}(j,c[i]);delete c[i]._events}c[i].chain(function(){var a=this.nodeName.toString().toLowerCase();
typeof b[a]=="undefined"&&(b[a]=document.createElement(a));this.parentNode&&this.parentNode.removeChild(this);this.customEventListeners&&delete this.customEventListeners;try{this.innerHTML=""}catch(i){}for(var c in this)try{if(typeof b[a][c]=="undefined")try{if(!delete this[c])throw"Could not delete key "+c;}catch(f){console.log("error: ",f)}}catch(h){console.log(c+": "+h)}})}}})();
(function(){if(!("console"in window)||window.location.toString().indexOf("?")==-1){var c="log,debug,info,warn,error,assert,dir,dirxml,group,groupEnd,time,timeEnd,count,trace,profile,profileEnd".split(",");window.console={};for(var a=0;a<c.length;++a)window.console[c[a]]=function(){}}})();var __DEBUG_CUSTOM_EVENT_LISTENERS__=false;Object.defineProperty(Array.prototype,"swap",{get:function(){return function(c,a){this[a]=this.splice(c,1,this[a])[0]}}});
Object.defineProperty(Array.prototype,"unique",{get:function(){return function(){for(var c=[],a=0,b=this.length;a<b;a++){for(var f=a+1;f<b;f++)this[a]===this[f]&&(f=++a);c.push(this[a])}return c}}});Object.defineProperty(Array.prototype,"merge",{get:function(){return function(c){for(var c=c||[],a=0;a<c.length;a++)this.push(c[a]);return this}}});
window.grep=function(c,a,b){c=c.toString();b&&(c=c.toLowerCase(),a=a.toLowerCase());b=c.split("\n");for(c=0;c<b.length;c++)b[c].indexOf(a)>=0&&console.log(c,b[c])};Node.prototype.setHTML=function(c){this.innerHTML=c;return this};Node.prototype.setAttr=function(c,a){typeof this.setAttribute!="undefined"&&this.setAttribute(c,a);return this};
Node.prototype.onDOMresize=function(c,a){this.__DEBUG_ANCHORS__&&console.log("onDOMresize: "+c+","+a);if(this.DOManchors)for(var b in this.DOManchors)try{this.style[b]=this.DOManchors[b].apply(this,[c,a])}catch(f){console.log("Error on Anchor: "+b+"\n"+f)}if(!this.noResize&&this.hasChildNodes()){b=this.innerWidth?this.innerWidth:this.offsetWidth;var g=this.innerHeight?this.innerHeight:this.offsetHeight;typeof this.__xPadding!="undefined"&&(b-=this.__xPadding);typeof this.__yPadding!="undefined"&&
(g-=this.__yPadding);var i=this.firstChild;do{if(i.nodeType==1)i.onDOMresize(b,g);i=i.nextSibling}while(i!=null)}};Node.prototype.setAnchors=function(c){this.DOManchors=c;return this};
Node.prototype.paint=function(){if(!this.parentNode)return this;this.onDOMresize(this.parentNode.innerWidth?this.parentNode.innerWidth:this.parentNode.offsetWidth-(typeof this.__xPadding=="undefined"?0:this.__xPadding),this.parentNode.innerHeight?this.parentNode.innerHeight:this.parentNode.offsetHeight-(typeof this.__yPadding=="undefined"?0:this.__yPadding));return this};Node.prototype.addBefore=function(c){if(!this.parentNode)throw"ERR_NOT_ATTACHED!";this.parentNode.insertBefore(c,this);return this};
Node.prototype.addAfter=function(c){if(!this.parentNode)throw"ERR_NOT_ATTACHED!";this.nextSibling?this.nextSibling.addBefore(c):this.parentNode.appendChild(c);return this};Node.prototype.removeFromParent=function(){this.parentNode&&this.parentNode.removeChild(this);return this};Node.prototype.firstParent=function(c,a){for(var b=this.parentNode;!b.nodeName.match(c)&&b!=a;)b=b.parentNode;return b};
Node.prototype.swapWith=function(c){var a=this.parentNode,b=this.nextSibling===c?this:this.nextSibling;c.parentNode.insertBefore(this,c);a.insertBefore(c,b);return this};
function typeOf(c,a){var a=a||2,b="unknown";switch(true){case c===Infinity:b="infinity";break;case typeof c=="number"&&isNaN(c):b="nan";break;case typeof c!="undefined"&&c===void 0:b="undefined";break;case c===null:b="null";break;case c===false||c===true:b="boolean";break;case typeof NaN!="undefined"&&c===NaN:b="number.nan";break;case typeof Infinity!="undefined"&&c===Infinity:b="number.infinity";break;case typeof c=="number":b="number."+(c.toString().isInteger()?"int":"float");break;case c instanceof
String:b="string";break;case c instanceof Array:b="object.array";break;case c instanceof Function:b="object.function."+c.toString().replace(/\{[^*]+$/,"").trim();break;case window.Node&&c instanceof window.Node:b="object.node";break;case c instanceof Object:b="object";break;default:b="unknown."+typeof c}return b.split(".").slice(0,a).join(".")}
try{if(typeof Node!="undefined"&&typeof Node.prototype.innerText=="undefined"){var getInnerText=function(c){for(var a="",b=0;b<c.childNodes.length;b++)switch(c.childNodes[b].nodeType){case 1:a+=getInnerText(c.childNodes[b]);break;case 3:a+=c.childNodes[b].nodeValue;break;case 8:a+="\n"}return a};Node.prototype.__defineGetter__("innerText",function(){return window.getInnerText(this)})}}catch(ex$$1){}
function fireEvent(c,a,b,f,g){var g=g||{},i;switch(true){case "abort,blur,change,error,focus,load,reset,resize,scroll,select,submit,unload".split(",").indexOf(a)!=-1:i=document.createEvent("HTMLEvents");i.initEvent(a,b||false,f||false);break;case ["keydown","keypress","keyup"].indexOf(a)!=-1:try{i=document.createEvent("KeyboardEvent");i.initKeyboardEvent(a,b||false,f||false,window,g.ctrlKey||false,g.altKey||false,g.shiftKey||false,g.metaKey||false,g.keyCode||0,g.charCode||0);break}catch(h){console.error(h.stack)}case ["DOMActivate",
"DOMFocusIn","DOMFocusOut"].indexOf(a)!=-1:i=document.createEvent("UIEvents");i.initUIEvent(a,b||false,f||false,window,g.detail||1);break;case "click,mousedown,mousemove,mouseout,mouseover,mouseup".split(",").indexOf(a)!=-1:i=document.createEvent("MouseEvents");i.initMouseEvent(a,b||false,f||false,window,g.detail||1,g.screenX||0,g.screenY||0,g.clientX||0,g.clientY||0,g.ctrlKey||false,g.altKey||false,g.shiftKey||false,g.metaKey||false,g.button||1,g.relatedTarget||c);break;case "DOMAttrModified,DOMNodeInserted,DOMNodeRemoved,DOMCharacterDataModified,DOMNodeInsertedIntoDocument,DOMNodeRemovedFromDocument,DOMSubtreeModified".split(",").indexOf(a)!=
-1:i=document.createEvent("MutationEvents"),i.initMutationEvent(a,b||false,f||false,g.relatedNode||c,g.prevValue||null,g.newValue||null,g.attrName||null,g.attrChange||1);default:throw"Event type '"+a+" is not implemented!";}for(var j in g)g.propertyIsEnumerable(j)&&(i[j]=g[j]);return c.dispatchEvent(i)}Object.defineProperty(Object.prototype,"setProperty",{get:function(){return function(c,a){this[c]=a;return this}}});
Object.defineProperty(Object.prototype,"chain",{get:function(){return function(c){c.apply(this,Array.prototype.slice(arguments,0));return this}}});Object.defineProperty(Object.prototype,"fields",{get:function(){return function(c){for(var a={},b,f=0,g=c.length;f<g;f++)if(typeof this[b=c[f]]!="undefined")a[b]=this[b];return a}}});Node.prototype.insert=function(c){return c};Node.prototype.addClass=function(c){addStyle(this,c);return this};Node.prototype.removeClass=function(c){removeStyle(this,c);return this};
Node.prototype.hasClass=function(c){return hasStyle(this,c)};function EnableCustomEventListeners(){}Object.defineProperty(Object.prototype,"addCustomEventListener",{get:function(){return function(c,a){this.customEventListeners=this.customEventListeners||{};this.customEventListeners[c]||(this.customEventListeners[c]=[]);this.customEventListeners[c].push(a)}}});
Object.defineProperty(Object.prototype,"removeCustomEventListener",{get:function(){return function(c,a){if(this.customEventListeners&&this.customEventListeners[c])for(var b=0,f=this.customEventListeners.length;b<f;b++)if(this.customEventListeners[c][b]==a){this.customEventListeners[c].splice(b,1);break}}}});
Object.defineProperty(Object.prototype,"onCustomEvent",{get:function(){return function(c,a){if(!this.customEventListeners||!this.customEventListeners[c])return true;for(var b=true,f=0,g=this.customEventListeners[c].length;f<g;f++)try{this.customEventListeners[c][f].apply(this,[a])||(b=false)}catch(i){b=false,console.error(i),console.log("Error was: "+i)}return b}}});
function ____ObjectToFeedPost(c,a,b,f){var g=[],i=[],b=b||"";switch(true){case c instanceof Array:for(var h=0;h<c.length;h++){i=____ObjectToFeedPost(c[h],"",b.concat(typeof f!="undefined"?"[":"").concat(h).concat(typeof f!="undefined"?"]":""),typeof f=="undefined"?true:false);for(a=0;a<i.length;a++)g.push(i[a])}break;case c instanceof Object:for(h in c){i=____ObjectToFeedPost(c[h],"",b.concat(typeof f!="undefined"?"[":"").concat(h).concat(typeof f!="undefined"?"]":""),typeof f=="undefined"?true:false);
for(a=0;a<i.length;a++)g.push(i[a])}break;default:typeof f=="undefined"?g.addPOST(a,c):g.addPOST(b,c)}return g}
function ResolveObjectVars(c){switch(true){case c instanceof Array:for(var a=[],b=0;b<c.length;b++)a.push(ResolveObjectVars(c[b]));return a;case c instanceof Object:a={};for(b in c)a[b]=ResolveObjectVars(c[b]);return a;default:try{a=c.toString()}catch(f){return console.log("err"),c}do c=/%[\w]+%/.exec(a),c!==null&&(b=c[0],b=b.substr(1,b.length-2),a=a.replace(c[0],window[b.toString()]));while(c!==null);return a}}
Object.defineProperty(Array.prototype,"addObject",{get:function(){return function(c){for(var c=ResolveObjectVars(c),c=____ObjectToFeedPost(c),a=0;a<c.length;a++)this.push(c[a]);return this}}});Object.defineProperty(Array.prototype,"first",{get:function(){return function(){return typeof this[0]=="undefined"?void 0:this[0]}}});Object.defineProperty(Array.prototype,"last",{get:function(){return function(){return this.length?this[this.length-1]:void 0}}});
Object.defineProperty(Array.prototype,"intersect",{get:function(){return function(c){for(var a=[],b=0,f=this.length;b<f;b++)c.indexOf(this[b])>=0&&a.push(this[b]);return a}}});
function ArrayRange(c,a,b){var f=c.length;a<0&&(b+=a,a=0);a+b>f&&(b=f-a);Object.defineProperty(this,"length",{get:function(){return b}});Object.defineProperty(this,"offset",{get:function(){return a}});this.get=function(f){if(!(f<0||f>=b))return c[a+f]};this.set=function(f,i,h){f>=0&&f<b&&(c[a+f]=i==void 0?h||null:i)};this.shiftLeft=function(a,i){if(a<b)for(var c=0;c<a;c++)this.set(c,this.get(c+a),i);for(c=0;c<a;c++)this.set(b-c-1,i)};this.shiftRight=function(a,i){if(a<b)for(var c=0;c<b;c++)this.set(b-
c,this.get(b-c-a),i);for(c=0;c<a;c++)this.set(c,i)};this.shift=function(a,b){a<0?this.shiftLeft(-a,b):this.shiftRight(a,b);return this};this.fill=function(a){for(var i=0;i<b;i++)this.set(i,a[i])};this.at=function(f,i){f>=0&&f<b&&i(c[a+f])};this.each=function(f){for(var i=0;i<b;i++)f(c[a+i],a+i);return this};return this}Object.defineProperty(Array.prototype,"createRange",{get:function(){return function(c,a){return new ArrayRange(this,c,a)}}});window.DEFAULT_DATE_FORMAT="%Y-%m-%d %H:%i:%s";
Date.prototype.diff=function(c,a){switch(a.toLowerCase()){case "days":case "day":return parseInt((this.getTime()-c.getTime())/864E5);case "weeks":case "week":return parseInt((this.getTime()-c.getTime())/6048E5);case "months":case "month":var b=this.getFullYear(),f=c.getFullYear(),g=this.getMonth();return c.getMonth()+12*f-(g+12*b);case "years":case "year":return parseInt((this.getTime()-c.getTime())/315576E5)}};Date.prototype.tomorrow=function(){this.setMonth(this.getMonth(),this.getDate()+1);return this};
Date.prototype.yesterday=function(){this.setMonth(this.getMonth(),this.getDate()-1);return this};Date.prototype.nextMonth=function(){this.setMonth(this.getMonth()+1,1);return this};Date.prototype.prevMonth=function(){this.setMonth(this.getMonth()-1,1);return this};Date.prototype.nextYear=function(){this.setFullYear(this.getFullYear()+1);return this};Date.prototype.prevYear=function(){this.setFullYear(this.getFullYear()-1);return this};Date.prototype.ShortDayNames="Su,Mo,Tu,We,Th,Fr,Sa".split(",");
Date.prototype.LongDayNames="Sunday,Monday,Tuesday,Wedensday,Thursday,Friday,Saturday".split(",");Date.prototype.ShortMonthNames="Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec".split(",");Date.prototype.LongMonthNames="January,February,March,April,May,June,July,August,September,Octomber,November,December".split(",");Date.prototype.pad=function(c,a){for(var b=c.toString();b.length<a;)b="0"+b;return b};
Date.prototype.toString=function(c){for(var c=c||window.DEFAULT_DATE_FORMAT,a="",b=0,f="",g=c.toString().length;b<g;){f=c.charAt(b);switch(f){case "%":b++;if(b==g)return a;f=c.charAt(b);switch(f){case "a":a=a.concat(this.ShortDayNames[this.getDay()]);break;case "b":a=a.concat(this.ShortMonthNames[this.getMonth()]);break;case "c":a=a.concat(this.getMonth()+1);break;case "d":a=a.concat(this.pad(this.getDate(),2));break;case "e":a=a.concat(this.getDate());break;case "H":a=a.concat(this.pad(this.getHours(),
2));break;case "h":case "I":f=this.getHours();a=a.concat(f==0?"12":f<=12?this.pad(f,2):this.pad(f-12,2));break;case "i":a=a.concat(this.pad(this.getMinutes(),2));break;case "k":a=a.concat(this.getHours());break;case "l":f=this.getHours();a=a.concat(f==0?"12":f<=12?f:f-12);break;case "M":a=a.concat(this.LongMonthNames[this.getMonth()]);break;case "m":a=a.concat(this.pad(this.getMonth()+1,2));break;case "p":f=this.getHours();a=a.concat(f<12?"AM":"PM");break;case "r":f=this.getHours();a=a.concat(this.pad(f==
0?"12":f<12?f:f-12,2),":",this.pad(this.getMinutes(),2),":",this.pad(this.getSeconds(),2)," ",this.getHours()<12?"AM":"PM");break;case "s":case "S":a=a.concat(this.pad(this.getSeconds(),2));break;case "T":a=a.concat(this.pad(this.getHours(),2),":",this.pad(this.getMinutes(),2),":",this.pad(this.getSeconds(),2));case "W":a=a.concat(this.LongDayNames[this.getDay()]);break;case "w":a=a.concat(this.getDay());break;case "Y":a=a.concat(this.getFullYear());break;case "y":a=a.concat(this.getYear().toString().substr(2));
break;case "U":a=a.concat(Math.floor(this.getTime()/1E3));break;case "%":a.concat("%");default:throw"Date.prototype: the %"+f+" specifier is not supported!";}break;default:a=a.concat(f)}b++}return a};Date.prototype.unpad=function(c){if(c=="")return 0;for(var c=c.toString(),a=0;a<c.length&&c.charAt(a)=="0";)a++;c=parseInt(c.substr(a));return!isNaN(c)?c:0};
Date.prototype.resetDate=function(){var c=new Date;this.setDate(c.getDate());this.setMonth(c.getMonth());this.setFullYear(c.getFullYear());this.setHours(c.getHours());this.setMinutes(c.getMinutes());this.setSeconds(c.getSeconds())};
Date.prototype.getInt=function(c,a,b,f){c=c.toString();if(c.length<a)throw"Date.prototype: cannot parse string: not enough length";for(var g=c.substr(0,a),i;a<b;){i=c.charAt(a);if("0123456789".indexOf(i)==-1)break;if(parseInt(this.unpad(g.concat(i)))<=f)g=g.concat(i);else break;a++}return g};
Date.prototype.getKey=function(c,a){for(var b=0,f=c.toLowerCase(),g,b=0;b<a.length;b++)if(g=a[b].toString().toLowerCase(),f.substr(0,g.length)==g)return b;throw"Date.prototype: Unparseable string: key not found (str="+c+", arr=["+a.join(",")+")!";};
Date.prototype.fromString=function(c,a){this.resetDate();if(typeof c!="undefined"){for(var b=false,f=false,g=false,i=false,h=false,j=false,k=false,l=c.toString(),m=a.toString(),o=0,n=0;n<m.length;n++)if(l=l.substr(o),m.charAt(n)=="%"){n++;if(n>=m.length)throw"Date.prototype: unterminated date expression at position "+n+" in string "+m;switch(m.charAt(n)){case "a":o+=this.ShortDayNames[this.getKey(l,this.ShortDayNames)].length;break;case "b":h=this.getKey(l,this.ShortMonthNames);o=this.ShortMonthNames[h].length;
break;case "c":h=this.getInt(l,1,2,12);o=h.length;h=this.unpad(h)-1;break;case "d":j=this.getInt(l,2,2,31);o=j.length;break;case "e":j=this.getInt(l,1,2,31);o=j.length;break;case "H":b=this.getInt(l,2,2,23);o=b.length;break;case "h":case "I":b=this.getInt(l,2,2,12);o=b.length;break;case "i":f=this.getInt(l,2,2,59);o=f.length;break;case "k":b=this.getInt(l,1,2,23);o=b.length;break;case "l":b=this.getInt(l,1,2,12);o=b.length;break;case "M":h=this.getKey(l,this.LongMonthNames);o=this.LongMonthNames[h].length;
break;case "m":h=this.getInt(l,2,2,12);o=h.length;h=this.unpad(h)-1;break;case "p":k=this.getKey(l,["AM","PM"]);o=2;break;case "s":case "S":g=this.getInt(l,2,2,59);o=g.length;break;case "Y":i=this.getInt(l,4,4,2100);o=i.length;break;case "U":b=/^(\-)?([\d]+)/.exec(l);if(b===null)throw"Date.prototype: Could not parse %U modifier: invalid unix timestamp!";this.setTime(parseInt((b[1]||"").concat(b[2]))*1E3);return this;default:throw'Date.prototype: Unsupported token "%'+m.charAt(n)+'" while parsing date';
}}else o=1;j=j===false?false:this.unpad(j);h=h===false?false:this.unpad(h);i=i===false?false:this.unpad(i);b=b===false?false:this.unpad(b);f=f===false?false:this.unpad(f);g=g===false?false:this.unpad(g);if(k===1&&b!==false&&(b+=12,b>23))throw'Date.prototype: invalid hour : "'+b+'"';h!==false&&this.setMonth(h);j!==false&&this.setDate(j);i!==false&&this.setYear(i);b!==false&&this.setHours(b);f!==false&&this.setMinutes(f);g!==false&&this.setSeconds(g);return this}};
Object.defineProperty(Node.prototype,"offsetBottom",{get:function(){return this.offsetTop+this.offsetHeight}});Object.defineProperty(Node.prototype,"offsetRight",{get:function(){return this.offsetLeft+this.offsetWidth}});var kernel_cache=kernel_cache||[];if(/(\?|\&)(devel|build)/.test(window.location))window.onerror=function(c,a,b){alert("Application Fatal Error: "+c+"\nline: "+b)};function KernelLog(c,a){try{console[a||"log"](c)}catch(b){}}
function KExtension(c){if(c=="")return"";for(c=c.split("/");c.length&&c[c.length-1]=="";)c.splice(c.length-1,1);if(c.length==0)return"";c=c[c.length-1];c=c.split(".");return c[c.length-1].toLowerCase()}window.jKernel={scripts:0,styles:0};
addOnload(function(){window.scriptLoader=new Dialog({width:230,height:100,closeable:false,minimizeable:false,caption:"Loading Application",maximizeable:false,onTop:true,resizeable:false});window.scriptLoader.many=$("span");window.scriptLoader.many.innerHTML="some scripts ";window.scriptLoader.insert($("img")).setAttr("style","display: block; margin-bottom: 10px; margin-left: auto; margin-right: auto").setAttr("src","img/ajax-loaders/loadbar-148x12.gif");window.scriptLoader.p=window.scriptLoader.insert($("p"));
window.scriptLoader.p.appendChild(document.createTextNode("Please wait, we have to load "));window.scriptLoader.p.appendChild(window.scriptLoader.many);window.scriptLoader.p.appendChild(document.createTextNode(" before starting your application ..."));window.scriptLoader.childOf=null});function setScriptsPending(c){if(!(c<0))window.jKernel.scripts=c,window.scriptLoader.setChildOf(c==0?null:document.body),window.scriptLoader.many.innerHTML=c+(c==1?" script":" scripts")}
function getScriptsPending(){return window.jKernel.scripts}
function KernelLoadApplication(c){KernelLog('Kernel: Loading "'+c+'"');for(var a=0;a<kernel_cache.length;a++)if(kernel_cache[a].fileName==c)return KernelLog('Kernel: Application "'+c+'" was loaded from cache'),kernel_cache[a];var b=$_JSON_POST("vfs/"+c);if(b===null)return KernelLog("Kernel: Loading '"+c+"' returned NULL!","error"),window.setScriptsPending(window.getScriptsPending()-1),null;b.fileName=c;var f;try{f=document.getElementsByTagName("head")[0]}catch(g){f=document.body.parentElement.getElementsByTagName("head")[0]}if(b.scripts&&
b.scripts.length){KernelLog("Kernel: Loading "+b.scripts.length+' Files from file "'+c+'"');for(a=0;a<b.scripts.length;a++)try{var i=KExtension(b.scripts[a].name),h;switch(i){case "js":h=$("script");KernelLog("script: "+b.scripts[a].name,"info");window.setScriptsPending(window.getScriptsPending()+1);h.setAttribute("type","text/javascript");b.scripts[a].data="try {"+b.scripts[a].data+' \n\n/* KernelLog("Script: '+b.scripts[a].name+' was loaded successfully!", "info"); */window.setScriptsPending(window.getScriptsPending()-1); } catch(ex_jkernel) { \n\nKernelLog("Script: '+
b.scripts[a].name+' COULD NOT BE LOADED!: "+ex_jkernel, "error"); window.setScriptsPending(window.getScriptsPending()-1); }\r\n\r\n//@ sourceURL='+b.scripts[a].name;try{h.appendChild(document.createTextNode(b.scripts[a].data))}catch(j){h.text=b.scripts[a].data}try{h.script_name=b.scripts[a].name,f.appendChild(h)}catch(k){alert("IE")}break;case "css":KernelLog("css   : "+b.scripts[a].name);h=document.createElement("style");try{h.appendChild(document.createTextNode(b.scripts[a].data))}catch(l){h.setAttribute("type",
"text/css"),h.styleSheet.cssText=b.scripts[a].data}f.appendChild(h)}}catch(m){KernelLog('Kernel: Error loading application "'+c+'":\n"'+i+'" error at script index '+a+' (name="'+b.scripts[a].name+")\n"+m,"error");try{m.stack()}catch(o){console.error("no trace information available!")}return null}}kernel_cache.push(b);return b}
function AppExec(c,a){window.scripts_pending++;var b=KernelLoadApplication(c);window.scripts_pending--;if(b===null)return KernelLog("Exec failed","error"),null;var f=typeof a=="undefined"?b.params&&b.params.toString().length?b.params.toString():"":a;if(b.init_class&&b.init_class.toString().length){b="new "+b.init_class+"("+f+");";KernelLog("exec  : "+b);try{var g=eval(b)}catch(i){KernelLog('Kernel: Error executing "'+c+'": JavaScript error at startup code: "'+i+'":',"error");try{KernelLog(i.stack,
"error")}catch(h){}throw i;}return g}return true}Number.prototype.between=function(c,a){return c<=this&&a>=this||a<=this&&c>=this};Object.defineProperty(Number.prototype,"toSize",{get:function(){return function(c){var a=0,b=Math.abs(this*1);for(c&&(b*=8);b>=1024&&a<5;)b/=1024,a++;return(this<0?"-":"")+b.toFixed(2).replace(".00","")+", Kb, Mb, Gb, Tb, Pb".split(",")[a]}}});
Object.defineProperty(Number.prototype,"toTime",{get:function(){return function(c){c=c||{};c.second=c.second||["s","s"];c.minute=c.minute||["m","m"];c.hour=c.hour||[" hour"," hrs"];c.day=c.day||[" day"," days"];c.month=c.month||[" month"," months"];c.year=c.year||[" year"," years"];c.past=c.past||"%time% ago";c.future=c.future||"in %time%";for(var a=[c.second,c.minute,c.hour,c.day,c.month,c.year],b=[1,60,3600,86400,2635200,31622400],f=Math.abs(this*1),g=1,i=[],h=0,j=0,k;f>=1&&h<5;){g=1;for(f=Math.round(f);f/
b[g]>=1&&g<5;)g++;j=f/b[g-1];i.push((k=Math.floor(j))+a[g-1][k==1?0:1]);f=(j-Math.floor(j))*b[g-1];h++}a=i.join(" ");return this<0?c.past.replace("%time%",a):c.future.replace("%time%",a)}}});Object.defineProperty(Object.prototype,"renameProperty",{get:function(){return function(c,a){typeof this[c]!="undefined"&&(this[a]=this[c],delete this[c]);return this}}});Selection.prototype.forceAddNode=function(c){(this.otherNodes=this.otherNodes||[]).push(c.chain(function(){this.renderSelected=true}))};
Selection.prototype.forceRemoveNode=function(c){var a;this.otherNodes&&(a=this.otherNodes.indexOf(c))>=0&&this.otherNodes.splice(a,1);c.renderSelected=false};window.addEventListener("selectionchange",function(){var c;if((c=window.getSelection()).otherNodes&&c.otherNodes instanceof Array){for(var a=0,b=c.otherNodes.length;a<b;a++)c.otherNodes[a].renderSelected=false;c.otherNodes=void 0}document.body.onCustomEvent("selection-changed")},true);
Object.defineProperty(Node.prototype,"renderSelected",{get:function(){return this.hasAttribute("_selected")},set:function(c){(c?this.setAttribute:this.removeAttribute).call(this,"_selected","yes")},enumerable:false});Selection.prototype.getCaretOffsetRelativeTo=function(c){try{var a=0,b=this.getRangeAt(0),f=b.cloneRange();f.selectNodeContents(c);f.setEnd(b.endContainer,b.endOffset);return a=f.toString().length}catch(g){return 0}};
Node.prototype.setCaretPosition=function(c){this.focus();var a=window.getSelection(),b=a.getCaretOffsetRelativeTo(this);for(c-=b;c!=0;)c<0?(c++,a.modify("move","left","character")):(c--,a.modify("move","right","character"))};Node.prototype.outerSelect=function(){var c=window.getSelection(),a=document.createRange();a.selectNode(this);c.addRange(a)};String.prototype.isEmail=function(){return/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/.test(this)};String.prototype.isInteger=function(){return/^(\+|-)?\d+$/.test(this)};
String.prototype.isDecimal=function(){return/^(\+|-)?((\d+(\.\d+)?)|(\.\d+))$/.test(this)};String.prototype.isNotEmpty=function(){return/\S+/.test(this)};String.prototype.isEmpty=function(){return!/\S+/.test(this)};String.prototype.isAlpha=function(){return/^[a-z]+$/i.test(this)};String.prototype.isAlphaNum=function(){return/^[a-z\d]+$/i.test(this)};String.prototype.lTrim=function(c){return this.replace(RegExp("^["+(c||"\\s")+"]+","g"),"")};
String.prototype.rTrim=function(c){return this.replace(RegExp("["+(c||"\\s")+"]+$","g"),"")};String.prototype.trim=function(c){return this.lTrim(c).rTrim(c)};String.prototype.lPad=function(c,a){for(var b=this.toString(),a=a||" ";b.length<c;)b=a.charAt(0).concat(b);return b};String.prototype.rPad=function(c,a){for(var b=this.toString(),a=a||" ";b.length<c;)b=b.concat(a.charAt(0));return b};
String.prototype.toHex=function(){for(var c="",a="",b=0,f=this.length;b<f;b++)a=this.charCodeAt(b).toString(16),a.length==1&&(a="0"+a),c+=a;return c};String.prototype.unhex=function(){for(var c="",a=this.length-this.length%2,b=0;b<a;b+=2)c+=String.fromCharCode(parseInt(this.substr(b,2),16));return c};
window.addEventListener("load",function(){var c=document.body.appendChild(document.createElement("span"));c.style.visibility="hidden";c.style.whiteSpace="pre";c.style.display="block";c.style["float"]="left";c.style.zIndex=-1;c.style.padding="0px";c.style.margin="0px";c.style.border="none";Object.defineProperty(window,"ruller",{get:function(){return c}})},true);
String.prototype.visualWidth=function(c,a){ruller.style.fontSize=c||"1em";ruller.style.fontFamily=typeof a=="undefined"?"arial":a;try{return ruller.innerHTML="",ruller.appendChild($text(this)),ruller.offsetWidth}catch(b){return null}};String.prototype.visualHeight=function(c,a){ruller.style.fontSize=c||"1em";ruller.style.fontFamily=typeof a=="undefined"?"arial":a;try{return ruller.innerHTML="",ruller.appendChild($text(this)),ruller.offsetHeight}catch(b){return null}};
String.prototype.divide=function(c){var a=this.length;if(a<c)return this.split("");for(var a=~~(a/c),b=[],f=0;f<c;f++)b.push(this.substr(f*a,a));return b};String.prototype.ensureMaxWordLength=function(c){function a(a,b){for(var c=2,f=a.length;f/(c+1)>b;)c++;return~~c}if(this.length<=c)return this;for(var b=RegExp("[\\S]{"+(c+1)+","+this.length+"}"),f=this.valueOf(),g=null;g=b.exec(f);)f=f.replace(g[0],g[0].divide(a(g[0],c)).join(" "));return f};window[".htmlEntities"]=document.createElement("b");
(function(){String.prototype.htmlEntities=function(){window[".htmlEntities"].appendChild($text(this));var c=window[".htmlEntities"].innerHTML;window[".htmlEntities"].innerHTML="";return c}})();String.prototype.strcmp=function(c){return this==c?0:this<c?-1:1};
function Game_Card(c,a,b){var c=c||1,a=a||"c",f=$("div","GameCard "+a+c+(b?"":" backed"));Object.defineProperty(f,"value",{get:function(){return c<=10?c:c-1}});Object.defineProperty(f,"color",{get:function(){return a=="d"||a=="h"?"red":"black"}});Object.defineProperty(f,"sign",{get:function(){return a}});(function(){var a=null,b=null,c=null,j=null,k=null,l=null,m=new dragObject(f,null,new Position(0,0),new Position(1E4,1E4),function(c){j=f.style.top;k=f.style.left;if(f.stack)try{if(!f.stack.moveable)throw"col not moveable";
if(!f.stack.canMoveCard(f))throw"unmoveable card";b=[];for(var h=0,m=getOwnerWindow(f).querySelectorAll(".GameStack"),l=m.length;h<l;h++)m[h]!=f.stack&&m[h].canAcceptCard&&b.push(m[h])}catch(o){return console.log("Drag start: "+o),cancelEvent(c),"cancel"}else b=null;a=f.style.zIndex;f.style.zIndex=1E4;f.stack&&f.stack.repaint(f.cardIndex,parseInt(f.style.left),parseInt(f.style.top));addStyle(f,"dragging")},function(){f.stack&&f.stack.repaint(f.cardIndex,parseInt(f.style.left),parseInt(f.style.top));
l=null;if(b)for(var a=0,g=b.length;a<g;a++)if(f.overlapsWith(b[a])&&b[a].canAcceptCard(f)){l=b[a];break}if(l!=c){if(c)c.highlight=false;if(c=l)c.highlight=true}},function(){c?(c.add(f),c.repaint(),c.highlight=false,c=null):(f.style.zIndex=a,f.stack?f.stack.repaint():(f.style.left=k,f.style.top=j));removeStyle(f,"dragging");console.log("Drag end: ",arguments)},true),o=false;Object.defineProperty(f,"moveable",{get:function(){return o},set:function(a){o!=!!a&&(o=!!a,f[o?"setAttribute":"removeAttribute"]("dragable",
"1"),m[o?"StartListening":"StopListening"]())}})})();(function(){var a=false;Object.defineProperty(f,"flipped",{get:function(){return a},set:function(b){a=!!b;(b?removeStyle:addStyle)(f,"backed")}})})();f.flipped=b||false;(function(){var a=null;Object.defineProperty(f,"stack",{get:function(){return a},set:function(b){a&&a.remove(f);a=b;f.prevCard=null;f.nextCard=null}})})();(function(){var a=0;Object.defineProperty(f,"cardIndex",{get:function(){return a},set:function(b){a=b}})})();(function(){var a=
null;Object.defineProperty(f,"nextCard",{get:function(){return a},set:function(b){a=b}})})();(function(){var a=null;Object.defineProperty(f,"prevCard",{get:function(){return a},set:function(b){a=b}})})();f.addEventListener("click",function(){if(f.stack)f.stack.onCustomEvent("card-clicked",f)},false);f.addEventListener("dblclick",function(){if(f.stack)f.stack.onCustomEvent("pull-up",f)});return f}
function Game_Stack(c){var a=$("div","GameStack");a.cards=[];highlight=false;c=c||{};(function(){var b="none";Object.defineProperty(a,"stackMethod",{get:function(){return b},set:function(c){if(["none","x","y","both"].indexOf(c)==-1)throw"Invalid stack method!";c!=b&&(b=c,a.repaint())}})})();Object.defineProperty(a,"highlight",{get:function(){return highlight},set:function(b){highlight=!!b;for(var b=0,c=a.cards.length;b<c;b++)(highlight?addStyle:removeStyle)(a.cards[b],"highlight");(highlight?addStyle:
removeStyle)(a,"highlight")}});(function(){var b=0;Object.defineProperty(a,"stackPadding",{get:function(){return b},set:function(c){c!=b&&(b=c,a.repaint())}})})();a.repaint=function(b,c,i){if(a.parentNode)for(var h=c||a.offsetLeft,j=i||a.offsetTop,k=0,l=0,m=a.stackPadding,o=-1,b=Math.max(0,b||0),c=a.cards.length;b<c;b++)a.cards[b].chain(function(){o==-1?o=this.style.zIndex:(o++,this.style.zIndex=o);this.style.left=h+k+"px";this.style.top=j+l+"px";switch(a.stackMethod){case "x":k+=m;break;case "both":k+=
m;l+=m;break;case "y":l+=m}})};a.setAnchors({dummy:function(){a.repaint();return null}});a.add=function(b){for(var c=[b],i=b.nextCard;i;)c.push(i),i=i.nextCard;for(var i=0,h=c.length;i<h;i++){var j=c[i];a.remove(j);a.cards.push(j);j.stack=a;j.cardIndex=a.cards.length-1;j.prevCard=j.cardIndex==0?null:a.cards[j.cardIndex-1];if(j.cardIndex>0)j.prevCard.nextCard=j;j.style.zIndex=j.cardIndex+1;j.moveable=a.moveable}a.repaint(b.cardIndex);a.parentNode&&getOwnerWindow(a).isGameWon()};a.remove=function(b){for(var c=
0,i=a.cards.length;c<i;c++)if(a.cards[c]==b){a.cards.splice(c,1);if(a.cards.length){a.cards[0].prevCard=null;c=0;for(i=a.cards.length-1;c<i;c++)a.cards[c].nextCard=a.cards[c+1],a.cards[c+1].prevCard=a.cards[c];a.cards.length==1?a.cards[0].nextCard=null:(a.cards.last().prevCard=a.cards[a.cards.length-2],a.cards[a.cards.length-2].nextCard=a.cards.last(),a.cards.last().nextCard=null)}a.repaint();break}};var b=false;Object.defineProperty(a,"moveable",{get:function(){return b},set:function(c){b=!!c;for(var c=
0,g=a.cards.length;c<g;c++)a.cards[c].moveable=b}});a.stackMethod=c.stackMethod||"none";a.stackPadding=c.stackPadding||0;a.moveable=c.moveable||false;return a}var __ACE_SYNTAXES={},__ACE_BAD_SYNTAXES={},__ACE_THEMES={},__ACE_BAD_THEMES={};
function AceEditor(){var c=$("div","ACE_EDITOR");try{if(c.editor=ace.edit(c),c.getWidth=function(){return c.offsetWidth},c.setWidth=function(a){c.style.width=a;c.editor.resize()},c.getHeight=function(){return c.offsetHeight},c.setHeight=function(a){c.style.height=a;c.editor.resize()},c.syntaxLoaded=function(a){return typeof __ACE_SYNTAXES[a]!="undefined"},c.themeLoaded=function(a){return typeof __ACE_THEMES[a]!="undefined"},c.loadSyntax=function(a,f){if(typeof __ACE_BAD_SYNTAXES[a]!="undefined")throw"AceEditor: Could not load syntax '"+
a+"'";if(c.syntaxLoaded(a))f();else{var g=$("script");g.setAttribute("type","text/javascript");g.setAttribute("src","contrib/ace-editor/mode-".concat(a).concat(".js"));g.onload=function(){__ACE_SYNTAXES[a]=true;g.parentNode.removeChild(g);f();console.log('AceEditor: Loaded Syntax Mode: "'+a+'"')};g.onerror=function(){__ACE_BAD_SYNTAXES[a]=true;throw"AceEditor: Could not load syntax '"+a+"'";};console.log("AceEditor: LoadSyntaxBegin: "+a);document.getElementsByTagName("head")[0].appendChild(g)}},c.loadTheme=
function(a,f){if(typeof __ACE_BAD_THEMES[a]!="undefined")throw"AceEditor: Could not load theme '"+a+"'";if(c.themeLoaded(a))f();else{var g=$("script");g.setAttribute("type","text/javascript");g.setAttribute("src","contrib/ace-editor/theme-".concat(a).concat(".js"));g.onload=function(){__ACE_THEMES[a]=true;g.parentNode.removeChild(g);f();console.log('AceEditor: Loaded Theme: "'+a+'"')};g.onerror=function(){__ACE_BAD_THEMES[a]=true;throw"AceEditor: Could not load theme '"+a+"'";};console.log("AceEditor: LoadThemeBegin: "+
a);document.getElementsByTagName("head")[0].appendChild(g)}},c._syntax=null,c._theme=null,c.getSyntax=function(){return c._syntax},c.setSyntax=function(a){if(a)c.loadSyntax(a,function(){var f=require("ace/mode/".concat(a)).Mode;c.editor.getSession().setMode(new f);c._syntax=a});else{var f=require("ace/mode/text").Mode;c.editor.getSession().setMode(new f);c._syntax=null}},c.getTheme=function(){return c._theme},c.setTheme=function(a){if(!a)throw"Expected theme name!";c.loadTheme(a,function(){c.editor.setTheme("ace/theme/"+
a);c._theme=a});localStorage.ACE_EDITOR_THEME=a},c.getValue=function(){return c.editor.getSession().getValue()},c.setValue=function(a){c.editor.getSession().setValue(a)},c.getTabSize=function(){return c.editor.getSession().getTabSize()},c.setTabSize=function(a){c.editor.getSession().setTabSize(a)},c.getSelection=function(){return c.editor.getSession().doc.getTextRange(c.editor.getSelectionRange())},c.__defineGetter__("value",c.getValue),c.__defineSetter__("value",c.setValue),c.__defineGetter__("width",
c.getWidth),c.__defineSetter__("width",c.setWidth),c.__defineGetter__("height",c.getHeight),c.__defineSetter__("height",c.setHeight),c.__defineGetter__("syntax",c.getSyntax),c.__defineSetter__("syntax",c.setSyntax),c.__defineGetter__("theme",c.getTheme),c.__defineSetter__("theme",c.setTheme),c.__defineGetter__("tabSize",c.getTabSize),c.__defineSetter__("tabSize",c.setTabSize),c.__defineGetter__("selection",c.getSelection),c.__defineSetter__("selection",function(){throw"ReadOnly property!";}),c.cmdHandler=
function(a){var f;switch(true){case (f=/^theme\-([a-z0-9_\-]+)$/i.exec(a))!=null:c.theme=f[1];break;case (f=/^syntax\-([a-z0-9_\-]+)$/i.exec(a))!=null:c.syntax=f[1];break;default:alert("Unknown command: "+a),console.log(f)}},c.getClipboard=function(){},c.__defineGetter__("clipboard",c.getClipboard),c.__defineSetter__("clipboard",function(){throw"AceEditor: Property .clipboard is readOnly!";}),c.__contextMenu=[{caption:"Edit",items:[{caption:"Cut",id:"cmd_cut",disabled:true,shortcut:"Ctrl + X"},{caption:"Copy",
id:"cmd_copy",disabled:true,shortcut:"Ctrl + C"},{caption:"Paste",id:"cmd_paste",disabled:true,shortcut:"Ctrl + V"},null,{caption:"Find",id:"cmd_find",shortcut:"Ctrl + F"}]},{caption:"Options",items:[{caption:"Theme",items:[{caption:"Clouds",input:"radio",id:"theme-clouds",handler:c.cmdHandler,checked:function(){return c.theme=="clouds"}},{caption:"Clouds Midnight",input:"radio",id:"theme-clouds_midnight",handler:c.cmdHandler,checked:function(){return c.theme=="clouds_midnight"}},{caption:"Cobalt",
input:"radio",id:"theme-cobalt",handler:c.cmdHandler,checked:function(){return c.theme=="cobalt"}},{caption:"Dawn",input:"radio",id:"theme-dawn",handler:c.cmdHandler,checked:function(){return c.theme=="dawn"}},{caption:"Eclipse",input:"radio",id:"theme-eclipse",handler:c.cmdHandler,checked:function(){return c.theme=="eclipse"}},{caption:"Idle Fingers",input:"radio",id:"theme-idle_fingers",handler:c.cmdHandler,checked:function(){return c.theme=="idle_fingers"}},{caption:"Kr-Theme",input:"radio",id:"theme-kr_theme",
handler:c.cmdHandler,checked:function(){return c.theme=="kr_theme"}},{caption:"Mono Industrial",input:"radio",id:"theme-mono_industrial",handler:c.cmdHandler,checked:function(){return c.theme=="mono_industrial"}},{caption:"Monokai",input:"radio",id:"theme-monokai",handler:c.cmdHandler,checked:function(){return c.theme=="monokai"}},{caption:"Pastel on Dark",input:"radio",id:"theme-pastel_on_dark",handler:c.cmdHandler,checked:function(){return c.theme=="pastel_on_dark"}},{caption:"Twilight",input:"radio",
id:"theme-twilight",handler:c.cmdHandler,checked:function(){return c.theme=="twilight"}}]}]},{caption:"Syntax Highlight",items:[{caption:"C / C++",id:"syntax-c_cpp",input:"radio",handler:c.cmdHandler,checked:function(){return c.syntax=="c_cpp"}},{caption:"Coffee",id:"syntax-coffee",input:"radio",handler:c.cmdHandler,checked:function(){return c.syntax=="coffee"}},{caption:"CSS",id:"syntax-css",input:"radio",handler:c.cmdHandler,checked:function(){return c.syntax=="css"}},{caption:"HTML",id:"syntax-html",
input:"radio",handler:c.cmdHandler,checked:function(){return c.syntax=="html"}},{caption:"Java",id:"syntax-java",input:"radio",handler:c.cmdHandler,checked:function(){return c.syntax=="java"}},{caption:"JavaScript",id:"syntax-javascript",input:"radio",handler:c.cmdHandler,checked:function(){return c.syntax=="javascript"}},{caption:"PHP",id:"syntax-php",input:"radio",handler:c.cmdHandler,checked:function(){return c.syntax=="php"}},{caption:"Python",id:"syntax-python",input:"radio",handler:c.cmdHandler,
checked:function(){return c.syntax=="python"}},{caption:"Ruby",id:"syntax-ruby",input:"radio",handler:c.cmdHandler,checked:function(){return c.syntax=="ruby"}},{caption:"XML",id:"syntax-xml",input:"radio",handler:c.cmdHandler,checked:function(){return c.syntax=="xml"}}]}],c.addContextMenu(c.__contextMenu,function(a){return!a.shiftKey?false:true}),c._DOManchors={},c.__getDOMAnchors=function(){return c._DOManchors},c.__setDOMAnchors=function(a){c._DOManchors=a;c._DOManchors.__internal=function(){c.editor.resize()}},
delete c.DOManchors,c.__defineGetter__("DOManchors",c.__getDOMAnchors),c.__defineSetter__("DOManchors",c.__setDOMAnchors),c.tabIndex=0,c.addEventListener("focus",function(){c.editor.focus()},false),localStorage.ACE_EDITOR_THEME)c.theme=localStorage.ACE_EDITOR_THEME}catch(a){}return c}
function ajaxAlert(c,a){window.DialogBox?(c=c.split("\n"),strMore=c.slice(1).join("\n"),DialogBox(c[0]||"Server returned a NULL response",{caption:a||"Server Error",type:"error",details:strMore||"",labelDetails:"See more details"})):alert((a?a+"\n":"")+c)}function displayLoading(){if(window.Notifier){var c=window.Notifier.getNotificationByName("AJAX");if(c!==null)c.value=!c.value?1:c.value+1,c.viewName="loading"}}
function stopLoading(){if(window.Notifier){var c=window.Notifier.getNotificationByName("AJAX");if(c!==null){c.value=!c.value?0:c.value-1;if(c.value<0)c.value=0;if(c.value==0)c.viewName="idle"}}}function XMLHttp(){if(window.ActiveXObject)try{result=new ActiveXObject("Msxml2.XMLHTTP")}catch(c){try{result=new ActiveXObject("Microsoft.XMLHTTP")}catch(a){result=null}}else result=null;!result&&typeof XMLHttpRequest!="undefined"&&(result=new XMLHttpRequest);return result?result:null}
function urlencode(c){return encodeURIComponent(c)}function __uniqueUrl(c){var a=(new Date).getTime();return c.indexOf("?")!==-1?c+"&rndval="+a.toString():c+"?rndval="+a.toString()}Object.defineProperty(Array.prototype,"addPOST",{get:function(){return function(c,a){if(c.length!=0)return this.push(urlencode(c).concat("=").concat(urlencode(a))),this}}});
function $_GET(c,a,b){var f=a?a:null,a=f!==null?false:true;if(typeof b!="undefined"&&b!==null)var b=b||0,g=parseInt((new Date).getTime()/1E3),i="CACHE_"+c;if(typeof b!="undefined"&&b!==null&&window.localStorage){var h=window.localStorage.getItem(i);if(h!==null){var j=h.split("\n\n")[0],k=parseInt(j);if(!isNaN(k)&&(b==0||g-k<b)){try{console.log('restoring url "'+c+'" from localStorage')}catch(l){}if(f){f(h.substr(j.length+2));return}else return h.substr(j.length+2)}}window.localStorage.removeItem("CACHE_"+
c)}var m=XMLHttp();if(typeof b!="undefined"&&window.localStorage)var o=i;f?m.onreadystatechange=function(){m.readyState==4&&(m.status==200?(o&&window.localStorage.setItem(o,g.toString()+"\n\n"+m.responseText),f(m.responseText)):f(null))}:displayLoading();return a?(m.open("GET",__uniqueUrl(c),false),m.send(null),stopLoading(),m.status==200?(o&&window.localStorage.setItem(o,g.toString()+"\n\n"+m.responseText),m.responseText):null):(m.open("GET",__uniqueUrl(c),true),m.send(null),m)}
function $_POST(c,a,b,f){var g=b?b:null,b=g?false:true;if(typeof f!="undefined"&&f!==null)var f=f||0,i=parseInt((new Date).getTime()/1E3),h="CACHE_"+c+"||"+a.join("||");if(typeof f!="undefined"&&f!==null&&window.localStorage){var j=window.localStorage.getItem(h);if(j!==null){var k=j.split("\n\n")[0],l=parseInt(k);if(!isNaN(l)&&(f<=0||i-l<f)){try{console.log('restoring url "'+c+'" from localStorage')}catch(m){}if(g){g(j.substr(k.length+2));return}else return j.substr(k.length+2)}}window.localStorage.removeItem(h)}if(typeof f!=
"undefined"&&window.localStorage)var o=h;var n=XMLHttp();displayLoading();if(g)n.onreadystatechange=function(){n.readyState==4&&(n.status==200?(o&&window.localStorage.setItem(o,i.toString()+"\n\n"+n.responseText),g(n.responseText)):g(null),stopLoading())};a=a?a.join("&"):"";return b?(n.open("POST",c,false),n.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),n.send(a),stopLoading(),n.status==200?(o&&window.localStorage.setItem(o,i.toString()+"\n\n"+n.responseText),n.responseText):
null):(n.open("POST",c,true),n.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),n.send(a),n)}
function $_JSON_POST(c,a,b,f){try{__DEBUG_JSON_POST__&&console.log("AJAX: "+c+"?"+a.join("&"))}catch(g){}b=typeof b!="undefined"?b?b:null:null;if(b==null){c=$_POST(c,a,null,f);try{return c===null?null:json_parse(c)}catch(i){return ajaxAlert(c),null}}else $_POST(c,a,function(a){var i;try{i=a===null?null:json_parse(a),b(i)}catch(c){return ajaxAlert(a,"$_JSON_POST - Async JSON Exception"),console.error(c),b(null),null}},f)}
function $_JSON_GET(c,a){var b=$_GET(c,null,a);try{return b===null?null:json_parse(b)}catch(f){return ajaxAlert(b,"Server Exception"),null}}
function $_FORM_POST(c,a,b){var f=document.createElement("form");f.setAttribute("method","post");typeof b!="undefined"&&f.setAttribute("target",b);f.setAttribute("action",c);for(var g,i,b=0;b<a.length;b++)g=a[b].toString(),c=g.substr(0,g.indexOf("=")),g=g.substr(c.length+1),c=decodeURIComponent(c),g=decodeURIComponent(g),i=document.createElement("input"),i.setAttribute("type","hidden"),i.setAttribute("name",c),i.value=g,f.appendChild(i);f.style.display="none";document.body.appendChild(f);f.submit();
document.body.removeChild(f)}function $_FORM_GET(c,a){var b=document.createElement("form");b.setAttribute("method","get");typeof a!="undefined"&&b.setAttribute("target",a);b.setAttribute("action",c);b.style.display="none";document.body.appendChild(b);b.submit();document.body.removeChild(b)}function $_SAVE(c,a){a=a||{};a.name=a.name||"unnamed-file";var b=[];b.addPOST("data",c);b.addPOST("cfg",JSON.stringify(a));$_FORM_POST("out/",b)}
function AllowDenyCheckbox(){var c=$("div","AllowDenyCheckbox"),a="";c.tabIndex=0;Object.defineProperty(c,"value",{get:function(){return a},set:function(b){if(["allow","deny","+","-","",null,false,0].indexOf(b)==-1)throw"Invalid state";b=b=="+"?"allow":b=="-"?"deny":b;removeStyle(c,a);a=b||"";addStyle(c,a)}});EnableCustomEventListeners(c);c.click=function(){switch(c.value){case "":c.value="allow";break;case "allow":c.value="deny";break;case "deny":c.value=""}c.onCustomEvent("click",c.value)};c.addEventListener("click",
c.click);Keyboard.bindKeyboardHandler(c,"space",c.click);disableSelection(c);return c}
function argsplit(c){for(var c=c.trim(),a=[],b="",f=null,g="",i=0,h=c.length;i<h;i++){g=c.charAt(i);switch(true){case g=="\\":i++;g=c.charAt(i)||"";switch(g){case "r":b+="\r";break;case "n":b+="\n";break;case "e":b+="\u001b";break;case "t":b+="\t";break;default:b+=g}break;case g=='"':case g=="'":if(f===null){f=g;break}else if(f==g&&(i==c.length-1||/[\s]/.test(c.charAt(i+1)))){f=null;a.push(b);b="";break}else b+=g;break;case /[\s]/.test(g)?true:false:if(f===null){if(i==c.length-1||/[\s]/.test(c.charAt(i+
1)))break;a.push(b);b=""}else b+=g;break;default:b+=g,i==c.length-1&&a.push(b)}oldChar=g}return a}
var Base64={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(c){for(var a="",b,f,g,i,h,j,k=0,c=Base64._utf8_encode(c);k<c.length;)b=c.charCodeAt(k++),f=c.charCodeAt(k++),g=c.charCodeAt(k++),i=b>>2,b=(b&3)<<4|f>>4,h=(f&15)<<2|g>>6,j=g&63,isNaN(f)?h=j=64:isNaN(g)&&(j=64),a=a+this._keyStr.charAt(i)+this._keyStr.charAt(b)+this._keyStr.charAt(h)+this._keyStr.charAt(j);return a},decode:function(c){for(var a="",b,f,g,i,h,j=0,c=c.replace(/[^A-Za-z0-9\+\/\=]/g,"");j<
c.length;)b=this._keyStr.indexOf(c.charAt(j++)),f=this._keyStr.indexOf(c.charAt(j++)),i=this._keyStr.indexOf(c.charAt(j++)),h=this._keyStr.indexOf(c.charAt(j++)),b=b<<2|f>>4,f=(f&15)<<4|i>>2,g=(i&3)<<6|h,a+=String.fromCharCode(b),i!=64&&(a+=String.fromCharCode(f)),h!=64&&(a+=String.fromCharCode(g));return a=Base64._utf8_decode(a)},_utf8_encode:function(c){for(var c=c.replace(/\r\n/g,"\n"),a="",b=0;b<c.length;b++){var f=c.charCodeAt(b);f<128?a+=String.fromCharCode(f):(f>127&&f<2048?a+=String.fromCharCode(f>>
6|192):(a+=String.fromCharCode(f>>12|224),a+=String.fromCharCode(f>>6&63|128)),a+=String.fromCharCode(f&63|128))}return a},_utf8_decode:function(c){for(var a="",b=0,f=c1=c2=0;b<c.length;)f=c.charCodeAt(b),f<128?(a+=String.fromCharCode(f),b++):f>191&&f<224?(c2=c.charCodeAt(b+1),a+=String.fromCharCode((f&31)<<6|c2&63),b+=2):(c2=c.charCodeAt(b+1),c3=c.charCodeAt(b+2),a+=String.fromCharCode((f&15)<<12|(c2&63)<<6|c3&63),b+=3);return a}};
function Button(c,a){var b=$("button");b.innerHTML=c;if(typeof a!="undefined")b.onclick=a;return b}
function CanvasDoc(c){var a=[],b=0,f=1,g=[],c=c||[],i=$("div","DOMCanvasDoc");EnableCustomEventListeners(i);var h=i.appendChild($("div").setAnchors({width:function(a){return a+"px"},height:function(a,b){return b+"px"}})),j=h.appendChild($("div","scroller").setAttr("style","width: "+(window.scrollbarWidth||15)+"px")),k=j.appendChild($("div"));Object.defineProperty(i,"height",{get:function(){return k.offsetHeight},set:function(a){a=isNaN(a)?0:a>>0;a<0&&(a=0);k.style.height=a+"px"}});var l=h.appendChild($("canvas").setAnchors({width:function(a){i.onCustomEvent("resize");
return(l.width=(a-(window.scrollbarWidth||15))*2)+"px"},height:function(a,b){i.onCustomEvent("resize");return(l.height=b*2)+"px"}}));Object.defineProperty(i,"top",{get:function(){return j.scrollTop},set:function(a){var b=j.scrollTop;j.scrollTop=a;if(b!=j.scrollTop)i.onCustomEvent("paint")}});l.addEventListener("mousewheel",function(a){i.top-=a.wheelDelta||a.wheelDeltaY},true);j.addEventListener("scroll",function(){m()},true);var m=function(){var a=l.getContext("2d"),b=l.offsetWidth,c=l.offsetHeight;
a.fillStyle="#333";a.fillRect(0,0,b,c);a.webkitImageSmoothingEnabled=true;for(var b=i.top,c=b+c,f=g.length,h=0;h<f;h++){if(g[h].y>c)break;else if(g[h].y+g[h].height<b)continue;g[h].img.style.width=g[h].width+"px";a.drawImage(g[h].img,g[h].x,g[h].y-b,g[h].width,g[h].height)}};i.addCustomEventListener("paint",function(){try{m()}catch(a){}return true});i.addCustomEventListener("preload",function(){b--;i.onCustomEvent("resize")});i.loadImages=function(c){a=[];for(var c=c||[],f=b=0;f<a.length;f++)a[f].state=
-2;for(f=0;f<c.length;f++)(function(c){var f=new Image;b++;f.state=-1;f.onload=function(){if(this.state!=-2)this.state=1,i.onCustomEvent("preload",this)};f.onerror=function(){if(this.state!=-2)this.state=0,i.onCustomEvent("preload",this)};f.computeHeight=function(a){return f.state!=1?0:a*f.height/f.width>>0};a.push(f);f.src=c})(c[f]);i.onCustomEvent("resize")};Object.defineProperty(i,"imgUp",{get:function(){return f},set:function(a){if(isNaN(a)||a<1)throw"Bad value. Expecting integer >= 1";f=a>>0;
i.onCustomEvent("resize")}});i.updateMatrix=function(b){g=[];for(var b=(b-10*f)/f>>0,c=a.length,h=0,j=20,m=0,k={},l=0;l<c;l++)if(a[l].state==1){k={x:(b+10)*h+5,y:j,img:a[l],width:b,height:a[l].computeHeight(b)};if(m<k.height)m=k.height;g.push(k);h++;h==f&&(j+=m+10,h=m=0)}i.height=j+m+10};Object.defineProperty(i,"matrix",{get:function(){return g}});i.addCustomEventListener("resize",function(){i.updateMatrix(l.offsetWidth);setTimeout(function(){m()},1);return true});i.loadImages(c);return i}
function DOMCheckBox(c){var a=$("input").setAttr("type","checkbox").addClass("DOM2Checkbox"),c=c||{},b=[false,true],f="two-states",g=0;Object.defineProperty(a,"valuesSet",{get:function(){return f},set:function(i){switch(i){case "tri-states-mixed":b=[false,true,""];f="tri-states-mixed";g=0;a.value=a.value;break;case "tri-states-allow-deny":b=["","allow","deny"];f="tri-states-allow-deny";a.value=a.value;break;default:b=[false,true],f="two-states",a.value=a.value}a.setAttribute("itype",f.replace(/-/g,
"_"))}});Object.defineProperty(a,"index",{get:function(){return g},set:function(i){i=!parseInt(i)?0:parseInt(i);i<0?i=f.length:i>=b.length&&(i=0);g=i;a.setAttribute("ivalue",b[g]===""?"none":b[g])}});Object.defineProperty(a,"checked",{get:function(){switch(f){case "tri-states-mixed":switch(g){case 1:return true;case 0:return false;default:return""}case "tri-states-allow-deny":switch(g){case 1:return"allow";case 2:return"deny";default:return""}default:return!!g}},set:function(b){switch(f){case "tri-states-mixed":switch(b){case "true":case 1:case true:a.index=
1;break;case "false":case false:case 0:a.index=0;break;default:a.index=2}break;case "tri-states-allow-deny":switch(b){case "true":case 1:case "allow":case true:a.index=1;break;case "false":case 2:case "deny":case false:a.index=2;break;default:a.index=0}break;default:switch(b){case "true":case true:case "1":case "on":case 1:a.index=1;break;default:a.index=0}}}});Object.defineProperty(a,"value",{get:function(){return a.checked},set:function(b){a.checked=b}});a.addEventListener("click",function(b){setTimeout(function(){!b.defaultPrevented&&
!a.readOnly&&!a.disabled&&(a.index+=1,a.onCustomEvent("change",a.checked))},1)},true);a.click=function(){a.index+=1;a.onCustomEvent("change",a.checked)};(function(){var b=false;Object.defineProperty(a,"disabled",{get:function(){return b},set:function(c){(b=!!c)?a.setAttribute("disabled","disabled"):a.removeAttribute("disabled")}})})();(function(){var b=false;Object.defineProperty(a,"readOnly",{get:function(){return b},set:function(c){(b=!!c)?a.setAttribute("readonly","readonly"):a.removeAttribute("readonly")}})})();
a.valuesSet=c.set||c.valuesSet;a.checked=c.checked||false;return a}
function CmsWidget(c){if(!c.id)throw"A cms widget must have defined it's id";var a=new Widget(c);a.loadAjaxHTMLContent=function(b,c){c=c||null;a.getBody().style.backgroundImage="url(img/loadbar.gif)";$_GET(b,function(b){a.getBody().style.backgroundImage="";b?a.getBody().innerHTML=b:a.getBody().innerHTML='<div class="DomWidgetError">Error loading content from '+a.config.html+"</div>"},c)};a.renderFeedContent=function(b,c,g,i,h){a.getBody().style.backgroundImage="url(img/loadbar.gif)";var j=[];j.addObject(c);
$_JSON_POST(b,j,function(b){a.getBody().style.backgroundImage="";try{var c=eval("new ".concat(g).concat("()"));i&&c.setParams(i);a.getBody().innerHTML="";a.getBody().appendChild(c.render(b,a))}catch(f){a.getBody().innerHTML='<div class="DomWidgetError">Widget Exception: <br />'+f+"</div>"}},typeof h!="undefined"?h:null)};a.addForm=function(b){a.getBody().style.backgroundImage="url(img/loadbar.gif)";$_JSON_POST("/forms/"+b+".form",[],function(b){a.getBody().style.backgroundImage="";b?a.config.action?
(a.form=new TForm(b,a.config.action,a.config.submit,a.config.reset),a.form.widget=a,a.getBody().appendChild(a.form)):alert("Action not defined on form id "+a.config.id):a.getBody().innerHTML='<div class="DomWidgetError">Bad form configuration response (got "'+b+'")</div>'})};switch(true){case typeof c.html!="undefined":a.loadAjaxHTMLContent(c.html,typeof c.cacheMaxAge!="undefined"?c.cacheMaxAge:null);break;case typeof c.render!="undefined":if(typeof c.feed=="undefined")throw'Missing "feed" from widget config';
if(typeof c.params=="undefined")throw'Missing "params" from widget config';a.renderFeedContent(c.feed,c.params,c.render,c.renderParams?c.renderParams:null,c.cacheMaxAge?c.cacheMaxAge:null);break;case typeof c.form!="undefined":a.addForm(c.form)}return a}
function ColorPicker(c){var a=$("div","DOMColorPicker");EnableCustomEventListeners(a);var b="";a.addCustomEventListener("internal_change",function(a){if(a==b)return false;b=a;q.style.backgroundColor=a;return true});a.tabIndex=0;var f=a.appendChild($("div")),g=f.appendChild($("div","preview"));f.appendChild($("div","state"));var i=$("div","DOMColorPickerOverlay");i.body=i.appendChild($("div"));i.body.appendChild(new DOMLabel("R",{x:10,y:120}));var h=i.body.appendChild((new Spinner({minValue:0,maxValue:255})).setAttr("style",
"position: absolute; left: 25px; top: 115px"));i.body.appendChild(new DOMLabel("G",{x:10,y:145}));var j=i.body.appendChild((new Spinner({minValue:0,maxValue:255})).setAttr("style","position: absolute; left: 25px; top: 140px"));i.body.appendChild(new DOMLabel("B",{x:10,y:170}));var k=i.body.appendChild((new Spinner({minValue:0,maxValue:255})).setAttr("style","position: absolute; left: 25px; top: 165px"));i.body.appendChild(new DOMLabel("H",{x:90,y:120}));var l=i.body.appendChild((new Spinner({minValue:0,
maxValue:360})).setAttr("style","position: absolute; left: 105px; top: 115px"));i.body.appendChild(new DOMLabel("S",{x:90,y:145}));var m=i.body.appendChild((new Spinner({minValue:0,maxValue:100})).setAttr("style","position: absolute; left: 105px; top: 140px"));i.body.appendChild(new DOMLabel("L",{x:90,y:170}));var o=i.body.appendChild((new Spinner({minValue:0,maxValue:100})).setAttr("style","position: absolute; left: 105px; top: 165px")),n=i.body.appendChild($("div","oldColor").setHTML("Cancel")),
q=i.body.appendChild($("div","newColor").setHTML("Set")),f=i.body.appendChild($("div","basicColorsHolder"));i.hsHolder=i.body.appendChild($("div","HS"));i.lHolder=i.body.appendChild($("div","L"));var p,r=i.hsHolder.appendChild(p=$("div")).appendChild($("canvas","HS").setAttr("width",359).setAttr("height",99)),t=p.appendChild($("div"));r.tabIndex=0;disableSelection(r);var w=i.lHolder.appendChild($("div")).appendChild($("canvas","L").setAttr("height",100).setAttr("width",1)),u=false,x=function(b){if(!isChildOf(b.src||
b.target,i))a.expanded=false,a.value=n.style.backgroundColor},B=window.paint=function(){var a=r.getContext("2d"),b=a.createImageData(r.width,r.height),i,c=0,f;for(i=0;i<360;i++)for(c=0;c<100;c++){f=z(i,c*0.01,0.5);var h=b,g=f.r,j=f.g;f=f.b;index=(i+(100-c)*h.width)*4;h.data[index+0]=g;h.data[index+1]=j;h.data[index+2]=f;h.data[index+3]=255}a.putImageData(b,0,0)},A=window.paintLight=function(a,b){for(var i=w.getContext("2d"),c=i.createImageData(w.width,w.height),f=0,h={},f=0;f<100;f++){var h=z(a,b*
0.01,f*0.01),g=c,j=h.r,m=h.g,h=h.b;index=(0+(100-f)*g.width)*4;g.data[index+0]=j;g.data[index+1]=m;g.data[index+2]=h;g.data[index+3]=255}i.putImageData(c,0,0)},z=function(a,b,i){a*=6/360;b=[i+=b*=i<0.5?i:1-i,i-a%1*b*2,i-=b*=2,i,i+a%1*b,i+b];return{r:Math.floor(b[~~a%6]*255),g:Math.floor(b[(a|16)%6]*255),b:Math.floor(b[(a|8)%6]*255)}};window.hsl2rgb=z;window.RGB2HEX=function(a){return"#".concat((1*a.r).toString(16)).concat((1*a.g).toString(16)).concat((1*a.b).toString(16))};Object.defineProperty(a,
"expanded",{get:function(){return u},set:function(b){b=!!b;if(b!=u){switch(b){case false:i.parentNode&&i.parentNode.removeChild(i);document.body.removeEventListener("mousedown",x,true);break;case true:n.style.backgroundColor=a.value;document.body.appendChild(i);B();var c=new Pinner(a,i,"bottom-left");i.offsetTop+i.offsetHeight>document.body.offsetHeight&&c.setPinMode("top-left","bottom-left");document.body.addEventListener("mousedown",x,true)}u=b}}});var C=0,D=0,s=0,F=0,G=0,L=0;Object.defineProperty(a,
"hue",{get:function(){return C},set:function(b){b=parseInt(b||0);C=b=b<0?0:b>360?360:b;t.style.left=b-8+"px";t.style.top=100-a.saturation-8+"px";A(a.hue,a.saturation);v()}});Object.defineProperty(a,"saturation",{get:function(){return D},set:function(b){b=parseInt(b||0);D=b=b<0?0:b>100?100:b;t.style.top=100-b-8+"px";t.style.left=a.hue-8+"px";A(a.hue,a.saturation);v()}});Object.defineProperty(a,"light",{get:function(){return s},set:function(a){a=parseInt(a||0);a=a<0?0:a>100?100:a;i.lHolder.style.backgroundPosition=
"100% "+(100-a-3)+"px";s=a;v()}});Object.defineProperty(a,"HSL",{get:function(){return"hsl("+a.hue+","+a.saturation+","+a.light+")"}});Object.defineProperty(a,"red",{get:function(){return F},set:function(a){a=a||0;F=a<0?0:a>255?255:a;I(false)}});Object.defineProperty(a,"green",{get:function(){return G},set:function(a){a=a||0;G=a<0?a:a>255?255:a;I()}});Object.defineProperty(a,"blue",{get:function(){return L},set:function(a){a=a||0;L=a<0?a:a>255?255:a;I()}});var I=function(){var b,c,f;b=F;c=G;var h=
f=L,j,m,k;b>c?(m=Math.max(b,h),j=Math.min(c,h)):(m=Math.max(c,h),j=Math.min(b,h));f=(m+j)/2;m==j?b=j=0:(k=m-j,j=f<128?255*k/(m+j):255*k/(511-m-j),b=b==m?(c-h)/k:c==m?2+(h-b)/k:4+(b-c)/k,b*=42.5,b<0?b+=255:b>255&&(b-=255));b=~~b%256;c=~~j%256;f=~~f%256;C=3.6*b/2.55+0.5<<0;D=c/2.55+0.5<<0;s=f/2.55+0.5<<0;A(C,D);i.lHolder.style.backgroundPosition="100% "+(100-a.light-3)+"px";t.style.left=a.hue-8+"px";t.style.top=100-a.saturation-8+"px";g.style.backgroundColor=a.value};Object.defineProperty(a,"RGB",{get:function(){return"rgb("+
a.red+","+a.green+","+a.blue+")"}});var O=function(a){return a.toString().length==1?"0"+a:a};Object.defineProperty(a,"value",{get:function(){return"#"+O(a.red.toString(16))+O(a.green.toString(16))+O(a.blue.toString(16))},set:function(b){var i;if(i=/^rgb\(([\s]+)?([\d]+)([\s]+)?,([\s]+)?([\d]+)([\s]+)?,([\s]+)?([\d]+)([\s]+)?\)$/i.exec(b))F=parseInt(i[2]),G=parseInt(i[5]),L=parseInt(i[8]),I(),g.style.backgroundColor=a.value,a.onCustomEvent("internal_change",a.value);else if(i=/^(\#)?([\da-f]{1})([\da-f]{1})([\da-f]{1})$/i.exec(b))F=
parseInt(i[2].concat(i[2]),16),G=parseInt(i[3].concat(i[3]),16),L=parseInt(i[4].concat(i[4]),16),I(),g.style.backgroundColor=a.value,a.onCustomEvent("internal_change",a.value);else if(i=/^(\#)?([\da-f]{2})([\da-f]{2})([\da-f]{2})$/i.exec(b))F=parseInt(i[2],16),G=parseInt(i[3],16),L=parseInt(i[4],16),I(),g.style.backgroundColor=a.value,a.onCustomEvent("internal_change",a.value);else throw"Invalid color: "+b;}});var v=function(){var b=z(a.hue,a.saturation*0.01,a.light*0.01);F=b.r;G=b.g;L=b.b;g.style.backgroundColor=
a.value;a.onCustomEvent("internal_change",a.value)};a.addEventListener("mousedown",function(b){if(!a.expanded&&b.which==1)a.expanded=true,b.stopPropagation(),b.preventDefault()},true);var J=function(b){var i=b.target||b.srcElement,c=0,f=0,c=b.offsetX,f=b.offsetY;i==t&&(c+=t.offsetLeft,f+=t.offsetTop);C=c;a.saturation=100-f;v();r.btnDown=true},P=function(b){if(r.btnDown){var i=b.target||b.srcElement,c=0,f=0,c=b.offsetX,f=b.offsetY;i==t&&(c+=t.offsetLeft,f+=t.offsetTop);C=c;a.saturation=100-f;v()}},
E=function(a){if(!(isChildOf(a.srcElement||a.target,p)&&a.type=="mouseout"))r.btnDown=false};r.addEventListener("mousedown",J,true);t.addEventListener("mousedown",J,true);r.addEventListener("mousemove",P,true);t.addEventListener("mousemove",P,true);r.addEventListener("mouseup",E,true);t.addEventListener("mouseup",E,true);r.addEventListener("mouseout",E,true);t.addEventListener("mouseout",E,true);J=function(b){if(w.btnDown)a.light=100-b.offsetY};w.addEventListener("mousedown",function(b){w.btnDown=
true;a.light=100-b.offsetY},true);w.addEventListener("mouseup",function(){w.btnDown=false},true);w.addEventListener("mousemove",J,true);w.addEventListener("mouseout",J,true);Keyboard.bindKeyboardHandler(a,"space",function(){a.expanded=true});Keyboard.bindKeyboardHandler(a,"enter",function(){a.expanded=true});Keyboard.bindKeyboardHandler(a,"esc",function(){a.expanded=false});a.addCustomEventListener("internal_change",function(){h.value=a.red;j.value=a.green;k.value=a.blue;l.value=a.hue;m.value=a.saturation;
o.value=a.light});h.addCustomEventListener("change",function(){a.red=h.value});j.addCustomEventListener("change",function(){a.green=j.value});k.addCustomEventListener("change",function(){a.blue=k.value});l.addCustomEventListener("change",function(){a.hue=l.value});m.addCustomEventListener("change",function(){a.saturation=m.value});o.addCustomEventListener("change",function(){a.light=o.value});a.value=c;n.addEventListener("click",function(){a.value=n.style.backgroundColor;a.expanded=false;a.onCustomEvent("change",
a.value)},true);q.addEventListener("click",function(){a.value=q.style.backgroundColor;a.expanded=false;a.onCustomEvent("change",a.value)},true);q.title="Current Color";n.title="Previous Color";c=[{name:"White",value:"#ffffff"},{name:"Silver",value:"#c0c0c0"},{name:"Gray",value:"#808080"},{name:"Black",value:"#000000"},{name:"Red",value:"#ff0000"},{name:"Maroon",value:"#800000"},{name:"Yellow",value:"#ffff00"},{name:"Olive",value:"#808000"},{name:"Lime",value:"#00ff00"},{name:"Green",value:"#008000"},
{name:"Aqua",value:"#00ffff"},{name:"Teal",value:"#008080"},{name:"Blue",value:"#0000ff"},{name:"Navy",value:"#000080"},{name:"Fuchsia",value:"#ff00ff"},{name:"Purple",value:"#800080"}];for(P=0;P<c.length;P++)(J=f.appendChild($("div").setAttr("style","background-color: "+c[P].value).setAttr("title",c[P].name))).onclick=function(){a.value=this.style.backgroundColor},J.ondblclick=function(){a.expanded=false;a.onCustomEvent("change",a.value)};return a}
function Cropper(){var c=$("div","DOMCropper"),a=c.appendChild($("div")),b=a.appendChild($("div","left")),f=a.appendChild($("div","right")),g=a.appendChild($("div","top")),i=a.appendChild($("div","bottom")),h=a.appendChild($("div","drag drag-top-left")),j=a.appendChild($("div","drag drag-top-right")),k=a.appendChild($("div","drag drag-top")),l=a.appendChild($("div","drag drag-left")),m=a.appendChild($("div","drag drag-right")),o=a.appendChild($("div","drag drag-bottom-left")),n=a.appendChild($("div",
"drag drag-bottom-right")),q=a.appendChild($("div","drag drag-bottom")),p=a.appendChild($("div","drag drag-center"));EnableCustomEventListeners(c);a.DOManchors={dummy:function(a,c){k.style.left=q.style.left=p.style.left=b.offsetWidth+(a-b.offsetWidth-f.offsetWidth)/2-4+"px";m.style.left=j.style.left=n.style.left=a-4-f.offsetWidth+"px";o.style.left=l.style.left=h.style.left=b.offsetWidth-4+"px";l.style.top=m.style.top=p.style.top=g.offsetHeight+(c-g.offsetHeight-i.offsetHeight)/2-4+"px";h.style.top=
k.style.top=j.style.top=g.offsetHeight-4+"px";o.style.top=q.style.top=n.style.top=c-i.offsetHeight-4+"px"}};Object.defineProperty(c,"left",{get:function(){return b.style.width?parseInt(b.style.width):b.offsetWidth},set:function(a){b.style.width=a+"px"}});Object.defineProperty(c,"right",{get:function(){return f.style.width?parseInt(f.style.width):f.offsetWidth},set:function(a){f.style.width=a+"px"}});Object.defineProperty(c,"top",{get:function(){return g.style.height?parseInt(g.style.height):g.offsetHeight},
set:function(a){b.style.top=f.style.top=g.style.height=a+"px"}});Object.defineProperty(c,"bottom",{get:function(){return i.style.height?parseInt(i.style.height):i.offsetHeight},set:function(a){b.style.bottom=f.style.bottom=i.style.height=a+"px"}});Object.defineProperty(c,"width",{get:function(){return c.offsetWidth-c.left-c.right}});Object.defineProperty(c,"height",{get:function(){return c.offsetHeight-c.top-c.bottom}});h.setAttribute("dragable","1");h.dragger=new dragObject(h,null,new Position(-4,
-4),new Position(screen.width,screen.height),null,function(){c.top=h.offsetTop+4;c.left=h.offsetLeft+4;a.paint()},function(){c.onCustomEvent("change")});n.setAttribute("dragable","1");n.dragger=new dragObject(n,null,new Position(-4,-4),new Position(screen.width,screen.height),null,function(){c.right=c.offsetWidth-n.offsetLeft+4;c.bottom=c.offsetHeight-n.offsetTop+4;a.paint()},function(){c.onCustomEvent("change")});j.setAttribute("dragable","1");j.dragger=new dragObject(j,null,new Position(-4,-4),
new Position(1E4,1E4),null,function(){c.top=j.offsetTop+4;c.right=c.offsetWidth-j.offsetLeft+4;a.paint()},function(){c.onCustomEvent("change")});o.setAttribute("dragable","1");o.dragger=new dragObject(o,null,new Position(-4,-4),new Position(1E4,1E4),null,function(){c.left=o.offsetLeft+4;c.bottom=c.offsetHeight-o.offsetTop+4;a.paint()},function(){c.onCustomEvent("change")});k.setAttribute("dragable","1");k.dragger=new dragObject(k,null,new Position(-4,-4),new Position(1E4,1E4),null,function(){c.top=
k.offsetTop+4;a.paint()},function(){c.onCustomEvent("change")});q.setAttribute("dragable","1");q.dragger=new dragObject(q,null,new Position(-4,-4),new Position(1E4,1E4),null,function(){c.bottom=c.offsetHeight-q.offsetTop+4;a.paint()},function(){c.onCustomEvent("change")});l.setAttribute("dragable","1");l.dragger=new dragObject(l,null,new Position(-4,-4),new Position(1E4,1E4),null,function(){c.left=l.offsetLeft+4;a.paint()},function(){c.onCustomEvent("change")});m.setAttribute("dragable","1");m.dragger=
new dragObject(m,null,new Position(-4,-4),new Position(1E4,1E4),null,function(){c.right=c.offsetWidth-m.offsetLeft+4;a.paint()},function(){c.onCustomEvent("change")});var r=0,t=0;p.setAttribute("dragable","1");p.dragger=new dragObject(p,null,new Position(-4,-4),new Position(1E4,1E4),function(){r=c.width;t=c.height},function(){var b=p.offsetLeft+4,i=p.offsetTop+4;c.left=b-Math.floor(r/2);c.right=c.offsetWidth-b-Math.floor(r/2);c.top=i-Math.floor(t/2);c.bottom=c.offsetHeight-i-Math.floor(t/2);a.paint()},
function(){c.onCustomEvent("change")});c.addCustomEventListener("change",function(){if(l.offsetLeft>m.offsetLeft)c.left=m.offsetLeft+4,c.right=c.offsetWidth-l.offsetLeft+4,a.paint();if(k.offsetTop>q.offsetTop)c.top=q.offsetTop+4,c.bottom=c.offsetHeight-k.offsetTop+4,a.paint();return true});return c}
function CSS_Modifier(c){this.css=c;this.ruleBegin=/^(([\s]+)?([a-z\d\_\-\:\[\]\=\s\.\"\'\(\)\>\*\@]+)([\s]+)?(\,)?([\s]+)?)+$/i;this.ruleContent=/^\{([\s\S]+?)?\}/;this.comment=/\/\*([\s\S]+?)\*\//;this.parse=function(){for(var a=this.css,b;comment=this.comment.exec(a);)a=a.replace(comment[0],"");for(var c=[],g={};(b=a.indexOf("{"))!=-1;){b=a.substr(0,b);g={rules:b};a=a.substr(b.length+1);b=a.indexOf("}");if(b==-1)throw"Cannot parse this css!";b=a.substr(0,b);a=a.substr(b.length+1);g.value=b;g.rules=
g.rules.trim("{").replace(/[\s]+/g," ").trim();g.value=g.value.replace(/[\s]+/g," ").trim();if(this.ruleBegin.test(g.rules)){g.rules=g.rules.split(",");b=0;for(var i=g.rules.length;b<i;b++)g.rules[b]=g.rules[b].trim();c.push(g)}}return c};this.inject=function(a){for(var b=this.parse(),c="",g=0,i=b.length;g<i;g++){for(var h=0,j=b[g].rules.length;h<j;h++)b[g].rules[h]=a.concat(b[g].rules[h]);c=c+b[g].rules.join(",\n")+" {\n\t"+b[g].value+"\n}\n"}return c};this.toString=function(){return c};return this}
function CSSParser(c){txt=c||"";var a={},b={},f=function(){var c=txt.split(";"),i;a={};b={};for(var f=0,j=c.length;f<j;f++)(function(c){c=c.trim();if(c.length&&(i=/^([\da-z\-]+)([\s]+)?\:([\s]+)?([^*]+)$/.exec(c))){var c=i[1],f=i[4];if(/^return /.test(f))try{var h=eval("(function(w,h){"+f+";})");b[c]=h}catch(g){console.warn("Could not parse anchor: "+f+";")}else a[c]=f}})(c[f])};Object.defineProperty(this,"textContent",{get:function(){return txt.toString()},set:function(a){txt=a.toString();f()}});
this.textContent=txt;this.toString=function(){var b=[],i;for(i in a)a.propertyIsEnumerable(i)&&b.push(i+": "+a[i]);return b.join("; ")};Object.defineProperty(this,"css",{get:function(){return this.toString()}});Object.defineProperty(this,"anchors",{get:function(){var a={},i=false,c;for(c in b)b.propertyIsEnumerable(c)&&(a[c]=b[c],i=true);Object.defineProperty(a,"toString",{get:function(){return function(){var b=[],i;for(i in a)a.propertyIsEnumerable(i)&&b.push(JSON.stringify(i)+":"+a[i].toString());
return"{"+b.join(", ")+"}"}}});return i?a:false}});return this}
function CSSUnitConvertor(c){var a="",b="",f=false;Object.defineProperty(this,"value",{get:function(){return a+b},set:function(c){c=(c||"").toString().toLowerCase().trim();switch(true){case c=="":b=a="";f=false;break;case /^auto|inherit|none$/.test(c):a=c;b="";f=false;break;case !!(c=/^([\d\.\-]+)(px|cm|mm|em|pt|\%|inch)$/.exec(c)):a=c[1];b=c[2];f=["%"].indexOf(b)==-1;break;default:throw"Bad css dimension value";}}});Object.defineProperty(this,"dimension",{get:function(){return a},set:function(c){if(f){var i;
if(!isNaN(c)||(i=["auto","inherit","none"].indexOf(c)>=0))i?(a=c,b="",f=false):a=parseFloat(c);else throw"Expected number!";}else throw"Read-Only dimension (not convertible)";}});Object.defineProperty(this,"unit",{get:function(){return b},set:function(a){if(f)if("px,cm,mm,em,pt,%,inch".split(",").indexOf(a)>=0)b=a;else throw"Expected css unit!";else throw"Read-Only unit (not convertible)";}});Object.defineProperty(this,"readOnly",{get:function(){return!f}});Object.defineProperty(this,"convertible",
{get:function(){return f}});this.to=function(c){c=(c||"").toString().toLowerCase().trim();switch(true){case !f:return null;case "px,cm,mm,em,pt,inch".split(",").indexOf(c)>=0:if(b==c)return a+b;else{var i;switch(b){case "px":i=parseFloat(a);break;case "mm":i=parseFloat(a)*3.779527559;break;case "cm":i=parseFloat(a)*37.795275591;break;case "em":i=parseFloat(a)*16;break;case "pt":i=parseFloat(a)*1.33375;break;case "inch":i=parseFloat(a)*100}switch(c){case "px":return(i.toFixed(2)+"px").replace(/\.([0]+)([a-z])/i,
"$2");case "em":return((i/16).toFixed(2)+"em").replace(/\.([0]+)([a-z])/i,"$2");case "cm":return((i*0.026458333).toFixed(2)+"cm").replace(/\.([0]+)([a-z])/i,"$2");case "mm":return((i*26.458333).toFixed(2)+"mm").replace(/\.([0]+)([a-z])/i,"$2");case "pt":return((i*0.75).toFixed(2)+"pt").replace(/\.([0]+)([a-z])/i,"$2");case "inch":return((i/100).toFixed(2)+"inch").replace(/\.([0]+)([a-z])/i,"$2")}}break;default:return null}};if(typeof c!="undefined")this.value=c;return this}
window.CSSDefs=window.CSSDefs||{};
function CSSBorderStyleInput(c){return(new DropDown([{id:"",name:"Default",icon:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAEwSURBVDiNrZOxisJAFEXPBIkghIlNRJgutiksUln7D36CpLEWrGxsLNKmsRG/JFiJZcRtsxaCICETbATZagU1WmT3lo9zDzPMPOE4zpdlWQ0qRGt9qVmW1bBtW1URAAejYvGeWtlQSslwOKTX62HbNkmSsNlsWC6XXK/XzwLDMJjP53S73fvM931830cpxXQ6feSfBZ1O516O45jBYECapgD0+30M47HycoLj8choNKLdbrPdbhFC0Gq1ADidTtxut8+CPM9Zr9cAeJ5HGIbU63WKomAymTzjr1f4jRCC2WyGlJKiKAiCgN1u98KVvgJAs9nENE3O5zOr1aq0/FEAEEURAPv9/i3zVqCUYjweA7BYLEiSpJT7808Urut+V92FLMv+YRe01hfgUKWstb78AE0MYGJdfC/XAAAAAElFTkSuQmCC"},{id:"none",
name:"None"},{id:"hidden",name:"Hidden (usefull for tables instead of none)"},{id:"inherit",name:"Inherited (from parent container)",icon:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAEwSURBVDiNrZOxisJAFEXPBIkghIlNRJgutiksUln7D36CpLEWrGxsLNKmsRG/JFiJZcRtsxaCICETbATZagU1WmT3lo9zDzPMPOE4zpdlWQ0qRGt9qVmW1bBtW1URAAejYvGeWtlQSslwOKTX62HbNkmSsNlsWC6XXK/XzwLDMJjP53S73fvM931830cpxXQ6feSfBZ1O516O45jBYECapgD0+30M47HycoLj8choNKLdbrPdbhFC0Gq1ADidTtxut8+CPM9Zr9cAeJ5HGIbU63WKomAymTzjr1f4jRCC2WyGlJKiKAiCgN1u98KVvgJAs9nENE3O5zOr1aq0/FEAEEURAPv9/i3zVqCUYjweA7BYLEiSpJT7808Urut+V92FLMv+YRe01hfgUKWstb78AE0MYGJdfC/XAAAAAElFTkSuQmCC"},
{id:"dotted",name:"Dotted",icon:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAADQSURBVDiN7dKxbYQwGIbh94xB1ok/QhSI4kTDAgzADAzAGKmYjcYD2AukDhUFQjFCJ1GQ7pp0KFWUr3+f6rsVRfEhIncuLISwaxG5Z1n2uAIAk7oYvvaXAGMMaZoCkCQJIoJSCq01IkIURSilEBHiOP4JDMPAOI4A9H2PtZayLGnbFmstTdNQVRXWWrquewFRnufvxpg3rTXTNOG9RynFsiw45ziOg33fcc6xbRvneeK9Z55nns/n162u68+rP1jX9f8HvwHoEMIOTFfiEML+Dc+QRbC9ibsuAAAAAElFTkSuQmCC"},
{id:"dashed",name:"Dashed",icon:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAADXSURBVDiN7ZIxioRAEABrDxFZGNDEQMwmMDGbVPyEf/Bd/sHcFxgLh6CBImgkDIigMhcc6wOMt6KmoQoa+uX7/q8Q4s0DtNabJYR4u64bPgkA489D8eYbAOszxHFMEAQA9H1P27akaYrjOADUdc2+7yRJwnmeVFX1L0opB6WUKcvSfCiKwiilzDRN9y7Pc5NlmTHGGK21UUoZKeXwklIOruuGYRjieR4Ay7IwzzNRFGHbNgBd13EcB1EUcV0XTdOwrut4B57cv67r95EAS2u9AeMTWWu9/QEEL2qtDoNIaAAAAABJRU5ErkJggg=="},
{id:"solid",name:"Solid",icon:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAABxSURBVDiN7ZKhCsAgFEXvhmnwwCSGNb/UX/Ff/Airs1mEC+alDdbGY3E3nXJOuotzrojIBsVITiMim7V21wQAtFUp3vsDgLkgpQTv/Ssp54wY4zNQSkHv/VWg1nrzEkI4tD8YY/w/+CJgSE4ATSOTnCftEiJjOGVciwAAAABJRU5ErkJggg=="},{id:"double",name:"Double",icon:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAB4SURBVDiNYxQTE7vJy8vLxUAG+Pz58zcWXl5eLgEBARlyDGBgYHjCRKZGOBh4A1hgjJqaGgYvLy+iNH358oXBzc0N1YALFy4w/Pv3jygDfvz4AWczKisrPyY3Fj58+EB5LIyGwaBIiZ8/f/7GwMDwhBzNnz9//gYABRg2ZGUgf08AAAAASUVORK5CYII="},
{id:"groove",name:"Groove"},{id:"ridge",name:"Ridge"},{id:"inset",name:"Inset"},{id:"outset",name:"Outset"}])).addClass("CSSBorderStyleInput").chain(function(){if(c)this.value=c}).chain(function(){this.onchange=function(){this.onCustomEvent("change")}})}window.CSSDefs=window.CSSDefs||{};
window.CSSDefs.colors={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#00FFFF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000000",blanchedalmond:"#FFEBCD",blue:"#0000FF",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#00FFFF",darkblue:"#00008B",darkcyan:"#008B8B",carkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgreen:"#006400",
darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#FF00FF",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",
gray:"#808080",green:"#008000",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgreen:"#90EE90",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#778899",lightsteelblue:"#B0C4DE",
lightyellow:"#FFFFE0",lime:"#00FF00",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#FF00FF",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",
orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",red:"#FF0000",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",
snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFFFFF",whitesmoke:"#F5F5F5",yellow:"#FFFF00",yellowgreen:"#9ACD32"};
function CSSColorStruc(c){var a=null;(c||{}).chain(function(){this.r>=0&&this.r<=255&&this.g>=0&&this.g<=255&&this.b>=0&&this.b<=255&&this.a>=0&&this.a<=1&&(a={r:this.r,g:this.g,b:this.b,a:this.a}.chain(function(){Object.defineProperty(this,"rgbValue",{get:function(){return{r:this.r,g:this.g,b:this.b}}});Object.defineProperty(this,"hrgb",{get:function(){return this.r.toString(16).lPad(2,"0")+this.g.toString(16).lPad(2,"0")+this.b.toString(16).lPad(2,"0")}});Object.defineProperty(this,"hrgba",{get:function(){return this.r.toString(16).lPad(2,
"0")+this.g.toString(16).lPad(2,"0")+this.b.toString(16).lPad(2,"0")+(255*this.a>>0).toString(16)}});Object.defineProperty(this,"rgb",{get:function(){return"rgb("+this.r+","+this.g+","+this.b+")"}});Object.defineProperty(this,"rgba",{get:function(){return"rgba("+this.r+","+this.g+","+this.b+","+this.a.toFixed(2)+")"}});Object.defineProperty(this,"alpha",{get:function(){return this.a}});Object.defineProperty(this,"alphaPercent",{get:function(){return this.a*100>>0}});this.setRed=function(a){if(a<0||
a>255)throw"Bad red value!";this.r=a;return this};this.setGreen=function(a){if(a<0||a>255)throw"Bad green value!";this.g=a;return this};this.setBlue=function(a){if(a<0||a>255)throw"Bad blue value!";this.b=a;return this};this.setAlpha=function(a){if(a<0||a>1)throw"Bad alpha value!";this.a=a;return this};this.toString=function(){return this.rgba}}))});return a}
function CSSColor(c){if(c=(c||"").toString().toLowerCase().trim()){var a;typeof window.CSSDefs.colors[c]!="undefined"&&(c=window.CSSDefs.colors[c].toLowerCase());switch(true){case !!(a=/^\#([\da-f]{6})$/i.exec(c)):return CSSColorStruc({r:parseInt(a[1].substr(0,2),16),g:parseInt(a[1].substr(2,2),16),b:parseInt(a[1].substr(4,2),16),a:1});case !!(a=/^\#([\da-f]{3})$/i.exec(c)):return CSSColorStruc({r:parseInt(a[1].substr(0,1)+a[1].substr(0,1),16),g:parseInt(a[1].substr(1,1)+a[1].substr(1,1),16),b:parseInt(a[1].substr(2,
1)+a[1].substr(2,1),16),a:1});case !!(a=/^rgb\(([\s]+)?([\d]+)([\s]+)?,([\s]+)?([\d]+)([\s]+)?,([\s]+)?([\d]+)([\s]+)?\)$/i.exec(c)):return CSSColorStruc({r:parseInt(a[2]),g:parseInt(a[5]),b:parseInt(a[8]),a:1});case !!(a=/^rgba\(([\s]+)?([\d]+)([\s]+)?,([\s]+)?([\d]+)([\s]+)?,([\s]+)?([\d]+)([\s]+)?,([\s]+)?((0?)\.[\d]+)([\s]+)?\)$/i.exec(c)):return CSSColorStruc({r:parseInt(a[2]),g:parseInt(a[5]),b:parseInt(a[8]),a:parseFloat(a[11])});default:return null}}else return null}
function CSSColorInput(c){return $("div","CSSColorInput").chain(function(){(function(a){return a.appendChild($("div","inner")).chain(function(){this.tabIndex=0;a.addEventListener("DOMFocusIn",function(){a.addClass("focused");a.onCustomEvent("focus")});a.addEventListener("DOMFocusOut",function(){a.removeClass("focused");a.onCustomEvent("blur")});var b=this.appendChild(new DropDown([{id:"",name:"Is"},{id:"inherit",name:"Inherit"},{id:"transparent",name:"Transparent"},{id:"empty",name:"Unspecified"}])).addClass("class");
b.onchange=function(){a.removeClass("color-inherit").removeClass("color-transparent").removeClass("color-empty");b.value&&a.addClass("color-"+b.value);a.onCustomEvent("change")};var c=this.appendChild(new ColorPicker("#000000"));c.title="Color";c.addCustomEventListener("change",function(){a.onCustomEvent("change")});var g=this.appendChild(new HSlider({value:100}));g.title="Completely opaque";g.addCustomEventListener("change",function(){a.onCustomEvent("change");g.title=g.value==0?"Fully transparent":
g.value==100?"Completely opaque":g.value+"% transparent";return true});setTimeout(function(){g.paint()},0);Object.defineProperty(a,"value",{get:function(){return b.value?b.value=="empty"?"":b.value:g.value<100?CSSColor(c.value).setAlpha(g.value/100).rgba:c.value},set:function(a){(a+="").toLowerCase().trim();switch(true){case a=="":b.value="empty";break;case a=="inherit":b.value="inherit";break;case a=="transparent":b.value="transparent";break;default:a=CSSColor(a),a==null?b.value="empty":(b.value=
"",c.value="#"+a.hrgb,g.value=a.alphaPercent)}b.onchange()}});var i=false,h=false;Object.defineProperty(a,"disabled",{get:function(){return i},set:function(b){i=!!b;for(var b=0,c=a.querySelectorAll("select, .DOMColorPicker, .DomHSlider")||[],f=c.length;b<f;b++)c[b].disabled=i&&h}});Object.defineProperty(a,"readOnly",{get:function(){return h},set:function(b){h=!!b;for(var b=0,c=a.querySelectorAll("select, .DOMColorPicker, .DomHSlider")||[],f=c.length;b<f;b++)c[b].disabled=i&&h}})})})(this)}).chain(function(){this.value=
c||""})}
function CSSDimensionInput(c){return $("div","CSSDimensionInput").chain(function(){(function(a){return a.appendChild($("div","inner")).chain(function(){this.tabIndex=0;a.addEventListener("DOMFocusIn",function(){a.addClass("focused");a.onCustomEvent("focus")},true);a.addEventListener("DOMFocusOut",function(){a.removeClass("focused");a.onCustomEvent("blur")},true);var b=this.appendChild(new DropDown([{id:"",name:"Is"},{id:"auto",name:"Automatic"},{id:"inherit",name:"Inherited"}])).addClass("class");b.onchange=
function(){a.removeClass("size-auto").removeClass("size-inherit");b.value&&a.addClass("size-"+b.value)};var c=this.appendChild(new Spinner({value:0}));Object.defineProperty(this,"size",{get:function(){return c.value},set:function(a){c.value=isNaN(a)?0:parseInt(a)}});var g=this.appendChild(new DropDown([{id:"px",name:"px"},{id:"pt",name:"points"},{id:"cm",name:"cm"},{id:"mm",name:"mm"},{id:"%",name:"%"},{id:"em",name:"em"}])).addClass("unit");Object.defineProperty(this,"unit",{get:function(){return g.value},
set:function(a){a=(a+"").toLowerCase();/^(px|pt|cm|mm|\%|em)$/.test(a)||(a="px");g.value=a}});b.addEventListener("change",function(){a.onCustomEvent("change");return true});g.addEventListener("change",function(){a.onCustomEvent("change");return true});c.addCustomEventListener("change",function(){a.onCustomEvent("change");return true});Object.defineProperty(a,"value",{get:function(){return b.value==""?parseInt(c.value||"0")+g.value:b.value},set:function(a){a=(a||"").toString().trim().toLowerCase();
switch(a){case "left":case "top":a="0%";break;case "right":case "bottom":a="100%";break;case "center":case "middle":a="50%"}(a=/^(auto|inherit|((\-)?[\d\.]+)(px|pt|cm|mm|em|\%)?)$/.exec((a+"").toLowerCase()))?(b.value=/^auto|inherit$/.test(a[1])?a[1]:"",c.value=parseInt(a[2]||"0"),g.value=a[4]||"px"):(b.value="auto",b.onchange());b.onchange()}});var i=false,h=false;Object.defineProperty(a,"disabled",{get:function(){return i},set:function(b){for(var b=!!b,c=0,f=a.querySelectorAll("input, select")||
[],g=f.length;c<g;c++)f[c].disabled=b||h;i=b}});Object.defineProperty(a,"readOnly",{get:function(){return h},set:function(b){for(var b=!!b,c=0,f=a.querySelectorAll("input, select")||[],g=f.length;c<g;c++)f[c].disabled=b||i;h=b}})})})(this)}).chain(function(){if(c)this.value=c})}
function CSSEditor_cmd_edit_borders(c){c.handlers.cmd_edit_borders=function(){var a={},b=function(b,c){return a[b]=c},f=function(b){var c;if(!(c=a[b]))throw"Namespace "+b+" is not defined (yet?)";return c},g=getUID(),i=b("0001-dlg",(new Dialog({alwaysOnTop:false,appIcon:"",caption:"Border properties",closeable:true,height:278,maximizeable:false,maximized:false,minHeight:278,minWidth:292,minimizeable:false,modal:false,moveable:true,resizeable:true,scrollable:false,visible:true,width:292,x:c.width+
4,y:0,childOf:c})).chain(function(){Object.defineProperty(this,"pid",{get:function(){return g}});this.addClass("PID-"+g)})),h=c.nodeAttributes;b("0001-tabs",(new TabPanel({initTabs:[{id:"0001-sheet",caption:"Width",closeable:false},{id:"0002-sheet",caption:"Style",closeable:false},{id:"0003-sheet",caption:"Color",closeable:false},{id:"0004-sheet",caption:"Corners Radius",closeable:false}]})).chain(function(){b("0001-sheet",this.getTabById("0001-sheet").getSheet());b("0002-sheet",this.getTabById("0002-sheet").getSheet());
b("0003-sheet",this.getTabById("0003-sheet").getSheet());b("0004-sheet",this.getTabById("0004-sheet").getSheet())}).setAttr("style","top: 10px; left: 10px; right: 10px; bottom: 40px; position: absolute"));b("0001-sheet",f("0001-sheet"));var j=b("border-top-width",(new CSSDimensionInput(h["border-top-width"])).setAttr("style","top: 10px; left: 80px; position: absolute; width: auto; right: 10px;")),k=b("border-right-width",(new CSSDimensionInput(h["border-right-width"])).setAttr("style","top: 40px; left: 80px; position: absolute; width: auto; right: 10px;")),
l=b("border-bottom-width",(new CSSDimensionInput(h["border-bottom-width"])).setAttr("style","top: 70px; left: 80px; position: absolute; width: auto; right: 10px;")),m=b("border-left-width",(new CSSDimensionInput(h["border-left-width"])).setAttr("style","top: 100px; left: 80px; position: absolute; width: auto; right: 10px;")),o=b("border-width-same",(new DOMCheckBox).setAttr("style","left: 6px; bottom: 8px; position: absolute"));b("0001-lbl",(new DOMLabel("Top:")).setAttr("style","top: 10px; left: 10px; width: 50px; position: absolute; text-overflow: ellipsis"));
b("0002-lbl",(new DOMLabel("Right:")).setAttr("style","top: 40px; left: 10px; width: 50px; position: absolute; text-overflow: ellipsis"));b("0003-lbl",(new DOMLabel("Bottom:")).setAttr("style","top: 70px; left: 10px; width: 50px; position: absolute; text-overflow: ellipsis"));b("0004-lbl",(new DOMLabel("Left:")).setAttr("style","top: 100px; left: 10px; width: 50px; position: absolute; text-overflow: ellipsis"));b("0005-lbl",(new DOMLabel("All border-widths are the same",{"for":f("border-width-same")})).setAttr("style",
"bottom: 10px; left: 30px; width: auto; position: absolute; text-overflow: ellipsis"));o.addCustomEventListener("change",function(){o.checked?(k.value=l.value=m.value=j.value,k.disabled=l.disabled=m.disabled=true):k.disabled=l.disabled=m.disabled=false;return true});j.addCustomEventListener("change",function(){if(o.checked)k.value=l.value=m.value=j.value;return true});b("0002-sheet",f("0002-sheet"));var n=b("border-top-style",(new CSSBorderStyleInput(h["border-top-style"])).setAttr("style","top: 10px; left: 80px; position: absolute; width: auto; right: 10px;")),
q=b("border-right-style",(new CSSBorderStyleInput(h["border-right-style"])).setAttr("style","top: 40px; left: 80px; position: absolute; width: auto; right: 10px;")),p=b("border-bottom-style",(new CSSBorderStyleInput(h["border-bottom-style"])).setAttr("style","top: 70px; left: 80px; position: absolute; width: auto; right: 10px;")),r=b("border-left-style",(new CSSBorderStyleInput(h["border-left-style"])).setAttr("style","top: 100px; left: 80px; position: absolute; width: auto; right: 10px;")),t=b("border-style-same",
(new DOMCheckBox).setAttr("style","left: 6px; bottom: 8px; position: absolute"));b("0006-lbl",(new DOMLabel("Top:")).setAttr("style","top: 10px; left: 10px; width: 50px; position: absolute; text-overflow: ellipsis"));b("0007-lbl",(new DOMLabel("Right:")).setAttr("style","top: 40px; left: 10px; width: 50px; position: absolute; text-overflow: ellipsis"));b("0008-lbl",(new DOMLabel("Bottom:")).setAttr("style","top: 70px; left: 10px; width: 50px; position: absolute; text-overflow: ellipsis"));b("0009-lbl",
(new DOMLabel("Left:")).setAttr("style","top: 100px; left: 10px; width: 50px; position: absolute; text-overflow: ellipsis"));b("0010-lbl",(new DOMLabel("All border-styles are the same",{"for":f("border-style-same")})).setAttr("style","bottom: 10px; left: 30px; width: auto; position: absolute; text-overflow: ellipsis; right: 10px"));t.addCustomEventListener("change",function(){t.checked?(q.value=p.value=r.value=n.value,q.disabled=p.disabled=r.disabled=true):q.disabled=p.disabled=r.disabled=false;return true});
n.addCustomEventListener("change",function(){if(t.checked)q.value=p.value=r.value=n.value;return true});b("0003-sheet",f("0003-sheet"));var w=b("border-top-color",(new CSSColorInput(h["border-top-color"])).setAttr("style","top: 10px; left: 80px; position: absolute; width: auto; right: 10px;")),u=b("border-right-color",(new CSSColorInput(h["border-right-color"])).setAttr("style","top: 40px; left: 80px; position: absolute; width: auto; right: 10px;")),x=b("border-bottom-color",(new CSSColorInput(h["border-bottom-color"])).setAttr("style",
"top: 70px; left: 80px; position: absolute; width: auto; right: 10px;")),B=b("border-left-color",(new CSSColorInput(h["border-left-color"])).setAttr("style","top: 100px; left: 80px; position: absolute; width: auto; right: 10px;")),A=b("border-color-same",(new DOMCheckBox).setAttr("style","left: 6px; bottom: 8px; position: absolute"));b("0011-lbl",(new DOMLabel("Top:")).setAttr("style","top: 10px; left: 10px; width: 50px; position: absolute; text-overflow: ellipsis"));b("0012-lbl",(new DOMLabel("Right:")).setAttr("style",
"top: 40px; left: 10px; width: 50px; position: absolute; text-overflow: ellipsis"));b("0013-lbl",(new DOMLabel("Bottom:")).setAttr("style","top: 70px; left: 10px; width: 50px; position: absolute; text-overflow: ellipsis"));b("0014-lbl",(new DOMLabel("Left:")).setAttr("style","top: 100px; left: 10px; width: 50px; position: absolute; text-overflow: ellipsis"));b("0015-lbl",(new DOMLabel("All border-colors are the same",{"for":f("border-color-same")})).setAttr("style","bottom: 10px; left: 30px; width: auto; position: absolute; text-overflow: ellipsis; right: 10px"));
A.addCustomEventListener("change",function(){A.checked?(u.value=x.value=B.value=w.value,u.disabled=x.disabled=B.disabled=true):u.disabled=x.disabled=B.disabled=false;return true});w.addCustomEventListener("change",function(){if(A.checked)u.value=x.value=B.value=w.value;return true});b("0004-sheet",f("0004-sheet"));var z=b("border-top-left-radius",(new CSSDimensionInput(h["border-top-left-radius"])).setAttr("style","top: 10px; left: 80px; position: absolute; width: auto; right: 10px;")),C=b("border-top-right-radius",
(new CSSDimensionInput(h["border-top-right-radius"])).setAttr("style","top: 40px; left: 80px; position: absolute; width: auto; right: 10px;")),D=b("border-bottom-right-radius",(new CSSDimensionInput(h["border-bottom-right-radius"])).setAttr("style","top: 70px; left: 80px; position: absolute; width: auto; right: 10px;")),s=b("border-bottom-left-radius",(new CSSDimensionInput(h["border-bottom-left-radius"])).setAttr("style","top: 100px; left: 80px; position: absolute; width: auto; right: 10px;")),F=
b("border-radius-same",(new DOMCheckBox).setAttr("style","left: 6px; bottom: 8px; position: absolute"));F.addCustomEventListener("change",function(){F.checked?(C.value=D.value=s.value=z.value,C.disabled=D.disabled=s.disabled=true):C.disabled=D.disabled=s.disabled=false;return true});z.addCustomEventListener("change",function(){if(F.checked)C.value=D.value=s.value=z.value;return true});b("0016-lbl",(new DOMLabel("Top-Left:")).setAttr("style","top: 10px; left: 10px; width: 60px; position: absolute; text-overflow: ellipsis"));
b("0017-lbl",(new DOMLabel("Top-Right:")).setAttr("style","top: 40px; left: 10px; width: 60px; position: absolute; text-overflow: ellipsis"));b("0018-lbl",(new DOMLabel("Btm-Right:")).setAttr("style","top: 70px; left: 10px; width: 60px; position: absolute; text-overflow: ellipsis"));b("0019-lbl",(new DOMLabel("Btm-Left:")).setAttr("style","top: 100px; left: 10px; width: 60px; position: absolute; text-overflow: ellipsis"));b("0020-lbl",(new DOMLabel("All border-radiuses are the same",{"for":f("border-radius-same")})).setAttr("style",
"bottom: 10px; left: 30px; width: auto; position: absolute; text-overflow: ellipsis; right: 10px"));b("0001-btn",(new Button("Ok",function(){i.appHandler("cmd_ok")})).setAttr("style","bottom: 10px; right: 70px; position: absolute; font-weight: bold"));b("0002-btn",(new Button("Cancel",function(){i.close()})).setAttr("style","bottom: 10px; right: 10px; position: absolute"));f("0001-dlg").insert(f("0001-tabs"));f("0001-tabs").insert(f("0001-sheet"));f("0001-sheet").insert(f("0001-lbl"));f("0001-sheet").insert(f("border-top-width"));
f("0001-sheet").insert(f("border-right-width"));f("0001-sheet").insert(f("border-bottom-width"));f("0001-sheet").insert(f("border-left-width"));f("0001-sheet").insert(f("border-width-same"));f("0001-sheet").insert(f("0002-lbl"));f("0001-sheet").insert(f("0003-lbl"));f("0001-sheet").insert(f("0004-lbl"));f("0001-sheet").insert(f("0005-lbl"));f("0001-tabs").insert(f("0002-sheet"));f("0002-sheet").insert(f("0006-lbl"));f("0002-sheet").insert(f("0007-lbl"));f("0002-sheet").insert(f("0008-lbl"));f("0002-sheet").insert(f("0009-lbl"));
f("0002-sheet").insert(f("0010-lbl"));f("0002-sheet").insert(f("border-top-style"));f("0002-sheet").insert(f("border-right-style"));f("0002-sheet").insert(f("border-bottom-style"));f("0002-sheet").insert(f("border-left-style"));f("0002-sheet").insert(f("border-style-same"));f("0001-tabs").insert(f("0003-sheet"));f("0003-sheet").insert(f("0011-lbl"));f("0003-sheet").insert(f("0012-lbl"));f("0003-sheet").insert(f("0013-lbl"));f("0003-sheet").insert(f("0014-lbl"));f("0003-sheet").insert(f("0015-lbl"));
f("0003-sheet").insert(f("border-top-color"));f("0003-sheet").insert(f("border-right-color"));f("0003-sheet").insert(f("border-bottom-color"));f("0003-sheet").insert(f("border-left-color"));f("0003-sheet").insert(f("border-color-same"));f("0001-tabs").insert(f("0004-sheet"));f("0004-sheet").insert(f("0016-lbl"));f("0004-sheet").insert(f("0017-lbl"));f("0004-sheet").insert(f("0018-lbl"));f("0004-sheet").insert(f("0019-lbl"));f("0004-sheet").insert(f("0020-lbl"));f("0004-sheet").insert(f("border-top-left-radius"));
f("0004-sheet").insert(f("border-top-right-radius"));f("0004-sheet").insert(f("border-bottom-left-radius"));f("0004-sheet").insert(f("border-bottom-right-radius"));f("0004-sheet").insert(f("border-radius-same"));f("0001-dlg").insert(f("0001-btn"));f("0001-dlg").insert(f("0002-btn"));o.checked=h["border-width"].indexOf(" ")==-1;t.checked=h["border-style"].indexOf(" ")==-1;A.checked=h["border-color"].indexOf(" ")==-1;F.checked=h["border-radius"].indexOf(" ")==-1;o.onCustomEvent("change");t.onCustomEvent("change");
A.onCustomEvent("change");F.onCustomEvent("change");i.handlers.cmd_ok=function(){h["border-top-width"]=j.value;h["border-right-width"]=k.value;h["border-bottom-width"]=l.value;h["border-left-width"]=m.value;h["border-top-style"]=n.value;h["border-right-style"]=q.value;h["border-bottom-style"]=p.value;h["border-left-style"]=r.value;h["border-top-color"]=w.value;h["border-right-color"]=u.value;h["border-bottom-color"]=x.value;h["border-left-color"]=B.value;h["border-top-left-radius"]=z.value;h["border-top-right-radius"]=
C.value;h["border-bottom-left-radius"]=s.value;h["border-bottom-right-radius"]=D.value;i.close()};i.closeCallback=function(){setTimeout(function(){i.purge();h=i=void 0},10);return true};Keyboard.bindKeyboardHandler(i,"enter",function(){i.appHandler("cmd_ok")});Keyboard.bindKeyboardHandler(i,"esc",function(){i.close()});setTimeout(function(){i.paint();i.ready()},1);return i}}
function CSSEditor_cmd_edit_colors(c){c.handlers.cmd_edit_colors=function(a,b,f){if(a||b){var f=f||{},g=c.nodeAttributes,i={},h=function(a,b){return i[a]=b},j=function(a){var b;if(!(b=i[a]))throw"Namespace "+a+" is not defined (yet?)";return b},k=getUID(),l=70;l+=b?70:0;l+=a?220:0;var m=0,o=0;b&&(m=30);a&&(o=m?m+75:30);var n=h("0001-dlg",(new Dialog({alwaysOnTop:false,appIcon:"",caption:"Background and Color",closeable:true,height:l,maximizeable:true,maximized:false,minHeight:l,minWidth:400,minimizeable:true,
modal:false,moveable:true,resizeable:true,scrollable:false,visible:true,width:400,x:c.width+2,y:0,childOf:c})).chain(function(){Object.defineProperty(this,"pid",{get:function(){return k}});this.addClass("PID-"+k)}));if(b){h("0001-holder",(new DOMPlaceable({caption:"Color",appearence:"opaque"})).setAttr("style","top: "+m+"px; left: 10px; right: 10px; position: absolute; height: 45px"));h("0002-lbl",(new DOMLabel("Color:")).setAttr("style","top: 15px; left: 10px; width: 120px; position: absolute; text-overflow: ellipsis"));
var q=h("0001-text",(new CSSColorInput(g.color)).setAttr("style","top: 10px; left: 140px; position: absolute; margin: 0; width: auto; right: 10px"))}if(a){h("0002-holder",(new DOMPlaceable({caption:"Background",appearence:"opaque"})).setAttr("style","top: "+o+"px; left: 10px; right: 10px; position: absolute; bottom: 40px"));h("0003-lbl",(new DOMLabel("BG Color:")).setAttr("style","top: 15px; left: 10px; width: 120px; position: absolute; text-overflow: ellipsis"));h("0004-lbl",(new DOMLabel("BG Image:")).setAttr("style",
"top: 50px; left: 10px; width: 120px; position: absolute; text-overflow: ellipsis"));h("0005-lbl",(new DOMLabel("BG Position (X / Y):")).setAttr("style","top: 85px; left: 10px; width: 120px; position: absolute; text-overflow: ellipsis"));h("0006-lbl",(new DOMLabel("BG Repeat:")).setAttr("style","top: 120px; left: 10px; width: 120px; position: absolute; text-overflow: ellipsis"));h("0007-lbl",(new DOMLabel("BG Attachment:")).setAttr("style","top: 155px; left: 10px; width: 120px; position: absolute; text-overflow: ellipsis"));
var p=h("0002-text",(new CSSColorInput(g["background-color"])).setAttr("style","top: 10px; left: 140px; position: absolute; margin: 0; width: auto; right: 10px")),r=h("0003-text",(new CSSSourceInput(g["background-image"],function(){var a={urlFormat:true,contentType:/^image(\/|$)/i},b;for(b in f)f.propertyIsEnumerable(b)&&(a[b]=f[b]);return a}())).setAttr("style","top: 45px; left: 140px; position: absolute; margin: 0; width: auto; right: 10px")),t=h("0004-text",(new CSSDimensionInput("")).setAttr("style",
"top: 80px; left: 140px; position: absolute; margin: 0; width: auto;").setAnchors({width:function(a){return(a-160)/2+5+"px"}}).setProperty("value",g["background-position-x"])),w=h("0004a-text",(new CSSDimensionInput("")).setAttr("style","top: 80px; position: absolute; margin: 0; width: auto;").setAnchors({width:function(a){return(a-160)/2+"px"},left:function(a){return(a-160)/2+150+"px"}}).setProperty("value",g["background-position-y"])),u=h("0005-text",(new DropDown([{id:"",name:"Unspecified"},{id:"inherit",
name:"Inherited from parent"},{id:"repeat",name:"Tiles"},{id:"repeat-x",name:"Horizontal"},{id:"repeat-y",name:"Vertical"},{id:"no-repeat",name:"None"}])).setAttr("style","top: 115px; left: 140px; position: absolute; margin: 0; width: auto; right: 10px").setProperty("value",g["background-repeat"])),x=h("0006-text",(new DropDown([{id:"",name:"Unspecified"},{id:"inherit",name:"Inherited from parent"},{id:"scroll",name:"Scroll"},{id:"fixed",name:"Fixed"}])).setAttr("style","top: 150px; left: 140px; position: absolute; margin: 0; width: auto; right: 10px").setProperty("value",
g["background-attachment"]))}h("0001-btn",(new Button("Ok",function(){n.appHandler("cmd_ok")})).setAttr("style","bottom: 10px; right: 75px; position: absolute; font-weight: bold"));h("0002-btn",(new Button("Cancel",function(){n.close()})).setAttr("style","bottom: 10px; right: 10px; position: absolute"));b&&(j("0001-dlg").insert(j("0001-holder")),j("0001-holder").insert(j("0002-lbl")),j("0001-holder").insert(j("0001-text")));a&&(j("0001-dlg").insert(j("0002-holder")),j("0002-holder").insert(j("0003-lbl")),
j("0002-holder").insert(j("0002-text")),j("0002-holder").insert(j("0004-lbl")),j("0002-holder").insert(j("0005-lbl")),j("0002-holder").insert(j("0006-lbl")),j("0002-holder").insert(j("0007-lbl")),j("0002-holder").insert(j("0003-text")),j("0002-holder").insert(j("0004-text")),j("0002-holder").insert(j("0004a-text")),j("0002-holder").insert(j("0005-text")),j("0002-holder").insert(j("0006-text")));n.handlers.cmd_ok=function(){if(b)g.color=q.value;if(a)g["background-color"]=p.value,g["background-image"]=
r.value,g["background-position-x"]=t.value,g["background-position-y"]=w.value,g["background-repeat"]=u.value,g["background-attachment"]=x.value;n.close()};n.closeCallback=function(){setTimeout(function(){n.purge();g=n=void 0},10);return true};Keyboard.bindKeyboardHandler(n,"enter",function(){n.appHandler("cmd_ok")});Keyboard.bindKeyboardHandler(n,"esc",function(){n.close()});j("0001-dlg").insert(j("0001-btn"));j("0001-dlg").insert(j("0002-btn"));setTimeout(function(){n.paint();n.ready()},1);return n}}}
function CSSEditor_cmd_edit_margins(c){c.handlers.cmd_edit_margins=function(){var a={},b=function(b,c){return a[b]=c},f=function(b){var c;if(!(c=a[b]))throw"Namespace "+b+" is not defined (yet?)";return c},g=getUID(),i=b("0001-dlg",(new Dialog({alwaysOnTop:false,appIcon:"",caption:"Edit Box Margins",closeable:true,height:227,maximizeable:false,maximized:false,minHeight:50,minWidth:50,minimizeable:false,modal:false,moveable:true,resizeable:false,scrollable:false,visible:true,width:237,childOf:c,y:0,
x:c.width+2})).chain(function(){Object.defineProperty(this,"pid",{get:function(){return g}});this.addClass("PID-"+g)}));b("0001-lbl",(new DOMLabel("Top:")).setAttr("style","top: 20px; left: 20px; width: 40px; position: absolute; text-overflow: ellipsis"));b("0002-lbl",(new DOMLabel("Right:")).setAttr("style","top: 50px; left: 20px; width: 50px; position: absolute; text-overflow: ellipsis"));b("0003-lbl",(new DOMLabel("Bottom:")).setAttr("style","top: 80px; left: 20px; width: 50px; position: absolute; text-overflow: ellipsis"));
b("0004-lbl",(new DOMLabel("Left:")).setAttr("style","top: 110px; left: 20px; width: 50px; position: absolute; text-overflow: ellipsis"));var h=c.nodeAttributes,j=b("0001-text",(new CSSDimensionInput).setAttr("style","top: 15px; left: 75px; position: absolute; margin: 0; right: 20px")),k=b("0002-text",(new CSSDimensionInput).setAttr("style","top: 45px; left: 75px; position: absolute; margin: 0; right: 20px")),l=b("0003-text",(new CSSDimensionInput).setAttr("style","top: 75px; left: 75px; position: absolute; margin: 0; right: 20px")),
m=b("0004-text",(new CSSDimensionInput).setAttr("style","top: 105px; left: 75px; position: absolute; margin: 0; right: 20px"));j.value=h["margin-top"];k.value=h["margin-right"];l.value=h["margin-bottom"];m.value=h["margin-left"];var o=b("0001-check",(new DOMCheckBox({valuesSet:"two-states",checked:"false"})).setAttr("style","top: 140px; left: 15px; position: absolute"));o.addCustomEventListener("change",function(){o.value?(k.value=l.value=m.value=j.value,k.disabled=l.disabled=m.disabled=true):k.disabled=
l.disabled=m.disabled=false});h.margin.indexOf(" ")==-1&&o.click();j.addCustomEventListener("change",function(){if(o.checked)m.value=k.value=l.value=j.value;return true});b("0005-lbl",(new DOMLabel("Modify all margins",{"for":o})).setAttr("style","top: 143px; left: 40px; width: auto; position: absolute; text-overflow: ellipsis; right: 20px"));b("0001-btn",(new Button("Ok",function(){i.ok()})).setAttr("style","bottom: 10px; right: 80px; position: absolute; font-weight: bold"));b("0002-btn",(new Button("Cancel",
function(){i.close()})).setAttr("style","bottom: 10px; right: 20px; position: absolute"));i.cancel=function(){setTimeout(function(){try{i.close(),i.purge(),h=i=void 0}catch(a){}},10)};i.ok=function(){h["margin-left"]=m.value;h["margin-top"]=j.value;h["margin-bottom"]=l.value;h["margin-right"]=k.value;h=void 0;i.close()};Keyboard.bindKeyboardHandler(i,"esc",i.close);Keyboard.bindKeyboardHandler(i,"enter",i.ok);i.closeCallback=function(){i.cancel();return true};f("0001-dlg").insert(f("0001-lbl"));f("0001-dlg").insert(f("0002-lbl"));
f("0001-dlg").insert(f("0003-lbl"));f("0001-dlg").insert(f("0004-lbl"));f("0001-dlg").insert(f("0005-lbl"));f("0001-dlg").insert(f("0001-text"));f("0001-dlg").insert(f("0002-text"));f("0001-dlg").insert(f("0003-text"));f("0001-dlg").insert(f("0004-text"));f("0001-dlg").insert(f("0001-check"));f("0001-dlg").insert(f("0001-btn"));f("0001-dlg").insert(f("0002-btn"));setTimeout(function(){m.focus();i.paint();i.ready()},1);return i}}
function CSSEditor_cmd_edit_padding(c){c.handlers.cmd_edit_padding=function(){var a={},b=function(b,c){return a[b]=c},f=function(b){var c;if(!(c=a[b]))throw"Namespace "+b+" is not defined (yet?)";return c},g=getUID(),i=b("0001-dlg",(new Dialog({alwaysOnTop:false,appIcon:"",caption:"Edit Box Padding",closeable:true,height:227,maximizeable:false,maximized:false,minHeight:50,minWidth:50,minimizeable:false,modal:false,moveable:true,resizeable:false,scrollable:false,visible:true,width:237,childOf:c,y:0,
x:c.width+2})).chain(function(){Object.defineProperty(this,"pid",{get:function(){return g}});this.addClass("PID-"+g)}));b("0001-lbl",(new DOMLabel("Top:")).setAttr("style","top: 20px; left: 20px; width: 40px; position: absolute; text-overflow: ellipsis"));b("0002-lbl",(new DOMLabel("Right:")).setAttr("style","top: 50px; left: 20px; width: 50px; position: absolute; text-overflow: ellipsis"));b("0003-lbl",(new DOMLabel("Bottom:")).setAttr("style","top: 80px; left: 20px; width: 50px; position: absolute; text-overflow: ellipsis"));
b("0004-lbl",(new DOMLabel("Left:")).setAttr("style","top: 110px; left: 20px; width: 50px; position: absolute; text-overflow: ellipsis"));var h=c.nodeAttributes,j=b("0001-text",(new CSSDimensionInput).setAttr("style","top: 15px; left: 75px; position: absolute; margin: 0; right: 20px")),k=b("0002-text",(new CSSDimensionInput).setAttr("style","top: 45px; left: 75px; position: absolute; margin: 0; right: 20px")),l=b("0003-text",(new CSSDimensionInput).setAttr("style","top: 75px; left: 75px; position: absolute; margin: 0; right: 20px")),
m=b("0004-text",(new CSSDimensionInput).setAttr("style","top: 105px; left: 75px; position: absolute; margin: 0; right: 20px"));j.value=h["padding-top"];k.value=h["padding-right"];l.value=h["padding-bottom"];m.value=h["padding-left"];var o=b("0001-check",(new DOMCheckBox({valuesSet:"two-states",checked:"false"})).setAttr("style","top: 140px; left: 15px; position: absolute"));o.addCustomEventListener("change",function(){o.value?(k.value=l.value=m.value=j.value,k.disabled=l.disabled=m.disabled=true):
k.disabled=l.disabled=m.disabled=false});h.padding.indexOf(" ")==-1&&o.click();j.addCustomEventListener("change",function(){if(o.checked)m.value=k.value=l.value=j.value;return true});b("0005-lbl",(new DOMLabel("Modify all paddings",{"for":o})).setAttr("style","top: 143px; left: 40px; width: auto; position: absolute; text-overflow: ellipsis; right: 20px"));b("0001-btn",(new Button("Ok",function(){i.ok()})).setAttr("style","bottom: 10px; right: 80px; position: absolute; font-weight: bold"));b("0002-btn",
(new Button("Cancel",function(){i.close()})).setAttr("style","bottom: 10px; right: 20px; position: absolute"));i.cancel=function(){setTimeout(function(){try{i.close(),i.purge(),h=i=void 0}catch(a){}},10)};i.ok=function(){h["padding-left"]=m.value;h["padding-top"]=j.value;h["padding-bottom"]=l.value;h["padding-right"]=k.value;h=void 0;i.close()};Keyboard.bindKeyboardHandler(i,"esc",i.close);Keyboard.bindKeyboardHandler(i,"enter",i.ok);i.closeCallback=function(){i.cancel();return true};f("0001-dlg").insert(f("0001-lbl"));
f("0001-dlg").insert(f("0002-lbl"));f("0001-dlg").insert(f("0003-lbl"));f("0001-dlg").insert(f("0004-lbl"));f("0001-dlg").insert(f("0005-lbl"));f("0001-dlg").insert(f("0001-text"));f("0001-dlg").insert(f("0002-text"));f("0001-dlg").insert(f("0003-text"));f("0001-dlg").insert(f("0004-text"));f("0001-dlg").insert(f("0001-check"));f("0001-dlg").insert(f("0001-btn"));f("0001-dlg").insert(f("0002-btn"));setTimeout(function(){m.focus();i.paint();i.ready()},1);return i}}
function CSSEditor_cmd_edit_size(c){c.handlers.cmd_edit_size=function(a,b){if(a||b){var f=c.nodeAttributes,g={},i=function(a,b){return g[a]=b},h=function(a){var b;if(!(b=g[a]))throw"Namespace "+a+" is not defined (yet?)";return b},j=getUID(),k=i("0001-dlg",(new Dialog({alwaysOnTop:false,appIcon:"",caption:"Edit Box Size",closeable:true,height:182,maximizeable:false,maximized:false,minHeight:50,minWidth:50,minimizeable:false,modal:false,moveable:true,resizeable:false,scrollable:false,visible:true,
width:201,x:c.width+2,y:0,childOf:c})).chain(function(){Object.defineProperty(this,"pid",{get:function(){return j}});this.addClass("PID-"+j)}));i("0001-btn",(new Button("Ok",function(){k.appHandler("cmd_ok")})).setAttr("style","bottom: 10px; right: 75px; position: absolute; font-weight: bold"));i("0002-btn",(new Button("Cancel",function(){k.close()})).setAttr("style","bottom: 10px; right: 10px; position: absolute"));if(a){i("0001-lbl",(new DOMLabel("Width:")).setAttr("style","top: 20px; left: 20px; width: 50px; position: absolute; text-overflow: ellipsis"));
var l=i("0001-text",(new CSSDimensionInput("")).setAttr("style","top: 15px; left: 70px; position: absolute; margin: 0; width: auto; right: 20px"))}if(b){i("0002-lbl",(new DOMLabel("Height:")).setAttr("style","top: 50px; left: 20px; width: 50px; position: absolute; text-overflow: ellipsis"));var m=i("0002-text",(new CSSDimensionInput("")).setAttr("style","top: 45px; left: 70px; position: absolute; margin: 0; width: auto; right: 20px"))}var o=false;if(a&&b){var n=i("0001-check",(new DOMCheckBox({valuesSet:"two-states",
checked:"false"})).setAttr("style","top: 80px; left: 17px; position: absolute"));i("0003-lbl",(new DOMLabel("Lock aspect ratio",{"for":h("0001-check")})).setAttr("style","top: 83px; left: 45px; width: 100px; position: absolute; text-overflow: ellipsis"));var q=null;l.addCustomEventListener("change",function(){try{var a=new CSSUnitConvertor(l.value),b=new CSSUnitConvertor(m.value);if(q&&n.checked)try{b.dimension=a.dimension/q,m.value=b.value}catch(c){console.warn("Failed to setup aspect ratio!")}if(a.unit==
b.unit&&!a.readOnly&&a.dimension!=0&&b.dimension!=0){if(n.style.display="",h("0003-lbl").style.display="",!o)try{q=a.dimension/b.dimension,o=true}catch(i){n.style.display="none",h("0003-lbl").style.display="none",n.checked=false}}else n.style.display="none",h("0003-lbl").style.display="none",n.checked=false}catch(f){}return true});m.addCustomEventListener("change",function(){try{var a=new CSSUnitConvertor(l.value),b=new CSSUnitConvertor(m.value);if(q&&n.checked)try{a.dimension=b.dimension*q,l.value=
a.value}catch(c){console.warn("Failed to setup aspect ratio!")}if(a.unit==b.unit&&!a.readOnly&&a.dimension!=0&&b.dimension!=0){if(n.style.display="",h("0003-lbl").style.display="",!o)try{q=a.dimension/b.dimension,o=true}catch(i){n.style.display="none",h("0003-lbl").style.display="none",n.checked=false}}else n.style.display="none",h("0003-lbl").style.display="none",n.checked=false}catch(f){}return true});n.addCustomEventListener("change",function(){return true})}if(a)l.value=f.width;if(b)m.value=f.height;
if(a)l.onCustomEvent("change");if(b)m.onCustomEvent("change");o&&n.click();k.handlers.cmd_ok=function(){if(a)f.width=l.value;if(b)f.height=m.value;k.close()};k.closeCallback=function(){k.parentNode&&setTimeout(function(){k.purge();f=k=void 0},10);return true};Keyboard.bindKeyboardHandler(k,"enter",function(){k.appHandler("cmd_ok")});Keyboard.bindKeyboardHandler(k,"esc",function(){k.close()});h("0001-dlg").insert(h("0001-lbl"));h("0001-dlg").insert(h("0002-lbl"));h("0001-dlg").insert(h("0003-lbl"));
h("0001-dlg").insert(h("0001-btn"));h("0001-dlg").insert(h("0002-btn"));h("0001-dlg").insert(h("0001-text"));h("0001-dlg").insert(h("0002-text"));h("0001-dlg").insert(h("0001-check"));setTimeout(function(){k.paint();k.ready()},1);return k}}}
function CSSNodeEditor_init_image_tab(c,a,b){console.log("Image: ",b);a=a.getTabById("image").getSheet();a.style.overflow="hidden";var f={},g=function(a,b){return f[a]=b},i=function(a){var b;if(!(b=f[a]))throw"Namespace "+a+" is not defined (yet?)";return b},h=c.nodeAttributes;g("0001-lbl",(new DOMLabel("Source:")).setAttr("style","top: 25px; left: 10px; width: 50px; position: absolute; text-overflow: ellipsis"));g("0002-lbl",(new DOMLabel("Alternate text:")).setAttr("style","top: 58px; left: 10px; width: 80px; position: absolute; text-overflow: ellipsis"));
var j=g("0001-text",(new CSSSourceInput(h.src,function(a){var b={contentType:/^image(\/|$)/i},c;for(c in a)a.propertyIsEnumerable(c)&&(b[c]=a[c]);return b}(b.integration||{}))).setAttr("style","top: 20px; left: 95px; position: absolute; margin: 0; width: auto; right: 10px"));j.addCustomEventListener("change",function(){h.src=j.value;return true});var k=g("0002-text",(new TextBox(h.alt)).setAttr("style","top: 55px; left: 95px; position: absolute; margin: 0; width: auto; right: 10px").setProperty("placeholder",
"Used for describing image")).chain(function(){this.addCustomEventListener("change",function(){h.alt=k.value})}),l=g("0001-img",(new DOMImage({src:h.src,displayMode:"best"})).setAttr("style","top: 100px; left: 10px; width: auto; height: auto; position: absolute; right: 10px; bottom: 10px"));l.style.visibility=h.src?"visible":"hidden";c.addCustomEventListener("attribute-changed",function(a){if(a.which=="src"){if(a.value)l.src=a.value;l.style.visibility=a.value?"visible":"hidden"}return true});c.addCustomEventListener("attribute-changed",
function(a){if(a.which=="src"&&a.value!=j.value)j.value=a.value;else if(a.which=="alt"&&a.value!=k.value)k.value=a.value;return true});a.insert(i("0001-lbl"));a.insert(i("0002-lbl"));a.insert(i("0001-text"));a.insert(i("0002-text"));a.insert(i("0001-img"))}window.CSSDefs=window.CSSDefs||{};
window.CSSDefs.isCSSBgPosition=function(c){c=(c+"").toString().toLowerCase().trim();if(c=="inherit")return{x:"inherit",y:"inherit"};var a,b,f=/^(auto|inherit|((\-)?([\d]+\.)?[\d]+(px|pt|cm|mm|em|inch|\%)))$/i;if(/^(left|right|center|top|bottom)([\s]+(left|right|center|top|bottom))?$/i.test(c)){b=a="center";for(var c=c.split(/[\s]+/),f=0,g=c.length;f<g;f++)["left","right"].indexOf(c[f])>=0?a=c[f]:["top","bottom"].indexOf(c[f])>=0&&(b=c[f]);return{x:a,y:b}}c=c.split(/[\s]+/g);b="50%";if(!isNaN(c[0])||
f.test(c[0]))a=c[0];else return null;if(c.length==2)if(!isNaN(c[1])||f.test(c[1]))b=c[1];else return null;else if(c.length>2)return null;return{x:a,y:b}};window.CSSDefs.isCSSColor=function(c){c=(c||"").toString().toLowerCase().trim();return c=="inherit"?true:CSSColor(c)};window.CSSDefs.isCSSDimension=function(c){c=(c||"").toString().toLowerCase().trim();return/^(auto|inherit|((\-)?([\d]+\.)?[\d]+(px|pt|cm|mm|em|inch|\%)))$/i.test(c)};
window.CSSDefs.isCSSBorderWidth=function(c){c=(c||"").toString().toLowerCase().trim();return/^(thin|thich|medium|inherit)$/.test(c)||window.CSSDefs.isCSSDimension(c)};window.CSSDefs.isCSSBorderStyle=function(c){c=(c||"").toString().toLowerCase().trim();return/^(none|hidden|dotted|dashed|solid|double|groove|ridge|inset|outset|inherit)$/.test(c)};
window.CSSDefs.attributesPlacement={padding:"style","padding-top":"style","padding-right":"style","padding-bottom":"style","padding-left":"style",margin:"style","margin-top":"style","margin-right":"style","margin-bottom":"style","margin-left":"style",border:"style","border-top":"style","border-top-style":"style","border-top-color":"style","border-top-width":"style","border-right":"style","border-right-style":"style","border-right-color":"style","border-right-width":"style","border-bottom":"style",
"border-bottom-style":"style","border-bottom-color":"style","border-bottom-width":"style","border-left":"style","border-left-style":"style","border-left-color":"style","border-left-width":"style","border-radius":"style","border-top-left-radius":"style","border-top-right-radius":"style","border-bottom-right-radius":"style","border-bottom-left-radius":"style",color:"style",background:"style","background-image":"style","background-color":"style","background-repeat":"style","background-attachment":"style",
"background-position-x":"style","background-position-y":"style",width:"both",height:"both",href:"node",target:"node",anchor:"node",id:"node","class":"node","float":"style",align:"node","text-align":"style",clear:"style",position:"style",title:"node",alt:"node",src:"node",poster:"node",display:"style",autostart:"node",controls:"node",posters:"none",sources:"none"};
window.CSSDefs.transformCSSPropertyToJavascriptNotation=function(c){for(var c=c.trim(" -").split(/\-/),a="",b=0,f=c.length;b<f;b++)c[b]&&b!=0&&(c[b]=c[b][0].toUpperCase()+c[b].substr(1)),a+=c[b];return a};
window.CSSDefs.setupAttributes=function(c,a,b){b=b||"style";if(["node","style"].indexOf(b)==-1)throw"Bad preferred placement. Allowed only: 'node', 'style'";for(var f in a)if(a.propertyIsEnumerable(f)){var g=f,i=a[f],h=null;switch(true){case CSSDefs.attributesPlacement[g]=="node":h="node";break;case CSSDefs.attributesPlacement[g]=="style":h="style";break;case CSSDefs.attributesPlacement[g]=="both":h=b}if(h!=null)switch(h){case "node":i?c.setAttribute(g,i):c.removeAttribute(g);break;case "style":c.style[CSSDefs.transformCSSPropertyToJavascriptNotation(g)]=
i}}};
function CSSNodeEditor(c,a){a=a||{};a.dialog=a.dialog||{};a.styles=a.styles||{};a.integration=a.integration||{};var b=document.activeElement,f=b?window.getSelection().getCaretOffsetRelativeTo(b):-1;console.log("On close I will focus the ",b," at position: ",f);return(new Dialog({width:a.dialog.width||360,height:a.dialog.height||410,caption:a.dialog.caption||"Item properties",childOf:a.dialog.childOf||null,appIcon:a.dialog.appIcon||void 0,minWidth:360,minHeight:410})).chain(function(){var g=this,i=
{},h={padding:{top:"",right:"",bottom:"",left:""},margin:{top:"",right:"",bottom:"",left:""},border:{top:{style:"",color:"",width:"",radius:{left:"",right:""}},right:{style:"",color:"",width:""},bottom:{style:"",color:"",width:"",radius:{left:"",right:""}},left:{style:"",color:"",width:"",radius:""}},color:"red",background:{image:"",position:{x:"",y:""},color:"",repeat:"",attachment:""},width:"",height:"",href:"",target:"",anchor:"",id:"","class":"","float":"",align:"",clear:"",position:"",title:"",
alt:"",src:"",poster:"",display:"",autostart:"",controls:"",posters:[].chain(function(){this.add=function(a){if(a){for(var b=0,c=this.length;b<c;b++)if(this[b]==a)return;h.posters.push(a);g.onCustomEvent("attribute-changed",{which:"posters",value:h.posters});if(h.poster=="")h.poster=a,g.onCustomEvent("attribute-changed",{which:"poster",value:h.poster})}};this.remove=function(a){for(var b=0,c=this.length;b<c;b++)if(this[b]==a&&(this.splice(b,1),g.onCustomEvent("attribute-changed",{which:"posters",
value:h.posters}),h.poster==a))h.poster="",g.onCustomEvent("attribute-changed",{which:"poster",value:h.poster})};this.clear=function(){for(;this.length>0;)this.shift();g.onCustomEvent("attribute-changed",{which:"posters",value:h.posters});h.poster="";g.onCustomEvent("attribute-changed",{which:"poster",value:h.poster})}}),sources:[].chain(function(){this.add=function(a,b,c){for(var i=0,f=h.sources.length;i<f;i++)if(h.sources[i].src==a)return;c=c||"";this.push({}.chain(function(){Object.defineProperty(this,
"src",{get:function(){return a},set:function(b){a=b;g.onCustomEvent("attribute-changed",{which:"sources",value:h.sources})}});Object.defineProperty(this,"type",{get:function(){return b},set:function(a){b=a;g.onCustomEvent("attribute-changed",{which:"sources",value:h.sources})}});Object.defineProperty(this,"quality",{get:function(){return c},set:function(a){c=a;g.onCustomEvent("attribute-changed",{which:"sources",value:h.sources})}})}));g.onCustomEvent("attribute-changed",{which:"sources",value:h.sources})};
this.remove=function(a){for(var b=0,c=h.sources.length;b<c;b++)if(h.sources[b].src==a){h.sources.splice(b,1);g.onCustomEvent("attribute-changed",{which:"sources",value:h.sources});break}};this.triggerChange=function(){g.onCustomEvent("attribute-changed",{which:"sources",value:h.sources})}})},j={cssDimension:/^(auto|inherit|((\-)?([\d]+\.)?[\d]+(px|pt|cm|mm|em|inch|\%)))$/i,"float":/^(left|right|none|inherit)?$/,align:/^(left|right|center|justify|inherit)$/,position:/^(absolute|relative|static|inherit|fixed)?$/,
display:/^(none|box|flex\-box|block|flex|inline|inline\-block|inline\-flex|inline\-table|list\-item|table|table-caption|table\-cell|table\-column|table\-column\-group|table\-footer\-group|table\-header\-group|table\-row|table\-row\-group|inherit)?$/,backgroundAttachment:/^(scroll|fixed|inherit)$/,backgroundRepeat:/^(no\-repeat|repeat|repeat\-x|repeat\-y)$/,urlImage:/^url\([\S\s]+\)$/},k=this;Object.defineProperty(this,"nodeAttributes",{get:function(){return{}.chain(function(){Object.defineProperty(this,
"posters",{get:function(){return h.posters},set:function(){throw"The posters property does not support direct modification, use the add, remove and clear methods of the posters property instead";}});Object.defineProperty(this,"sources",{get:function(){return h.sources},set:function(){throw"The sources property does not support direct modification, use the add and remove methods of the source property instead";}});Object.defineProperty(this,"autostart",{get:function(){return h.autostart},set:function(a){h.autostart=
a?"autostart":"";k.onCustomEvent("attribute-changed",{which:"autostart",value:h.autostart})}});Object.defineProperty(this,"controls",{get:function(){return h.controls},set:function(a){h.controls=a?"controls":"";k.onCustomEvent("attribute-changed",{which:"controls",value:h.controls})}});Object.defineProperty(this,"width",{get:function(){return h.width},set:function(a){a=((a||"")+"").toLowerCase().trim();if(a==""||j.cssDimension.test(a)||!isNaN(a))h.width=!isNaN(a)&&a!=""?a+"px":a,k.onCustomEvent("attribute-changed",
{which:"width",value:h.width});else throw"Bad width value!";}});Object.defineProperty(this,"height",{get:function(){return h.height},set:function(a){a=((a||"")+"").toLowerCase().trim();if(a==""||j.cssDimension.test(a)||!isNaN(a))h.height=!isNaN(a)&&a!=""?a+"px":a,k.onCustomEvent("attribute-changed",{which:"height",value:h.height});else throw"Bad height value!";}});Object.defineProperty(this,"anchor",{get:function(){return h.anchor},set:function(a){h.anchor=a||"";k.onCustomEvent("attribute-changed",
{which:"anchor",value:h.anchor})}});Object.defineProperty(this,"href",{get:function(){return h.href},set:function(a){a=((a||"")+"").trim();h.href=a;k.onCustomEvent("attribute-changed",{which:"href",value:h.href})}});Object.defineProperty(this,"src",{get:function(){return h.src},set:function(a){a=(a||"")+"";h.src=a;k.onCustomEvent("attribute-changed",{which:"src",value:a})}});Object.defineProperty(this,"target",{get:function(){return h.target},set:function(a){a=((a||"")+"").trim();h.target=a;k.onCustomEvent("attribute-changed",
{which:"target",value:a})}});Object.defineProperty(this,"id",{get:function(){return h.id},set:function(a){a=((a||"")+"").trim();h.id=a;k.onCustomEvent("attribute-changed",{which:"id",value:a})}});Object.defineProperty(this,"class",{get:function(){return h["class"]},set:function(a){a=(a||"")+"";h["class"]=a;k.onCustomEvent("attribute-changed",{which:"class",value:a})}});Object.defineProperty(this,"float",{get:function(){return h["float"]},set:function(a){a=((a||"")+"").toLowerCase().trim();if(!j["float"].test(a))throw"Bad float value!";
h["float"]=a;k.onCustomEvent("attribute-changed",{which:"float",value:a})}});Object.defineProperty(this,"display",{get:function(){return h.display},set:function(a){a=((a||"")+"").toLowerCase().trim();if(!j.display.test(a))throw"Bad display value!";h.display=a;k.onCustomEvent("attribute-changed",{which:"display",value:a})}});Object.defineProperty(this,"align",{get:function(){return h.align},set:function(a){a=((a||"")+"").toLowerCase().trim();if(!j.align.test(a)&&a!="")throw"Bad align value!";h.align=
a;k.onCustomEvent("attribute-changed",{which:"align",value:a})}});Object.defineProperty(this,"clear",{get:function(){return h.clear},set:function(a){a=((a||"")+"").toLowerCase().trim();if(!/^(left|right|both)?$/.test(a))throw"Bad clear value!";h.clear=a;k.onCustomEvent("attribute-changed",{which:"clear",value:h.clear})}});Object.defineProperty(this,"position",{get:function(){return h.position},set:function(a){a=((a||"")+"").toLowerCase().trim();if(!j.position.test(a))throw"Bad position value!";h.position=
a;k.onCustomEvent("attribute-changed",{which:"position",value:a})}});Object.defineProperty(this,"title",{get:function(){return h.title},set:function(a){a=(a||"")+"";h.title=a;k.onCustomEvent("attribute-changed",{which:"title",value:a})}});Object.defineProperty(this,"alt",{get:function(){return h.alt},set:function(a){a=(a||"")+"";h.alt=a;k.onCustomEvent("attribute-changed",{which:"alt",value:a})}});Object.defineProperty(this,"poster",{get:function(){return h.poster},set:function(a){a=((a||"")+"").trim();
h.poster=a;k.onCustomEvent("attribute-changed",{which:"poster",value:a})}});Object.defineProperty(this,"color",{get:function(){return h.color},set:function(a){a=((a||"")+"").trim();if(!CSSDefs.isCSSColor(a))throw"Bad color value!";h.color=a;k.onCustomEvent("attribute-changed",{which:"color",value:a})}});Object.defineProperty(this,"background",{get:function(){var a=[];h.background.color&&a.push(h.background.color);h.background.image&&a.push(h.background.image);h.background.repeat&&a.push(h.background.repeat);
h.background.attachment&&a.push(h.background.attachment);h.background.position.x&&h.background.position.y&&a.push(h.background.position.x+" "+h.background.position.y);return a.join(" ")},set:function(a){a=(a||"").toString().trim().replace(/[\s]+/g," ");if(a=="")this["background-attachment"]="",this["background-color"]="",this["background-image"]="",this["background-position"]="",this["background-repeat"]="";else{var a=a.split(" "),b="",c="",i="",f="",h={x:"inherit",y:"inherit"};a.length&&CSSDefs.isCSSColor(a[0])?
(b=a[0].toLowerCase(),a.shift()):b="";a.length&&j.urlImage.test(a[0])?(c=a[0],a.shift()):c="";a.length&&j.backgroundRepeat.test(a[0])?(i=a[0].toLowerCase(),a.shift()):i="";a.length&&j.backgroundAttachment.test(a[0])?(f=a[0].toLowerCase(),a.shift()):f="";a.length&&a.length<=2&&(h=CSSDefs.isCSSBgPosition(a.slice(0,2).join(" ")))?(a.shift(),a.length&&a.shift()):h={x:"inherit",y:"inherit"};if(a.length)throw"Bad background value (failed to parse: '"+a[0]+"'!";this["background-color"]=b;this["background-image"]=
c;this["background-repeat"]=i;this["background-attachment"]=f;this["background-position-x"]=h.x;this["background-position-y"]=h.y}k.onCustomEvent("attribute-changed",{which:"background",value:this.background})}});Object.defineProperty(this,"background-color",{get:function(){return h.background.color},set:function(a){a=(a||"").toString().toLowerCase().trim();if(a==""||CSSDefs.isCSSColor(a))h.background.color=a;else throw"Bad CSS background color!";k.onCustomEvent("attribute-changed",{which:"background-color",
value:h.background.color});k.onCustomEvent("attribute-changed",{which:"background",value:this.background})}});Object.defineProperty(this,"background-image",{get:function(){return h.background.image},set:function(a){a=(a||"").toString().trim();if(a==""||j.urlImage.test(a))h.background.image=a;else throw"Bad CSS background image!";k.onCustomEvent("attribute-changed",{which:"background-image",value:h.background.image});k.onCustomEvent("attribute-changed",{which:"background",value:this.background})}});
Object.defineProperty(this,"background-position",{get:function(){return h.background.position.x=="inherit"&&h.background.position.y=="inherit"?"inherit":(h.background.position.x+" "+h.background.position.y).trim()},set:function(a){var a=(a||"").toString().trim(),b;if(a==""||(b=CSSDefs.isCSSBgPosition(a)))h.background.position=a==""?{x:"inherit",y:"inherit"}:b;else throw"Bad CSS background position!";k.onCustomEvent("attribute-changed",{which:"background-position",value:this["background-position"]});
k.onCustomEvent("attribute-changed",{which:"background",value:this.background})}});Object.defineProperty(this,"background-repeat",{get:function(){return h.background.repeat},set:function(a){a=(a||"").toString().trim();if(a==""||j.backgroundRepeat.test(a))h.background.repeat=a;else throw"Invalid background repeat value!";k.onCustomEvent("attribute-changed",{which:"background-repeat",value:h.background.repeat});k.onCustomEvent("attribute-changed",{which:"background",value:this.background})}});Object.defineProperty(this,
"background-attachment",{get:function(){return h.background.attachment},set:function(a){a=(a||"").toString().trim();if(a==""||j.backgroundAttachment.test(a))h.background.attachment=a;else throw"Invalid background attachment value!";k.onCustomEvent("attribute-changed",{which:"background-attachment",value:h.background.attachment});k.onCustomEvent("attribute-changed",{which:"background",value:this.background})}});Object.defineProperty(this,"background-position-x",{get:function(){return h.background.position.x},
set:function(a){a=(a||"").toString().trim();h.background.position.x=a;k.onCustomEvent("attribute-changed",{which:"background-position-x",value:h.background.position.x});k.onCustomEvent("attribute-changed",{which:"background",value:this.background})}});Object.defineProperty(this,"background-position-y",{get:function(){return h.background.position.y},set:function(a){a=(a||"").toString().trim();h.background.position.y=a;k.onCustomEvent("attribute-changed",{which:"background-position-y",value:h.background.position.y});
k.onCustomEvent("attribute-changed",{which:"background",value:this.background})}});Object.defineProperty(this,"padding-left",{get:function(){return h.padding.left},set:function(a){a=(a||"").toString().toLowerCase().trim();if(a==""||!isNaN(a)||CSSDefs.isCSSDimension(a))h.padding.left=!isNaN(a)&&a!=""?a+"px":a;else throw"Bad padding left value";k.onCustomEvent("attribute-changed",{which:"padding-left",value:h.padding.left});k.onCustomEvent("attribute-changed",{which:"padding",value:this.padding})}});
Object.defineProperty(this,"padding-right",{get:function(){return h.padding.right},set:function(a){a=(a||"").toString().toLowerCase().trim();if(a==""||!isNaN(a)||CSSDefs.isCSSDimension(a))h.padding.right=!isNaN(a)&&a!=""?a+"px":a;else throw"Bad padding right value";k.onCustomEvent("attribute-changed",{which:"padding-right",value:h.padding.right});k.onCustomEvent("attribute-changed",{which:"padding",value:this.padding})}});Object.defineProperty(this,"padding-top",{get:function(){return h.padding.top},
set:function(a){a=(a||"").toString().toLowerCase().trim();if(a==""||!isNaN(a)||CSSDefs.isCSSDimension(a))h.padding.top=!isNaN(a)&&a!=""?a+"px":a;else throw"Bad padding top value";k.onCustomEvent("attribute-changed",{which:"padding-top",value:h.padding.top});k.onCustomEvent("attribute-changed",{which:"padding",value:this.padding})}});Object.defineProperty(this,"padding-bottom",{get:function(){return h.padding.bottom},set:function(a){a=(a||"").toString().toLowerCase().trim();if(a==""||!isNaN(a)||CSSDefs.isCSSDimension(a))h.padding.bottom=
!isNaN(a)&&a!=""?a+"px":a;else throw"Bad padding bottom value";k.onCustomEvent("attribute-changed",{which:"padding-bottom",value:h.padding.bottom});k.onCustomEvent("attribute-changed",{which:"padding",value:this.padding})}});Object.defineProperty(this,"padding",{get:function(){switch(true){case h.padding.top==h.padding.right&&h.padding.right==h.padding.bottom&&h.padding.bottom==h.padding.left:return h.padding.left||"";case h.padding.top==h.padding.bottom&&h.padding.left==h.padding.right:return(h.padding.top+
" "+h.padding.right).trim();default:return((h.padding.top==""?"auto":h.padding.top)+" "+(h.padding.right==""?"auto":h.padding.right)+" "+(h.padding.bottom==""?"auto":h.padding.bottom)+" "+(h.padding.left||h.padding.right||"auto")).trim()}},set:function(a){a=(a||"").toString().trim().toLowerCase();if(a=="")this["padding-left"]="",this["padding-right"]="",this["padding-top"]="",this["padding-bottom"]="";else{a=a.split(/[\s]+/g);if(a.length>4)throw"Bad padding value (more than 4 args specified)";for(var b=
0,c=a.length;b<c;b++)if(isNaN(a[b])&&!CSSDefs.isCSSDimension(a[b]))throw"Bad padding value (argument #"+(b+1)+" is not a css dimension)";switch(a.length){case 1:this["padding-top"]=this["padding-right"]=this["padding-bottom"]=this["padding-left"]=a[0];break;case 2:this["padding-top"]=this["padding-bottom"]=a[0];this["padding-left"]=this["padding-right"]=a[1];break;case 3:this["padding-top"]=a[0];this["padding-right"]=this["padding-left"]=a[1];this["padding-bottom"]=a[2];break;case 4:this["padding-top"]=
a[0],this["padding-right"]=a[1],this["padding-bottom"]=a[2],this["padding-left"]=a[3]}}k.onCustomEvent("attribute-changed",{which:"padding",value:this.padding})}});Object.defineProperty(this,"margin-left",{get:function(){return h.margin.left},set:function(a){a=(a||"").toString().toLowerCase().trim();if(a==""||!isNaN(a)||CSSDefs.isCSSDimension(a))h.margin.left=!isNaN(a)?a+"px":a;else throw"Bad margin left value";k.onCustomEvent("attribute-changed",{which:"margin-left",value:h.margin.left});k.onCustomEvent("attribute-changed",
{which:"margin",value:this.margin})}});Object.defineProperty(this,"margin-right",{get:function(){return h.margin.right},set:function(a){a=(a||"").toString().toLowerCase().trim();if(a==""||!isNaN(a)||CSSDefs.isCSSDimension(a))h.margin.right=!isNaN(a)?a+"px":a;else throw"Bad margin right value";k.onCustomEvent("attribute-changed",{which:"margin-right",value:h.margin.right});k.onCustomEvent("attribute-changed",{which:"margin",value:this.margin})}});Object.defineProperty(this,"margin-top",{get:function(){return h.margin.top},
set:function(a){a=(a||"").toString().toLowerCase().trim();if(a==""||!isNaN(a)||CSSDefs.isCSSDimension(a))h.margin.top=!isNaN(a)&&a!=""?a+"px":a;else throw"Bad margin top value";k.onCustomEvent("attribute-changed",{which:"margin-top",value:h.margin.top});k.onCustomEvent("attribute-changed",{which:"margin",value:this.margin})}});Object.defineProperty(this,"margin-bottom",{get:function(){return h.margin.bottom},set:function(a){a=(a||"").toString().toLowerCase().trim();if(a==""||!isNaN(a)||CSSDefs.isCSSDimension(a))h.margin.bottom=
!isNaN(a)?a+"px":a;else throw"Bad margin bottom value";k.onCustomEvent("attribute-changed",{which:"margin-bottom",value:h.margin.bottom});k.onCustomEvent("attribute-changed",{which:"margin",value:this.margin})}});Object.defineProperty(this,"margin",{get:function(){switch(true){case h.margin.top+h.margin.left+h.margin.bottom+h.margin.right=="":return"";case h.margin.top==h.margin.right&&h.margin.right==h.margin.bottom&&h.margin.bottom==h.margin.left:return h.margin.left||"auto";case h.margin.top==
h.margin.bottom&&h.margin.left==h.margin.right:return(h.margin.top+" "+h.margin.right).trim();default:return((h.margin.top==""?"auto":h.margin.top)+" "+(h.margin.right==""?"auto":h.margin.right)+" "+(h.margin.bottom==""?"auto":h.margin.bottom)+" "+(h.margin.left||h.margin.right||"auto")).trim()}},set:function(a){a=(a||"").toString().trim().toLowerCase();if(a=="")this["margin-left"]="",this["margin-right"]="",this["margin-top"]="",this["margin-bottom"]="";else{a=a.split(/[\s]+/g);if(a.length>4)throw"Bad margin value (more than 4 args specified)";
for(var b=0,c=a.length;b<c;b++)if(isNaN(a[b])&&!CSSDefs.isCSSDimension(a[b]))throw"Bad margin value (argument #"+(b+1)+" is not a css dimension)";switch(a.length){case 1:this["margin-top"]=this["margin-right"]=this["margin-bottom"]=this["margin-left"]=a[0];break;case 2:this["margin-top"]=this["margin-bottom"]=a[0];this["margin-left"]=this["margin-right"]=a[1];break;case 3:this["margin-top"]=a[0];this["margin-right"]=this["margin-left"]=a[1];this["margin-bottom"]=a[2];break;case 4:this["margin-top"]=
a[0],this["margin-right"]=a[1],this["margin-bottom"]=a[2],this["margin-left"]=a[3]}}k.onCustomEvent("attribute-changed",{which:"margin",value:this.margin})}});Object.defineProperty(this,"border-radius",{get:function(){switch(true){case h.border.top.radius.left==h.border.top.radius.right&&h.border.top.radius.right==h.border.bottom.radius.right&&h.border.bottom.radius.right==h.border.bottom.radius.left:return h.border.bottom.radius.left;case h.border.top.radius.left==h.border.bottom.radius.right&&h.border.top.radius.right==
h.border.bottom.radius.left:return(h.border.top.radius.left||"0px")+" "+(h.border.top.radius.right||"0px");default:return(h.border.top.radius.left||"0px")+" "+(h.border.top.radius.right||"0px")+" "+(h.border.bottom.radius.right||"0px")+" "+(h.border.bottom.radius.left||"0px")}},set:function(a){a=(a||"").toString().toLowerCase().trim();if(a.indexOf("/")>=0)console.warn("Warning: Border radius format not implemented (ignored for now)!");else{if(a=="")this["border-bottom-left-radius"]=this["border-bottom-right-radius"]=
this["border-top-left-radius"]=this["border-top-right-radius"]="";else{a=a.split(/[\s]+/);if(a.length>4)throw"Bad border radius format: detected "+a.length+" arguments, max 4 are allowed!";for(var b=0,c=a.length;b<c;b++)if(isNaN(a[b])&&!CSSDefs.isCSSDimension(a[b]))throw"Bad border radius argument @pos:"+(b+1)+" detected!";switch(a.length){case 4:this["border-top-left-radius"]=a[0];this["border-top-right-radius"]=a[1];this["border-bottom-right-radius"]=a[2];this["border-bottom-left-radius"]=a[3];
break;case 3:this["border-top-left-radius"]=a[0];this["border-top-right-radius"]=a[1];this["border-bottom-right-radius"]=a[2];this["border-bottom-left-radius"]=a[1];break;case 2:this["border-top-left-radius"]=this["border-bottom-right-radius"]=a[0];this["border-top-right-radius"]=this["border-bottom-left-radius"]=a[1];break;case 1:this["border-top-left-radius"]=this["border-top-right-radius"]=this["border-bottom-right-radius"]=this["border-bottom-left-radius"]=a[0]}}k.onCustomEvent("attribute-changed",
{which:"border-radius",value:this["border-radius"]})}}});Object.defineProperty(this,"border-top-left-radius",{get:function(){return h.border.top.radius.left},set:function(a){a=(a||"").toString().toLowerCase().trim();if(a==""||!isNaN(a)||CSSDefs.isCSSDimension(a))h.border.top.radius.left=!isNaN(a)?a+"px":a;else throw"Bad border top left radius value";k.onCustomEvent("attribute-changed",{which:"border-top-left-radius",value:h.border.top.radius.left});k.onCustomEvent("attribute-changed",{which:"border-radius",
value:this["border-radius"]})}});Object.defineProperty(this,"border-top-right-radius",{get:function(){return h.border.top.radius.right},set:function(a){a=(a||"").toString().toLowerCase().trim();if(a==""||!isNaN(a)||CSSDefs.isCSSDimension(a))h.border.top.radius.right=!isNaN(a)?a+"px":a;else throw"Bad border top right radius value";k.onCustomEvent("attribute-changed",{which:"border-top-right-radius",value:h.border.top.radius.right});k.onCustomEvent("attribute-changed",{which:"border-radius",value:this["border-radius"]})}});
Object.defineProperty(this,"border-bottom-left-radius",{get:function(){return h.border.bottom.radius.left},set:function(a){a=(a||"").toString().toLowerCase().trim();if(a==""||!isNaN(a)||CSSDefs.isCSSDimension(a))h.border.bottom.radius.left=!isNaN(a)?a+"px":a;else throw"Bad border bottom left radius value";k.onCustomEvent("attribute-changed",{which:"border-bottom-left-radius",value:h.border.bottom.radius.left});k.onCustomEvent("attribute-changed",{which:"border-radius",value:this["border-radius"]})}});
Object.defineProperty(this,"border-bottom-right-radius",{get:function(){return h.border.bottom.radius.right},set:function(a){a=(a||"").toString().toLowerCase().trim();if(a==""||!isNaN(a)||CSSDefs.isCSSDimension(a))h.border.bottom.radius.right=!isNaN(a)?a+"px":a;else throw"Bad border bottom right radius value";k.onCustomEvent("attribute-changed",{which:"border-bottom-right-radius",value:h.border.bottom.radius.right});k.onCustomEvent("attribute-changed",{which:"border-radius",value:this["border-radius"]})}});
Object.defineProperty(this,"border-width",{get:function(){switch(true){case h.border.top.width==h.border.right.width&&h.border.right.width==h.border.bottom.width&&h.border.bottom.width==h.border.left.width:return h.border.left.width;case h.border.top.width==h.border.bottom.width&&h.border.left.width==h.border.right.width:return(h.border.top.width||"0px")+" "+(h.border.right.width||"0px");default:return(h.border.top.width||"0px ")+" "+(h.border.right.width||"0px")+" "+(h.border.bottom.width||"0px")+
" "+(h.border.left.width||"0px")}},set:function(a){a=(a||"").toString().toLowerCase().trim();if(a=="")this["border-top-width"]=this["border-right-width"]=this["border-bottom-width"]=this["border-left-width"]="";else{a=a.split(/[\s]+/);if(a.length>4)throw"Bad border-width value (detected more than 4 arguments)";for(var b=0,c=a.length;b<c;b++)if(isNaN(a[b])&&!CSSDefs.isCSSBorderWidth(a[b]))throw"Bad border-width property detected @argument "+(b+1);switch(a.length){case 4:this["border-top-width"]=a[0];
this["border-right-width"]=a[1];this["border-bottom-width"]=a[2];this["border-left-width"]=a[3];break;case 3:this["border-top-width"]=a[0];this["border-right-width"]=a[1];this["border-bottom-width"]=a[2];this["border-left-width"]=a[1];break;case 2:this["border-top-width"]=this["border-bottom-width"]=a[0];this["border-right-width"]=this["border-left-width"]=a[1];break;case 1:this["border-top-width"]=this["border-bottom-width"]=this["border-right-width"]=this["border-left-width"]=a[0]}}}});Object.defineProperty(this,
"border-left-width",{get:function(){return h.border.left.width},set:function(a){a=(a||"").toString().toLowerCase().trim();if(a==""||!isNaN(a)||CSSDefs.isCSSBorderWidth(a))h.border.left.width=!isNaN(a)?a+"px":a;else throw"Bad border left width value";k.onCustomEvent("attribute-changed",{which:"border-left-width",value:h.border.left.width});k.onCustomEvent("attribute-changed",{which:"border-left",value:this["border-left"]});k.onCustomEvent("attribute-changed",{which:"border-width",value:this["border-width"]})}});
Object.defineProperty(this,"border-right-width",{get:function(){return h.border.right.width},set:function(a){a=(a||"").toString().toLowerCase().trim();if(a==""||!isNaN(a)||CSSDefs.isCSSBorderWidth(a))h.border.right.width=!isNaN(a)?a+"px":a;else throw"Bad border right width value";k.onCustomEvent("attribute-changed",{which:"border-right-width",value:h.border.right.width});k.onCustomEvent("attribute-changed",{which:"border-right",value:this["border-right"]});k.onCustomEvent("attribute-changed",{which:"border-width",
value:this["border-width"]})}});Object.defineProperty(this,"border-top-width",{get:function(){return h.border.top.width},set:function(a){a=(a||"").toString().toLowerCase().trim();if(a==""||!isNaN(a)||CSSDefs.isCSSBorderWidth(a))h.border.top.width=!isNaN(a)?a+"px":a;else throw"Bad border top width value";k.onCustomEvent("attribute-changed",{which:"border-top-width",value:h.border.top.width});k.onCustomEvent("attribute-changed",{which:"border-top",value:this["border-top"]});k.onCustomEvent("attribute-changed",
{which:"border-width",value:this["border-width"]})}});Object.defineProperty(this,"border-bottom-width",{get:function(){return h.border.bottom.width},set:function(a){a=(a||"").toString().toLowerCase().trim();if(a==""||!isNaN(a)||CSSDefs.isCSSBorderWidth(a))h.border.bottom.width=!isNaN(a)?a+"px":a;else throw"Bad border bottom width value";k.onCustomEvent("attribute-changed",{which:"border-bottom-width",value:h.border.bottom.width});k.onCustomEvent("attribute-changed",{which:"border-bottom",value:this["border-bottom"]});
k.onCustomEvent("attribute-changed",{which:"border-width",value:this["border-width"]})}});Object.defineProperty(this,"border-color",{get:function(){switch(true){case h.border.top.color==h.border.right.color&&h.border.right.color==h.border.bottom.color&&h.border.bottom.color==h.border.left.color:return h.border.left.color;case h.border.top.color==h.border.bottom.color&&h.border.left.color==h.border.right.color:return(h.border.top.color||"transparent")+" "+(h.border.left.color||"transparent");default:return(h.border.top.color||
"transparent")+" "+(h.border.right.color||"transparent")+" "+(h.border.bottom.color||"transparent")+" "+(h.border.left.color||"transparent")}},set:function(a){a=(a||"").toString().toLowerCase().trim();if(a=="")this["border-top-color"]=this["border-right-color"]=this["border-bottom-color"]=this["border-left-color"]="";else{a=a.split(/[\s]+/);if(a.length>4)throw"Bad border-color value (detected more than 4 arguments)";for(var b=0,c=a.length;b<c;b++)if(!CSSDefs.isCSSColor(a[b]))throw"Bad border-color property detected @argument "+
(b+1)+": "+a[b];switch(a.length){case 4:this["border-top-color"]=a[0];this["border-right-color"]=a[1];this["border-bottom-color"]=a[2];this["border-left-color"]=a[3];break;case 3:this["border-top-color"]=a[0];this["border-right-color"]=a[1];this["border-bottom-color"]=a[2];this["border-left-color"]=a[1];break;case 2:this["border-top-color"]=this["border-bottom-color"]=a[0];this["border-right-color"]=this["border-left-color"]=a[1];break;case 1:this["border-top-color"]=this["border-right-color"]=this["border-bottom-color"]=
this["border-left-color"]=a[0]}}k.onCustomEvent("attribute-changed",{which:"border-color",value:this["border-color"]})}});Object.defineProperty(this,"border-left-color",{get:function(){return h.border.left.color},set:function(a){a=(a||"").toString().toLowerCase().trim();if(a==""||CSSDefs.isCSSColor(a))h.border.left.color=a;else throw"Bad border left color value";k.onCustomEvent("attribute-changed",{which:"border-left-color",value:h.border.left.color});k.onCustomEvent("attribute-changed",{which:"border-left",
value:this["border-left"]});k.onCustomEvent("attribute-changed",{which:"border-color",value:this["border-color"]})}});Object.defineProperty(this,"border-right-color",{get:function(){return h.border.right.color},set:function(a){a=(a||"").toString().toLowerCase().trim();if(a==""||CSSDefs.isCSSColor(a))h.border.right.color=a;else throw"Bad border right color value";k.onCustomEvent("attribute-changed",{which:"border-right-color",value:h.border.right.color});k.onCustomEvent("attribute-changed",{which:"border-right",
value:this["border-right"]});k.onCustomEvent("attribute-changed",{which:"border-color",value:this["border-color"]})}});Object.defineProperty(this,"border-top-color",{get:function(){return h.border.top.color},set:function(a){a=(a||"").toString().toLowerCase().trim();if(a==""||CSSDefs.isCSSColor(a))h.border.top.color=a;else throw"Bad border top color value";k.onCustomEvent("attribute-changed",{which:"border-top-color",value:h.border.top.color});k.onCustomEvent("attribute-changed",{which:"border-top",
value:this["border-top"]});k.onCustomEvent("attribute-changed",{which:"border-color",value:this["border-color"]})}});Object.defineProperty(this,"border-bottom-color",{get:function(){return h.border.bottom.color},set:function(a){a=(a||"").toString().toLowerCase().trim();if(a==""||CSSDefs.isCSSColor(a))h.border.bottom.color=a;else throw"Bad border bottom color value";k.onCustomEvent("attribute-changed",{which:"border-bottom-color",value:h.border.bottom.color});k.onCustomEvent("attribute-changed",{which:"border-bottom",
value:this["border-bottom"]});k.onCustomEvent("attribute-changed",{which:"border-color",value:this["border-color"]})}});Object.defineProperty(this,"border-style",{get:function(){switch(true){case h.border.top.style==h.border.right.style&&h.border.right.style==h.border.bottom.style&&h.border.bottom.style==h.border.left.style:return h.border.left.style;case h.border.top.style==h.border.bottom.style&&h.border.left.style==h.border.right.style:return(h.border.top.style||"none")+" "+(h.border.left.style||
"none");default:return(h.border.top.style||"none")+" "+(h.border.right.style||"none")+" "+(h.border.bottom.style||"none")+" "+(h.border.left.style||"none")}},set:function(a){a=(a||"").toString().toLowerCase().trim();if(a=="")this["border-top-style"]=this["border-right-style"]=this["border-bottom-style"]=this["border-left-style"]="";else{a=a.split(/[\s]+/);if(a.length>4)throw"Bad border-style value (detected more than 4 arguments)";for(var b=0,c=a.length;b<c;b++)if(!CSSDefs.isCSSBorderStyle(a[b]))throw"Bad border-style property detected @argument "+
(b+1);switch(a.length){case 4:this["border-top-style"]=a[0];this["border-right-style"]=a[1];this["border-bottom-style"]=a[2];this["border-left-style"]=a[3];break;case 3:this["border-top-style"]=a[0];this["border-right-style"]=a[1];this["border-bottom-style"]=a[2];this["border-left-style"]=a[1];break;case 2:this["border-top-style"]=this["border-bottom-style"]=a[0];this["border-right-style"]=this["border-left-style"]=a[1];break;case 1:this["border-top-style"]=this["border-right-style"]=this["border-bottom-style"]=
this["border-left-style"]=a[0]}}k.onCustomEvent("attribute-changed",{which:"border-style",value:this["border-style"]})}});Object.defineProperty(this,"border-left-style",{get:function(){return h.border.left.style},set:function(a){a=(a||"").toString().toLowerCase().trim();if(a==""||CSSDefs.isCSSBorderStyle(a))h.border.left.style=a;else throw"Bad border left style value";k.onCustomEvent("attribute-changed",{which:"border-left-style",value:h.border.left.style});k.onCustomEvent("attribute-changed",{which:"border-left",
value:this["border-left"]});k.onCustomEvent("attribute-changed",{which:"border-style",value:this["border-style"]})}});Object.defineProperty(this,"border-right-style",{get:function(){return h.border.right.style},set:function(a){a=(a||"").toString().toLowerCase().trim();if(a==""||CSSDefs.isCSSBorderStyle(a))h.border.right.style=a;else throw"Bad border right style value";k.onCustomEvent("attribute-changed",{which:"border-right-style",value:h.border.right.style});k.onCustomEvent("attribute-changed",{which:"border-right",
value:this["border-right"]});k.onCustomEvent("attribute-changed",{which:"border-style",value:this["border-style"]})}});Object.defineProperty(this,"border-top-style",{get:function(){return h.border.top.style},set:function(a){a=(a||"").toString().toLowerCase().trim();if(a==""||CSSDefs.isCSSBorderStyle(a))h.border.top.style=a;else throw"Bad border top style value";k.onCustomEvent("attribute-changed",{which:"border-top-style",value:h.border.top.style});k.onCustomEvent("attribute-changed",{which:"border-top",
value:this["border-top"]});k.onCustomEvent("attribute-changed",{which:"border-style",value:this["border-style"]})}});Object.defineProperty(this,"border-bottom-style",{get:function(){return h.border.bottom.style},set:function(a){a=(a||"").toString().toLowerCase().trim();if(a==""||CSSDefs.isCSSBorderStyle(a))h.border.bottom.style=a;else throw"Bad border bottom style value";k.onCustomEvent("attribute-changed",{which:"border-bottom-style",value:h.border.bottom.style});k.onCustomEvent("attribute-changed",
{which:"border-bottom",value:this["border-bottom"]});k.onCustomEvent("attribute-changed",{which:"border-style",value:this["border-style"]})}});Object.defineProperty(this,"border-bottom",{get:function(){var a,b=[];a=this["border-bottom-width"];a!=""&&a.indexOf(" ")==-1&&b.push(a);a=this["border-bottom-style"];a!=""&&a.indexOf(" ")==-1&&b.push(a);a=this["border-bottom-color"];a!=""&&a.indexOf(" ")==-1&&b.push(a);return b.join(" ")},set:function(a){a=(a||"").toString().toLowerCase().trim();if(a==""||
a=="inherit")this["border-bottom-width"]=a,this["border-bottom-style"]=a,this["border-bottom-color"]=a;else{var a=a.split(/[\s]+/),b="",c="",i="";a.length&&CSSDefs.isCSSBorderWidth(a[0])&&(b=a[0],a.shift());a.length&&CSSDefs.isCSSBorderStyle(a[0])&&(c=a[0],a.shift());a.length&&CSSDefs.isCSSColor(a[0])&&(i=a[0],a.shift());if(a.length)throw"Failed to parse the border property: (@string: "+a[0]+")";this["border-bottom-width"]=b;this["border-bottom-style"]=c;this["border-bottom-color"]=i}k.onCustomEvent("attribute-changed",
{which:"border-bottom",value:this["border-bottom"]});k.onCustomEvent("attribute-changed",{which:"border",value:this.border})}});Object.defineProperty(this,"border-top",{get:function(){var a,b=[];a=this["border-top-width"];a!=""&&a.indexOf(" ")==-1&&b.push(a);a=this["border-top-style"];a!=""&&a.indexOf(" ")==-1&&b.push(a);a=this["border-top-color"];a!=""&&a.indexOf(" ")==-1&&b.push(a);return b.join(" ")},set:function(a){a=(a||"").toString().toLowerCase().trim();if(a==""||a=="inherit")this["border-top-width"]=
a,this["border-top-style"]=a,this["border-top-color"]=a;else{var a=a.split(/[\s]+/),b="",c="",i="";a.length&&CSSDefs.isCSSBorderWidth(a[0])&&(b=a[0],a.shift());a.length&&CSSDefs.isCSSBorderStyle(a[0])&&(c=a[0],a.shift());a.length&&CSSDefs.isCSSColor(a[0])&&(i=a[0],a.shift());if(a.length)throw"Failed to parse the border property: (@string: "+a[0]+")";this["border-top-width"]=b;this["border-top-style"]=c;this["border-top-color"]=i}k.onCustomEvent("attribute-changed",{which:"border-top",value:this["border-top"]});
k.onCustomEvent("attribute-changed",{which:"border",value:this.border})}});Object.defineProperty(this,"border-right",{get:function(){var a,b=[];a=this["border-right-width"];a!=""&&a.indexOf(" ")==-1&&b.push(a);a=this["border-right-style"];a!=""&&a.indexOf(" ")==-1&&b.push(a);a=this["border-right-color"];a!=""&&a.indexOf(" ")==-1&&b.push(a);return b.join(" ")},set:function(a){a=(a||"").toString().toLowerCase().trim();if(a==""||a=="inherit")this["border-right-width"]=a,this["border-right-style"]=a,
this["border-right-color"]=a;else{var a=a.split(/[\s]+/),b="",c="",i="";a.length&&CSSDefs.isCSSBorderWidth(a[0])&&(b=a[0],a.shift());a.length&&CSSDefs.isCSSBorderStyle(a[0])&&(c=a[0],a.shift());a.length&&CSSDefs.isCSSColor(a[0])&&(i=a[0],a.shift());if(a.length)throw"Failed to parse the border property: (@string: "+a[0]+")";this["border-right-width"]=b;this["border-right-style"]=c;this["border-right-color"]=i}k.onCustomEvent("attribute-changed",{which:"border-right",value:this["border-right"]});k.onCustomEvent("attribute-changed",
{which:"border",value:this.border})}});Object.defineProperty(this,"border-left",{get:function(){var a,b=[];a=this["border-left-width"];a!=""&&a.indexOf(" ")==-1&&b.push(a);a=this["border-left-style"];a!=""&&a.indexOf(" ")==-1&&b.push(a);a=this["border-left-color"];a!=""&&a.indexOf(" ")==-1&&b.push(a);return b.join(" ")},set:function(a){a=(a||"").toString().toLowerCase().trim();if(a==""||a=="inherit")this["border-left-width"]=a,this["border-left-style"]=a,this["border-left-color"]=a;else{var a=a.split(/[\s]+/),
b="",c="",i="";a.length&&CSSDefs.isCSSBorderWidth(a[0])&&(b=a[0],a.shift());a.length&&CSSDefs.isCSSBorderStyle(a[0])&&(c=a[0],a.shift());a.length&&CSSDefs.isCSSColor(a[0])&&(i=a[0],a.shift());if(a.length)throw"Failed to parse the border property: (@string: "+a[0]+")";this["border-left-width"]=b;this["border-left-style"]=c;this["border-left-color"]=i}k.onCustomEvent("attribute-changed",{which:"border-left",value:this["border-left"]});k.onCustomEvent("attribute-changed",{which:"border",value:this.border})}});
Object.defineProperty(this,"border",{get:function(){var a,b=[];a=this["border-width"];a!=""&&a.indexOf(" ")==-1&&b.push(a);a=this["border-style"];a!=""&&a.indexOf(" ")==-1&&b.push(a);a=this["border-color"];a!=""&&a.indexOf(" ")==-1&&b.push(a);return b.join(" ")},set:function(a){a=(a||"").toString().toLowerCase().trim();if(a==""||a=="inherit")this["border-width"]=a,this["border-style"]=a,this["border-color"]=a;else{var a=a.split(/[\s]+/),b="",c="",i="";a.length&&CSSDefs.isCSSBorderWidth(a[0])&&(b=
a[0],a.shift());a.length&&CSSDefs.isCSSBorderStyle(a[0])&&(c=a[0],a.shift());a.length&&CSSDefs.isCSSColor(a[0])&&(i=a[0],a.shift());if(a.length)throw"Failed to parse the border property: (@string: "+a[0]+")";this["border-width"]=b;this["border-style"]=c;this["border-color"]=i}k.onCustomEvent("attribute-changed",{which:"border",value:this.border})}});Object.defineProperty(this,"alteredAttributes",{get:function(){return i}})})}});this.addCustomEventListener("attribute-changed",function(a){console.log(a.which,
" => ",a.value);i[a.which]=a.value;return true});var l=this.insert((new TabPanel({initTabs:function(){var b=[];(a.styles.border||a.styles.padding||a.styles.margin||a.styles.color||a.styles.background||a.styles.width||a.styles.height)&&b.push({id:"styles",caption:"Box Model",closeable:false});(a.styles.title||a.styles["class"]||a.styles.id)&&b.push({id:"web",caption:"Web",closeable:false});(a.styles.href||a.styles.target)&&b.push({id:"link",caption:"Link",closeable:false});(a.styles["float"]||a.styles.align||
a.styles.clear)&&b.push({id:"position",caption:"Position",closeable:false});a.styles.image&&b.push({id:"image",caption:"Picture",closeable:false});a.styles.audio&&b.push({id:"audio",caption:"Audio",closeable:false});a.styles.video&&b.push({id:"video",caption:"Video",closeable:false});return b}()})).setAnchors({width:function(a){return a-10+"px"},height:function(a,b){return b-50+"px"}}).setAttr("style","margin: 10px 5px"));(function(a){a.insert(new Button("Ok",function(){a.appHandler("cmd_ok")})).setAttr("style",
"position: absolute; bottom: 10px; right: 70px");a.insert(new Button("Cancel",function(){a.appHandler("cmd_cancel")})).setAttr("style","position: absolute; bottom: 10px; right: 10px")})(this);(a.styles.border||a.styles.padding||a.styles.margin||a.styles.color||a.styles.background||a.styles.width||a.styles.height)&&CSSNodeEditor_init_style_tab(this,l,{border:!!a.styles.border,margin:!!a.styles.margin,padding:!!a.styles.padding,color:!!a.styles.color,background:!!a.styles.background,width:!!a.styles.width,
height:!!a.styles.height,integration:a.integration});(a.styles.id||a.styles["class"]||a.styles.title)&&CSSNodeEditor_init_web_tab(this,l,{id:!!a.styles.id,"class":!!a.styles["class"],title:!!a.styles.title});(a.styles.href||a.styles.target)&&CSSNodeEditor_init_link_tab(this,l,{href:!!a.styles.href,target:!!a.styles.target,anchor:!!a.styles.anchor,integration:a.integration});(a.styles["float"]||a.styles.align||a.styles.clear)&&CSSNodeEditor_init_position_tab(this,l,{"float":!!a.styles["float"],align:!!a.styles.align,
clear:!!a.styles.clear});a.styles.image&&CSSNodeEditor_init_image_tab(this,l,{integration:a.integration});a.styles.video&&CSSNodeEditor_init_video_tab(this,l,{integration:a.integration});CSSEditor_cmd_edit_margins(this);CSSEditor_cmd_edit_padding(this);CSSEditor_cmd_edit_size(this);CSSEditor_cmd_edit_colors(this);CSSEditor_cmd_edit_borders(this);(function(i){setTimeout(function(){i.paint()},10);i.handlers.cmd_ok=function(){typeof a.done=="function"&&a.done(c,i.nodeAttributes);i.close()};i.closeCallback=
function(){b&&(b.focus(),f>=0&&b.setCaretPosition(f));setTimeout(function(){i.purge()},30);return true};i.handlers.cmd_cancel=function(){i.close()};Keyboard.bindKeyboardHandler(i,"esc",function(){i.appHandler("cmd_cancel")})})(this);typeof a.init=="function"&&a.init(c,this.nodeAttributes)})}
function CSSNodeEditor_init_link_tab(c,a,b){a=a.getTabById("link").getSheet();a.style.overflow="hidden";var f={},g=function(a,b){return f[a]=b},i=function(a){var b;if(!(b=f[a]))throw"Namespace "+a+" is not defined (yet?)";return b},h=c.nodeAttributes;b.href&&(g("0001-lbl",(new DOMLabel("Hyperlink:")).setAttr("style","top: 10px; left: 10px; width: 65px; position: absolute; text-overflow: ellipsis")),g("0001-text",(new CSSSourceInput(h.href,{}.chain(function(){this.allowBrowse=b.integration.allowBrowse;
this.browseCallback=b.integration.browseCallback}))).setAttr("style","top: 5px; left: 90px; position: absolute; margin: 0; width: auto; right: 10px")),a.insertTop(i("0001-lbl"),10),a.insertTop(i("0001-text"),-5,20),i("0001-text").addCustomEventListener("change",function(){h.href=this.value;return true}));b.target&&(g("0002-lbl",(new DOMLabel("Target:")).setAttr("style","top: 40px; left: 10px; width: 50px; position: absolute; text-overflow: ellipsis")),g("0002-text",(new DropDown([{id:"",name:"Not Specified"},
{id:"_blank",name:"Blank Page ( New Tab )"},{id:"_self",name:"Same Frame"},{id:"_parent",name:"Parent Frame"},{id:"_top",name:"Main Page"}])).setProperty("value",["_blank","_self","_parent","_top"].indexOf(h.target)>=0?h.target:"").setAttr("style","top: 35px; left: 90px; position: absolute; margin: 0; width: auto; right: 10px; padding: 0; margin: 0;").chain(function(){this.addEventListener("change",function(){h.target=this.value})})),a.insertTop(i("0002-lbl"),10),a.insertTop(i("0002-text"),-5,20));
b.anchor&&(g("0003-lbl",(new DOMLabel("Anchor Text:")).setAttr("style","top: 70px; left: 10px; width: 70px; position: absolute; text-overflow: ellipsis")),g("0003-text",(new TextBox(h.anchor)).setAttr("style","top: 65px; left: 90px; position: absolute; margin: 0; width: auto; right: 10px")),a.insertTop(i("0003-lbl"),10),a.insertTop(i("0003-text"),-5,20),i("0003-text").addCustomEventListener("change",function(){h.anchor=this.value}))}
function CSSNodeEditor_init_position_tab(c,a,b){a=a.getTabById("position").getSheet();a.style.overflow="hidden";var f={},g=function(a,b){return f[a]=b},i=function(a){var b;if(!(b=f[a]))throw"Namespace "+a+" is not defined (yet?)";return b},h=c.nodeAttributes;if(b["float"]){g("0001-holder",(new DOMPlaceable({caption:"Float",appearence:"opaque"})).setAttr("style","top: 30px; left: 10px; right: 10px; position: absolute; height: 100px; zoom: .8"));var j=g("0001-img",(new DOMImage({src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAABQCAIAAADKqIEEAAAAAXNSR0IArs4c6QAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB90EGAcWFAFUC84AAAAZdEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIEdJTVBXgQ4XAAAAlklEQVRo3u3XwQmAMAwF0FZcUtzAgdxAHDPePAiehJDi+zdvnxhfbY+INlqmNmCUVlrpApkfz+ex1yy6rJv1SE93IipND+tBD6XpYT3oQQ960IMeJv1bPe4vOsEcelRYj+/vzqStR/4fCz3oQQ960MPNxaTdXDJDD3rQgx70oIdJ04Me9DBpetDDetBDaaWVVlpppd9yAZxQRM+n/g9IAAAAAElFTkSuQmCC",
displayMode:"best"})).setAttr("style","top: 10px; left: 10px; width: 45px; height: 60px; position: absolute")),k=g("0002-img",(new DOMImage({src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAABQCAIAAADKqIEEAAAAAXNSR0IArs4c6QAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB90EGAcWLClWs1AAAAAZdEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIEdJTVBXgQ4XAAAAk0lEQVRo3u3YsQ2AMAwEwASxJGIDBsoGiDFNi+igiS2du1S8zOsQ6RHRqs3SCo7QQgudYNbn4TpHzpTbfqjHjOm+iELTQz3oITQ91IMe9KAHPehh0/T44cCnZ9EjQz1eb8Gm1WOWHupBD5umBz38udg0Pdx7qAc9hKaHetBDaHrQgx70oAc96GHTQgsttNBCVwx9AynKRM9UwSHfAAAAAElFTkSuQmCC",
displayMode:"best"})).setAttr("style","top: 10px; left: 85px; width: 45px; height: 60px; position: absolute")),l=g("0003-img",(new DOMImage({src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAABQCAIAAADKqIEEAAAAAXNSR0IArs4c6QAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB90EGAcYEJi64lkAAAAZdEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIEdJTVBXgQ4XAAAAnUlEQVRo3u3XQQqAIBRFUY02Ge2gBbWDaJk2i2ggFGFa582cXb7PKz+mlEJr6UKDAQ0adAXpj4d1meukHMZJPd5I9COCZg/1YA/Q7KEe7MEe7MEe7GHSf7PH/pYv2eZkAPVorh4P3qBJgwYNGrTPpWRu7Ec2F5sLe3xjcykf9mAP9mAP9mAPk2YP9mAPk2YP9lAP9gANGjRo0KAz2QCCvkCtL3GPQAAAAABJRU5ErkJggg==",
displayMode:"best"})).setAttr("style","top: 10px; left: 160px; width: 45px; height: 60px; position: absolute"));switch(h["float"]){case "left":j.style.outline="3px solid orange";break;case "right":k.style.outline="3px solid orange";break;default:l.style.outline="3px solid orange"}j.onclick=function(){h["float"]="left";b.align&&(h.align="")};k.onclick=function(){h["float"]="right";b.align&&(h.align="")};l.onclick=function(){h["float"]=""};c.addCustomEventListener("attribute-changed",function(a){if(a.which==
"float")switch(j.style.outline=k.style.outline=l.style.outline="none",a.value){case "left":j.style.outline="3px solid orange";break;case "right":k.style.outline="3px solid orange";break;default:l.style.outline="3px solid orange"}return true});g("0001-lbl",(new DOMLabel("Left")).setAttr("style","top: 75px; left: 24px; width: 25px; position: absolute; text-overflow: ellipsis")).chain(function(){this.onclick=function(){j.onclick()}});g("0002-lbl",(new DOMLabel("Right")).setAttr("style","top: 75px; left: 96px; width: 30px; position: absolute; text-overflow: ellipsis")).chain(function(){this.onclick=
function(){k.onclick()}});g("0004-lbl",(new DOMLabel("Normal")).setAttr("style","top: 75px; left: 165px; width: 45px; position: absolute; text-overflow: ellipsis")).chain(function(){this.onclick=function(){l.onclick()}});a.insertTop(i("0001-holder"),20,105);i("0001-holder").insert(i("0001-img"));i("0001-holder").insert(i("0002-img"));i("0001-holder").insert(i("0003-img"));i("0001-holder").insert(i("0001-lbl"));i("0001-holder").insert(i("0002-lbl"));i("0001-holder").insert(i("0004-lbl"))}if(b.align){g("0021-holder",
(new DOMPlaceable({caption:"Align",appearence:"opaque"})).setAttr("style","top: 30px; left: 10px; right: 10px; position: absolute; height: 100px; zoom: .8"));var m=g("0021-img",(new DOMImage({src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAABQCAIAAADKqIEEAAAAAXNSR0IArs4c6QAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB90EGAcWFAFUC84AAAAZdEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIEdJTVBXgQ4XAAAAlklEQVRo3u3XwQmAMAwF0FZcUtzAgdxAHDPePAiehJDi+zdvnxhfbY+INlqmNmCUVlrpApkfz+ex1yy6rJv1SE93IipND+tBD6XpYT3oQQ960IMeJv1bPe4vOsEcelRYj+/vzqStR/4fCz3oQQ960MPNxaTdXDJDD3rQgx70oIdJ04Me9DBpetDDetBDaaWVVlpppd9yAZxQRM+n/g9IAAAAAElFTkSuQmCC",
displayMode:"best"})).setAttr("style","top: 10px; left: 10px; width: 45px; height: 60px; position: absolute")),o=g("0022-img",(new DOMImage({src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAABQCAIAAADKqIEEAAAAAXNSR0IArs4c6QAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB90EGAcWLClWs1AAAAAZdEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIEdJTVBXgQ4XAAAAk0lEQVRo3u3YsQ2AMAwEwASxJGIDBsoGiDFNi+igiS2du1S8zOsQ6RHRqs3SCo7QQgudYNbn4TpHzpTbfqjHjOm+iELTQz3oITQ91IMe9KAHPehh0/T44cCnZ9EjQz1eb8Gm1WOWHupBD5umBz38udg0Pdx7qAc9hKaHetBDaHrQgx70oAc96GHTQgsttNBCVwx9AynKRM9UwSHfAAAAAElFTkSuQmCC",
displayMode:"best"})).setAttr("style","top: 10px; left: 85px; width: 45px; height: 60px; position: absolute")),n=g("0023-img",(new DOMImage({src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAABQCAIAAADKqIEEAAAAAXNSR0IArs4c6QAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB90EGAgEBoFFTWgAAAAZdEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIEdJTVBXgQ4XAAAAjklEQVRo3u3YsQmAMBBA0URcUtzAgdxAHPNsxS42yYV3nd0jHF+SGhEl2ywl4UBDQw8w6/vjvs4xldt+WI8eU/0RodXDeqgHtHpYD/VQD/VQD/Vw0tPU4980NefTAesBDQ0NDQ0NDQ3t5gLdenPx7mE91ANaPayHekCrh3qoh3qoh3qoh5OGhoaGhs6IfgApNjmLKDErUwAAAABJRU5ErkJggg==",
displayMode:"best"})).setAttr("style","top: 10px; left: 160px; width: 45px; height: 60px; position: absolute")),q=g("0024-img",(new DOMImage({src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAABQCAIAAADKqIEEAAAAAXNSR0IArs4c6QAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB90EGAcYEJi64lkAAAAZdEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIEdJTVBXgQ4XAAAAnUlEQVRo3u3XQQqAIBRFUY02Ge2gBbWDaJk2i2ggFGFa582cXb7PKz+mlEJr6UKDAQ0adAXpj4d1meukHMZJPd5I9COCZg/1YA/Q7KEe7MEe7MEe7GHSf7PH/pYv2eZkAPVorh4P3qBJgwYNGrTPpWRu7Ec2F5sLe3xjcykf9mAP9mAP9mAPk2YP9mAPk2YP9lAP9gANGjRo0KAz2QCCvkCtL3GPQAAAAABJRU5ErkJggg==",
displayMode:"best"})).setAttr("style","top: 10px; left: 235px; width: 45px; height: 60px; position: absolute"));switch(h.align){case "left":m.style.outline="3px solid orange";break;case "right":o.style.outline="3px solid orange";break;case "center":o.style.outline="3px solid orange";break;default:q.style.outline="3px solid orange"}m.onclick=function(){h.align="left";b["float"]&&(h["float"]="")};o.onclick=function(){h.align="right";b["float"]&&(h["float"]="")};n.onclick=function(){h.align="center";
b["float"]&&(h["float"]="")};q.onclick=function(){h.align=""};c.addCustomEventListener("attribute-changed",function(a){if(a.which=="align")switch(m.style.outline=o.style.outline=n.style.outline=q.style.outline="none",a.value){case "left":m.style.outline="3px solid orange";break;case "right":o.style.outline="3px solid orange";break;case "center":n.style.outline="3px solid orange";break;default:q.style.outline="3px solid orange"}return true});g("0021-lbl",(new DOMLabel("Left")).setAttr("style","top: 75px; left: 24px; width: 25px; position: absolute; text-overflow: ellipsis")).chain(function(){this.onclick=
function(){m.onclick()}});g("0022-lbl",(new DOMLabel("Right")).setAttr("style","top: 75px; left: 96px; width: 30px; position: absolute; text-overflow: ellipsis")).chain(function(){this.onclick=function(){o.onclick()}});g("0024-lbl",(new DOMLabel("Center")).setAttr("style","top: 75px; left: 165px; width: 45px; position: absolute; text-overflow: ellipsis")).chain(function(){this.onclick=function(){n.onclick()}});g("0025-lbl",(new DOMLabel("Normal")).setAttr("style","top: 75px; left: 239px; width: 45px; position: absolute; text-overflow: ellipsis")).chain(function(){this.onclick=
function(){q.onclick()}});a.insertTop(i("0021-holder"),20,105);i("0021-holder").insert(i("0021-img"));i("0021-holder").insert(i("0022-img"));i("0021-holder").insert(i("0023-img"));i("0021-holder").insert(i("0024-img"));i("0021-holder").insert(i("0021-lbl"));i("0021-holder").insert(i("0022-lbl"));i("0021-holder").insert(i("0024-lbl"));i("0021-holder").insert(i("0025-lbl"))}if(b.clear){g("0031-holder",(new DOMPlaceable({caption:"Clear",appearence:"opaque"})).setAttr("style","top: 30px; left: 10px; right: 10px; position: absolute; height: 100px; zoom: .8"));
var p=g("0031-img",(new DOMImage({src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAABQCAIAAADKqIEEAAAAAXNSR0IArs4c6QAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB90EGAsiIwvZpFIAAAAZdEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIEdJTVBXgQ4XAAAA70lEQVRo3u2YUQ6DIBAFhfSSTW/ggbxB4zHph0lDAI0NbzdYh78ShWHzdqyGlNJ0tRGnCw6ggQZ6gPEofq/vZUzQ52smHu4j8EQEGnsQD+wBNPYgHtgDe2AP7IE9qPRt7ZF39HZvcyaf37tmb6ZeQVnpg723XXOCk8Tfe4trojVxvXfPGWTQnfX76QwyaG0GDtYxsYcqA811rKCNclxze9hD3otKe7j1YhTW2K0XZfbw7EXxfw+7XnSyh/YM+kw792Ic/JnStAdvLkDz3YN48N0DaOxBPLAH9sAe2AN7UGnsgT2wB5UGGmiggQb6n6E/9yO1fCBlpRUAAAAASUVORK5CYII=",
displayMode:"best"})).setAttr("style","top: 10px; left: 10px; width: 45px; height: 60px; position: absolute")),r=g("0032-img",(new DOMImage({src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAABQCAIAAADKqIEEAAAAAXNSR0IArs4c6QAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB90EGAsjALCl5GEAAAAZdEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIEdJTVBXgQ4XAAAA6klEQVRo3u2YQQqEMBAEdfGT4g98kD9YfGb24GVgdIPYoxOpHARDEiuhp0T7UkrXWvt0DTaggQY6QRvszfpdclKO00w8nmg9b0SgsQfxwB5AYw/igT2wB/bAHtiDk36TPcZp3q62x4856vEr/JmlsYd/3tbjx/h9WrLqLHE8rlCe2q0400GUdh09dASlXUcPHUHpq1AJHUSprcJ9eySvwro9ElbhYabjqlBvjxuqUG+PJqpw56TzV2HFHkH5DrRH5rcMXy5A89+DeGAPoLEH8cAe2AN7YA/swUljD+yBPThpoIEGGmig3wz9Az4CtXxg8vglAAAAAElFTkSuQmCC",
displayMode:"best"})).setAttr("style","top: 10px; left: 85px; width: 45px; height: 60px; position: absolute")),t=g("0033-img",(new DOMImage({src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAABQCAIAAADKqIEEAAAAAXNSR0IArs4c6QAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB90EGAskEgxdA+4AAAAZdEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIEdJTVBXgQ4XAAABCklEQVRo3u2YUQqDMBBEdeklxRt4IG9QPGb8KJRgkk1cU5vI249Cxe4O68wLdXTODb2VDB0WohGN6Abq5X/Z3mubKqd5wR7/qJETEdHQA3tAD0RDD+wBPaAH9IAe0INNP4ke07x8Pv0r4T1m5hx+WzhC2/RB8fdKeE9dnOkjwnFiaPFr3f6I6NbF1kJ/fCVVMiLlE4m2O9Xi4naVEalHKqlYlLe4qNsQIVFi20gKM57uIoV5eij+riXaECGxtahFD1uEpLsURjzdYArz9Cj3920pPEePG04Z2wipeFDZFBtG8M8F0bz3wB6890A09MAe0AN6QA/oAT3YNPSAHtCDTSMa0YhGNKKfLHoH9mKFfM5OtwcAAAAASUVORK5CYII=",
displayMode:"best"})).setAttr("style","top: 10px; left: 160px; width: 45px; height: 60px; position: absolute")),w=g("0034-img",(new DOMImage({src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAABQCAIAAADKqIEEAAAAAXNSR0IArs4c6QAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB90EGAcYEJi64lkAAAAZdEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIEdJTVBXgQ4XAAAAnUlEQVRo3u3XQQqAIBRFUY02Ge2gBbWDaJk2i2ggFGFa582cXb7PKz+mlEJr6UKDAQ0adAXpj4d1meukHMZJPd5I9COCZg/1YA/Q7KEe7MEe7MEe7GHSf7PH/pYv2eZkAPVorh4P3qBJgwYNGrTPpWRu7Ec2F5sLe3xjcykf9mAP9mAP9mAPk2YP9mAPk2YP9lAP9gANGjRo0KAz2QCCvkCtL3GPQAAAAABJRU5ErkJggg==",
displayMode:"best"})).setAttr("style","top: 10px; left: 235px; width: 45px; height: 60px; position: absolute"));switch(h.clear){case "left":p.style.outline="3px solid orange";break;case "right":r.style.outline="3px solid orange";break;case "both":t.style.outline="3px solid orange";break;default:w.style.outline="3px solid orange"}p.onclick=function(){h.clear="left"};r.onclick=function(){h.clear="right"};t.onclick=function(){h.clear="both"};w.onclick=function(){h.clear=""};c.addCustomEventListener("attribute-changed",
function(a){if(a.which=="clear")switch(p.style.outline=r.style.outline=t.style.outline=w.style.outline="none",a.value){case "left":p.style.outline="3px solid orange";break;case "right":r.style.outline="3px solid orange";break;case "both":t.style.outline="3px solid orange";break;default:w.style.outline="3px solid orange"}return true});g("0031-lbl",(new DOMLabel("Left")).setAttr("style","top: 75px; left: 24px; width: 25px; position: absolute; text-overflow: ellipsis")).chain(function(){this.onclick=
function(){p.onclick()}});g("0032-lbl",(new DOMLabel("Right")).setAttr("style","top: 75px; left: 96px; width: 30px; position: absolute; text-overflow: ellipsis")).chain(function(){this.onclick=function(){r.onclick()}});g("0034-lbl",(new DOMLabel("Both")).setAttr("style","top: 75px; left: 173px; width: 45px; position: absolute; text-overflow: ellipsis")).chain(function(){this.onclick=function(){t.onclick()}});g("0035-lbl",(new DOMLabel("Normal")).setAttr("style","top: 75px; left: 239px; width: 45px; position: absolute; text-overflow: ellipsis")).chain(function(){this.onclick=
function(){w.onclick()}});a.insertTop(i("0031-holder"),20,135);i("0031-holder").insert(i("0031-img"));i("0031-holder").insert(i("0032-img"));i("0031-holder").insert(i("0033-img"));i("0031-holder").insert(i("0034-img"));i("0031-holder").insert(i("0031-lbl"));i("0031-holder").insert(i("0032-lbl"));i("0031-holder").insert(i("0034-lbl"));i("0031-holder").insert(i("0035-lbl"))}}
function CSSNodeEditor_init_style_tab(c,a,b){var f=a.getTabById("styles").getSheet();f.style.overflow="hidden";b.margin&&f.appendChild(new Button("Margin",function(){i.className="CSS_NodeEditorHolder has-margin";f.removeClass("section-margins").removeClass("section-borders").removeClass("section-padding").removeClass("section-dimensions").removeClass("section-colors").addClass("section-margins");c.paint()})).setAttr("style","margin: 5px 0px; zoom: .9").addClass("button-tab-margins");b.border&&f.appendChild(new Button("Border",
function(){i.className="CSS_NodeEditorHolder has-border";f.removeClass("section-margins").removeClass("section-borders").removeClass("section-padding").removeClass("section-dimensions").removeClass("section-colors").addClass("section-borders");c.paint()})).setAttr("style","margin: 5px 0px; zoom: .9").addClass("button-tab-borders");b.padding&&f.appendChild(new Button("Padding",function(){i.className="CSS_NodeEditorHolder has-padding";f.removeClass("section-margins").removeClass("section-borders").removeClass("section-padding").removeClass("section-dimensions").removeClass("section-colors").addClass("section-padding");
c.paint()})).setAttr("style","margin: 5px 0px; zoom: .9").addClass("button-tab-padding");(b.width||b.height)&&f.appendChild(new Button("Size",function(){i.className="CSS_NodeEditorHolder has-dimensions";f.removeClass("section-margins").removeClass("section-borders").removeClass("section-padding").removeClass("section-dimensions").removeClass("section-colors").addClass("section-dimensions");c.paint()})).setAttr("style","margin: 5px 0px; zoom: .9").addClass("button-tab-dimensions");(b.background||b.color)&&
f.appendChild(new Button("Fill and Color",function(){i.className="CSS_NodeEditorHolder has-colors";f.removeClass("section-margins").removeClass("section-borders").removeClass("section-padding").removeClass("section-dimensions").removeClass("section-colors").addClass("section-colors");c.paint()})).setAttr("style","margin: 5px 0px; zoom: .9").addClass("button-tab-colors");try{f.querySelectorAll("button")[0].style.marginLeft="10px"}catch(g){}var i=f.insert($("div","CSS_NodeEditorHolder").setAnchors({height:function(a,
b){return b-70+"px"},width:function(a){return a-10+"px"}}).setAttr("style","margin: 0px 5px")),h=c.nodeAttributes,b=b||{};b.border&&i.appendChild($("div","border-layer")).chain(function(){(function(a){a.appendChild($("div").chain(function(){this.appendChild($("div","explain")).chain(function(){this.appendChild($("div").setHTML("Padding")).setAnchors({marginTop:function(a,b){return b/2-this.offsetHeight/2+"px"}})});var b=this.appendChild($("div","border-top-left")).chain(function(){var i=this.appendChild($("div",
"value"));Object.defineProperty(this,"borderRadius",{set:function(b){i.innerHTML=b?b+"<br />rad":"";a.style.borderTopLeftRadius=h["border-top-left-radius"]}});c.addCustomEventListener("attribute-changed",function(a){if(a.which=="border-top-left-radius")b.borderRadius=a.value,c.paint();return true});this.borderRadius=h["border-top-left-radius"]}),i=this.appendChild($("div","border-top-right")).chain(function(){var b=this.appendChild($("div","value"));Object.defineProperty(this,"borderRadius",{set:function(c){b.innerHTML=
c?c+"<br />rad":"";a.style.borderTopRightRadius=h["border-top-right-radius"]}});c.addCustomEventListener("attribute-changed",function(a){if(a.which=="border-top-right-radius")i.borderRadius=a.value,c.paint();return true});this.borderRadius=h["border-top-right-radius"]}),f=this.appendChild($("div","border-bottom-left")).chain(function(){var b=this.appendChild($("div","value"));Object.defineProperty(this,"borderRadius",{set:function(c){b.innerHTML=c?c+"<br />rad":"";a.style.borderBottomLeftRadius=h["border-bottom-left-radius"]}});
c.addCustomEventListener("attribute-changed",function(a){if(a.which=="border-bottom-left-radius")f.borderRadius=a.value,c.paint();return true});this.borderRadius=h["border-bottom-left-radius"]}),g=this.appendChild($("div","border-bottom-right")).chain(function(){var b=this.appendChild($("div","value"));Object.defineProperty(this,"borderRadius",{set:function(c){b.innerHTML=c?c+"<br />rad":"";a.style.borderBottomRightRadius=h["border-bottom-right-radius"]}});this.borderRadius=h["border-bottom-right-radius"];
c.addCustomEventListener("attribute-changed",function(a){if(a.which=="border-bottom-right-radius")g.borderRadius=a.value,c.paint();return true})}),j=this.appendChild($("div","border-left")).chain(function(){var b=this.appendChild($("div","value"));Object.defineProperty(this,"value",{set:function(){var c=[];h["border-left-width"]&&c.push(h["border-left-width"]);h["border-left-style"]&&c.push(h["border-left-style"]);h["border-left-color"]&&c.push(h["border-left-color"]);b.innerHTML=c.length?c.join(",<br />"):
"-";a.style.borderLeft=h["border-left"]}});c.addCustomEventListener("attribute-changed",function(a){if(a.which=="border-left")j.value="",c.paint();return true});this.value=""}),p=this.appendChild($("div","border-right")).chain(function(){var b=this.appendChild($("div","value"));Object.defineProperty(this,"value",{set:function(){var c=[];h["border-right-width"]&&c.push(h["border-left-width"]);h["border-right-style"]&&c.push(h["border-right-style"]);h["border-right-color"]&&c.push(h["border-right-color"]);
b.innerHTML=c.length?c.join(",<br />"):"-";a.style.borderRight=h["border-right"]}});c.addCustomEventListener("attribute-changed",function(a){if(a.which=="border-right")p.value="",c.paint();return true});this.value=""}),r=this.appendChild($("div","border-top")).chain(function(){var b=this.appendChild($("div","value"));Object.defineProperty(this,"value",{set:function(){var c=[];h["border-top-width"]&&c.push(h["border-top-width"]);h["border-top-style"]&&c.push(h["border-top-style"]);h["border-left-color"]&&
c.push(h["border-top-color"]);b.innerHTML=c.length?c.join(", "):"-";a.style.borderTop=h["border-top"]}});c.addCustomEventListener("attribute-changed",function(a){if(a.which=="border-top")r.value="",c.paint();return true});this.value=""}),t=this.appendChild($("div","border-bottom")).chain(function(){var b=this.appendChild($("div","value"));Object.defineProperty(this,"value",{set:function(){var c=[];h["border-bottom-width"]&&c.push(h["border-bottom-width"]);h["border-bottom-style"]&&c.push(h["border-bottom-style"]);
h["border-bottom-color"]&&c.push(h["border-bottom-color"]);b.innerHTML=c.length?c.join(", "):"-";a.style.borderBottom=h["border-bottom"]}});c.addCustomEventListener("attribute-changed",function(a){if(a.which=="border-bottom")t.value="",c.paint();return true});this.value=""})}))})(this)});b.margin&&i.appendChild($("div","margin-layer")).chain(function(){(function(a){a.appendChild($("div").chain(function(){this.appendChild($("div","explain").chain(function(){this.appendChild($("div").setHTML("Borders")).setAnchors({marginTop:function(a,
b){return b/2-this.offsetHeight/2+"px"}})}));var a=this.appendChild($("div","margin-left")).chain(function(){var b=this.appendChild($("div","value")).setAnchors({marginTop:function(a,b){return b/2-this.offsetHeight/2+"px"}});Object.defineProperty(this,"value",{set:function(a){b.innerHTML=a?a:"none"}});c.addCustomEventListener("attribute-changed",function(b){if(b.which=="margin-left")a.value=b.value});this.value=h["margin-left"]}),b=this.appendChild($("div","margin-right")).chain(function(){var a=
this.appendChild($("div","value")).setAnchors({marginTop:function(a,b){return b/2-this.offsetHeight/2+"px"}});Object.defineProperty(this,"value",{set:function(b){a.innerHTML=b?b:"none"}});c.addCustomEventListener("attribute-changed",function(a){if(a.which=="margin-right")b.value=a.value});this.value=h["margin-right"]}),i=this.appendChild($("div","margin-top")).chain(function(){var a=this.appendChild($("div","value"));Object.defineProperty(this,"value",{set:function(b){a.innerHTML=b?b:"none"}});c.addCustomEventListener("attribute-changed",
function(a){if(a.which=="margin-top")i.value=a.value});this.value=h["margin-top"]}),f=this.appendChild($("div","margin-bottom")).chain(function(){var a=this.appendChild($("div","value"));Object.defineProperty(this,"value",{set:function(b){a.innerHTML=b?b:"none"}});c.addCustomEventListener("attribute-changed",function(a){if(a.which=="margin-bottom")f.value=a.value});this.value=h["margin-bottom"]})}))})(this)});b.padding&&i.appendChild($("div","padding-layer")).chain(function(){(function(a){a.appendChild($("div").chain(function(){this.appendChild($("div",
"explain").chain(function(){this.appendChild($("div").setHTML("Dimensions")).setAnchors({marginTop:function(a,b){return b/2-this.offsetHeight/2+"px"}})}));var a=this.appendChild($("div","padding-top")).chain(function(){var b=this.appendChild($("div","value"));Object.defineProperty(this,"value",{set:function(a){b.innerHTML=a?a:"none"}});c.addCustomEventListener("attribute-changed",function(b){if(b.which=="padding-top")a.value=b.value});this.value=h["padding-top"]}),b=this.appendChild($("div","padding-right")).chain(function(){var a=
this.appendChild($("div","value")).setAnchors({marginTop:function(a,b){return b/2-this.offsetHeight/2+"px"}});Object.defineProperty(this,"value",{set:function(b){a.innerHTML=b?b:"none"}});c.addCustomEventListener("attribute-changed",function(a){if(a.which=="padding-right")b.value=a.value});this.value=h["padding-right"]}),i=this.appendChild($("div","padding-bottom")).chain(function(){var a=this.appendChild($("div","value"));Object.defineProperty(this,"value",{set:function(b){a.innerHTML=b?b:"none"}});
c.addCustomEventListener("attribute-changed",function(a){if(a.which=="padding-bottom")i.value=a.value});this.value=h["padding-bottom"]}),f=this.appendChild($("div","padding-left")).chain(function(){var a=this.appendChild($("div","value")).setAnchors({marginTop:function(a,b){return b/2-this.offsetHeight/2+"px"}});Object.defineProperty(this,"value",{set:function(b){a.innerHTML=b?b:"none"}});c.addCustomEventListener("attribute-changed",function(a){if(a.which=="padding-left")f.value=a.value});this.value=
h["padding-left"]})}))})(this)});(b.width||b.height)&&i.appendChild($("div","dimensions-layer")).chain(function(){(function(a){a.appendChild($("div")).chain(function(){this.appendChild($("div","padding-top").setHTML("Padding"));this.appendChild($("div","padding-right"));this.appendChild($("div","padding-bottom").setHTML("Padding"));this.appendChild($("div","padding-left"));this.appendChild($("div","explain"));if(b.width)var a=this.appendChild($("div","width")).chain(function(){var b=this.appendChild($("div",
"value"));Object.defineProperty(this,"value",{set:function(a){b.innerHTML=a?a:"auto"}});c.addCustomEventListener("attribute-changed",function(b){if(b.which=="width")a.value=b.value});this.value=h.width});if(b.height){this.appendChild($("div","height-arrow"));var i=this.appendChild($("div","height")).chain(function(){var a=this.appendChild($("div","value")).setAnchors({marginTop:function(a,b){return b/2-this.offsetHeight/2+"px"}});Object.defineProperty(this,"value",{set:function(b){a.innerHTML=b?b:
"auto"}});c.addCustomEventListener("attribute-changed",function(a){if(a.which=="height")i.value=a.value});this.value=h.height})}})})(this)});(b.color||b.background)&&i.appendChild($("div","color-layer").chain(function(){(function(a){a.appendChild($("div")).chain(function(){a.style.borderLeft=h["border-left"];a.style.borderRight=h["border-right"];a.style.borderTop=h["border-top"];a.style.borderBottom=h["border-bottom"];a.style.borderTopLeftRadius=h["border-top-left-radius"];a.style.borderTopRightRadius=
h["border-top-right-radius"];a.style.borderBottomLeftRadius=h["border-bottom-left-radius"];a.style.borderBottomRightRadius=h["border-bottom-right-radius"];a.style.backgroundColor=h["background-color"];a.style.color=h.color;a.style.backgroundRepeat=h["background-repeat"];a.style.backgroundImage=h["background-image"];a.style.backgroundPosition=h["background-position"];this.appendChild($("div").setHTML("The quick brown fox jumps over the lazy dog. The quick brown fox jumps over the lazy dog. The quick brown fox jumps over the lazy dog. The quick brown fox jumps over the lazy dog. ").setAttr("style",
"display: block; color: inherit; font-size: inherit; text-align: center; margin: 20px;"));c.addCustomEventListener("attribute-changed",function(b){if("border-left,border-right,border-top,border-bottom,border-top-left-radius,border-top-right-radius,border-bottom-left-radius,border-bottom-right-radius,background-color,color,background-repeat,background-image,background-position".split(",").indexOf(b.which)>=0)a.style.borderLeft=h["border-left"],a.style.borderRight=h["border-right"],a.style.borderTop=
h["border-top"],a.style.borderBottom=h["border-bottom"],a.style.borderTopLeftRadius=h["border-top-left-radius"],a.style.borderTopRightRadius=h["border-top-right-radius"],a.style.borderBottomLeftRadius=h["border-bottom-left-radius"],a.style.borderBottomRightRadius=h["border-bottom-right-radius"],a.style.backgroundColor=h["background-color"],a.style.color=h.color,a.style.backgroundRepeat=h["background-repeat"],a.style.backgroundImage=h["background-image"],a.style.backgroundPosition=h["background-position"];
return true})})})(this)}));try{f.querySelectorAll("button")[0].onclick()}catch(j){}f.tabIndex=0;b.margin&&(f.insert(new Button("Edit <u>M</u>argins",function(){c.appHandler("cmd_edit_margins")})).addClass("button-tab-margins edit"),Keyboard.bindKeyboardHandler(c,"alt m",function(){c.appHandler("cmd_edit_margins")}));b.border&&(f.insert(new Button("Edit <u>B</u>orders",function(){c.appHandler("cmd_edit_borders")})).addClass("button-tab-borders edit"),Keyboard.bindKeyboardHandler(c,"alt b",function(){c.appHandler("cmd_edit_borders")}));
b.padding&&(f.insert(new Button("Edit <u>P</u>adding",function(){c.appHandler("cmd_edit_padding")})).addClass("button-tab-padding edit"),Keyboard.bindKeyboardHandler(c,"alt p",function(){c.appHandler("cmd_edit_padding")}));if(b.width||b.height)f.insert(new Button("Edit <u>S</u>ize",function(){c.appHandler("cmd_edit_size",!!b.width,!!b.height)})).addClass("button-tab-dimensions edit"),Keyboard.bindKeyboardHandler(c,"alt s",function(){c.appHandler("cmd_edit_size",!!b.width,!!b.height)});if(b.background||
b.color)f.insert(new Button("Edit Fill and <u>C</u>olor",function(){c.appHandler("cmd_edit_colors",b.background,b.color,b.integration)})).addClass("button-tab-colors edit"),Keyboard.bindKeyboardHandler(c,"alt c",function(){c.appHandler("cmd_edit_colors",b.background,b.color)});console.log(b)}
function CSSNodeEditor_init_video_tab_cmd_select_poster(c,a){c.handlers.cmd_select_poster=function(){if(a.posters.length){var b={},f=function(a,c){return b[a]=c},g=function(a){var c;if(!(c=b[a]))throw"Namespace "+a+" is not defined (yet?)";return c},i=getUID(),h=f("0001-dlg",(new Dialog({alwaysOnTop:false,appIcon:"",caption:"Available video posters",closeable:true,height:246,maximizeable:false,maximized:false,minHeight:50,minWidth:50,minimizeable:false,modal:false,moveable:true,resizeable:true,scrollable:false,
visible:true,width:294,x:c.width+4,y:0,childOf:c})).chain(function(){Object.defineProperty(this,"pid",{get:function(){return i}});this.addClass("PID-"+i)})),j=null;f("0001-holder",(new DOMPlaceable({caption:"Click on a poster to select it:",appearence:"opaque"})).setAttr("style","top: 30px; left: 10px; right: 10px; position: absolute").setAnchors({height:function(a,b){return b-70+"px"}})).chain(function(){j=this.firstChild;j.style.overflowY="scroll"});f("0001-btn",(new Button("Ok",function(){})).setAttr("style",
"bottom: 10px; right: 70px; position: absolute; font-weight: bold;"));f("0002-btn",(new Button("Cancel",function(){h.close()})).setAttr("style","bottom: 10px; right: 10px; position: absolute"));f("0001-css",(new JSIde_ApplicationCSS("img { height: 64px; width: auto; border: none; padding: 0; margin: 5px; display: inline-block; } img.selected { outline: 3px solid orange; }")).toString("PID-"+i).chain(function(){h.addCss(this)}));g("0001-dlg").insert(g("0001-holder"));g("0001-dlg").insert(g("0001-btn"));
g("0001-dlg").insert(g("0002-btn"));setTimeout(function(){h.paint();h.ready()},1);h.closeCallback=function(){setTimeout(function(){h.purge();h=void 0},30);return true};Keyboard.bindKeyboardHandler(h,"esc",function(){h.close()});f=0;for(g=a.posters.length;f<g;f++)(function(b){var c=$("img").setAttr("src",b);j.appendChild(c);c.onclick=function(){for(var a=0,b=this.parentNode.querySelectorAll("img"),i=b.length;a<i;a++)b[a].removeClass("selected");c.addClass("selected")};c.ondblclick=function(){h.appHandler("cmd_ok")};
b==a.poster&&c.addClass("selected")})(a.posters[f]);h.handlers.cmd_ok=function(){var b=j.querySelector("img.selected");if(b)a.poster=b.getAttribute("src"),h.close()};h.selectNext=function(){try{j.querySelector("img.selected").nextSibling.onclick()}catch(a){}};h.selectPrev=function(){try{j.querySelector("img.selected").previousSibling.onclick()}catch(a){}};Keyboard.bindKeyboardHandler(h,"left",h.selectPrev);Keyboard.bindKeyboardHandler(h,"up",h.selectPrev);Keyboard.bindKeyboardHandler(h,"right",h.selectNext);
Keyboard.bindKeyboardHandler(h,"down",h.selectNext);Keyboard.bindKeyboardHandler(h,"enter",function(){h.appHandler("cmd_ok")});return h}else DialogBox("There are no posters available to choose from!\n\nTry adding a video first",{type:"error",childOf:c,caption:"Error choosing poster"})}}
function CSSNodeEditor_init_video_tab(c,a,b){a=a.getTabById("video").getSheet();a.style.overflow="hidden";var f={},g=function(a,b){return f[a]=b},i=function(a){var b;if(!(b=f[a]))throw"Namespace "+a+" is not defined (yet?)";return b},h=c.nodeAttributes,j=g("0001-grid",(new DataGrid).setAttr("style","top: 115px; left: 10px; position: absolute;").setAnchors({width:function(a){return a-20+"px"},height:function(a,b){return b-210+"px"}}).setProperty("selectable",true).setProperty("multiple",true).chain(function(){this.colWidths=
[170,60,60];this.th(["Source","Type","Quality"]);this.setProperty("delrow",function(){return false});this.enableResizing();this.enableSorting();this.selectable=true}).chain(function(){var a=this;c.addCustomEventListener("attribute-changed",function(b){console.log("changed!");if(b.which!="sources")return true;a.clear();for(var b=0,c=h.sources,i=c.length;b<i;b++){var f=c[b];a.tr([f.src,f.type,f.quality||"-"]).primaryKey=f.src}a.render();return true})}));g("0001-check",(new DOMCheckBox({valuesSet:"two-states",
checked:!!h.controls})).setAttr("style","top: 53px; left: 10px; position: absolute").chain(function(){this.addCustomEventListener("change",function(){h.controls=this.checked;return true})}));g("0002-check",(new DOMCheckBox({valuesSet:"two-states",checked:!!h.autostart})).setAttr("style","top: 53px; left: 95px; position: absolute").chain(function(){this.addCustomEventListener("change",function(){h.autostart=this.checked;return true})}));g("0001-btn",(new Button("Remove",function(){j.selectedIndex>=
0&&h.sources.remove(j.tbody.rows[j.selectedIndex].primaryKey)})).setAttr("style","bottom: 65px; right: 10px; position: absolute"));g("0002-btn",(new Button("Add",function(){if(k.value){var a=null;if(typeof b.integration.getVideoInfo=="function")try{a=b.integration.getVideoInfo(k.value)}catch(c){a=null}var i="video";if(a!==null&&a.versions&&a.versions.length){for(var i=0,f=a.versions||[],g=f.length;i<g;i++)f[i].src&&f[i].type&&h.sources.add(f[i].src,f[i].type,f[i].quality||"");if(a.posters&&a.posters.length){i=
0;for(g=a.posters.length;i<g;i++)h.posters.add(a.posters[i])}}else{a=k.value;switch(true){case !!(i=/\.(mp4|webm|ogv|flv)$/i.exec(a)):i="video/"+i[1];break;default:return DialogBox("Sorry, you can add only '.mp4', '.webm', '.ogv' and\n'.flv' video files!\n\nTo support more video file types, your\napplication should implement video integration",{type:"error"}),false}h.sources.add(a,i)}}})).setAttr("style","bottom: 65px; right: 75px; position: absolute"));g("0003-btn",(new Button("Choose From...",function(){c.appHandler("cmd_select_poster")})).setAttr("style",
"top: 20px; right: 10px; position: absolute"));var k=g("0001-text",(new CSSSourceInput("")).setAttr("style","bottom: 65px; left: 60px; right: 120px; position: absolute; margin: 0; width: auto")),l=g("0002-text",(new CSSSourceInput(h.poster)).setAttr("style","top: 20px; left: 60px; position: absolute; margin: 0; width: auto; right: 120px").chain(function(){this.addCustomEventListener("change",function(){h.poster=this.value;return true});c.addCustomEventListener("attribute-changed",function(a){if(a.which==
"poster")l.value=a.value;return true})}));g("0001-lbl",(new DOMLabel("Poster:")).setAttr("style","top: 23px; left: 10px; width: 50px; position: absolute; text-overflow: ellipsis"));g("0002-lbl",(new DOMLabel("Controls",{"for":i("0001-check")})).setAttr("style","top: 55px; left: 35px; width: 50px; position: absolute; text-overflow: ellipsis"));g("0003-lbl",(new DOMLabel("AutoStart",{"for":i("0002-check")})).setAttr("style","top: 55px; left: 120px; width: 60px; position: absolute; text-overflow: ellipsis"));
g("0004-lbl",(new DOMLabel("Sources:")).setAttr("style","top: 90px; left: 10px; width: 60px; position: absolute; text-overflow: ellipsis"));g("0005-lbl",(new DOMLabel("Source:")).setAttr("style","bottom: 69px; left: 10px; width: 50px; position: absolute; text-overflow: ellipsis"));g("0006-lbl",(new DOMLabel("Tip: You might even specify a YouTube url")).setAttr("style","bottom: 48px; left: 60px; width: auto; right: 10px; position: absolute; text-overflow: ellipsis"));a.insert(i("0001-lbl"));a.insert(i("0002-lbl"));
a.insert(i("0003-lbl"));a.insert(i("0004-lbl"));a.insert(i("0001-grid"));a.insert(i("0001-btn"));a.insert(i("0002-btn"));a.insert(i("0005-lbl"));a.insert(i("0001-text"));a.insert(i("0006-lbl"));a.insert(i("0002-text"));a.insert(i("0003-btn"));a.insert(i("0001-check"));a.insert(i("0002-check"));CSSNodeEditor_init_video_tab_cmd_select_poster(c,h)}
function CSSNodeEditor_init_web_tab(c,a,b){a=a.getTabById("web").getSheet();a.style.overflow="hidden";var f={},g=function(a,b){return f[a]=b},i=function(a){var b;if(!(b=f[a]))throw"Namespace "+a+" is not defined (yet?)";return b},h=c.nodeAttributes;if(b.id){g("0001-lbl",(new DOMLabel("Id:")).setAttr("style","top: 10px; left: 10px; width: 65px; position: absolute; text-overflow: ellipsis"));g("0001-text",(new TextBox(h.id)).setAttr("style","top: 5px; left: 90px; position: absolute; margin: 0; width: auto; right: 10px"));
a.insertTop(i("0001-lbl"),10);var j=a.insertTop(i("0001-text"),-5,20);i("0001-text").addCustomEventListener("change",function(){h.id=this.value;return true})}if(b["class"]){g("0002-lbl",(new DOMLabel("Class:")).setAttr("style","top: 40px; left: 10px; width: 50px; position: absolute; text-overflow: ellipsis"));var k=g("0002-text",(new TextBox(h["class"])).setAttr("style","top: 35px; left: 90px; position: absolute; width: auto; right: 10px; margin: 0;").chain(function(){this.addCustomEventListener("change",
function(){h["class"]=this.value})}));a.insertTop(i("0002-lbl"),10);a.insertTop(i("0002-text"),-5,20)}if(b.title){g("0003-lbl",(new DOMLabel("Title:")).setAttr("style","top: 70px; left: 10px; width: 70px; position: absolute; text-overflow: ellipsis"));g("0003-text",(new TextBox(h.title)).setAttr("style","top: 65px; left: 90px; position: absolute; margin: 0; width: auto; right: 10px"));a.insertTop(i("0003-lbl"),10);var l=a.insertTop(i("0003-text"),-5,20);i("0003-text").addCustomEventListener("change",
function(){h.title=this.value})}c.addCustomEventListener("attribute-changed",function(a){if(a.which=="id"&&b.id)j.value=a.value;else if(a.which=="class"&&b["class"])k.value=a.value;else if(a.which=="title"&&b.title)l.value=a.value;return true})}window.CSSDefs=window.CSSDefs||{};
function CSSSourceInput(c,a){return $("div","CSSSourceInput").chain(function(){(function(b){return b.appendChild($("div","inner")).chain(function(){a=a||{};a.urlFormat=typeof a.urlFormat=="undefined"?false:!!a.urlFormat;a.allowInput=typeof a.allowInput=="undefined"?true:!!a.allowInput;a.allowUpload=typeof a.allowUpload=="undefined"?false:!!a.allowUpload;a.allowEmbed=typeof a.allowEmbed=="undefined"?false:!!a.allowEmbed;if(a.allowUpload&&typeof a.uploadCallback!="function")throw"CSSSourceInput initialization failure: No uploadCallback was specified, or the callback is not a closure!";
if(a.allowBrowse&&typeof a.browseCallback!="function")throw"CSSSourceInput initialization failure: No browseCallback was specified, or the callback is not a closure!";a.allowEmbed=typeof a.allowEmbed=="undefined"?false:!!a.allowEmbed;var c=a,g;if(typeof a.maxEmbedSize=="undefined")g=32768;else if(isNaN(a.maxEmbedSize))throw"Bad maxEmbedSize value: Allowing only numbers";else if(a.maxEmbedSize<=0)throw"Bad value for maxEmbedSize ( not allowing negative or zero values )!";else g=parseInt(a.maxEmbedSize);
c.maxEmbedSize=g;c=a;if(typeof a.maxUploadSize=="undefined")g=8388608;else if(isNaN(a.maxUploadSize))throw"Bad maxUploadSize value: Allowing only numbers";else if(a.maxUploadSize<=0)throw"Bad value for maxUploadSize ( not allowing negative or zero values )!";else g=parseInt(a.maxUploadSize);c.maxUploadSize=g;c=a;if(typeof a.contentType=="undefined")g=void 0;else if(a.contentType instanceof RegExp)g=a.contentType;else throw"Bad content type option: Expected undefined or regular expression";c.contentType=
g;this.tabIndex=0;var i=this.appendChild((new DropDown(function(){var b=[];b.push({id:"",name:"Specify"});a.allowUpload&&b.push({id:"upload",name:"Upload"});a.allowBrowse&&b.push({id:"browse",name:"Browse"});a.allowEmbed&&b.push({id:"embed",name:"Embed"});return b}())).addClass("method")),h=null,j=this,k=function(){b.removeClass("method-upload").removeClass("method-browse").removeClass("method-embed");i.value&&b.addClass("method-"+i.value);switch(i.value){case "browse":h&&(h.chain(function(){this.removeFromParent();
this.purge()}),h=null);a.browseCallback(b,a.contentType);break;case "upload":h&&(h.chain(function(){this.removeFromParent();this.purge()}),h=null);h=j.appendChild(new DOMFile({destination:"server",dataType:"binary",mime:a.contentType,maxSize:a.maxUploadSize||8388608})).chain(function(){this.addCustomEventListener("change",function(){a.uploadCallback(b,this.serverPath);return true})}).addClass("file");break;case "embed":h&&(h.chain(function(){this.removeFromParent();this.purge()}),h=null),h=j.appendChild(new DOMFile({destination:"memory",
dataType:"base64",maxSize:a.maxEmbedSize,mime:a.contentType})).chain(function(){this.addCustomEventListener("change",function(){b.value=this.value;b.onCustomEvent("change");return true})}).addClass("file")}};i.addEventListener("change",k);var l=this.appendChild(new TextBox("")).addClass("specify");l.addCustomEventListener("change",function(){b.onCustomEvent("change",l.value)});var m="";Object.defineProperty(b,"value",{get:function(){return a.urlFormat?(m=l.value)!=""?'url("'+m+'")':"":m=l.value},
set:function(b){b=(b||"").toString().trim().replace(/^url\((["'])?([\s\S]+?)(["'])?\)$/g,"$2");a.urlFormat&&(b=b.replace(/^none$/i,""));m=l.value=b;i.value="";k()}})})})(this)}).chain(function(){this.value=c||""})}window.CSSDefs=window.CSSDefs||{};
window.CSSDefs.styleAttributeParser=function(c){for(var a=((c||"")+";").toString().trim(),c=[],b="",f="",g="",i=0,h=a.length;i<h;i++)switch(g=a.charAt(i)){case '"':f!="'"&&(f=f==""?'"':"");b+=g;break;case "'":f!='"'&&(f=f==""?"'":"");b+=g;break;case ";":if(f==""){if(b=b.trim())if((b=b.split(":",2)).length==2)g=b[0].trim().replace(/^\-(webkit|moz|o|ms)\-/,"").toLowerCase(),b=b[1].trim().replace(/, /g,","),c.push({selector:g,value:b});b=""}else b+=g;break;default:b+=g}c.sort(function(a,b){return a.selector.length!=
b.selector.length?a.selector.length-b.selector.length:a.selector.strcmp(b.selector)});a={};i=0;for(h=c.length;i<h;i++)a[c[i].selector]=c[i].value;return a};
function VT100Application(c,a,b,f){var g=f||null;return(new VT101).chain(function(){b=b||{};b.pamUser=b.pamUser||"";b.sshUser=b.sshUser||"";b.pamPassword=b.pamPassword||"";b.sshPassword=b.sshPassword||"";b.cwd=b.cwd||"";c=c||"/bin/bash";a=a||[];b.secure=typeof b.secure=="undefined"?window.location.protocol=="https:"?true:false:!!b.secure;var i=b.host||window.location.host+":10000",f=false,j=null;Object.defineProperty(this,"command",{get:function(){return c}});Object.defineProperty(this,"args",{get:function(){return a}});
Object.defineProperty(this,"host",{get:function(){return i}});Object.defineProperty(this,"url",{get:function(){return"ws"+(b.secure?"s":"")+"://"+i+"/"+btoa(c)+"?args="+encodeURIComponent(JSON.stringify(a))+(g?"&remoteHost="+encodeURIComponent(g):"")+(b.cwd?"&cwd="+encodeURIComponent(b.cwd):"")}});this.sendFrame=function(a,b){f&&j.send(JSON.stringify({type:a,data:b}))};this.connect=function(){f||(typeof window.keyRing=="undefined"?DialogBox("The terminal component is depending on\nthe KeyRing service provided by JSPlatform,\nwhich seems to not be started.\n\nPlease start the service first",
{type:"error",childOf:getOwnerWindow(this),caption:"Terminal connecting error"}):this.state!="closed"?console.error("Cannot connect, socket is allready in state: ",this.state):(this.reset(),function(a){if(g){a.receive("authenticating: ");var c=window.keyRing.requestAuth("PAM","Terminal",function(c){a.receive(c.user+"\r\n");a.receive("authenticating (SSH): ");var i=window.keyRing.requestAuth("SSH@"+g,"Terminal",function(b){a.receive(b.user+"\r\n");a.receive("connecting: ");j=new WebSocket(a.url,"terminal");
j.onopen=function(){a.receive("connected via SSH on "+g+"\r\n");f=true;a.sendFrame("connect",{lines:a.lines,cols:a.cols,user:c.user,password:c.password,sshUser:b.user,sshPassword:b.password,sshHost:g})};j.onmessage=function(b){var b=b.data,c;try{c=JSON.parse(b);if(typeof c!="object")throw"FrameData not an object!";a.onCustomEvent("hostPacket",c)}catch(i){console.error("Could not parse frame: ",b,"\nReason: ",i)}};j.onerror=function(b){console.log("Error");a.onCustomEvent("connectionError",b);a.receive("connection error!\r\n")};
j.onclose=function(){a.onCustomEvent("disconnect","socket is closing")}},function(){a.onCustomEvent("auth-canceled");a.receive("Auth canceled by user, aborting...\r\n")},!!b.forceRunAs,b.sshUser,b.sshPassword);if(i instanceof Node)i.childOf=getOwnerWindow(a),i.x=30,i.y=50},function(){a.onCustomEvent("auth-canceled");a.receive("Auth canceled by user, aborting...\r\n")},!!b.forceRunAs,b.pamUser,b.pamPassword);if(c instanceof Node)c.childOf=getOwnerWindow(a),c.x=30,c.y=80}else if(a.receive("authenticating: "),
c=window.keyRing.requestAuth("PAM","Terminal",function(b){a.receive(b.user+"\r\n");j=new WebSocket(a.url,"terminal");a.receive("connecting: ");j.onopen=function(){a.onCustomEvent("connect");f=true;a.receive("connected\r\n");a.sendFrame("connect",{lines:a.lines,cols:a.cols,user:b.user,password:b.password})};j.onmessage=function(b){var b=b.data,c;try{c=JSON.parse(b);if(typeof c!="object")throw"FrameData not an object!";a.onCustomEvent("hostPacket",c)}catch(i){console.error("Could not parse frame: ",
b,"\nReason: ",i)}};j.onerror=function(b){console.log("Error");a.onCustomEvent("connectionError",b);a.receive("connection error!\r\n")};j.onclose=function(){a.onCustomEvent("disconnect","socket is closing")}},function(){a.onCustomEvent("auth-canceled");a.receive("Authentication canceled by user\r\n")},!!b.forceRunAs,b.pamUser,b.pamPassword),c instanceof Node)c.childOf=getOwnerWindow(a),c.x=30,c.y=50}(this)))};Object.defineProperty(this,"state",{get:function(){if(!j)return"closed";switch(j.readyState){case j.CLOSED:return"closed";
case j.CLOSING:return"closing";case j.CONNECTING:return"connecting";case j.OPEN:return"connected"}}});this.addCustomEventListener("connectionError",function(a){console.error("Socket Error: "+(a||"Unknown reason"));this.disconnect();return true});this.addCustomEventListener("hostPacket",function(a){switch(a.type){case "process":a=a.data||{};switch(a.event){case "output":this.receive(a.data||"");break;case "exit":console.log(a.data),this.disconnect()}break;case "auth":a.data?this.focus():(a.hide||DialogBox("Server disconnected you because could not verify your credentials",
{type:"error",childOf:null,caption:"Authentication failed"}),a.bad&&(keyRing.unvalidate(a.bad),console.log("Keyring: Unvalidate credentials: ",a.bad)),this.connected=false);this.onCustomEvent("auth",!!a.data);break;case "error":DialogBox(a.data,{type:"error",childOf:null,caption:"Error"});break;default:console.log("Unknown server packet type: ",a.type)}});this.disconnect=function(){j&&[j.CONNECTING,j.OPEN].indexOf(j.readyState)>=0&&(j.close(),j=null);this.onCustomEvent("disconnect");f=false;j=null;
this.receive("\r\ndisconnected from terminal server\r\n")};Object.defineProperty(this,"connected",{get:function(){return f},set:function(a){a=!!a;if(a!=f)switch(a){case true:this.connect();break;case false:this.disconnect()}}});this.addCustomEventListener("send",function(a){this.sendFrame("input",a);return true});this.addCustomEventListener("resize",function(){this.sendFrame("resize",{lines:this.lines,cols:this.cols});return true});this.addCustomEventListener("setTitle",function(a){getOwnerWindow(this).caption=
a+(g?" (via SSH on "+g+")":"")});this.addCustomEventListener("destroy",function(){this.connected=false;return true});var k=this;b.autoConnect&&setTimeout(function(){k.connected=true},200)})}
var CRTProto={ATTR_DEFAULT:240,ATTR_REVERSE:256,ATTR_UNDERLINE:512,ATTR_DIM:1024,ATTR_BRIGHT:2048,ATTR_BLINK:4096,colors:null,palette:"linux",palettes:{linux:{fg:"#000000,#aa0000,#00aa00,#aa5500,#0000aa,#aa00aa,#00aaaa,#aaaaaa,#555555,#ff5555,#55ff55,#ffff55,#5555ff,#ff55ff,#55ffff,#ffffff".split(","),bg:"#000000,#aa0000,#00aa00,#aa5500,#0000aa,#aa00aa,#00aaaa,#aaaaaa,#555555,#ff5555,#55ff55,#ffff55,#5555ff,#ff55ff,#55ffff,#ffffff".split(",")},tango:{fg:"#000000,#cc0000,#4e9a06,#c4a000,#3465a4,#75507b,#06989a,#d3d7cf,#555753,#ef2929,#8ae234,#fce94f,#729fcf,#ad7fa8,#34e2e2,#eeeeec".split(","),
bg:"#000000,#cc0000,#4e9a06,#c4a000,#3465a4,#75507b,#06989a,#d3d7cf,#555753,#ef2929,#8ae234,#fce94f,#729fcf,#ad7fa8,#34e2e2,#eeeeec".split(",")},xterm:{fg:"#000000,#cd0000,#00cd00,#cdcd00,#1e90ff,#cd00cd,#00cdcd,#e5e5e5,#4c4c4c,#ff0000,#00ff00,#ffff00,#4682b4,#ff00ff,#00ffff,#ffffff".split(","),bg:"#000000,#cd0000,#00cd00,#cdcd00,#1e90ff,#cd00cd,#00cdcd,#e5e5e5,#4c4c4c,#ff0000,#00ff00,#ffff00,#4682b4,#ff00ff,#00ffff,#ffffff".split(",")},rxvt:{fg:"#000000,#cd0000,#00cd00,#cdcd00,#0000cd,#cd00cd,#00cdcd,#faebd7,#404040,#ff0000,#00ff00,#ffff00,#0000ff,#ff00ff,#00ffff,#ffffff".split(","),
bg:"#000000,#cd0000,#00cd00,#cdcd00,#0000cd,#cd00cd,#00cdcd,#faebd7,#404040,#ff0000,#00ff00,#ffff00,#0000ff,#ff00ff,#00ffff,#ffffff".split(",")}},blinkTick:true,cursorTick:true,fontSettings:{},domTester:null,getFontWidthHeight:function(c,a){var b=c.concat("_"+a);return typeof this.fontSettings[b]!="undefined"?this.fontSettings[b]:(this.domTester=this.domTester||document.body.appendChild($("div").setAttr("style","padding: 0; margin: 0; position: absolute; left: -1000px; top: -1000px;").setHTML("\u2588")),
this.domTester.style.fontFamily=c,this.domTester.style.fontSize=a,this.fontSettings[b]={width:this.domTester.offsetWidth,height:this.domTester.offsetHeight})},subscribers:[],numSubscribers:0,paintLoop:function(){if(CRTProto.numSubscribers!=0){webkitRequestAnimationFrame(CRTProto.paintLoop);for(var c=0;c<CRTProto.numSubscribers;c++)CRTProto.subscribers[c].render()}},addSubscriber:function(c){for(var a=0,b=this.nubSubscribers;a<b;a++)if(subscribers[a]==c)return;this.subscribers.push(c);this.numSubscribers++;
this.numSubscribers==1&&this.paintLoop()},removeSubscriber:function(c){for(var a=0,b=this.numSubscribers;a<b;a++)c==this.subscribers[a]&&(this.subscribers.splice(a,1),this.numSubscribers--)},setPalette:function(c){if(typeof this.palettes[c]!="undefined"){this.colors=this.palettes[this.palette=c];for(var c=0,a=this.subscribers.length;c<a;c++)this.subscribers[c].changed=true}else throw"Unknown palette name: "+c;}};
addOnload(function request(){if(window.userStorage){var a=userStorage.getItem("VT101",{palette:"linux"});CRTProto.setPalette(a.palette)}else setTimeout(request,1E3)});setInterval(function(){CRTProto.blinkTick=!CRTProto.blinkTick;for(var c=0,a=CRTProto.subscribers.length;c<a;c++)CRTProto.subscribers[c].changed=true},800);
setInterval(function(){CRTProto.cursorTick=!CRTProto.cursorTick;for(var c=0,a=CRTProto.subscribers.length;c<a;c++)CRTProto.subscribers[c].blinkingCursor&&CRTProto.subscribers[c].renderCursor()},300);function CRT_Rom(c){this.fb=c;this._attr=240;this._chr="";this._selected=false}Object.defineProperty(CRT_Rom.prototype,"attr",{get:function(){return this._attr},set:function(c){this._attr=c;this.fb.changed=true}});
Object.defineProperty(CRT_Rom.prototype,"chr",{get:function(){return this._chr},set:function(c){this._chr=c;this.fb.changed=true}});
function CRT_FrameBuffer(){return $("div","DOMTerm").chain(function(){var c=[[],[]],a=0,b=0,f=0,g=false,i=true,h=false,j="monospace",k="14px",l=0,m=0,o=0,n=0,q=0,p=0,r=this.appendChild($("canvas")),t=r.getContext("2d"),w=false,u=240,x=false,B={},A=0,z=0,C=0,D=0,s=0,F=false;Object.defineProperty(this,"selection",{get:function(){return B}});Object.defineProperty(B,"length",{get:function(){return A}});var G=throttle(function(){for(var b=false,i=0;i<o;i++)for(var f=0;f<n;f++)f==z&&i==C&&(b=true),f==D&&
i==s&&(b=false),c[a][i][f]._selected=b;w=true},10);Object.defineProperty(B,"start",{get:function(){return{x:z,y:C}},set:function(a){if(a&&typeof a.x=="number"&&typeof a.y=="number")z=a.x<0?0:a.x>=n?Math.max(n-1,0):a.x,C=a.y<0?0:a.y>=o?Math.max(o-1,0):a.y;else throw"Invalid selection start object. Expected { x: ..., y: ... }!";z=Math.min(z,D);C=Math.min(C,s);D=Math.max(z,D);s=Math.max(C,s);A=D-z+(s-C)*n;G.run()}});Object.defineProperty(B,"stop",{get:function(){return{x:D,y:s}},set:function(a){if(a&&
typeof a.x=="number"&&typeof a.y=="number")D=a.x<0?0:a.x>=n?Math.max(n-1,0):a.x,s=a.y<0?0:a.y>=o?Math.max(o-1,0):a.y;else throw"Invalid selection start object. Expected { x: ..., y: ... }!";z=Math.min(z,D);C=Math.min(C,s);D=Math.max(z,D);s=Math.max(C,s);A=D-z+(s-C)*n;G.run()}});B.getText=function(b){for(var b=!!b,i=[],f="",h=false,g,j=C;j<=s;j++)for(var k=0;k<n;k++)k==z&&j==C&&(h=true),k==D&&j==s&&(h=false),k==0&&j>C&&h&&(i.push(f),f=""),h&&(f+=(g=(c[a][j][k]._chr||" ").charCodeAt(0))<32?" ":String.fromCharCode(g));
i.push(f);i=i.join("\n");b||(i=i.replace(/[\s]+\n/g,"\n"));return i};(function(a){a.addEventListener("mousedown",function(b){if(b.which==1)b.shiftKey?F=!!(a.selection.start=a.selection.stop={x:b.layerX/l<<0,y:b.layerY/m<<0}):a.selection.start=a.selection.stop={x:0,y:0};else if(b.which==2)a.onCustomEvent("paste")});a.addEventListener("mousemove",function(b){if(F)a.selection.stop={x:b.layerX/l<<0,y:b.layerY/m<<0}});a.addEventListener("mouseup",function(b){if(F)a.selection.stop={x:b.layerX/l<<0,y:b.layerY/
m<<0},a.onCustomEvent("clipboardData",a.selection.getText()),F=false})})(this);var L=function(a){return throttle(function(){a.onCustomEvent("resize")},100)}(this);this.malloc=function(a){for(var b=[],c=0;c<a;c++)b.push(new CRT_Rom(this));return b};Object.defineProperty(this,"solidCursor",{get:function(){return h},set:function(a){h=!!a}});Object.defineProperty(this,"lines",{get:function(){return o},set:function(a){if(a!=o){if(o<a)for(var b=0,i=c.length;b<i;b++)for(var h=o;h<a;h++)c[b].push(this.malloc(n));
else if(o>a)for(;o--!=a;){b=0;for(i=c.length;b<i;b++)c[b].splice(0,1)}o=a;f>=o&&(f=o-1);f<0&&(f=0);this.selection.start=this.selection.start;this.selection.stop=this.selection.stop;w=true;L.run()}}});Object.defineProperty(this,"cols",{get:function(){return n},set:function(a){if(a!=n){if(a>n)for(var i=0;i<o;i++)for(var f=0,h=c.length;f<h;f++)Array.prototype.splice.apply(c[f][i],[n,0].merge(this.malloc(a-n)));else if(a<n)for(i=0;i<o;i++){f=0;for(h=c.length;f<h;f++)Array.prototype.splice.apply(c[f][i],
[a,n-a])}n=a;b>=n&&(b=n-1);b<0&&(b=0);this.selection.start=this.selection.start;this.selection.stop=this.selection.stop;w=true;L.run()}}});Object.defineProperty(this,"mem",{get:function(){return c[a]}});Object.defineProperty(this,"activePage",{get:function(){return a},set:function(b){if(b>=0&&b<c.length)a=b,this.selection.start=this.selection.stop={x:0,y:0},G.run(),w=true,this.render();else throw"Failed to set framebuffer rom page #"+b;}});Object.defineProperty(this,"cursorX",{get:function(){return b},
set:function(a){a!=b&&(b=a<0?0:a>=n?n-1:a)}});Object.defineProperty(this,"cursorY",{get:function(){return f},set:function(a){a!=f&&(f=a<0?0:a>=o?o-1:a)}});Object.defineProperty(this,"cursorNeedsShowing",{get:function(){return i},set:function(a){i!=!!a&&(i=!!a,w=true)}});Object.defineProperty(this,"isInverted",{get:function(){return x},set:function(a){x!=!!a&&(x=!!a,w=true)}});Object.defineProperty(this,"blinkingCursor",{get:function(){return g},set:function(a){g!=!!a&&(g=!!a,w=true)}});Object.defineProperty(this,
"attr",{get:function(){return u},set:function(a){u=a}});Object.defineProperty(this,"changed",{get:function(){return w},set:function(){w=true}});this.render=function(){if(w){w=false;var b,i,f,h,g,u=["normal "+k+' "'+j+'"',"bold "+k+' "'+j+'"'],q,p;t.textAlign="left";t.textBaseline="bottom";for(var r=0;r<o;r++)for(var B=0;B<n;B++){b=c[a][r][B];f=b._attr;p=b._chr;q=b._selected;b=f&512;h=f>>4&15;g=f&15;h==15&&(h=0,g==0&&(g=15));f&256&&(i=h,h=g,g=i);if(x&&!q||q&&!x)i=h,h=g,g=i;i=0;(f&1280)==1024?g=8:f&
2048&&(g|=8,i=1);f=f&4096?1:0;t.fillStyle=CRTProto.colors.bg[h];t.fillRect(h=B*l,q=r*m,l,m);if(f&&CRTProto.blinkTick||!f)t.font=u[i],t.fillStyle=CRTProto.colors.fg[g],t.fillText(p,h,q+m),b&&t.fillRect(h,q+m-3,l,2)}this.renderCursor()}};this.renderCursor=function(){if(i&&c[a].length){var o,n,u,q,w,p=["normal "+k+' "'+j+'"',"bold "+k+' "'+j+'"'],r,B;q=c[a][f][b];o=q._attr;n=q._chr;r=q._selected;B=o&512;u=o>>4&15;q=o&15;u==15&&(u=0,q==0&&(q=15));o&256&&(w=u,u=q,q=w);if(x&&!r||r&&!x)w=u,u=q,q=w;w=0;(o&
1280)==1024?q=8:o&2048&&(q|=8,w=1);o=o&4096?1:0;if(!g||g&&CRTProto.cursorTick){if(h?(t.fillStyle=CRTProto.colors.fg[q],t.fillRect(b*l+1,f*m+1,l-1,m-1)):(t.fillStyle=CRTProto.colors.fg[q],t.fillRect(b*l,f*m,l,m),t.fillStyle=CRTProto.colors.bg[u],t.fillRect(b*l+1,f*m+1,l-2,m-2)),o&&CRTProto.blinkTick||!o)t.fillStyle=h?CRTProto.colors.bg[u]:CRTProto.colors.fg[q],t.font=p[w],t.fillText(n,u=b*l,(r=f*m)+m),B&&t.fillRect(u,r+m-3,l,2)}else if(t.fillStyle=CRTProto.colors.bg[u],t.fillRect(u=b*l,r=f*m,l,m),
o&&CRTProto.blinkTick||!o)t.fillStyle=CRTProto.colors.fg[q],t.font=p[w],t.fillText(n,u,r+m),B&&t.fillRect(u,r+m-3,l,2)}};Object.defineProperty(this,"width",{get:function(){return q},set:function(a){a=a<0?0:a;if(a!=q||w)q=a,r.width=q,this.cols=q/l>>0,w=true}});Object.defineProperty(this,"height",{get:function(){return p},set:function(a){a=a<0?0:a;if(a!=p||w)p=a,r.height=p,this.lines=p/m>>0,w=true}});this.setFont=function(a,b){k=a;j=b;var c=CRTProto.getFontWidthHeight(b,a);l=c.width;m=c.height;w=true};
this.setLinesCols=function(a,b){this.lines=a;this.cols=b};var I={_dummy:function(){(function(a){setTimeout(function(){a.width=a.offsetWidth;a.height=a.offsetHeight},1)})(this)}};Object.defineProperty(this,"DOManchors",{get:function(){return I},set:function(a){for(var b in I)b!="_dummy"&&I.propertyIsEnumerable(b)&&delete I[b];a=a||{};for(b in a)b!="_dummy"&&a.propertyIsEnumerable(b)&&(I[b]=a[b])}});this.setFont(k,j);Object.defineProperty(this,"charWidth",{get:function(){return l},set:function(a){if(!(a<
4||a==l))l=a,w=true,this.width=this.width}});Object.defineProperty(this,"charHeight",{get:function(){return m},set:function(a){if(!(a<4||a==m))m=a,w=true,this.height=this.height}});Object.defineProperty(this,"font",{get:function(){return k+" "+j},set:function(a){if(!(a=/^([\d]+px) (.*)$/.exec(a)))throw"Invalid font, format is: <n>px fontFace";this.setFont(a[1],a[2]);this.width=this.width;this.height=this.height;this.paint();w=true}});this.destroy=function(){this.onCustomEvent("destroy");CRTProto.removeSubscriber(this);
this.purge()};CRTProto.addSubscriber(this)})}
function VT101Preferences(c){var a={},b=function(b,c){return a[b]=c},f=function(b){var c;if(!(c=a[b]))throw"Namespace "+b+" is not defined (yet?)";return c},g=getUID(),i=b("0001-dlg",(new Dialog({alwaysOnTop:false,appIcon:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH1QoSFSUbRvzYGQAAAilJREFUOMt9k89LVFEUxz93fDMqZEGG0cLAEgpXrly1qEXLNu2C0mqRuggXQWCtgja1DkqwRWKC/gG1LSUIwqI0UCOdsRgrHX2Ome/dX6fFG2dGLQ8c7r3ccz/3ew7nqKHngweNsf3W2u44jhuMMVTcYmz1OXFn3XoUx4+11g8CpdT9o03Hek62tKYztXWAgPBP896xXiySX8o3jk+8vp1bzKYD4PqJltb0la5Opj9Ns5+JJOTTbafo7enN5BazPYGI1CmV4svcHKMvH+HFISJ4cXjvEUnceUHE4b2j80I/qZRCRA4FFXnC1MdZwOG9lEDJ422QF8F5C4B1yVoF8DQ2NSTB3uOxeO/wJUBstgjXlwk3CwA453YCRISpDzP09d7l2cgTlgt5BME5SyH8SRRtJoFKJR/uAXihviHDqzcvuNHVR2FtmcGRh6wVfkGNpf5AbQlAKYVdAC+e2el5Vn/8oaP9HJmglveTnxHvy49Qle2eFBAgcNzsvsXw2ABvJycI0gqoKSlXOxS43UUE+Dr7jUtXL4IIKHg3PlO+0zrmzPn28tk5v6sGgPMuqZFKAdBxtq1KukKlUvsoECiubv2/Davy31EDpZQGqW8+3szCwkK5XfezxiOHieIIpdTvANRwNjd/bWxsNNjYKBKGIWG4RhRFGGuw1mK3J9FarDVoo1lZKWjgaSDi7+SXvpPNzV82xmS01pVRNqYM2R5lrTVGm9hYOyQi9/4C16KCF5hN9R0AAAAASUVORK5CYII=",caption:"VT100 Terminal Preferences",
closeable:true,height:387,maximizeable:true,maximized:false,minHeight:387,minWidth:391,minimizeable:false,modal:false,moveable:true,resizeable:false,scrollable:false,visible:true,width:391,childOf:getOwnerWindow(c)})).chain(function(){Object.defineProperty(this,"pid",{get:function(){return g}});this.addClass("PID-"+g)}));console.log(c.font);var h=CRTProto.palette,j=b("0001-properties",(new PropertyGrid([{name:"fonts",label:"Fonts",items:[{name:"fontFace",type:"dropdown",label:"Font Face",value:/^[\d]+px (.*)$/.exec(c.font)[1],
values:[{id:"monospace",name:"Monospace"},{id:"courier new",name:"Courier New"},{id:"ubuntu mono",name:"Ubuntu Mono"}]},{name:"fontSize",type:"int",label:"Font Size",value:/^([\d]+)px/.exec(c.font)[1],min:10,max:18},{name:"charWidth",type:"int",label:"Font Width",value:c.charWidth||6,min:6,max:20},{name:"charHeight",type:"int",label:"Font Height",value:c.charHeight||6,min:6,max:20}]},{name:"colors",label:"Colors",items:[{name:"palette",type:"dropdown",label:"Palette",value:CRTProto.palette||"linux",
values:[{id:"linux",name:"Linux"},{id:"tango",name:"Tango"},{id:"xterm",name:"XTerm"},{id:"rxvt",name:"Rxvt"}]}]},{name:"compat",label:"Compatibility",items:[{name:"bs",type:"dropdown",label:"Backspace key",value:"",values:[{id:"",name:"Auto"},{id:"ctrlh",name:"Control H"},{id:"del",name:"Ascii DEL"},{id:"escape",name:"Escape Sequence"},{id:"ttyerase",name:"TTY Erase"}]},{name:"del",type:"dropdown",label:"Delete Key",value:"",values:[{id:"",name:"Auto"},{id:"ctrlh",name:"Control H"},{id:"del",name:"Ascii DEL"},
{id:"escape",name:"Escape Sequence"},{id:"ttyerase",name:"TTY Erase"}]}]}])).chain(function(){this.hasToolbar=false;this.splitPosition=140}).setAttr("style","top: 10px; left: 10px; position: absolute").setAnchors({width:function(a){return a-20+"px"},height:function(a,b){return b-145+"px"}})),k=function(){c.font=l.font;c.charWidth=l.charWidth;c.charHeight=l.charHeight;var a=userStorage.getItem("VT101",{});a.font=l.font;a.charWidth=l.charWidth;a.charHeight=l.charHeight;a.palette=j.values.colors.palette;
userStorage.setItem("VT101",a)};b("0001-btn",(new Button("Ok",function(){k();i.close()})).setAttr("style","bottom: 10px; left: 10px; position: absolute"));b("0003-btn",(new Button("Apply",function(){k()})).setAttr("style","bottom: 10px; left: 50px; position: absolute"));b("0002-btn",(new Button("Cancel",function(){CRTProto.setPalette(h);i.close();i.purge()})).setAttr("style","bottom: 10px; right: 10px; position: absolute"));var b=b("0001-holder",(new DOMPlaceable({caption:"Preview",appearence:"groove"})).setAttr("style",
"top: 255px; left: 10px; right: 10px; position: absolute; height: 60px")),l=window.frameBuffer=b.insert((new VT101).setAnchors({width:function(a){return a-4+"px"},height:function(a,b){return b-4+"px"}}));l.addContextMenu(function(){return[]});l.cursorNeedsShowing=false;l.update=throttle(function(){l.font=j.values.fonts.fontSize+"px "+j.values.fonts.fontFace;l.charWidth=j.values.fonts.charWidth;l.charHeight=j.values.fonts.charHeight;l.reset();setTimeout(function(){l.receive("The quick brown fox jumps Over the lazy dog 0123456789".substr(0,
l.cols)+"\r\nColors: ");for(var a=0;a<16;a++)l.attr=l.attr&-241|a<<4,l.receive(" ");l.cursorNeedsShowing=false},55)},100);j.inputs.fonts.fontFace.onchange=function(){j.values.fonts.charWidth=CRTProto.getFontWidthHeight(j.values.fonts.fontFace,j.values.fonts.fontSize+"px").width;j.values.fonts.charHeight=CRTProto.getFontWidthHeight(j.values.fonts.fontFace,j.values.fonts.fontSize+"px").height;l.update.run()};j.inputs.fonts.fontSize.addCustomEventListener("change",function(){j.values.fonts.charWidth=
CRTProto.getFontWidthHeight(j.values.fonts.fontFace,j.values.fonts.fontSize+"px").width;j.values.fonts.charHeight=CRTProto.getFontWidthHeight(j.values.fonts.fontFace,j.values.fonts.fontSize+"px").height;l.update.run()});j.inputs.fonts.charWidth.addCustomEventListener("change",function(){l.update.run()});j.inputs.fonts.charHeight.addCustomEventListener("change",function(){l.update.run()});j.inputs.colors.palette.addCustomEventListener("change",function(){CRTProto.setPalette(j.values.colors.palette)});
f("0001-dlg").insert(f("0001-properties"));f("0001-dlg").insert(f("0001-btn"));f("0001-dlg").insert(f("0002-btn"));f("0001-dlg").insert(f("0003-btn"));f("0001-dlg").insert(f("0001-holder"));i.paint();l.update.run();i.closeCallback=function(){l.destroy();return true};return i}
var ESC="\u001b",TermProto={ESnormal:0,ESesc:1,ESsquare:2,ESgetpars:3,ESgotpars:4,ESdeviceattr:5,ESfunckey:6,EShash:7,ESsetG0:8,ESsetG1:9,ESsetG2:10,ESsetG3:11,ESbang:12,ESpercent:13,ESignore:14,ESnonstd:15,ESpalette:16,EStitle:17,ESss2:18,ESss3:19,MOUSE_DOWN:0,MOUSE_UP:1,MOUSE_CLICK:2,KeyMappings:{f1:(ESC+"OP").toHex(),"shift f1":(ESC+"OP").toHex(),f2:(ESC+"OQ").toHex(),"shift f2":(ESC+"OQ").toHex(),f3:(ESC+"OR").toHex(),"shift f3":(ESC+"OR").toHex(),f4:(ESC+"OS").toHex(),"shift f4":(ESC+"OS").toHex(),
f5:(ESC+"[15~").toHex(),f6:(ESC+"[17~").toHex(),"shift f6":(ESC+"[17~").toHex(),f7:(ESC+"[18~").toHex(),f8:(ESC+"[19~").toHex(),f9:(ESC+"[20~").toHex(),f10:(ESC+"[21~").toHex(),f11:(ESC+"[23~").toHex(),f12:(ESC+"[24~").toHex(),"ctrl f1":(ESC+"O4P").toHex(),"ctrl f2":(ESC+"O4Q").toHex(),"ctrl f3":(ESC+"O4R").toHex(),"ctrl f4":(ESC+"O4S").toHex(),"ctrl f5":(ESC+"[15;4~").toHex(),"ctrl f6":(ESC+"[17;4~").toHex(),"ctrl f7":(ESC+"[18;4~").toHex(),"ctrl f8":(ESC+"[19;4~").toHex(),"ctrl f9":(ESC+"[20;4~").toHex(),
"ctrl f10":(ESC+"[21;4~").toHex(),"ctrl f11":(ESC+"[23;4~").toHex(),"ctrl f12":(ESC+"[24;4~").toHex(),"ctrl 1":"11","ctrl 2":"12","ctrl 3":"1b","ctrl 4":"1c","ctrl 5":"1d","ctrl 6":"1e","ctrl 7":"1f","ctrl 8":"7f","ctrl 9":"19","ctrl 0":"10","ctrl -":"0D","ctrl =":"1D","ctrl q":"11","ctrl w":null,"ctrl e":"05","ctrl r":"12","ctrl t":null,"ctrl y":"19","ctrl u":"15","ctrl i":"09","ctrl o":"0F","ctrl p":"10","ctrl [":null,"ctrl ]":null,"ctrl \\":"1C","ctrl a":"01","ctrl s":"13","ctrl d":"04","ctrl f":"06",
"ctrl g":"07","ctrl h":"08","ctrl j":"0A","ctrl k":"0B","ctrl l":"0C","ctrl ;":"1B","ctrl '":"07","ctrl z":"1A","ctrl x":"18","ctrl c":"03","ctrl v":"16","ctrl b":"02","ctrl n":null,"ctrl m":"0D","ctrl ,":"0C","ctrl .":"0E","ctrl /":"0F","alt 1":(ESC+"1").toHex(),"alt 2":(ESC+"2").toHex(),"alt 3":(ESC+"3").toHex(),"alt 4":(ESC+"4").toHex(),"alt 5":(ESC+"5").toHex(),"alt 6":(ESC+"6").toHex(),"alt 7":(ESC+"7").toHex(),"alt 8":(ESC+"8").toHex(),"alt 9":(ESC+"9").toHex(),"alt 0":(ESC+"0").toHex(),"alt -":(ESC+
"-").toHex(),"alt =":(ESC+"=").toHex(),"alt q":(ESC+"q").toHex(),"alt w":(ESC+"w").toHex(),"alt e":(ESC+"e").toHex(),"alt r":(ESC+"r").toHex(),"alt t":(ESC+"t").toHex(),"alt y":(ESC+"y").toHex(),"alt u":(ESC+"u").toHex(),"alt i":(ESC+"i").toHex(),"alt o":(ESC+"o").toHex(),"alt p":(ESC+"p").toHex(),"alt \\":(ESC+"\\").toHex(),"alt a":(ESC+"a").toHex(),"alt s":(ESC+"s").toHex(),"alt d":(ESC+"d").toHex(),"alt f":(ESC+"f").toHex(),"alt g":(ESC+"g").toHex(),"alt h":(ESC+"h").toHex(),"alt j":(ESC+"j").toHex(),
"alt k":(ESC+"k").toHex(),"alt l":(ESC+"l").toHex(),"alt ;":(ESC+";").toHex(),"alt '":(ESC+"'").toHex(),"alt z":(ESC+"z").toHex(),"alt x":(ESC+"x").toHex(),"alt c":(ESC+"c").toHex(),"alt v":(ESC+"v").toHex(),"alt b":(ESC+"b").toHex(),"alt n":(ESC+"n").toHex(),"alt m":(ESC+"m").toHex(),"alt ,":(ESC+",").toHex(),"alt .":(ESC+".").toHex(),"alt /":(ESC+"/").toHex(),"ctrl alt 1":"1B11","ctrl alt 3":"1B1B","ctrl alt 4":"1B1C","ctrl alt 5":"1B1D","ctrl alt 6":"1B1E","ctrl alt 7":"1B1F","ctrl alt 8":"1B7F",
"ctrl alt 9":"1B19","ctrl alt 0":"1B10","ctrl alt -":"1B0D","ctrl alt =":"1B1D","ctrl alt e":"1B05","ctrl alt r":"1B12","ctrl alt y":"1B19","ctrl alt u":"1B15","ctrl alt i":"1B09","ctrl alt o":"1B0F","ctrl alt p":"1B10","ctrl alt \\":"5C","ctrl alt a":"1B01","ctrl alt f":"1B06","ctrl alt g":"1B07","ctrl alt h":"1B08","ctrl alt j":"1B0A","ctrl alt k":"1B0B","ctrl alt ;":"1B1B","ctrl alt '":"1B07","ctrl alt z":"1B1A","ctrl alt x":"1B18","ctrl alt c":"1B03","ctrl alt v":"1B16","ctrl alt b":"1B02","ctrl alt n":"1B0E",
"ctrl alt m":"1B0D","ctrl alt ,":"1B0C","ctrl alt .":"1B0E","ctrl alt /":"1B0D",enter:"0D","ctrl enter":"0D","shift enter":"0D","alt enter":"1B0D","ctrl alt enter":"1B0D","ctrl alt shift enter":"0D",tab:"09","shift tab":"09","ctrl alt shift tab":"09",backspace:"7F","ctrl backspace":"08","alt backspace":"1B7F","ctrl alt backspace":"1B7F","shift backspace":"7F","ctrl alt shift backspace":"7F","ctrl shift backspace":"7F","alt shift backspace":"1B7F",home:"1B4F48","alt home":"1B4F3248","shift home":"1B4F3148",
"ctrl alt home":"1B4F3648","ctrl home":"1B4F3448","delete":"1B5B337E","ctrl delete":"1B5B333B347E",end:"1B4F46","ctrl end":"1B4F3446","ctrl alt end":"1B4F3646","alt end":"1B4F3246",page_up:(ESC+"[5~").toHex(),"ctrl alt page_up":"1B5B353B367E","alt page_up":"1B3C",page_down:(ESC+"[6~").toHex(),"ctrl alt page_down":"1B5B363B367E","alt page_down":"1B3E",up0:"1B5B41","ctrl up":"1B5B3441","alt up":"1B70",down0:"1B5B42","ctrl down":"1B5B3442","alt down":"1B6E",left0:"1B5B44","ctrl left":"1B5B3444","alt left":"1B62",
right0:"1B5B43","ctrl right":"1B5B3443","alt right":"1B66",up1:"1B4F41",down1:"1B4F42",left1:"1B4F44",right1:"1B4F43",insert:"1B5B327E","ctrl insert":"1B5B323B347E","shift insert":"5F","ctrl alt insert":"1B5B323B367E",space:"20","shift space":"20","ctrl space":"00","ctrl alt space":"1B00",esc:"1B"}};
addOnload(function(){var c="";Object.defineProperty(window,"clipData",{get:function(){return c},set:function(a){c=a+""}});window.addEventListener("paste",function(a){c=a.clipboardData.getData("text/plain")},true)});
function VT101(){return(new CRT_FrameBuffer).chain(function(){var c=null,a="";Object.defineProperty(this,"translate",{get:function(){return c},set:function(a){c=a}});Object.defineProperty(this,"terminalWidth",{get:function(){return this.cols},set:function(){throw"terminal width is read-only";}});Object.defineProperty(this,"terminalHeight",{get:function(){return this.lines},set:function(){throw"terminal height is read-only!";}});Object.defineProperty(this,"currentScreen",{get:function(){return this.activePage},
set:function(a){this.activePage=a}});Object.defineProperty(this,"titleString",{get:function(){return a},set:function(b){a=b;this.onCustomEvent("setTitle",b)}});this.doControl=function(a){if(this.printing)return this.sendControlToPrinter(a),"";var b="";switch(a){case 0:break;case 8:this.bs();break;case 9:this.ht();break;case 10:case 11:case 12:case 132:if(this.lf(),!this.crLfMode)break;case 13:this.cr();break;case 133:this.cr();this.lf();break;case 14:this.useGMap=1;this.translate=this.GMap[1];this.dispCtrl=
true;break;case 15:this.useGMap=0;this.translate=this.GMap[0];this.dispCtrl=false;break;case 24:case 26:this.isEsc=0;break;case 27:this.isEsc=1;break;case 127:break;case 136:this.userTabStop[this.cursorX]=true;break;case 141:this.ri();break;case 142:this.isEsc=18;break;case 143:this.isEsc=19;break;case 154:this.respondID();break;case 155:this.isEsc=2;break;case 7:if(this.isEsc!=17){this.beep();break}default:switch(this.isEsc){case 1:this.isEsc=0;switch(a){case 37:this.isEsc=13;break;case 40:this.isEsc=
8;break;case 45:case 41:this.isEsc=9;break;case 46:case 42:this.isEsc=10;break;case 47:case 43:this.isEsc=11;break;case 35:this.isEsc=7;break;case 55:this.saveCursor();break;case 56:this.restoreCursor();break;case 62:this.applKeyMode=false;break;case 61:this.applKeyMode=true;break;case 68:this.lf();break;case 69:this.cr();this.lf();break;case 77:this.ri();break;case 78:this.isEsc=18;break;case 79:this.isEsc=19;break;case 72:this.userTabStop[this.cursorX]=true;break;case 90:this.respondID();break;
case 91:this.isEsc=2;break;case 93:this.isEsc=15;break;case 99:this.reset();break;case 103:this.flashScreen()}break;case 15:switch(a){case 48:case 49:case 50:this.isEsc=17;this.titleString="";break;case 80:this.npar=0;this.par=[0,0,0,0,0,0,0];this.isEsc=16;break;case 82:this.isEsc=0;break;default:this.isEsc=0}break;case 16:if(a>=48&&a<=57||a>=65&&a<=70||a>=97&&a<=102){if(this.par[this.npar++]=a>57?(a&223)-55:a&15,this.npar==7)this.isEsc=0}else this.isEsc=0;break;case 2:if(this.npar=0,this.par=[0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.isEsc=3,a==91){this.isEsc=6;break}else if(this.isQuestionMark=a==63)break;case 5:case 3:if(a==59){this.npar++;break}else if(a>=48&&a<=57){var c=this.par[this.npar];c==void 0&&(c=0);this.par[this.npar]=10*c+(a&15);break}else if(this.isEsc==5){switch(a){case 99:this.par[0]==0&&this.respondSecondaryDA()}this.isEsc=0;break}else this.isEsc=4;case 4:this.isEsc=0;if(this.isQuestionMark){switch(a){case 104:this.setMode(true);break;case 108:this.setMode(false);break;case 99:this.setCursorAttr(this.par[2],
this.par[1])}this.isQuestionMark=false;break}switch(a){case 33:this.isEsc=12;break;case 62:if(!this.npar)this.isEsc=5;break;case 71:case 96:this.gotoXY(this.par[0]-1,this.cursorY);break;case 65:this.gotoXY(this.cursorX,this.cursorY-(this.par[0]?this.par[0]:1));break;case 66:case 101:this.gotoXY(this.cursorX,this.cursorY+(this.par[0]?this.par[0]:1));break;case 67:case 97:this.gotoXY(this.cursorX+(this.par[0]?this.par[0]:1),this.cursorY);break;case 68:this.gotoXY(this.cursorX-(this.par[0]?this.par[0]:
1),this.cursorY);break;case 69:this.gotoXY(0,this.cursorY+(this.par[0]?this.par[0]:1));break;case 70:this.gotoXY(0,this.cursorY-(this.par[0]?this.par[0]:1));break;case 100:this.gotoXaY(this.cursorX,this.par[0]-1);break;case 72:case 102:this.gotoXaY(this.par[1]-1,this.par[0]-1);break;case 73:this.ht(this.par[0]?this.par[0]:1);break;case 64:this.csiAt(this.par[0]);break;case 105:this.csii(this.par[0]);break;case 74:this.csiJ(this.par[0]);break;case 75:this.csiK(this.par[0]);break;case 76:this.csiL(this.par[0]);
break;case 77:this.csiM(this.par[0]);break;case 109:this.csim();break;case 80:this.csiP(this.par[0]);break;case 88:this.csiX(this.par[0]);break;case 83:this.lf(this.par[0]?this.par[0]:1);break;case 84:this.ri(this.par[0]?this.par[0]:1);break;case 99:this.par[0]||this.respondID();break;case 103:if(this.par[0]==0)this.userTabStop[this.cursorX]=false;else if(this.par[0]==2||this.par[0]==3){this.userTabStop=[];for(a=0;a<this.terminalWidth;a++)this.userTabStop[a]=false}break;case 104:this.setMode(true);
break;case 108:this.setMode(false);break;case 110:switch(this.par[0]){case 5:this.statusReport();break;case 6:this.cursorReport()}break;case 114:a=this.par[0]?this.par[0]:1;c=this.par[1]?this.par[1]:this.terminalHeight;if(a<c&&c<=this.terminalHeight)this.top=a-1,this.bottom=c,this.gotoXaY(0,0);break;case 98:a=this.par[0]?this.par[0]:1;for(a>this.terminalWidth*this.terminalHeight&&(a=this.terminalWidth*this.terminalHeight);a-- >0;)b+=this.lastCharacter;break;case 115:this.saveCursor();break;case 117:this.restoreCursor();
break;case 90:this.rt(this.par[0]?this.par[0]:1);break;case 93:this.settermCommand()}break;case 12:a=="p"&&this.reset();this.isEsc=0;break;case 13:this.isEsc=0;switch(a){case 64:this.utfEnabled=false;break;case 71:case 56:this.utfEnabled=true}break;case 6:this.isEsc=0;break;case 7:this.isEsc=0;break;case 8:case 9:case 10:case 11:c=this.isEsc-8;this.isEsc=0;switch(a){case 48:this.GMap[c]=this.VT100GraphicsMap;break;case 66:case 66:this.GMap[c]=this.Latin1Map;break;case 85:this.GMap[c]=this.CodePage437Map;
break;case 75:this.GMap[c]=this.DirectToFontMap}if(this.useGMap==c)this.translate=this.GMap[c];break;case 17:if(a==7){if(this.titleString&&this.titleString.charAt(0)==";")this.titleString=this.titleString.substr(1),this.titleString!=""&&(this.titleString+=" - "),this.titleString+="Terminal";this.isEsc=0}else this.titleString+=String.fromCharCode(a);break;case 18:case 19:if(a<256)if(a=this.GMap[this.isEsc-18+2][this.toggleMeta?a|128:a],(a&65280)==61440)a&=255;else if(a==65279||a>=8202&&a<=8207){this.isEsc=
0;break}this.lastCharacter=String.fromCharCode(a);b+=this.lastCharacter;this.isEsc=0;break;default:this.isEsc=0}}return b};this.sendControlToPrinter=function(a){try{switch(a){case 9:case 10:case 12:break;case 27:this.isEsc=1;break;default:switch(this.isEsc){case 1:this.isEsc=0;switch(a){case 91:this.isEsc=2}break;case 2:if(this.npar=0,this.par=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.isEsc=3,this.isQuestionMark=a==63)break;case 3:if(a==59){this.npar++;break}else if(a>=48&&a<=57){var b=this.par[this.npar];
b==void 0&&(b=0);this.par[this.npar]=10*b+(a&15);break}else this.isEsc=4;case 4:this.isEsc=0;if(this.isQuestionMark)break;switch(a){case 105:this.csii(this.par[0])}break;default:this.isEsc=0}}}catch(c){}};this.bs=function(){if(this.cursorX>0)this.gotoXY(this.cursorX-1,this.cursorY),this.needWrap=false};this.ht=function(a){a==void 0&&(a=1);for(var b=this.cursorX;a-- >0;)for(;b++<this.terminalWidth;){var c=this.userTabStop[b];if(c!=false)if(c)break;else if(b%8==0)break}b>this.terminalWidth-1&&(b=this.terminalWidth-
1);b!=this.cursorX&&this.gotoXY(b,this.cursorY)};this.lf=function(a){if(a==void 0)a=1;else{if(a>this.terminalHeight)a=this.terminalHeight;a<1&&(a=1)}for(;a-- >0;)this.cursorY==this.bottom-1?this.scrollRegion(0,this.top+1,this.terminalWidth,this.bottom-this.top-1,0,-1,this.attr):this.cursorY<this.terminalHeight-1&&this.gotoXY(this.cursorX,this.cursorY+1)};this.cr=function(){this.gotoXY(0,this.cursorY);this.needWrap=false};this.ri=function(a){if(a==void 0)a=1;else{if(a>this.terminalHeight)a=this.terminalHeight;
a<1&&(a=1)}for(;a-- >0;)this.cursorY==this.top?this.scrollRegion(0,this.top,this.terminalWidth,this.bottom-this.top-1,0,1,this.attr):this.cursorY>0&&this.gotoXY(this.cursorX,this.cursorY-1);this.needWrap=false};this.rt=function(a){a==void 0&&(a=1);for(var b=this.cursorX;a-- >0;)for(;b-- >0;){var c=this.userTabStop[b];if(c!=false)if(c)break;else if(b%8==0)break}b<0&&(b=0);b!=this.cursorX&&this.gotoXY(b,this.cursorY)};this.respondID=function(){this.respondString+="\u001b[?6c"};this.saveCursor=function(){this.savedX[this.currentScreen]=
this.cursorX;this.savedY[this.currentScreen]=this.cursorY;this.savedAttr[this.currentScreen]=this.attr;this.savedUseGMap=this.useGMap;for(var a=0;a<4;a++)this.savedGMap[a]=this.GMap[a];this.savedValid[this.currentScreen]=true};this.reset=function(){this.isEsc=0;this.needWrap=false;this.autoWrapMode=true;this.printing=this.mouseReporting=this.offsetMode=this.crLfMode=this.cursorKeyMode=this.applKeyMode=this.insertMode=this.toggleMeta=this.dispCtrl=false;this.utfEnabled=this.utfPreferred;this.utfChar=
this.utfCount=0;this.attr=240;this.useGMap=0;this.GMap=[this.Latin1Map,this.VT100GraphicsMap,this.CodePage437Map,this.DirectToFontMap];this.translate=this.GMap[this.useGMap];this.top=0;this.bottom=this.terminalHeight;this.lastCharacter=" ";this.userTabStop=[];this.enableAlternateScreen(false);this.gotoXY(0,0);this.showCursor();this.isInverted=false;this.clearRegion(0,0,this.terminalWidth,this.terminalHeight,this.attr)};this.flashScreen=function(){this.isInverted=!this.isInverted;setTimeout(function(a){return function(){a.isInverted=
!a.isInverted}}(this),100)};this.respondSecondaryDA=function(){this.respondString+="\u001b[>0;0;0c"};this.setMode=function(a){for(var b=0;b<=this.npar;b++)if(this.isQuestionMark)switch(this.par[b]){case 1:this.cursorKeyMode=a;break;case 5:this.isInverted=a;break;case 6:this.offsetMode=a;break;case 7:this.autoWrapMode=a;break;case 1E3:case 9:this.mouseReporting=a;break;case 25:(this.cursorNeedsShowing=a)?this.showCursor():this.hideCursor();break;case 1047:case 1049:case 47:this.enableAlternateScreen(a)}else switch(this.par[b]){case 3:this.dispCtrl=
a;break;case 4:this.insertMode=a;break;case 20:this.crLfMode=a}};this.setCursorAttr=function(){};this.showCursor=function(){return this.cursorNeedsShowing?false:this.cursorNeedsShowing=true};this.hideCursor=function(){return this.cursorNeedsShowing?(this.cursorNeedsShowing=false,true):false};this.gotoXY=function(a,b){a>=this.terminalWidth&&(a=this.terminalWidth-1);a<0&&(a=0);var c,h;this.offsetMode?(c=this.top,h=this.bottom):(c=0,h=this.terminalHeight);b>=h&&(b=h-1);b<c&&(b=c);this.cursorX=a;this.cursorY=
b;this.needWrap=false};this.gotoXaY=function(a,b){this.gotoXY(a,this.offsetMode?this.top+b:b)};this.csiAt=function(a){a==0&&(a=1);a>this.terminalWidth-this.cursorX&&(a=this.terminalWidth-this.cursorX);this.scrollRegion(this.cursorX,this.cursorY,this.terminalWidth-this.cursorX-a,1,a,0,this.attr);this.needWrap=false};this.csii=function(a){switch(a){case 4:this.printing=false;break;case 5:this.printing=100}};this.csiJ=function(a){switch(a){case 0:this.clearRegion(this.cursorX,this.cursorY,this.terminalWidth-
this.cursorX,1,this.attr);this.cursorY<this.terminalHeight-2&&this.clearRegion(0,this.cursorY+1,this.terminalWidth,this.terminalHeight-this.cursorY-1,this.attr);break;case 1:this.cursorY>0&&this.clearRegion(0,0,this.terminalWidth,this.cursorY,this.attr);this.clearRegion(0,this.cursorY,this.cursorX+1,1,this.attr);break;case 2:this.clearRegion(0,0,this.terminalWidth,this.terminalHeight,this.attr);break;default:return}this.needWrap=false};this.csiK=function(a){switch(a){case 0:this.clearRegion(this.cursorX,
this.cursorY,this.terminalWidth-this.cursorX,1,this.attr);break;case 1:this.clearRegion(0,this.cursorY,this.cursorX+1,1,this.attr);break;case 2:this.clearRegion(0,this.cursorY,this.terminalWidth,1,this.attr);break;default:return}this.needWrap=false};this.csiL=function(a){if(!(this.cursorY>=this.bottom))a==0&&(a=1),a>this.bottom-this.cursorY&&(a=this.bottom-this.cursorY),this.scrollRegion(0,this.cursorY,this.terminalWidth,this.bottom-this.cursorY-a,0,a,this.attr),this.needWrap=false};this.csiM=function(a){if(!(this.cursorY>=
this.bottom))a==0&&(a=1),a>this.bottom-this.cursorY&&(a=this.bottom-this.cursorY),this.scrollRegion(0,this.cursorY+a,this.terminalWidth,this.bottom-this.cursorY-a,0,-a,this.attr),this.needWrap=false};this.csim=function(){for(var a=0;a<=this.npar;a++)switch(this.par[a]){case 0:this.attr=CRTProto.ATTR_DEFAULT;break;case 1:this.attr=this.attr&CRTProto.ATTR_DIM|CRTProto.ATTR_BRIGHT;break;case 2:this.attr=this.attr&CRTProto.ATTR_BRIGHT|CRTProto.ATTR_DIM;break;case 4:this.attr|=CRTProto.ATTR_UNDERLINE;
break;case 5:this.attr|=CRTProto.ATTR_BLINK;break;case 7:this.attr|=CRTProto.ATTR_REVERSE;break;case 10:this.translate=this.GMap[this.useGMap];this.toggleMeta=this.dispCtrl=false;break;case 11:this.translate=this.CodePage437Map;this.dispCtrl=true;this.toggleMeta=false;break;case 12:this.translate=this.CodePage437Map;this.toggleMeta=this.dispCtrl=true;break;case 21:case 22:this.attr&=~(CRTProto.ATTR_BRIGHT|CRTProto.ATTR_DIM);break;case 24:this.attr&=~CRTProto.ATTR_UNDERLINE;break;case 25:this.attr&=
~CRTProto.ATTR_BLINK;break;case 27:this.attr&=~CRTProto.ATTR_REVERSE;break;case 38:this.attr=this.attr&~(CRTProto.ATTR_DIM|CRTProto.ATTR_BRIGHT|15)|CRTProto.ATTR_UNDERLINE;break;case 39:this.attr&=~(CRTProto.ATTR_DIM|CRTProto.ATTR_BRIGHT|CRTProto.ATTR_UNDERLINE|15);break;case 49:this.attr|=240;break;default:if(this.par[a]>=30&&this.par[a]<=37)this.attr=this.attr&-16|this.par[a]-30;else if(this.par[a]>=40&&this.par[a]<=47)this.attr=this.attr&-241|this.par[a]-40<<4}};this.csiP=function(a){a==0&&(a=
1);a>this.terminalWidth-this.cursorX&&(a=this.terminalWidth-this.cursorX);this.scrollRegion(this.cursorX+a,this.cursorY,this.terminalWidth-this.cursorX-a,1,-a,0,this.attr);needWrap=false};this.csiX=function(a){a==0&&a++;a>this.terminalWidth-this.cursorX&&(a=this.terminalWidth-this.cursorX);this.clearRegion(this.cursorX,this.cursorY,a,1,this.attr);needWrap=false};this.statusReport=function(){this.respondString+="\u001b[0n"};this.cursorReport=function(){this.respondString+="\u001b["+(this.cursorY+(this.offsetMode?
this.top+1:1))+";"+(this.cursorX+1)+"R"};this.saveCursor=function(){this.savedX[this.currentScreen]=this.cursorX;this.savedY[this.currentScreen]=this.cursorY;this.savedAttr[this.currentScreen]=this.attr;this.savedUseGMap=this.useGMap;for(var a=0;a<4;a++)this.savedGMap[a]=this.GMap[a];this.savedValid[this.currentScreen]=true};this.restoreCursor=function(){if(this.savedValid[this.currentScreen]){this.attr=this.savedAttr[this.currentScreen];this.useGMap=this.savedUseGMap;for(var a=0;a<4;a++)this.GMap[a]=
this.savedGMap[a];this.translate=this.GMap[this.useGMap];this.needWrap=false;this.gotoXY(this.savedX[this.currentScreen],this.savedY[this.currentScreen])}};this.settermCommand=function(){};this.scrollRegion=function(a,b,c,h,j,k,l){if(!(j==0&&k==0)){if(a<0)c+=a,a=0;else if(a>=q)return;if(b<0)h+=b,b=0;else if(b>=p)return;if(!(c<=0||h<=0)){var m=a+c-1,o=b+h-1;m>=p&&(m=p-1);o>=q&&(o=q-1);c=m-a+1;h=o-b+1;if(!(c<=0||h<=0)){var n,q=this.cols,p=this.lines,l=typeof l=="undefined"?CRTProto.ATTR_DEFAULT:l;if(Math.abs(j)>=
c||Math.abs(k)>=h){for(p=b;p<=o;p++)for(h=a;h<=m;h++)c=this.mem[p][h],c._attr=l,c._chr="";this.changed=true}else{if(k<0){b+=k;b<0&&(b=0);for(var p=b,r=o+k;p<=r;p++)for(h=a;h<=m;h++)c=this.mem[p][h],n=this.mem[p-k][h],c._attr=n._attr,c._chr=n._chr;p=0;for(k=-k;p<k;p++)for(h=a;h<=m;h++)c=this.mem[o-p][h],c._attr=l,c._chr="";this.changed=true}else if(k>0){o+=k;o>=p&&(o=p);for(p=o;p>=b+k;p--)for(h=a;h<=m;h++)c=this.mem[p][h],n=this.mem[p-k][h],c._attr=n._attr,c._chr=n._chr;for(p=0;p<k;p++)for(h=a;h<=
m;h++)c=this.mem[p+b][h],c._attr=l,c._chr="";this.changed=true}if(j<0){a+=j;a<0&&(a=0);h=a;for(r=m+j;h<=r;h++)for(p=b;p<=o;p++)c=this.mem[p][h],n=this.mem[p][h-j],c._attr=n._attr,c._chr=n._chr;h=0;for(k=-j;h<k;h++)for(p=b;p<=o;p++)c=this.mem[p][m-h],c._attr=l,c._chr="";this.changed=true}else if(j>0){m+=j;m>=q&&(m=q);for(h=m;h>=a+j;h--)for(p=b;p<=o;p++)c=this.mem[p][h],n=this.mem[p][h-j],c._attr=n._attr,c._chr=n._chr;for(h=0;h<j;h++)for(p=b;p<=o;p++)c=this.mem[p][h],c._attr=l,c._chr="";this.changed=
true}}}}}};this.enableAlternateScreen=function(a){(a?1:0)==this.currentScreen?this.render():(a&&this.saveCursor(),this.currentScreen=a?1:0,this.render(),a?(this.gotoXY(0,0),this.clearRegion(0,0,this.terminalWidth,this.terminalHeight)):this.restoreCursor())};this.putString=function(a,b,c,h){if(!h)h=this.attr;if(c.length){for(var j=0,k=c.length;j<k;j++){if(a+j>=this.cols)break;this.mem[b][a+j].chain(function(){this.chr=c.charAt(j);this.attr=h})}this.cursorX=a+c.length}else this.cursorX=a;this.cursorY=
b};this.beep=function(){this.isInverted=true;(function(a){setTimeout(function(){a.isInverted=false},100)})(this)};this.renderString=function(a,b){if(this.printing)this.sendToPrinter(a),b&&this.showCursor();else{if(b)this.cursorNeedsShowing=true;this.putString(this.cursorX,this.cursorY,a,this.attr)}};this.receive=function(a,b){a=b?a.unhex():a;this.onCustomEvent("receive",a);this.cursorNeedsShowing=this.hideCursor();for(var c=this.respondString="",h=0;h<a.length;h++){var j=a.charCodeAt(h);if((j>=32&&
j<=127||j>=160||this.utfEnabled&&j>=128)&&j!=127&&this.isEsc==0){j<256&&(j=this.translate[this.toggleMeta?j|128:j]);if((j&65280)==61440)j&=255;else if(j==65279||j>=8202&&j<=8207)continue;if(!this.printing){if((this.needWrap||this.insertMode)&&c)this.renderString(c),c="";this.needWrap&&(this.cr(),this.lf());this.insertMode&&this.scrollRegion(this.cursorX,this.cursorY,this.terminalWidth-this.cursorX-1,1,1,0,this.attr)}this.lastCharacter=String.fromCharCode(j);c+=this.lastCharacter;if(!this.printing&&
this.cursorX+c.length>=this.terminalWidth)this.needWrap=this.autoWrapMode}else c&&(this.renderString(c),c=""),j=this.doControl(j),j.length&&(this.respondString+=this.vt100(j))}c?this.renderString(c,this.cursorNeedsShowing):this.cursorNeedsShowing&&this.showCursor();this.respondString&&this.send(this.respondString);return this.respondString};this.send=function(a,b){this.onCustomEvent("send",b?a:a.toHex())};this.clearRegion=function(a,b,c,h,j){c<0||h<0||this.mem.createRange(b,h).each(function(b){b.createRange(a,
c).each(function(a){a._chr=" ";a._attr=j})})};this.Latin1Map=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,
138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255];this.VT100GraphicsMap=[0,1,2,
3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,8594,8592,8593,8595,47,9608,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,160,9670,9618,9225,9228,9229,9226,176,177,9617,9227,9496,9488,9484,9492,9532,63488,63489,9472,63491,63492,9500,9508,9524,9516,9474,8804,8805,960,8800,163,183,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,
143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255];this.CodePage437Map=[0,9786,9787,9829,9830,9827,
9824,8226,9688,9675,9689,9794,9792,9834,9835,9788,9654,9664,8597,8252,182,167,9644,8616,8593,8595,8594,8592,8735,8596,9650,9660,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,8962,199,252,233,226,228,224,229,231,234,235,232,239,238,236,
196,197,201,230,198,244,246,242,251,249,255,214,220,162,163,165,8359,402,225,237,243,250,241,209,170,186,191,8976,172,189,188,161,171,187,9617,9618,9619,9474,9508,9569,9570,9558,9557,9571,9553,9559,9565,9564,9563,9488,9492,9524,9516,9500,9472,9532,9566,9567,9562,9556,9577,9574,9568,9552,9580,9575,9576,9572,9573,9561,9560,9554,9555,9579,9578,9496,9484,9608,9604,9612,9616,9600,945,223,915,960,931,963,181,964,934,920,937,948,8734,966,949,8745,8801,177,8805,8804,8992,8993,247,8776,176,8729,183,8730,8319,
178,9632,160];this.DirectToFontMap=[61440,61441,61442,61443,61444,61445,61446,61447,61448,61449,61450,61451,61452,61453,61454,61455,61456,61457,61458,61459,61460,61461,61462,61463,61464,61465,61466,61467,61468,61469,61470,61471,61472,61473,61474,61475,61476,61477,61478,61479,61480,61481,61482,61483,61484,61485,61486,61487,61488,61489,61490,61491,61492,61493,61494,61495,61496,61497,61498,61499,61500,61501,61502,61503,61504,61505,61506,61507,61508,61509,61510,61511,61512,61513,61514,61515,61516,61517,
61518,61519,61520,61521,61522,61523,61524,61525,61526,61527,61528,61529,61530,61531,61532,61533,61534,61535,61536,61537,61538,61539,61540,61541,61542,61543,61544,61545,61546,61547,61548,61549,61550,61551,61552,61553,61554,61555,61556,61557,61558,61559,61560,61561,61562,61563,61564,61565,61566,61567,61568,61569,61570,61571,61572,61573,61574,61575,61576,61577,61578,61579,61580,61581,61582,61583,61584,61585,61586,61587,61588,61589,61590,61591,61592,61593,61594,61595,61596,61597,61598,61599,61600,61601,
61602,61603,61604,61605,61606,61607,61608,61609,61610,61611,61612,61613,61614,61615,61616,61617,61618,61619,61620,61621,61622,61623,61624,61625,61626,61627,61628,61629,61630,61631,61632,61633,61634,61635,61636,61637,61638,61639,61640,61641,61642,61643,61644,61645,61646,61647,61648,61649,61650,61651,61652,61653,61654,61655,61656,61657,61658,61659,61660,61661,61662,61663,61664,61665,61666,61667,61668,61669,61670,61671,61672,61673,61674,61675,61676,61677,61678,61679,61680,61681,61682,61683,61684,61685,
61686,61687,61688,61689,61690,61691,61692,61693,61694,61695];this.addEventListener("keydown",function(a){var b=[],c=a.keyCode||a.charCode;if(!([16,17,18].indexOf(c)>=0)){b=[];a.ctrlKey&&b.push("ctrl");a.altKey&&b.push("alt");a.shiftKey&&b.push("shift");var h=null,j;for(j in Keyboard.keyBindings)if(Keyboard.keyBindings[j]===c){b.push(j);h=b.join(" ");break}if(h===null)console.log("Terminal: Unknown key code: ",c);else{/([\s]|$)shift /.test(h)&&(h=h.replace(/^(ctrl )?(alt )?([^*])$/,"$3"));switch(true){case (b=
/^shift ([a-z])$/.exec(h))?true:false:h=b[1].toUpperCase();break;case (b=/^shift ([\d\`\-\=\[\];\'\\\,\.\/])$/.exec(h))?true:false:h={1:"!",2:"@",3:"#",4:"$",5:"%",6:"^",7:"&",8:"*",9:"(",0:")","-":"_","=":"+","`":"~","[":"{","]":"}",";":":","'":'"',"\\":"|",",":"<",".":">","/":"?"}[b[1]];break;case (b=/^(shift )?num_([\S])$/.exec(h))?true:false:h=b[2]}b=h;if(b=="shift insert")(function(a){setTimeout(function(){a.send(clipData.toHex())},100)})(this);else if(b!="ctrl insert"){h!="numlock"&&(a.preventDefault(),
a.stopPropagation());h=h.replace(/(^)(up|down|left|right)$/,"$2"+(this.cursorKeyMode?1:0));switch(true){case h.length==1:h=h.charCodeAt(0).toString(16);h.length<2&&(h="0"+h);break;case h=="enter":case h=="ctrl enter":case h=="shift enter":h="0D";break;case typeof TermProto.KeyMappings[h]!="undefined":h=TermProto.KeyMappings[h];break;default:console.log("'"+h+"' key not mapped"),h=null}if(h!==null)this.onCustomEvent("VT100_Keyboard",h)}}}});this.addCustomEventListener("VT100_Keyboard",function(a){this.send(a,
true);return true});this.addCustomEventListener("resize",function(){this.bottom=this.lines});this.utfPreferred=true;this.autoprint=false;this.blinkingCursor=true;this.npar=0;this.par=[];this.isQuestionMark=false;this.savedX=[];this.savedY=[];this.savedAttr=[];this.savedUseGMap=0;this.savedGMap=[this.Latin1Map,this.VT100GraphicsMap,this.CodePage437Map,this.DirectToFontMap];this.savedValid=[];this.titleString=this.respondString="";this.blinkingCursor=false;this.reset();var b=userStorage.getItem("VT101",
{font:"14px monospace",charWidth:11,charHeight:18});this.font=b.font;this.charWidth=b.charWidth;this.charHeight=b.charHeight;this.tabIndex=0;(function(a){a.addEventListener("focus",function(){a.solidCursor=a.blinkingCursor=true},true);a.addEventListener("blur",function(){a.solidCursor=a.blinkingCursor=false},true)})(this);(function(a){a.handler=function(b){console.log("VT100.command: ",b);switch(b){case "cmd_copy":a.copycmd();break;case "cmd_paste":clipData&&a.send(clipData.toHex());a.selection.start=
a.selection.stop={x:0,y:0};break;case "cmd_reset":a.reset();break;case "cmd_preferences":new VT101Preferences(a)}}})(this);(function(a){Keyboard.bindKeyboardHandler(a,"ctrl insert",a.copycmd=function(){var b=a.selection.getText();if(b){var c=new Dialog({alwaysOnTop:true,appIcon:"",caption:"Copy",closeable:true,height:193,maximizeable:false,maximized:false,minimizeable:false,modal:true,moveable:true,resizeable:true,scrollable:false,visible:true,width:377,childOf:getOwnerWindow(this)});c.insert((new DOMLabel("Because we cannot manipulate browser clipboard directly, please press again CTRL+C in this box:")).setAttr("style",
"top: 10px; left: 10px; right: 10px; position: absolute; white-space: normal; height: 30px; text-align: justify"));c.clip=c.insert(new TextArea("")).setAttr("style","top: 50px; left: 10px; position: absolute; right: 10px; bottom: 10px");c.paint();c.clip.value=b;c.clip.focus();c.clip.select();c.clip.oncopy=function(){setTimeout(function(){clipData=c.clip.value;c.close();c.purge();a.focus()},100)};Keyboard.bindKeyboardHandler(c,"esc",function(){c.close();c.purge()});c.closeCallback=function(){a.focus();
return true}}});a.pastecmd=function(){var b=new Dialog({alwaysOnTop:true,appIcon:"",caption:"Paste",closeable:true,height:193,maximizeable:false,maximized:false,minimizeable:false,modal:true,moveable:true,resizeable:true,scrollable:false,visible:true,width:377,childOf:getOwnerWindow(this)});b.insert((new DOMLabel("Because we cannot manipulate browser clipboard directly, please press again CTRL+V in this box:")).setAttr("style","top: 10px; left: 10px; right: 10px; position: absolute; white-space: normal; height: 30px; text-align: justify"));
b.clip=b.insert(new TextArea("")).setAttr("style","top: 50px; left: 10px; position: absolute; right: 10px; bottom: 10px");b.paint();b.clip.value="";b.clip.focus();b.clip.select();b.clip.onpaste=function(){setTimeout(function(){clipData=b.clip.value;b.close();b.purge();a.focus();a.handler("cmd_paste")},100)};Keyboard.bindKeyboardHandler(b,"esc",function(){b.close();b.purge()});b.closeCallback=function(){a.focus();return true}}})(this);this.addContextMenu([{caption:"Copy",id:"cmd_copy",handler:this.handler,
shortcut:"Ctrl + Ins"},{caption:"Paste",handler:this.pastecmd,shortcut:"Shift + Ins"},null,{caption:"Reset",id:"cmd_reset",handler:this.handler},null,{caption:"Preferences",id:"cmd_preferences",handler:this.handler}]);this.addCustomEventListener("clipboardData",function(a){clipData=a.trim();return true});this.addCustomEventListener("paste",function(){this.handler("cmd_paste");return true});(function(a){a.expect=function(b,c,h){if(!b instanceof Array)throw"Bad expectation object!";var j=0,k=false,
l=function(c){for(var c=c.replace(/[\r\n]+/g,"\n").split("\n"),i=0,h=c.length;i<h;i++)for(var k=0,l=b.length;k<l;k++)if(b[k].when.test(c[i])&&j==0){j=1;try{b[k].then.call(a,c[i])}catch(t){console.log("Expect:: Exception: "+t)}m();return}},m=function(){k||(console.log("Expect:: unregister!"),a.removeCustomEventListener("receive",l),k=true)};console.log("Expect:: register");a.addCustomEventListener("receive",l);setTimeout(function(){m();!j&&h instanceof Function&&h.call(a)},c)}})(this)})}
function DatePicker(c,a,b){var c=c||false,f=$("table","DomDatePicker").setAttr("border","0").setAttr("cellpadding","0").setAttr("cellspacing","0"),a=a||"%Y-%m-%d",g=[];Object.defineProperty(f,"isDate",{get:function(){return/%(b|c|d|e|M|m|Y|y)/.test(a)}});Object.defineProperty(f,"isTime",{get:function(){return/%(k|H|i|S|s)/.test(a)}});EnableCustomEventListeners(f);f.DT=typeof b=="undefined"?!c||!c.value?new Date:(new Date).fromString(c.value,a):(new Date).fromString(b,a);f.DD=(new Date).fromString(f.DT.toString("%Y-%m-%d"),
"%Y-%m-%d");var i=function(a){cancelEvent(a);f.DD.prevMonth();p()},h=function(a){cancelEvent(a);f.DD.nextMonth();p()},j=function(a){cancelEvent(a);f.DD.prevYear();p()},k=function(a){cancelEvent(a);f.DD.nextYear();p()};if(f.isDate){if(/%(M|m|c|b|Y|y)/.test(a)){var l=f.insertRow(f.rows.length).addClass("DatePickerRowMonthYear").chain(function(){this.style.whiteSpace="nowrap"});l.insertCell(0).addClass("DomPrevMonth").chain(function(){this.addEventListener("mousedown",i)});var m=l.insertCell(1).chain(function(){this.title=
"Scroll, or Scroll + Shift, or Click for navigation";this.addEventListener("mousedown",function(a){cancelEvent(a);f.yearOverlay=!f.yearOverlay});this.setAttr("colspan",3)});l.insertCell(2).addClass("DomNextMonth").chain(function(){this.addEventListener("mousedown",h)});l.insertCell(3).addClass("DomPrevYear").chain(function(){this.addEventListener("mousedown",j)});l.insertCell(4).addClass("DomNextYear").chain(function(){this.addEventListener("mousedown",k)})}if(/%(d|e)/.test(a)){for(var b=f.insertRow(f.rows.length).chain(function(){this.addEventListener("mousedown",
function(a){cancelEvent(a)})}).addClass("DatePickerRowWeekDays"),o=0;o<7;o++)b.insertCell(o).innerHTML=Date.prototype.ShortDayNames[o];for(o=0;o<6;o++)f.insertRow(f.rows.length).addClass("DomDatePickerRowWeeks").chain(function(){for(var a=0;a<7;a++)this.insertCell(a).addClass("DomDayCell"+(a==0||a==6?" DomDateCellWeekend":"")).chain(function(){this.addEventListener("mousedown",function(a){f.DT.setDate(this.clickDay);f.DT.setMonth(this.clickMonth);f.DT.setFullYear(this.clickYear);f.DD.fromString(f.DT.toString("%Y-%m-%d"),
"%Y-%m-%d");p();f.onCustomEvent("change",f);u();cancelEvent(a)});g.push(this)})})}}(function(){var a=false;Object.defineProperty(f,"yearOverlay",{get:function(){return a},set:function(b){b=!!b;if(b!=!!a)switch(b){case true:try{a=f.parentNode.appendChild($("div").setAttr("style","display: block; position: absolute; border: 1px solid black; background-color: white; z-index: 1000000; overflow: hidden").chain(function(){this.style.left=parseInt(f.style.left)+m.offsetLeft+"px";this.style.top=parseInt(f.style.top)+
m.offsetTop+m.offsetHeight+"px"}));var c=[].chain(function(){for(var a=1900;a<2050;a++)this.push({id:a,name:a})}),i=a.appendChild(new DropDown(c)).setAttr("style","display: block; width: "+a.style.width+"; height: "+a.style.height+"; border: none; padding: none; margin: none").setAttr("multiple","multiple").chain(function(){this.addEventListener("change",function(){f.DD.setFullYear(i.value);p();f.yearOverlay=false});try{if(this.value=f.DD.getFullYear()+"",this.selectedIndex>=0)this.scrollTop=this.selectedIndex*
16-(this.offsetHeight/2>>0)}catch(a){}})}catch(h){a=false;break}break;case false:a&&a.parentNode&&a.parentNode.removeChild(a).purge(),a=false}}})})();if(f.isTime){var n=[];/%(k|H)/.test(a)&&(new Spinner({minValue:0,maxValue:23,step:1,value:parseInt(f.DT.unpad(f.DT.toString("%k")))})).chain(function(){this.addCustomEventListener("change",function(){f.DT.setHours(this.value);f.onCustomEvent("change",f)});this.role="%k";n.push(this)});/%i/.test(a)&&(new Spinner({minValue:0,maxValue:59,step:1,value:parseInt(f.DT.unpad(f.DT.toString("%i")))})).chain(function(){this.addCustomEventListener("change",
function(){f.DT.setMinutes(this.value);f.onCustomEvent("change",f)});this.role="%i";n.push(this)});/%(S|s)/.test(a)&&(new Spinner({minValue:0,maxValue:59,step:1,value:parseInt(f.DT.unpad(f.DT.toString("%s")))})).chain(function(){this.addCustomEventListener("change",function(){f.DT.setSeconds(this.value);f.onCustomEvent("change",f)});this.role="%s";n.push(this)});n.length&&f.insertRow(f.rows.length).addClass("DomTimeRow").chain(function(){for(var a=0,b=n.length;a<b;a++)this.insertCell(a).setAttr("colspan",
"2").appendChild(n[a]);f.isDate&&this.insertCell(n.length).setAttr("colspan",7-n.length+"")})}var q=function(){if(f.isTime)try{for(var a=0,b=n.length;a<b;a++)n[a].value=parseInt(f.DD.unpad(f.DD.toString(n[a].role)))}catch(c){}};f.insertRow(f.rows.length).chain(function(){this.addClass("DatePickerRowReset").insertCell(0).setHTML("Now").setAttr("colspan","7").addEventListener("mousedown",function(a){f.DT.resetDate();f.DD.resetDate();f.isDate&&p();f.isTime&&q();f.onCustomEvent("change",f);cancelEvent(a)})});
var p=function(){var a=f.DD.toString("%Y"),b=f.DD.toString("%b");if(m)m.innerHTML=b.concat(" ").concat(a).concat(" \u25bc");var a=(new Date).fromString(f.DD.toString("%Y-%m-01"),"%Y-%m-%d"),b=a.getMonth(),c=a.getFullYear();if(a.getDay()!=0)for(;a.getDay()!=0;)a.yesterday();else for(var i=0;i<7;i++)a.yesterday();for(var h=new Date,h={day:h.getDate(),month:h.getMonth(),year:h.getFullYear()},i=0,j=g.length;i<j;i++)g[i].innerHTML=a.getDate(),g[i].clickDay=a.getDate(),g[i].clickMonth=a.getMonth(),g[i].clickYear=
a.getFullYear(),(a.getMonth()==b&&a.getFullYear()==c?removeStyle:addStyle)(g[i],"other"),g[i].flipMonth=!(a.getMonth()==b&&a.getFullYear()==c),(a.getMonth()==f.DT.getMonth()&&a.getDate()==f.DT.getDate()&&a.getFullYear()==f.DT.getFullYear()?addStyle:removeStyle)(g[i],"this"),(a.getDate()==h.day&&a.getMonth()==h.month&&a.getFullYear()==h.year?addStyle:removeStyle)(g[i],"today"),a.tomorrow()};f.isDate&&p();c&&f.addCustomEventListener("change",function(){c.value=f.DT.toString(a);try{c.onCustomEvent("change",
c.value)}catch(b){}});var r=function(a){if(a=a.target||a.srcElement){for(;a!=document.body;){if(a==f||a==c||a==f.yearOverlay)return;a=a.parentNode}u()}};f.tabIndex=0;var t=function(){if(!(c==document.activeElement||f==document.activeElement)){for(var a=document.activeElement;a;){if(a==f)return;a=a.parentNode}if(n)for(var a=0,b=n.length;a<b;a++)if(document.activeElement==n[a].ctl)return;u()}},w=function(){if(c){if(c.value=="")c.value=(new Date).toString(a);try{f.DT.fromString(c.value,a),f.DD.fromString(c.value,
a),p()}catch(b){f.DT.resetDate(),f.DD.resetDate()}q();if(f.parentNode!=document.body)f.style.position="absolute",document.body.appendChild(f),document.body.addEventListener("mousedown",r,true),window.addEventListener("keyup",t,true);var i=new Pinner(c,f);i.setPinMode("bottom-left");f.offsetTop+f.offsetHeight>getMaxY()&&i.setPinMode("top-left")}},u=function(){if(c){f.parentNode&&f.parentNode.removeChild(f);document.body.removeEventListener("mousedown",r,true);window.removeEventListener("keyup",t,true);
try{f.yearOverlay=false}catch(a){}}},b=function(a){a=a||window.event;switch(true){case typeof window.opera!="undefined":var b=a.wheelDelta/40;break;case typeof a.wheelDelta!="undefined":b=a.wheelDelta/40;break;case typeof a.detail!="undefined":b=-a.detail/3;break;default:b=0}(b<0?-1:1)<0?a.shiftKey?k():h():a.shiftKey?j():i()};f.isDate&&(l.addEventListener("mousewheel",b,true),l.addEventListener("DOMMouseScroll",b,true));c&&(c.addEventListener("click",function(a){typeof c.editable!="undefined"&&!c.editable?
cancelEvent(a):w(a)},true),c.addEventListener("focus",function(a){typeof c.editable!="undefined"&&!c.editable?cancelEvent(a):w(a)},true));f.addCustomEventListener("render-date",function(){renderDate()});f.addCustomEventListener("render-time",function(){q()});return f}var _winZIndexOrder=100;function _winZIndexSorter(c,a){switch(true){case c.alwaysOnTop&&a.alwaysOnTop:return 0;case c.alwaysOnTop:return 1;case c.active:return 1;default:return c.__zIndexSort-a.__zIndexSort}}
function Dialog(c,a){var b=$("div","DOM2Window");b.designMode=typeof a=="undefined"?false:true;b.designMode&&addStyle(b,"design-mode");b.___uniqueID=uniqueID();b.getUniqueID=function(){return b.___uniqueID};try{b.__defineGetter__("uniqueID",b.getUniqueID)}catch(f){Object.defineProperty(b,"uniqueID",{get:b.getUniqueID})}b.__zIndexSort=_winZIndexOrder;b.settings=c||{};EnableCustomEventListeners(b);b.settings.width=typeof b.settings.width!="undefined"?b.settings.width:b.settings.childOf?b.settings.childOf.offsetWidth:
getMaxX();b.settings.height=typeof b.settings.height!="undefined"?b.settings.height:b.settings.childOf?b.settings.childOf.offsetHeight:getMaxY();b.settings.x=typeof b.settings.x!="undefined"?b.settings.x:Math.ceil((b.settings.childOf?b.settings.childOf.offsetWidth:getMaxX())/2-b.settings.width/2);b.settings.y=typeof b.settings.y!="undefined"?b.settings.y:Math.ceil((b.settings.childOf?b.settings.childOf.offsetHeight:getMaxY())/2-b.settings.height/2);b.settings.childOf=typeof b.settings.childOf!="undefined"?
b.settings.childOf:null;b.settings.attached=typeof b.settings.attached!="undefined"?b.settings.attached:false;b.settings.minimizeable=typeof b.settings.minimizeable!="undefined"?b.settings.minimizeable:true;b.settings.minimized=typeof b.settings.minimized!="undefined"?b.settings.minimized:false;b.settings.maximizeable=typeof b.settings.maximizeable!="undefined"?b.settings.maximizeable:true;b.settings.maximized=typeof b.settings.maximized!="undefined"?b.settings.maximized:false;b.settings.closeable=
typeof b.settings.closeable!="undefined"?b.settings.closeable:true;b.settings.resizeable=typeof b.settings.resizeable!="undefined"?b.settings.resizeable:true;b.settings.moveable=typeof b.settings.moveable!="undefined"?b.settings.moveable:true;b.settings.visible=typeof b.settings.visible!="undefined"?b.settings.visible:true;b.settings.caption=typeof b.settings.caption!="undefined"?b.settings.caption:"No Title";b.settings.appIcon=typeof b.settings.appIcon!="undefined"?b.settings.appIcon:"";b.settings.active=
typeof b.settings.active!="undefined"?b.settings.active:true;b.settings.alwaysOnTop=typeof b.settings.alwaysOnTop!="undefined"?b.settings.alwaysOnTop:false;b.settings.scrollable=typeof b.settings.scrollable!="undefined"?b.settings.scrollable:false;b.settings.modal=typeof b.settings.modal!="undefined"?b.settings.modal:false;b.settings.minWidth=typeof b.settings.minWidth!="undefined"?b.settings.minWidth:10;b.settings.minHeight=typeof b.settings.minHeight!="undefined"?b.settings.minHeight:10;b.settings.titlebar=
typeof b.settings.titlebar!="undefined"?b.settings.titlebar:true;b.settings.menuVisible=typeof b.settings.menuVisible!="undefined"?b.settings.menuVisible:true;b.settings.menu=typeof b.settings.menu!="undefined"?b.settings.menu:false;b.settings.toolbarsVisible=typeof b.settings.toolbarsVisible!="undefined"?b.settings.toolbarsVisible:true;b.settings.toolBars=typeof b.settings.toolbars!="undefined"?b.settings.toolbars:false;b.settings.statusBarVisible=typeof b.settings.statusBarVisible!="undefined"?
b.settings.statusBarVisible:true;b.settings.statusBar=typeof b.settings.statusBar!="undefined"?b.settings.statusBar:false;b.settings.toolbarsSettings=b.settings.toolbarsSettings||{iconSize:"normal",titles:false,buttonLabels:false};b.inner=$("div","DOM2WindowInner");b.appendChild(b.inner);b._titlebarHolder=$("div","DOM2WindowTitle");b._titlebarHolder.setAttribute("dragable","1");b._titlebarHolder.addContextMenu([{caption:"Always On Top",checked:function(){return b.alwaysOnTop},input:"checkbox",handler:function(a){b.alwaysOnTop=
!!a}},null,{caption:"Maximized",disabled:function(){return!b.maximizeable},handler:function(a){b.maximized=!!a},input:"checkbox",checked:function(){return b.maximized}},{caption:"Minimize",disabled:function(){return!b.minimizeable},handler:function(){b.minimized=true}},{caption:"Close",disabled:function(){return!b.closeable},handler:function(){b.close()}}]);b._titlebarHolderMouseDown=function(){b._titlebarHolder.activeElement=document.activeElement};b._titlebarHolderMouseUp=function(){if(b.windows)for(var a=
0;a<b.windows.length;a++)if(b.windows[a].active&&b.windows[a].modal)b.designMode||b._titlebarHolder.activeElement.focus(),document.body.scrollTop=0,document.body.scrollLeft=0};try{b._titlebarHolder.addEventListener("mousedown",b.titlebarHolderMouseDown,true),b._titlebarHolder.addEventListener("mouseup",b.titlebarHolderMouseUp,false)}catch(g){b._titlebarHolder.attachEvent("onmousedown",b.titlebarHolderMouseDown),b._titlebarHolder.attachEvent("onmouseup",b.titlebarHolderMouseUp)}b._titlebarHolder.style.display=
b.settings.titlebar?"":"none";b.inner.appendChild(b._titlebarHolder);b._titlebarHolderInner=b._titlebarHolder.appendChild($("div","DOM2WindowTitleInner"));b._titlebarHolderInner.setAttribute("dragable","1");b.modalIconHolder=b._titlebarHolderInner.appendChild($("div","DOM2WindowModalIcon"));b.modalIconHolder.setAttribute("dragable","1");b._titlebarHolder._caption=b._titlebarHolderInner.appendChild($("div","DOM2WindowCaption"));b._titlebarHolder._caption.setAttribute("dragable","1");disableSelection(b._titlebarHolder._caption);
b.modalButtonsHolder=b._titlebarHolderInner.appendChild($("div","DOM2WindowModalButtonsHolder"));b.modalButtonsHolder.setAttribute("dragable","1");b._close_button=b.modalButtonsHolder.appendChild($("div","DOM2WindowClose"));b._maximize_button=b.modalButtonsHolder.appendChild($("div","DOM2WindowMaximize"));b._minimize_button=b.modalButtonsHolder.appendChild($("div","DOM2WindowMinimize"));b._close_button.style.display=b.settings.closeable?"":"none";b._maximize_button.style.display=b.settings.maximizeable?
"":"none";b._minimize_button.style.display=b.settings.minimizeable?"":"none";b._menuHolder=b.inner.appendChild($("div","DomDialogMenuBar"));b._toolbarHolder=b.inner.appendChild($("div","DomDialogToolbar"));b._statusBarHolder=b.inner.appendChild($("div","DomDialogStatusBar"));if(!b.settings.statusBar||!b.settings.statusBarVisible)b._statusBarHolder.style.display="none";if(!b.settings.menuBar||!b.settings.menuBarVisible)b._menuHolder.style.display="none";b.body=$("div","DOM2WindowBody");b.inner.appendChild(b.body);
b._hMenu=false;b._hToolbar=false;b.onLooseFocus=function(){};b.onGetFocus=function(){};b.___toolbarsRedrawEventListener=function(){b.onCustomEvent("redraw",{wnd:b})};b.___onLayoutChange=function(){var a=0;if(b.getTitlebar())b._titlebarHolder.style.top=a+"px",a+=b._titlebarHolder.offsetHeight;if(b._hMenu&&b.getMenuVisible())b._menuHolder.style.top=a+"px",a+=b._menuHolder.offsetHeight;if(b._hToolbar&&b.getToolbarsVisible())b._toolbarHolder.style.height=b._hToolbar.offsetHeight+"px",b._toolbarHolder.style.top=
a+"px",a+=b._toolbarHolder.offsetHeight;b.body.style.height=b.getHeight()-a+"px"};b.addCustomEventListener("redraw",b.___onLayoutChange);b.getMinWidth=function(){return b.settings.minWidth};b.setMinWidth=function(a){a=parseInt(a);a=isNaN(a)||!a||a<10?10:a;b.getWidth()<a&&b.setWidth(a);b.settings.minWidth=a};b.getMinHeight=function(){return b.settings.minHeight};b.setMinHeight=function(a){a=parseInt(a);a=isNaN(a)||!a||a<10?10:a;b.getHeight()<a&&b.setHeight(a);b.settings.minHeight=a};b.getToolbarsSettings=
function(){return b.settings.toolbarsSettings};b.setToolbarsSettings=function(a){b.settings.toolbarsSettings=a};b.getTitlebar=function(){return b.settings.titlebar};b.setTitlebar=function(a){b.settings.titlebar=a?true:false;b._titlebarHolder.style.display=b.settings.titlebar?"":"none";b.onCustomEvent("redraw",{wnd:b})};b.getMenuVisible=function(){return b.settings.menu&&b.settings.menuVisible};b.setMenuVisible=function(a){b.settings.menuVisible=a?true:false;b._menuHolder.style.display=b.settings.menuVisible&&
b.settings.menu?"":"none";if(b.settings.menu)b.onCustomEvent("redraw",{wnd:b})};b.getMenu=function(){return b.settings.menu?b._hMenu:false};b.setMenu=function(a){if(a!=b.settings.menu){if(a){b.settings.menu=a;b._menuHolder.innerHTML="";try{b._hMenu=new MenuBar(b.settings.menu)}catch(c){console.log("Attempted to setup a menu on a window, but the following error occured:\n   - "+c+"\n"+c.stack);b.setMenu(false);return}b._menuHolder.appendChild(b._hMenu);b._menuHolder.style.display=b.settings.menuVisible?
"":"none"}else b.settings.menu=false,b._menuHolder.innerHTML="",b._hMenu=false;if(b.settings.menuVisible)b.onCustomEvent("redraw",{wnd:b})}};b.getToolbarsVisible=function(){return b.settings.toolbars&&b.settings.toolbarsVisible};b.setToolbarsVisible=function(a){b.settings.toolbarVisible=a?true:false;b._toolbarHolder.style.display=b.settings.toolbarVisible&&b.settings.toolbars?"":"none";if(b.settings.toolbars)b.onCustomEvent("redraw",{wnd:b})};b.getToolbars=function(){return b.settings.toolbars?b._hToolbar:
false};b.setToolbars=function(a){if(a!=b.settings.toolbars)if(a){b.settings.toolbars=a;try{for(var a=[],c=0;c<b.settings.toolbars.length;c++)a.push(new Toolbar(b.settings.toolbars[c].items,b.settings.toolbars[c].name));b._hToolbar=new AppToolbarZone(a,b.settings.toolbarsSettings);b._hToolbar.addCustomEventListener("resize",b.___toolbarsRedrawEventListener)}catch(i){b.setToolbars(false);return}b._toolbarHolder.innerHTML="";b._toolbarHolder.appendChild(b._hToolbar);b._toolbarHolder.style.display=b.settings.toolbarsVisible?
"":"none";if(b.settings.toolbarsVisible)b.onCustomEvent("redraw",{wnd:b})}else b.settings.toolbars=false,b._toolbarHolder.innerHTML="",b._hToolbar=false,b.settings.toolbarsVisible&&(b.setToolbarsVisible(false),b.onCustomEvent("redraw",{wnd:b}))};b.getStatusBarVisible=function(){return b.settings.statusBar&&b.settings.statusBarVisible};b.setStatusBarVisible=function(a){b.settings.statusBarVisible=a?true:false;b._statusBarHolder.style.display=b.settings.statusBarVisible&&b.settings.statusBar?"":"none";
if(b.settings.statusBar)b.onCustomEvent("redraw",{wnd:b})};b.getStatusBar=function(){return b.settings.statusBar?b.statusBarHolder:false};b.setStatusBar=function(a){if(a!=b.settings.statusBar&&(a?(b.settings.statusBar=a,b._statusBarHolder.style.display=b.settings.statusBarVisible?"":"none"):(b.settings.statusBar=false,b._statusBarHolder.innerHTML="",b._statusBarHolder.style.display="none"),b.settings.statusBarVisible))b.onCustomEvent("redraw",{wnd:b})};b.getModal=function(){return b.settings.modal};
b.setModal=function(a){a=a?true:false;if(a!=b.settings.modal){switch(a){case true:b.__MODAL_FRAME=$("div","DOM2DialogModalOverlay");if(b.settings.childOf){var c=getOwnerWindow(b.settings.childOf);if(c===null)c=b.settings.childOf;c.appendChild(b.__MODAL_FRAME)}break;case false:typeof b.__MODAL_FRAME!="undefined"&&(b.__MODAL_FRAME.parentNode&&b.__MODAL_FRAME.parentNode.removeChild(b.__MODAL_FRAME),delete b.__MODAL_FRAME)}b.settings.modal=a}};b.getWidth=function(){return b.settings.width};b.setWidth=
function(a){var c=parseInt(a),c=isNaN(c)||c<b.settings.minWidth?b.settings.minWidth:c,a=(b.getToolbarsVisible()?b._hToolbar.offsetHeight:0)+(b.getMenuVisible()?b._menuHolder.offsetHeight:0);b.style.width=c+"px";b.inner.style.width=c+"px";b.settings.width=c;b._titlebarHolderInner.style.width=c+"px";if(typeof b._resize_handle!="undefined"&&b._resize_handle!==null)b._resize_handle.style.left=c-10+"px";c=(b.getToolbarsVisible()?b._hToolbar.offsetHeight:0)+(b.getMenuVisible()?b._menuHolder.offsetHeight:
0);a!=c?(b.onCustomEvent("redraw",{wnd:b}),b.skipRepaint=false):b.skipRepaint?b.skipRepaint=false:b.__repaint()};b.set__width=function(a){b.skipRepaint=true;b.setWidth(a)};b.getHeight=function(){return b.settings.height};b.setHeight=function(a){var c=(b.getToolbarsVisible()?b._toolbarHolder.offsetHeight:0)+(b.getMenuVisible()?b._menuHolder.offsetHeight:0),a=parseInt(a),a=isNaN(a)||a<b.settings.minHeight?b.settings.minHeight:a;b.style.height=a+"px";b.inner.style.height=a+"px";b.settings.height=a;b._titlebarHolderInner.style.height=
b._titlebarHolder.offsetHeight+"px";if(typeof b._resize_handle!="undefined"&&b._resize_handle!==null)b._resize_handle.style.top=a-10+"px";b.skipRepaint?b.skipRepaint=false:b.__repaint();a=(b.getToolbarsVisible()?b._toolbarHolder.offsetHeight:0)+(b.getMenuVisible()?b._menuHolder.offsetHeight:0);c!=a?(b.onCustomEvent("redraw",{wnd:b}),b.skipRepaint=false):b.skipRepaint?b.skipRepaint=false:b.__repaint()};b.set__height=function(a){b.skipRepaint=true;b.setHeight(a)};b.getX=function(){return b.settings.x};
b.setX=function(a){a=parseInt(a);a=isNaN(a)?0:a;b.style.left=a+"px";b.settings.x=a};b.getY=function(){return b.settings.y};b.setY=function(a){a=parseInt(a);a=isNaN(a)?0:a;b.style.top=a+"px";b.settings.y=a};b.getMinimizeable=function(){return b.settings.minimizeable};b.setMinimizeable=function(a){a?(b.settings.minimizeable=true,b._minimize_button.style.display=""):(b.settings.minimizeable=false,b._minimize_button.style.display="none")};b.getMinimized=function(){return b.settings.minimized};b.setMinimized=
function(a){if(!b.modal)if(a){if(!b.settings.minimizeable)return false;b.settings.minimized=true;b.setActive(false);addStyle(b,"DOM2MinimizedWindow");if(typeof b._minimizeHandle=="undefined")b._minimizeHandle=$("div","DOM2MinimizeHandle");if(b.getChildOf()!==null){if(!b.getChildOf()._minimize_holder)b.getChildOf()._minimize_holder=$("div","DOM2MinimizeHolder"),b.getChildOf().appendChild(b.getChildOf()._minimize_holder);b.getChildOf()._minimize_holder.appendChild(b._minimizeHandle);b._minimizeHandle.innerHTML=
"";b._minimizeHandle.appendChild(document.createTextNode(b.settings.caption));b._minimizeHandle.onclick=function(){b.setMinimized(false)}}}else{b.settings.minimized=false;b.setActive(true);if(b._minimizeHandle)try{b._minimizeHandle.parentNode.removeChild(b._minimizeHandle)}catch(c){}removeStyle(b,"DOM2MinimizedWindow");b.__repaint()}};b.getMaximizeable=function(){return!!b.settings.maximizeable};b.setMaximizeable=function(a){a?(b.settings.maximizeable=true,b._maximize_button.style.display=""):(b._maximize_button.style.display=
"none",b.settings.maximizeable=false)};b.getMaximized=function(){return typeof b.settings.is_maximized&&b.settings.is_maximized==true?true:false};b.setMaximized=function(a){if(b.getResizeable()&&b.settings.maximizeable)a&&!b.getMaximized()&&b.maximize(),!a&&b.getMaximized()&&b.restore(),b.settings.maximized=a,b.paint()};b.maximize=function(){if(!b.settings.is_maximized)b.settings.is_maximized=true,b.settings.beforeMaximizeWidth=b.getWidth(),b.settings.beforeMaximizeHeight=b.getHeight(),b.settings.beforeMaximizeX=
b.getX(),b.settings.beforeMaximizeY=b.getY(),b.settings.beforeMaximizeMoveable=b.getMoveable(),b.setX(0),b.setY(0),b.set__width(b.getChildOf().offsetWidth),b.setHeight(b.getChildOf().offsetHeight-(typeof b.settings.childOf.taskbar!="undefined"?b.settings.childOf.taskbar.offsetHeight:0)),b.setMoveable(false),b.body.paint()};b.restore=function(){if(b.settings.is_maximized)b.settings.is_maximized=false,b.setX(b.settings.beforeMaximizeX),b.setY(b.settings.beforeMaximizeY),b.setWidth(b.settings.beforeMaximizeWidth),
b.setHeight(b.settings.beforeMaximizeHeight),b.setMoveable(b.settings.beforeMaximizeMoveable)};b.getCloseable=function(){return b.settings.closeable};b.__closeButtonClick=function(){b.close()};b.setCloseable=function(a){a?(b.settings.closeable=true,b._close_button.style.display=""):(b._close_button.style.display="none",b.settings.closeable=false)};b.close=function(){if(b.settings.closeable){if(typeof b.closeCallback!="undefined"?b.closeCallback():1){if(b.settings.childOf)for(var a=0;a<b.settings.childOf.windows.length;a++)if(b.settings.childOf.windows[a]==
b)break;b.onCustomEvent("destroy");b.setChildOf(null)}}else console.log('Attempting to close the window (title="'+b.caption+'") failed (window is not closeable)')};b.getResizeable=function(){return b.settings.resizeable};b.setResizeable=function(a){if(a){if(!b.resizeListener||b.resizeListener===null){b._resize_handle=$("div","DOM2WindowResize");b.inner.appendChild(b._resize_handle);b._resize_handle.style.left=b.getWidth()-10+"px";b._resize_handle.style.top=b.getHeight()-10+"px";var c;b._onResizeStart=
function(){c=b.getCaption();if(b.maximized&&(b.settings.is_maximized=null,b.settings.beforeMaximizeMoveable))b.moveable=b.settings.beforeMaximizeMoveable;b.onCustomEvent("resizeStart",{width:b.settings.width,height:b.settings.height,wnd:b})};b._onResizeRun=function(){var a=parseInt(b._resize_handle.style.left)+10,c=parseInt(b._resize_handle.style.top)+10;b.set__width(a);b.set__height(c);b.setCaption(a+" x "+c);b.onCustomEvent("resizeRun",{width:b.settings.width,height:b.settings.height,wnd:b});b.__repaint()};
b._onResizeStop=function(){b.setCaption(c);b.set__width(parseInt(b._resize_handle.style.left)+10);b.set__height(parseInt(b._resize_handle.style.top)+10);b.onCustomEvent("resizeStop",{width:b.settings.width,height:b.settings.height,wnd:b});b.__repaint()};b._resize_handle.setAttribute("dragable","1");b.resizeListener=new dragObject(b._resize_handle,null,new Position(50,b._titlebarHolder?b._titlebarHolder.offsetHeight-10:14),new Position(5E3,5E3),b._onResizeStart,b._onResizeRun,b._onResizeStop)}b.settings.resizeable=
true}else{if(b.resizeListener&&b.resizeListener!==null)b.resizeListener.StopListening(),b.resizeListener=null,b._onResizeStart=null,b._onResizeRun=null,b._onResizeStop=null,b.inner.removeChild(b._resize_handle),b._resize_handle=null;b.settings.resizeable=false}};b.getMoveable=function(){return b.settings.moveable};b.setMoveable=function(a){if(a){if(!b._dragListener)b._moveStart=function(){b.onCustomEvent("dragStart",{x:b.x,y:b.y,wnd:b})},b._moveRun=function(){b.settings.x=parseInt(b.style.left);b.settings.y=
parseInt(b.style.top);b.onCustomEvent("dragRun",{x:b.settings.x,y:b.settings.y,wnd:b})},b._moveStop=function(){b.settings.x=parseInt(b.style.left);b.settings.y=parseInt(b.style.top);b.onCustomEvent("dragStop",{x:b.settings.x,y:b.settings.y,wnd:b})},b._dragListener=new dragObject(b,null,new Position(-5E3,-5E3),new Position(5E3,5E3),b._moveStart,b._moveRun,b._moveStop,null,true);b.settings.moveable=true}else{if(b._dragListener&&b._dragListener!==null)b._dragListener.StopListening(),b._dragListener=
false,b._moveStart=null,b._moveRun=null,b._moveStop=null;b.settings.moveable=false}};b.getVisible=function(){return b.settings.visible};b.setVisible=function(a){(b.settings.visible=a)?removeStyle(b,"DOM2InvisibleWindow"):addStyle(b,"DOM2InvisibleWindow")};b.getChildOf=function(){return b.settings.childOf};b.setChildOf=function(a){if(a!==null){if(b.settings.childOf!==null)try{for(var c=0;c<b.settings.childOf.windows.length;c++)if(b.settings.childOf.windows[c]==b){b.settings.childOf.windows.splice(c,
1);break}b.settings.childOf.removeChild(b)}catch(i){}b.settings.childOf=a;typeof b.__MODAL_FRAME!="undefined"&&(c=getOwnerWindow(a),c==null&&(c=a),c.appendChild(b.__MODAL_FRAME));b.setTaskbarTab();a.appendChild(b);if(typeof a.windows=="undefined")a.windows=[];a.windows.push(b)}else{if(b.parentNode)try{getOwnerWindow(b.parentNode).focus()}catch(h){}typeof b.__MODAL_FRAME!="undefined"&&b.__MODAL_FRAME.parentNode&&b.__MODAL_FRAME.parentNode.removeChild(b.__MODAL_FRAME);if(b.taskbar_tab&&b.taskbar_tab!==
null)b.taskbar_tab.close(),b.taskbar_tab=null;if(b.settings.childOf!==null){for(c=0;c<b.settings.childOf.windows.length;c++)if(b.settings.childOf.windows[c]==b){b.settings.childOf.windows.splice(c,1);break}b.settings.childOf.removeChild(b);b.settings.childOf=null}}};b.getCaption=function(){return b.settings.caption};b.setCaption=function(a){if(typeof b._titlebarHolder._caption=="undefined")b._titlebarHolder._caption=$("span","DOM2WindowCaption"),b._titlebarHolder.appendChild(b._titlebarHolder._caption),
b._titlebarHolder._caption.setAttribute("dragable","1");b._titlebarHolder._caption.innerHTML="";b._titlebarHolder._caption.appendChild(document.createTextNode(a));b.settings.caption=a;if(b.taskbar_tab&&b.taskbar_tab!==null)b.taskbar_tab.caption=a};b.getAppIcon=function(){return b.settings.appIcon};b.setAppIcon=function(a){a?(b.modalIconHolder.style.backgroundImage='url("'+a+'")',b.settings.appIcon=a):(b.modalIconHolder.style.backgroundImage="none",a="");if(b.taskbar_tab&&b.taskbar_tab!==null)b.taskbar_tab.icon=
a};b.getScrollable=function(){return b.settings.scrollable};b.setScrollable=function(a){a?addStyle(b,"DOM2WindowScrollable"):removeStyle(b,"DOM2WindowScrollable");b.settings.scrollable=a?true:false};b.getActive=function(){return b.settings.active};b.setActive=function(a){if(!b.designMode){a&&!b.designMode&&b.focus();if(!a&&b.settings.active)b.onCustomEvent("blur",{wnd:b}),removeStyle(b,"DOM2WindowFocused");else if(a&&!b.settings.active){addStyle(b,"DOM2WindowFocused");b.__zIndexSort=++_winZIndexOrder;
if(b.getChildOf()!==null){for(var c=0;c<b.getChildOf().windows.length;c++)if(b.getChildOf().windows[c]!=b)b.getChildOf().windows[c].active=false;b.getChildOf().windows.sort(_winZIndexSorter);for(c=0;c<b.getChildOf().windows.length;c++)b.getChildOf().windows[c].style.zIndex=100+c}b.onCustomEvent("focus",{wnd:b})}b.settings.active=a;if(b.taskbar_tab&&b.taskbar_tab!=null)b.taskbar_tab.active=a}};b.setTaskbarTab=function(){if(b.taskbar_tab&&b.taskbar_tab!=null)b.taskbar_tab.close(),b.taskbar_tab=null;
if(b.getChildOf().taskbar)b.taskbar_tab=b.getChildOf().taskbar.createAppEntry({caption:b.getCaption(),icon:b.getAppIcon(),active:b.getActive()}),b.taskbar_tab.onclick=function(){if(b.getMinimized())b.setMinimized(false),b.setActive(true);else if(b.getMinimized()==false)if(b.getActive())b.setMinimized(true);else{if(!b.getActive())b.active=true}else b.setActive(true)},b.taskbar_tab.active=b.active,b.taskbar_tab.icon=b.settings.appIcon,MakeDropable(b.taskbar_tab),b.taskbar_tab.addCustomEventListener("dragenter",
function(){if(b.minimized)b.minimized=false;b.active=true}),b.taskbar_tab.addContextMenu([{caption:"Always OnTop",handler:function(a){b.alwaysOnTop=!!a},input:"checkbox",checked:function(){return b.alwaysOnTop}},null,{caption:"Maximized",disabled:function(){return!b.maximizeable},handler:function(a){b.maximized=!!a},input:"checkbox",checked:function(){return b.maximized}},{caption:"Minimized",input:"checkbox",checked:function(){return b.minimized},disabled:function(){return!b.minimizeable},handler:function(a){b.minimized=
!!a}},{caption:"Close",disabled:function(){return!b.closeable},handler:function(){b.close()}}])};b.getAlwaysOnTop=function(){return b.settings.alwaysOnTop};b.setAlwaysOnTop=function(a){(b.settings.alwaysOnTop=a)?addStyle(b,"DOM2WindowAlwaysOnTop"):removeStyle(b,"DOM2WindowAlwaysOnTop")};Object.defineProperty(b,"minWidth",{get:b.getMinWidth,set:b.setMinWidth});Object.defineProperty(b,"minHeight",{get:b.getMinHeight,set:b.setMinHeight});Object.defineProperty(b,"titlebar",{get:b.getTitlebar,set:b.setTitlebar});
Object.defineProperty(b,"menu",{get:b.getMenu,set:b.setMenu});Object.defineProperty(b,"menuVisible",{get:b.getMenuVisible,set:b.setMenuVisible});Object.defineProperty(b,"toolbars",{get:b.getToolbars,set:b.setToolbars});Object.defineProperty(b,"toolbarsVisible",{get:b.getToolbarsVisible,set:b.setToolbarsVisible});Object.defineProperty(b,"toolbarsSettings",{get:b.getToolbarsSettings,set:b.setToolbarsSettings});Object.defineProperty(b,"statusBar",{get:b.getStatusBar,set:b.setStatusBar});Object.defineProperty(b,
"statusBarVisible",{get:b.setStatusBarVisible,set:b.setStatusBarVisible});Object.defineProperty(b,"width",{get:b.getWidth,set:b.setWidth});Object.defineProperty(b,"__width",{set:b.set__width});Object.defineProperty(b,"height",{get:b.getHeight,set:b.setHeight});Object.defineProperty(b,"__height",{set:b.set__height});Object.defineProperty(b,"x",{get:b.getX,set:b.setX});Object.defineProperty(b,"y",{get:b.getY,set:b.setY});Object.defineProperty(b,"minimizeable",{get:b.getMinimizeable,set:b.setMinimizeable});
Object.defineProperty(b,"minimized",{get:b.getMinimized,set:b.setMinimized});Object.defineProperty(b,"closeable",{get:b.getCloseable,set:b.setCloseable});Object.defineProperty(b,"resizeable",{get:b.getResizeable,set:b.setResizeable});Object.defineProperty(b,"moveable",{get:b.getMoveable,set:b.setMoveable});Object.defineProperty(b,"visible",{get:b.getVisible,set:b.setVisible});Object.defineProperty(b,"childOf",{get:b.getChildOf,set:b.setChildOf});Object.defineProperty(b,"caption",{get:b.getCaption,
set:b.setCaption});Object.defineProperty(b,"appIcon",{get:b.getAppIcon,set:b.setAppIcon});Object.defineProperty(b,"scrollable",{get:b.getScrollable,set:b.setScrollable});Object.defineProperty(b,"active",{get:b.getActive,set:b.setActive});Object.defineProperty(b,"alwaysOnTop",{get:b.getAlwaysOnTop,set:b.setAlwaysOnTop});Object.defineProperty(b,"maximized",{get:b.getMaximized,set:b.setMaximized});Object.defineProperty(b,"maximizeable",{get:b.getMaximizeable,set:b.setMaximizeable});Object.defineProperty(b,
"modal",{get:b.getModal,set:b.setModal});b.center=function(){if(b.parentNode){var a=b.parentNode.offsetHeight-(b.parentNode.taskbar?b.parentNode.taskbar.offsetHeight||0:0),c=b.offsetHeight;b.x=~~(b.parentNode.offsetWidth/2-b.offsetWidth/2);b.y=~~(a/2-c/2)}};b.__repaint=function(){b.___onLayoutChange();var a=b.body.firstChild;for(b.onCustomEvent("paint",b);a;){try{a.paint()}catch(c){console.log("exception: "+c)}a=a.nextSibling}};b.insert=function(){if(arguments.length==0)return null;else{for(var a=
null,c=0;c<arguments.length;c++)a=arguments[c],b.body.appendChild(a),a.DOManchors&&a.paint();return a}};b.settings.childOf!==null?b.setChildOf(b.settings.childOf):b.setChildOf(document.body);b.setX(b.settings.x);b.setY(b.settings.y);b.set__width(b.settings.width);b.set__height(b.settings.height);b.setVisible(b.settings.visible);b.setCaption(b.settings.caption);b.setMoveable(b.settings.moveable);b.settings.minimizeable&&b.setMinimizeable(true);b.settings.maximizeable&&b.setMaximizeable(true);b.settings.closeable&&
b.setCloseable(true);b.settings.resizeable&&b.setResizeable(true);b.settings.maximized&&b.setMaximized(true);b.settings.scrollable&&b.setScrollable(true);b.settings.titlebar||b.setTitlebar(false);var i;if(b.settings.menu)i=b.settings.menu,b.settings.menu=false,b.setMenu(i);if(b.settings.toolbars)i=b.settings.toolbars,b.settings.toolbars=false,b.setToolbars(i);if(b.settings.statusBar)i=b.settings.statusBar,b.settings.statusBar=false,b.setStatusBar(i);b.setAppIcon(b.settings.appIcon);b.setMinimized(b.settings.minimized);
b.setActive(b.settings.active);b.setMinWidth(b.settings.minWidth);b.setMinHeight(b.settings.minHeight);b.tabIndex=0;b.setAlwaysOnTop(b.settings.alwaysOnTop);try{b._close_button.addEventListener("mouseup",b.__closeButtonClick,false)}catch(h){b._close_button.attachEvent("onmouseup",b.__closeButtonClick)}try{b._maximize_button.addEventListener("click",function(a){cancelEvent(a);b.setMaximized(!b.getMaximized())},false)}catch(j){b._maximize_button.attachEvent("click",function(){cancelEvent(window.event);
b.setMaximized(!b.getMaximized())})}b._titlebarHolder.ondblclick=function(a){b.getResizeable()&&(cancelEvent(a),b.setMaximized(!b.getMaximized()))};b._minimize_button.onclick=function(){b.setMinimized(true)};b.onFocusHandler=function(){b.getActive()||(b.setActive(true),b.onCustomEvent("focus",{wnd:b}))};b._titlebarHolder.onmousedown=b.onFocusHandler;b.onmousedown=b.onFocusHandler;b.setActive(false);b.setActive(true);disableSelection(b._titlebarHolder);Keyboard.setFocusCycling(b);if(b.settings.modal)b.settings.modal=
false,b.modal=true;(function(){var a="";Object.defineProperty(b,"applicationState",{get:function(){return a},set:function(c){a!=c&&(a!=""&&removeStyle(b.body,"DOMWindow_AppState_"+a),a=c,a!=""&&addStyle(b.body,"DOMWindow_AppState_"+a))}})})();Keyboard.bindKeyboardHandler(b,"ctrl shift up",function(){document.activeElement==b&&b.setY(b.getY()-10)});Keyboard.bindKeyboardHandler(b,"ctrl shift down",function(){document.activeElement==b&&b.setY(b.getY()+10)});Keyboard.bindKeyboardHandler(b,"ctrl shift left",
function(){document.activeElement==b&&b.setX(b.getX()-10)});Keyboard.bindKeyboardHandler(b,"ctrl shift right",function(){document.activeElement==b&&b.setX(b.getX()+10)});b.dialog=function(a,c){c=c||{};c.childOf=b;return new DialogBox(a,c)};b.addCustomEventListener("redraw",function(){b.onCustomEvent("resizeRun",{width:b.width,height:b.height,wnd:b})});Object.defineProperty(b,"nextWindow",{get:function(){if(!b.childOf||!b.childOf.windows)return null;for(var a=b.childOf,c=a.windows.length,i=0;i<c;i++)if(a.windows[i]==
b&&i<c-1)return a.windows[i+1];switch(true){case !(!getOwnerWindow(a.parentNode)||!getOwnerWindow(a).childOf):return getOwnerWindow(a).childOf.nextWindow;default:return a.windows[0]}}});Object.defineProperty(b,"previousWindow",{get:function(){if(!b.childOf||!b.childOf.windows)return null;for(var a=b.childOf,c=a.windows.length,i=0;i<c;i++)if(a.windows[i]==b&&i>0)return a.windows[i-1];switch(true){case !(!getOwnerWindow(a.parentNode)||!getOwnerWindow(a).childOf):return getOwnerWindow(a).childOf.previousWindow;
default:return a.windows[c-1]}}});b.handlers={};b.appHandler=function(a){if(typeof b.handlers[a]!="undefined")return b.handlers[a].apply(b,Array.prototype.slice.call(arguments,1));else DialogBox("Handler '"+a+"' is not implemented!",{type:"error",childOf:b,caption:"OneDB"})};Object.defineProperty(b,"addCss",{get:function(){return function(a){if(a&&a.length){var c=$("style");c.textContent=a;b.appendChild(c)}return b}}});b.ready=function(){try{for(var a=b.body.querySelectorAll("div,input,textarea,select"),
c=0,i=a.length;c<i;c++)if(a[c].customEventListeners)a[c].onCustomEvent("ready",{app:b})}catch(h){}};return b}Object.defineProperty(window,"activeWindow",{get:function(){var c=document.querySelectorAll("div.DOM2Window.DOM2WindowFocused");return c.length?c[0]:document.body.windows&&document.body.windows.length?document.body.windows[0]:null}});function activateWindow(c){c.minimized=false;c.active=true;for(c=c.childOf;c;)activateWindow(c),c=c.childOf}function DOM2Window(c){return new Dialog(c)}
function getOwnerWindow(c){for(;c;){if(hasStyle(c,"DOM2Window"))return c;c=c.parentNode}return null}
addOnload(function(){var c=function(){for(var a=0;a<document.body.windows.length;a++)if(document.body.windows[a].maximized)document.body.windows[a].width=getMaxX(),document.body.windows[a].height=getMaxY()-(typeof document.body.taskbar!="undefined"?document.body.taskbar.offsetHeight:0),document.body.windows[a].paint()};try{window.addEventListener?window.addEventListener("resize",c,true):window.attachEvent("onresize",c)}catch(a){try{console.error("Could not attach window.resize handler: "+a)}catch(b){console.log("Could not attach window,resize handler: "+
a)}}});
window.getWindowsList=function(c,a){var c=typeof c!="undefined"?c:document.body,a=typeof a=="undefined"?false:!!a,b=[],f;if(typeof c.windows!="undefined"&&c.windows&&c.windows.length)for(var g=0;g<c.windows.length;g++){f={uniqueID:c.windows[g].getUniqueID(),caption:c.windows[g].getCaption(),width:c.windows[g].getWidth(),height:c.windows[g].getHeight(),x:c.windows[g].getX(),y:c.windows[g].getY(),active:c.windows[g].getActive(),minimized:c.windows[g].getMinimized(),minimizeable:c.windows[g].getMinimizeable(),maximized:c.windows[g].getMaximized(),
maximizeable:c.windows[g].getMaximizeable(),modal:c.windows[g].getModal(),resizeable:c.windows[g].getResizeable(),closeable:c.windows[g].getCloseable()};if(a)f.appIcon=c.windows[g].getAppIcon();if(typeof c.windows[g].windows!="undefined")f.windows=getWindowsList(c.windows[g],a);b.push(f)}return b};window.addEventListener("keydown",function(c){if(c.altKey){c=c.keyCode||c.charCode;try{c==81&&activateWindow(activeWindow.nextWindow),c==87&&activateWindow(activeWindow.previousWindow)}catch(a){}}},true);
function DialogBox(c,a){var b=document.activeElement,a=a||{};a.details=(a.details||"").toString().trim();var f=a.details?Math.min(150,a.details.visualHeight())+20:0,g=Math.min((c||"").visualHeight(),300)+(f?20:0)+100,i=new Dialog({width:a.width||Math.min(getMaxX()-100,Math.max((a.labelDetails||"More Details...").visualWidth(),c.visualWidth(),200)+100),height:Math.min(getMaxY()-50,g),caption:a.caption||"Dialog",closeable:false,minimizeable:false,maximizeable:true,modal:typeof a.modal!="undefined"?
!!a.modal:true,childOf:typeof a.childOf!="undefined"?a.childOf:null,minHeight:135,minWidth:300});i.closeCallback=function(){try{b.focus()}catch(a){}return true};a.icon="img/dialog/"+(function(){var b=a.icon||a.type;return["info","error","warning"].indexOf(b)==-1?null:b}()||"info")+".png";a.buttons=a.buttons||{Ok:function(){}};a.keyboard=a.keyboard||{enter:["yes","ok","retry"],esc:["no","cancel","abort","ignore"]};i.insert($("img","Dialog_Icon").setAttr("src",a.icon));if(a.details)i.details=i.insert($("div",
"Dialog_MoreDetails")),i.details.appendChild(i.details.expand=$("img").setAttr("src","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAdtJREFUeNqkUzsvBFEUPjNzZhY7az3CFh4RkfWqNKJFolDoyIaCTlR0SqGhEp0oNKqlEgkRCX6ARIdEZLWWwdrZsY95ufeuO3Zssgon+XLP6ztz7jl3BNd14T+Cc2tPIIpiGBFXiR0jiPzBSRLELctacRznAx3HBoLVgai8GBurhaY6qSL7JWVH4mfpxatbk5pLomEYQBCbGg1CveoCqVwRNGdypIZxKBd1XaeVIo1hkSWUysTSDTuPtvp9/sawBITHroqZTJo5yX3KCvDYbz8dPI+hYXwyxbZtBi6maQKPJRKPJFYsIkkIqqp6Mczlcl4HFEPTF2WDm1y+9/SDjSjk83ngPLQs12srm81De/uIl5xInLOzs3P0Z+/4TNYuAeehICBTstkCaasA++s1XvJgrBjbX/9ZraZVkQICcB55P9VMKRQckGUF0unPkq8VY6U+RQn4Yqgooe/hKNT03b2tbZCdsiyUzYXzMBBgSlJLiZGmesWXdLgpf6/T9L/lVxMIL8k+bGjX0NIz0/quw1B3RzWEgsiGVBwUMHCbQksB7B1n4OlV3L07nz2lvTUE66JdfcM7C2pD7ziA0Fz5X3KfM293J7eX89tG6v6BFqDTCJUN4G+hL0v/EmAAoNXlG97vnHoAAAAASUVORK5CYII=").setAttr("style",
"vertical-align: middle; margin-right: 5px")),i.details.appendChild($text(a.labelDetails||"More Details...")),i.detailsBody=i.details.appendChild($("div","Dialog_MoreDetailsBody").setAttr("style","height: "+f+"px;")),i.detailsBody.appendChild($text(a.details)),function(){var a=false;i.details.onclick=function(){var b=!a,b=!!b;if(b!=a){a=b;var c=-i.detailsBody.offsetHeight;i.detailsBody.style.display=b?"block":"none";i.details.expand.src=b?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAZ1JREFUeNqkkr1OAkEQx+fuhkPgkK8ghYZYGPzo7GjFxMJeQ7TQzljhGxhs9A2MhY0V2muMifoAJpaQGB+Aw0NPjuOA+3J34eg8ME7yT2Y3+/vv7OxwruvCfwL3T+rA83wMEctkXSTKjGFkooplWceO43yj49hAVF7NBUrFjWlIxwVf+kO1M5WHVumlatLlEa/rOhAVt9cjkJBcIM6+ome2CmHGUBY1TaNOmVSMZwcmiVRMAMKxp2K73WKb5D0TG9DGexzqeocltm0zeWGaJi0TOh2D5bY9MBcEBEmSwOOw2+2OKqDK7zz53n5zloNerwceh5bljsoyjB5kswX/f8cG+XYBPA45DlliGH1SVh+uT8O+BooyRQw48DgyPyGW9PsOBAIitFodXwNRDA7BAYeiGB02R6TLiUfY4zAYZImsqHwmnRAnguWmCYST2cW68gqzS7tzXxrkF+dDEI0ga9JvUlSAq9s21Jv8Ze1x754jJslIPLewsnZxKCWXNwG4mTFj1Gh/1u6qzwfnuvr2Tg1oN6J/asAg6GRpPwIMAFcAzawVzQR4AAAAAElFTkSuQmCC":
"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAdtJREFUeNqkUzsvBFEUPjNzZhY7az3CFh4RkfWqNKJFolDoyIaCTlR0SqGhEp0oNKqlEgkRCX6ARIdEZLWWwdrZsY95ufeuO3Zssgon+XLP6ztz7jl3BNd14T+Cc2tPIIpiGBFXiR0jiPzBSRLELctacRznAx3HBoLVgai8GBurhaY6qSL7JWVH4mfpxatbk5pLomEYQBCbGg1CveoCqVwRNGdypIZxKBd1XaeVIo1hkSWUysTSDTuPtvp9/sawBITHroqZTJo5yX3KCvDYbz8dPI+hYXwyxbZtBi6maQKPJRKPJFYsIkkIqqp6Mczlcl4HFEPTF2WDm1y+9/SDjSjk83ngPLQs12srm81De/uIl5xInLOzs3P0Z+/4TNYuAeehICBTstkCaasA++s1XvJgrBjbX/9ZraZVkQICcB55P9VMKRQckGUF0unPkq8VY6U+RQn4Yqgooe/hKNT03b2tbZCdsiyUzYXzMBBgSlJLiZGmesWXdLgpf6/T9L/lVxMIL8k+bGjX0NIz0/quw1B3RzWEgsiGVBwUMHCbQksB7B1n4OlV3L07nz2lvTUE66JdfcM7C2pD7ziA0Fz5X3KfM293J7eX89tG6v6BFqDTCJUN4G+hL0v/EmAAoNXlG97vnHoAAAAASUVORK5CYII=";
i.height+=b?i.detailsBody.offsetHeight:c;i.height=Math.min(i.height,getMaxY()-50)+"px";i.details.style.height=16+(i.detailsBody.offsetHeight?i.detailsBody.offsetHeight+4:0)+"px"}i.paint()}}();i.insert($("div","Dialog_Message").setAnchors({height:function(){return i.height-90-(i.details?i.details.offsetHeight:0)+"px"}})).appendChild($text(c));var h=i.insert($("div","Dialog_ButtonsHolder")),j;for(j in a.buttons)a.buttons.propertyIsEnumerable(j)&&function(b){h.appendChild((new Button(b,function(){a.buttons[b]();
i.closeable=true;i.close()})).setAttr("style","margin: 0px 5px 0px 5px; min-width: 50px;"))}(j);for(var k in a.keyboard)a.keyboard.propertyIsEnumerable(k)&&function(b){Keyboard.bindKeyboardHandler(i,b,function(){for(var c in a.buttons)if(a.buttons.propertyIsEnumerable(c)&&(a.keyboard[b].indexOf(c.toLowerCase())>=0||a.keyboard[b].indexOf(c)))i.closeable=true,i.close()})}(k);addStyle(i,"DOMModalDialog");i.paint();i.focus();return i}
function GetMainDomain(){return window.location.host.split(".").reverse().slice(0,2).reverse().join(".")}function GetDomain(c){return(window.location.protocol||"http:").concat("//").concat(typeof c!="undefined"?c.concat("."):"").concat(GetMainDomain())}function $(c,a){var b=document.createElement(c);if(typeof a!="undefined")b.className=a;return b}function $text(c){return document.createTextNode(c)}function ID(c){return document.getElementById(c)}
function addStyle(c,a){for(var b=c&&c.className&&c.className.length>0?c.className.split(" "):[],f=0;f<b.length;f++)if(b[f]==a)return;b.push(a);c.className=b.join(" ");return c}function removeStyle(c,a){for(var b=c.className&&c.className.length>0?c.className.split(" "):[],f=false,g=0;g<b.length;g++)b[g]==a&&(f=g);if(f!==false)return b.splice(f,1),c.className=b.length>0?b.join(" "):"",c}
function hasStyle(c,a){for(var b=c.className&&c.className.length>0?c.className.split(" "):[],f=0;f<b.length;f++)if(b[f]==a)return true;return false}function cancelEvent(c){if(c=c||window.event)c.cancelBubble=true,c.preventDefault&&c.preventDefault(),c.stopPropagation&&c.stopPropagation()}
function getXY(c){var a=y=0;obj=c;for(var b=0,f=0;obj.parentNode!==null;)f+=obj.scrollLeft,b+=obj.scrollTop,obj=obj.parentNode;obj=c;if(obj.offsetParent){do a+=obj.offsetLeft,y+=obj.offsetTop;while(obj=obj.offsetParent)}return[a-f,y-b]}function getMaxX(){return document.body.innerWidth?document.body.innerWidth:document.documentElement?document.documentElement.clientWidth:document.getElementsByTagName("body")[0].clientWidth}
function getMaxY(){return document.body.innerHeight?document.body.innerHeight:document.documentElement?document.documentElement.clientHeight:document.getElementsByTagName("body")[0].clientHeight}function disableSelection(c){c.style.webkitUserSelect=c.style.userSelect="none"}
function MouseBoundaryCrossing(c,a){var c=c||window.event,b=c.type;this.enteredLandmark=this.leftLandmark=this.inLandmark=false;if(b=="mouseout")this.toElement=c.relatedTarget||c.toElement,this.fromElement=c.target||c.srcElement;else if(b=="mouseover")this.toElement=c.target||c.srcElement,this.fromElement=c.relatedTarget||c.fromElement;else throw Error('Event type "'+b+'" is irrelevant');if(!this.toElement||!this.fromElement)throw Error("Event target(s) undefined");for(var f=this.fromElement;f.nodeType==
1;){if(f==a)break;f=f.parentNode}for(var g=this.toElement;g.nodeType==1;){if(g==a)break;g=g.parentNode}if(f==a&&g==a)this.inLandmark=true;else if(f==a&&g!=a)this.leftLandmark=true,this.inLandmark=b=="mouseout";else if(f!=a&&g==a)this.enteredLandmark=true,this.inLandmark=b=="mouseover"}
function assureVisibility(c){if(c.parentNode){xp=c.parentNode.scrollLeft;yp=c.parentNode.scrollTop;xd=c.offsetLeft;yd=c.offsetTop;switch(true){case yp>yd:c.parentNode.scrollTop=yd-10;break;case yd+c.offsetHeight>c.parentNode.offsetHeight+yp:c.parentNode.scrollTop=yd+c.offsetHeight-c.parentNode.offsetHeight+10}switch(true){case xp>xd:c.parentNode.scrollLeft=xd-10;break;case xd+c.offsetWidth>c.parentNode.offsetWidth+xp:c.parentNode.scrollLeft=xd+c.offsetWidth-c.parentNode.offsetWidth+10}}}
function alpha(c,a){if(typeof c=="undefined"||!c)return false;var b=c.style;try{b.opacity=a/100,b.MozOpacity=a/100,b.KhtmlOpacity=a/100,b.filter="alpha(opacity="+a+")"}catch(f){}}function winMouseX(c){return c.pageX?c.pageX:c.clientX?c.clientX+(document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body.scrollLeft):null}
function winMouseY(c){return c.pageY?c.pageY:c.clientY?c.clientY+(document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop):null}
function relMousePos(c,a){var b=getXY(c),f=[winMouseX(a),winMouseY(a)];return[f[0]-b[0]-(document.body.scrollLeft||window.pageXOffset||(document.body.parentElement?document.body.parentElement.scrollLeft:0)),f[1]-b[1]-(document.body.scrollTop||window.pageYOffset||(document.body.parentElement?document.body.parentElement.scrollTop:0))]}
function HighlightElement(c,a){a=typeof a=="undefined"?true:a;c.style.outline="4px solid red";setTimeout(function(){c.style.outline="none"},1E3);c.focus&&a&&c.focus()}function isChildOf(c,a){return!!(a.compareDocumentPosition(c)&16)}(function(){var c=0;window.uniqueID=function(){c++;return c}})();
function var_dump(c,a,b,f){f=f||0;a=a||10;b=b||" ";if(f>a)return"[WARNING: Too much recursion]\n";var g,i="",h=typeof c,j="";if(c===null)i+="(null)\n";else if(h=="object"){f++;for(g=0;g<f;g++)j+=b;c&&c.length&&(h="array");i+="("+h+") :\n";for(g in c)if(c.propertyIsEnumerable(g))try{i+=j+(h=="array"?"["+g+"]":'"'+g+'"')+" : "+var_dump(c[g],a,b,f+1)}catch(k){return"[ERROR: "+k+"]\n"}}else h=="string"&&c==""&&(c="(empty)"),i+="("+h+") "+c+"\n";return i}
Node.prototype.overlapsWith=function(c){var a=this.offsetLeft,b=this.offsetTop,f=b+this.offsetHeight,g=c.offsetLeft,i=c.offsetTop,h=g+c.offsetWidth,c=i+c.offsetHeight;return!(a+this.offsetWidth<g||a>h||f<i||b>c)};
Object.defineProperty(window,"scrollbarWidth",{get:function(){if(!window.__scrollbarWidth)if(navigator.appName.indexOf("Microsoft Internet Explorer")!=-1){var c=$("textarea");c.setAttribute("cols",10);c.setAttribute("rows",2);c.style.position="absolute";c.style.left="-1000px";c.style.top="-1000px";document.body.appendChild(c);var a=$("textarea");a.setAttribute("cols",10);a.setAttribute("rows",2);a.style.overflow="hidden";a.style.position="absolute";a.style.top="-1000px";a.style.left="-1000px";document.body.appendChild(a);
window.__scrollbarWidth=c.offsetWidth-a.offsetWidth;document.body.removeChild(c);document.body.removeChild(a)}else c=document.body.appendChild($("div").setAttr("style","width: 100px; height: 100px; overflow: auto; position: absolute; left: -1000px; top: -1000px")),a=c.appendChild($("div").setAttr("style","width: 100%; height: 200px")),window.__scrollbarWidth=100-a.offsetWidth,document.body.removeChild(c);return window.__scrollbarWidth}});
function MakeDragable(c,a){var b=true;Object.defineProperty(c,"isDragable",{get:function(){return b},set:function(a){a=!!a;a!=b&&(b=!!a,c.onCustomEvent("dragable-state-change",a))}});c.onCustomEvent("dragable-state-change",true);var a=a||{},f=null,g=null,i=null,h=false,j=null,k=null,l=null,m=function(){window.removeEventListener("mouseup",o,true);window.removeEventListener("mousemove",n,true)},o=function(b){if(j)j.innerHTML="",j.parentNode.removeChild(j),j=null;k!==null&&(document.body.removeChild(k),
k=null);if(h===false)m();else{m();for(var i=b.toElement||b.target,b={ownerWindow:getOwnerWindow(c),source:c,dataType:a.dataType||null,data:l&&l.data?l.data:f,event:b};i!=document.body.parentElement;){try{if(i.isDropable&&(i.onCustomEvent("dragleave"),i.onCustomEvent("drop",b)))return}catch(g){}i=i.parentNode}f=null}},n=function(b){if(f!==null){if(h==false&&(h=true,l=a.getData?a.getData():null,c.onCustomEvent("dragstart",{node:f}),l&&l.tooltip))k=document.body.appendChild($("div","DOMDragDropTooltip")),
k.innerHTML=l.tooltip;if(k!==null){var j=getMousePos(b),m=getXY(b.toElement||b.target);k.style.left=m[0]+j.X+10+"px";k.style.top=m[1]+j.Y-2-k.offsetHeight+"px"}j=b.toElement||b.target;if(j!=i){m=false;for(b={ownerWindow:getOwnerWindow(c),source:c,dataType:a.dataType||null,data:l&&l.data?l.data:f,event:b};j!=document.body.parentElement;){if(j.isDropable){if(j!=g){if(g!==null)try{g.onCustomEvent("dragleave",b)}catch(o){console.error("Dropable::dragleave:: Exception: "+o)}g=j;try{g.onCustomEvent("dragenter",
b)}catch(n){console.error("Dropable::dragenter:: Exception: "+n)}}m=true;break}j=j.parentNode}if(m==false){if(g!==null)try{g.onCustomEvent("dragleave")}catch(u){}g=null}i=j}}};c.addEventListener("mousedown",function(a){if(b&&a.which==1&&(l=i=g=f=null,h=false,a=a.srcElement||a.target,a!=c)){for(;a.parentNode!=c;)a=a.parentNode;f=a;window.addEventListener("mouseup",o,true);window.addEventListener("mousemove",n,true);j=document.body.appendChild($("div"));j.innerHTML="<style>* { -webkit-user-select: none !important; -moz-user-select: none !important; user-select: none !important; cursor: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABoAAAAaCAYAAACpSkzOAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAANgSURBVEiJtZVNaFxVFMd/933NJDNvXmIxGQ0thoAW7Eqh4heJoCABIWIMZBFXQoJZSEuWhQjZNYts4jJCkQZBBBdqpO5jsimFoIYSNcjkY/Jomnmx83Uz77iYN2E6TmNqJ3+4POa+c87vnnPPeQMwA5wTEc5yEY/H7yWTyRWg+yxBhmVZVjqdftl13R+VUs9yVkomk4fr6+syMDBQdl33F+C5Mylde3v735lMRorFogwODpZTqdRd4PmWg9ra2h7s7OyIiIjWWoaHh8upVOpP4FKrQflsNis1VSoVGRsb057nZYCXWtl1Bd/3pV5hGMrExIROpVK7wGstAcViseL+/r4009TU1JHrur5pmm+1AlQ6ODhoChIRmZ6ePnJd975pmoNPBHIcpxwEwSNBIiKzs7MV13VzjuN88H9Blogo0zT/NV+Li4ssLy/r2u/Ozs6k7/s3HMeJl8vlmyfNplLKBrqADmBTRB5YIoJhGMdGWmts28Z1XRYWFrTW+jvLso6BInJZKXUH+A04B6SB7obnU4CquSilbijTNI/y+bzpOA5ra2uMjo6Gq6urRjwep6enRwdBcC2fz1+PTpoE3gMuAU8D1ik/QFmjVrqVlRX6+/v1xsbG3vz8fGiaJpOTk6ZlWR8qpbzI4QrwDvDMCZAQ8IE1oBTtdSulVLi0tKRGRkZ0oVD4Umt9s6Oj44ft7e1YLpejr69PVyqV90ul0h2qfyk15YDdaGWBQ+APwBeRo6gCs1F5qydIJBIl27Y/By6ICJ7n/TQ3NxeKiAwNDZVs2/4GeBH4IlofP9S6cD7a72rYn635WIZhHGqtF7TW10VkFyCXy306MzNzu7e3N7a1tUUsFrO01ufrspGGciWoXn6XUioBiIhs1htYYRhOlMvlWyJy7ziKyK+e5309Pj5+WUQywC1gq/EylFJvABepNscrwGdRCQvAJw+BgK8kyrNeQRB8FATBC0AR2AMuNNoA7wJOZOMD3wK3gb8aDa1mkCgrAdbrTt/M5lr07iLVGfpZRH5vFu+0c/Bf2gHuUs2KaBzSQOyJQdGld0UB08B94KpSqrseECnzOKD6Er8KvH5Kvwrw/eOANql2UxtgnGCXpzrAtWFeFZE99YheaCql1JvA21RL5jcEzAJZETls5vsPIkD9la0zK5IAAAAASUVORK5CYII=) 0 0, auto !important; }</style>"}},
true)}
function MakeDropable(c,a){var a=a||{},b=true;Object.defineProperty(c,"isDropable",{get:function(){return b},set:function(a){a=!!a;a!=b&&(b=a,c.onCustomEvent("dropable-state-change",a))}});a.dragInElements&&function(){var a=null,b=function(b){for(b=b.srcElement||b.target;b.parentNode!=c;)if(b=b.parentNode,b==document.documentElement)return;if(b!=a){if(a!=null)c.onCustomEvent("dragmove-out",a);a=b;c.onCustomEvent("dragmove-in",a)}};c.addCustomEventListener("dragenter",function(){a=null;c.addEventListener("mousemove",b,
true);return true});c.addCustomEventListener("dragleave",function(){c.removeEventListener("mousemove",b,true)})}();c.onCustomEvent("dropable-state-change",true)}
function MakeSortable(c){EnableCustomEventListeners(c);var a;(a=getComputedStyle(c).position)!="relative"&&console.warn("MakeSortable(",c,"): It seems that position is not relative, but '"+a+"'");var b=function(a){a.setAttribute("dragable",1);var b=null,i,h=false,j=false,k=0,l=0,m=0,o=false;new dragObject(a,a,new Position(-2E4,-2E4),new Position(2E4,2E5),function(c,h){k=(new Date).getTime();l=h.offsetLeft;m=h.offsetTop;j=o=false;b&&(b.parentNode&&b.parentNode.removeChild(b),b=null);if(c.which!=1)return cancelEvent(c),
false;b=a.cloneNode(true);b.style.opacity=0.5;i=JSON.parse(JSON.stringify(getComputedStyle(a)));if(i.position!="absolute")i.left="",i.top="",i.right="",i.bottom="",i.position="",i.width=a.style.width,i.height=a.style.height,i.display=a.style.display;i.zIndex=i.zIndex=="auto"?"":i.zIndex},function(i,q){if(!(l==q.offsetLeft&&m==q.offsetTop&&!o)){o=true;if(!j){h=false;a.style.width=a.style.width||a.offsetWidth+"px";a.style.height=a.style.height||a.offsetHeight+"px";a.style.display="block";a.style.position=
"absolute";a.style.zIndex=1E7;for(a.addAfter(b);a.offsetHeight>b.offsetHeight;)a.style.height=parseInt(a.style.height)-1+"px";for(;a.offsetWidth>b.offsetWidth;)a.style.width=parseInt(a.style.width)-1+"px";a.style.left=b.offsetLeft-c.scrollLeft+"px";a.style.top=b.offsetTop-c.scrollTop+"px";j=true}a.style.position="absolute";a.style.display="block";a.style.zIndex=1E7;var p=false,r=c.firstChild;if((new Date).getTime()-k>400){do{var t=a.offsetLeft,w=a.offsetTop,u=w+a.offsetHeight,x=r.offsetLeft,B=r.offsetTop,
A=x+r.offsetWidth,z=B+r.offsetHeight;if(!(t+a.offsetWidth<x||t>A||u<B||w>z)&&a!=r){p=r;break}if(!r.nextSibling)return;r=r.nextSibling}while(1);p!==false&&p!=b&&(b.swapWith(p),h=true)}}},function(){if(j){j=false;a.style.width=i.width;a.style.height=i.height;a.style.position=i.position;a.style.display=i.display;a.style.left=i.left;a.style.top=i.top;a.style.right=i.right;a.style.bottom=i.bottom;a.style.zIndex=i.zIndex;try{b.addBefore(a)}catch(k){console.warn("Could not re-insert original item to dom: ",
k)}try{c.removeChild(b)}catch(l){console.warn(l)}if(h)c.onCustomEvent("change")}},false)};for(a=0;a<c.childNodes.length;a++)b(c.childNodes[a]);c.addEventListener("DOMNodeInserted",function(){for(var a=c.firstChild;a;)a.getAttribute("dragable")||b(a),a=a.nextSibling},true)}Object.defineProperty(HTMLOptionElement.prototype,"icon",{get:function(){return this.getAttribute("data-icon")||null},set:function(c){(c=c||"")?this.setAttribute("data-icon",c):this.removeAttribute("data-icon")}});
Object.defineProperty(HTMLSelectElement.prototype,"syncIcon",{get:function(){return function(){if(this.selectedIndex!=-1&&!this.multiple)this.icon=this.options[this.selectedIndex].icon}}});
Object.defineProperty(HTMLSelectElement.prototype,"icon",{get:function(){return this.getAttribute("data-icon")||null},set:function(c){(c=c||"")?(this.setAttribute("data-icon",c),this.addClass("icon"),this.style.backgroundImage="url("+c+")"):(this.removeAttribute("data-icon"),this.removeClass("icon"),this.style.backgroundImage="")}});
function DropDown(c){var a=$("select");a.addItem=function(b,c,g){var i=$("option");i.value=b;i.text=typeof c!="undefined"?c:b;try{a.add(i,null)}catch(h){a.add(i)}i.icon=g;return i};a.setItems=function(b){if(a.options.length)for(;a.options.length>0;)a.remove(0);for(var c=0;c<b.length;c++)a.addItem((typeof b[c].value!="undefined"?b[c].value:b[c].id).toString(),(b[c].name||b[c].text).toString(),b[c].icon||"").selected=typeof b[c].selected!="undefined"?b[c].selected:false;a.syncIcon();return a};a.addEventListener("change",
function(){a.syncIcon()});typeof c!="undefined"&&a.setItems(c);return a}function ListBox(c){c=new DropDown(c);c.size=2;return c}
function DomDropDownBase(){var c=$("div","DomDropDown");c.__xPadding=4;c.__yPadding=4;c.inner=c.appendChild($("div","DomDropDownInner"));c.optionHolder=c.inner.appendChild($("div","DomOptionHolder"));c.expand=c.inner.appendChild($("button","expand"));c.tabIndex=0;c._expanded=false;EnableCustomEventListeners(c);c.getExpanded=function(){return c._expanded};c.setExpanded=function(a){if(a!=c._expanded)c._expanded=a?true:false,(c._expanded?addStyle:removeStyle)(c,"expanded"),c.onCustomEvent("expand",{source:c,
value:c._expanded})};c.__defineGetter__?(c.__defineGetter__("expanded",c.getExpanded),c.__defineSetter__("expanded",c.setExpanded)):Object.defineProperty&&Object.defineProperty(c,"expanded",{get:c.getExpanded,set:c.setExpanded});try{c.addEventListener("click",function(){c.setExpanded(!c.getExpanded())},false)}catch(a){c.inner.attachEvent("onclick",function(){c.setExpanded(!c.getExpanded())})}return c}
function DomOption(){var c=$("div","DomOption");c._value="";c._text="";c._selected=false;c.getValue=function(){return c._value};c.setValue=function(a){c._value=a};c.getText=function(){return c._text};c.setText=function(a){c.innerHTML="";c.appendChild($text(a));c._text=a};c.getSelected=function(){return c._selected};c.getIndex=function(){if(!c.parentNode||!c.parentNode._parentDropDown)return-1;for(var a=0;a<c.parentNode._parentDropDown._options.length;a++)if(c==c.parentNode._parentDropDown._options[a])return a;
return-1};c.setSelected=function(a,f){f=typeof f=="undefined"?c.parentNode&&c.parentNode._parentDropDown?!c.parentNode._parentDropDown._multiple:false:f;c.parentNode&&c.parentNode._parentDropDown&&a&&c.parentNode._parentDropDown.setSelectedIndex(c.getIndex(),f);c._selected=a?true:false;(c._selected?addStyle:removeStyle)(c,"selected")};c.clickHandler=function(a){a=a||window.event||{ctrlKey:false};c.parentNode._parentDropDown&&c.setSelected(a.ctrlKey&&c.parentNode._parentDropDown._multiple?!c.getSelected():
true,!a.ctrlKey||!c.parentNode._parentDropDown._multiple);try{c.parentNode._parentDropDown.onCustomEvent("change",{srcElement:c.parentNode._parentDropDown})}catch(f){}try{c.parentNode._parentDropDown.setExpanded&&c.parentNode._parentDropDown.setExpanded(false)}catch(g){}};c.mouseOverHandler=function(a){try{var f=new MouseBoundaryCrossing(a,c);switch(true){case f.enteredLandmark:c.parentNode&&c.parentNode._parentDropDown&&c.parentNode._parentDropDown.setFocusedIndex(c.getIndex())}}catch(g){}};c.getHtml=
function(){return c.innerHTML};c.setHTML=function(a){c.innerHTML=a;c.parentNode&&c.parentNode._parentDropDown&&c.parentNode._parentDropDown._selectedIndex==c.getIndex()&&c.setSelected(true)};try{c.addEventListener("click",c.clickHandler,true),c.addEventListener("mouseover",c.mouseOverHandler,true),c.addEventListener("mouseout",c.mouseOverHandler,true)}catch(a){c.attachEvent("onclick",c.clickHandler),c.attachEvent("onmouseover",c.mouseOverHandler),c.attachEvent("onmouseout",c.mouseOverHandler)}c.__defineGetter__?
(c.__defineGetter__("value",c.getValue),c.__defineSetter__("value",c.setValue),c.__defineGetter__("text",c.getText),c.__defineSetter__("text",c.setText),c.__defineGetter__("index",c.getIndex),c.__defineGetter__("html",c.getHtml),c.__defineSetter__("html",c.setHTML),c.__defineGetter__("selected",c.getSelected),c.__defineSetter__("selected",c.setSelected)):Object.defineProperty&&(Object.defineProperty(c,"value",{get:c.getValue,set:c.setValue}),Object.defineProperty(c,"text",{get:c.getText,set:c.setText}),
Object.defineProperty(c,"index",{get:c.getIndex}),Object.defineProperty(c,"html",{get:c.getHtml,set:c.setHtml}),Object.defineProperty(c,"selected",{get:c.getSelected,set:c.setSelected}));return c}
function DomDropDown(c){var a=new DomDropDownBase;a._options=[];a._selectedIndex=-1;a._focusedIndex=-1;a._expander=$("div","DomDropDownExpander");a._expander._parentDropDown=a;a._pinner=new Pinner(a,a._expander,"bottom-left");a._expander.tabIndex=0;a.getOptions=function(){return a._options};a.setFocusedIndex=function(b){for(var c=0;c<a._options.length;c++)(c==b?addStyle:removeStyle)(a._options[c],"hover");a._focusedIndex=b<-1?-1:b>a._options.length-1?a._options.length-1:b};a.getFocusedIndex=function(){return a._focusedIndex};
a.getSelectedIndex=function(){return a._selectedIndex};a.setSelectedIndex=function(b){try{removeStyle(d._options[d._selectedIndex],"selected")}catch(c){}a.optionHolder.innerHTML="";if(b>=0&&b<a._options.length){for(var i=0;i<a._options.length;i++)i!=b&&a._options[i].setSelected(false);a.optionHolder.innerHTML="";i=a._options[b].cloneNode(true);try{i.detachEvent("onclick",i.clickHandler)}catch(h){}a.optionHolder.appendChild(i);a._selectedIndex=b;a._focusedIndex=b;addStyle(a._options[b],"selected")}else if(b==
-1)a._selectedIndex=-1;else throw a._selectedIndex=-1,"DomDropDown.selectedIndex: invalid index!";};a.add=function(b){a._options.push(b);a._expander.appendChild(b);(a._options.length==1||b.getSelected())&&a.setSelectedIndex(a._options.length-1)};a.remove=function(b){if(b>=0&&b<a._options.length)a._selectedIndex==b?a.setSelectedIndex(-1):a._selectedIndex>b&&a._selectedIndex--,a._expander.removeChild(a._options.splice(b,1)[0]);else throw'DomDropDown.remove: Invalid index "'+b+'"';};a.outerBodyClickListener=
function(b){b=b||window.event;for(b=b.target||b.srcElement;b;){if(b==a._expander||b==a)return;b=b.parentNode}a.setExpanded(false)};a.onToggleExpand=function(){switch(a.getExpanded()){case false:document.body.removeChild(a._expander);try{window.removeEventListener("mousedown",a.outerBodyClickListener,true)}catch(b){document.body.detachEvent("onmousedown",a.outerBodyClickListener)}a.focus();break;case true:document.body.appendChild(a._expander);a._expander.style.width=a.offsetWidth-2+"px";a._expander.style.height=
"";if(a._expander.offsetHeight>150)a._expander.style.height="150px";a._pinner.setPinMode("bottom-left");a._expander.offsetTop+a._expander.offsetHeight>getMaxY()&&a._pinner.setPinMode("top-left");try{window.addEventListener("mousedown",a.outerBodyClickListener,true)}catch(c){document.body.attachEvent("onmousedown",a.outerBodyClickListener)}a._expander.focus();try{a._options[a._selectedIndex].scrollIntoView(false)}catch(i){}}};a.focusNextOption=function(b){cancelEvent(b);a._options.length!=0&&(a.setFocusedIndex(a._focusedIndex+
1<a._options.length?a._focusedIndex+1:0),assureVisibility(a._options[a._focusedIndex]))};a.focusPrevOption=function(b){cancelEvent(b);a._options.length!=0&&(a.setFocusedIndex(a._focusedIndex-1>=0?a._focusedIndex-1:a._options.length-1),assureVisibility(a._options[a._focusedIndex]))};a.switchToFocusedOption=function(b){cancelEvent(b);a._options.length!=0&&(a._focusedIndex<0||a._options[a._focusedIndex].clickHandler())};a._expander.keyboardHandler=function(b){b=b||window.event;charCode=Math.max(b.keyCode?
b.keyCode:0,b.charCode?b.charCode:0);if(charCode!=0)switch(charCode){case 40:return a.focusNextOption(b),false;case 38:return a.focusPrevOption(b),false;case 13:return a.switchToFocusedOption(b),false;case 27:return a.setExpanded(false),false}};a.keyboardHandler=function(b){b=b||window.event;charCode=Math.max(b.keyCode?b.keyCode:0,b.charCode?b.charCode:0);if(charCode!=0)switch(charCode){case 40:case 13:case 32:return a.setExpanded(true),cancelEvent(b),false}};try{a._expander.addEventListener("keydown",
a._expander.keyboardHandler,false),a._expander.addEventListener("keypress",function(a){cancelEvent(a)},false),a.addEventListener("keydown",a.keyboardHandler,false)}catch(b){a._expander.attachEvent("onkeydown",a._expander.keyboardHandler),a._expander.attachEvent("onkeypress",function(){window.event.cancelBubble=true;return false}),a.attachEvent("onkeydown",a.keyboardHandler)}a.addCustomEventListener("expand",a.onToggleExpand);a.addItem=function(b,c,i){var h=new DomOption;h.setValue(b);typeof i!="undefined"?
h.innerHTML=i:h.setText(typeof c!="undefined"?c:b);a.add(h);return h};a.setItems=function(b){for(;a._options.length;)a.remove(0);for(var g,i=0;i<b.length;i++)g=a.addItem(b[i].value,b[i].text,c[i].html),b[i].selected&&g.setSelected(true)};a.getValue=function(){return a._selectedIndex>=0&&a._selectedIndex<a._options.length?a._options[a._selectedIndex].getValue():""};a.setValue=function(b){for(var c=0;c<a._options.length;c++)if(a._options[c].getValue()==b)return a.setSelectedIndex(c),b;a.setSelectedIndex(-1);
return""};a.__defineGetter__?(a.__defineGetter__("options",a.getOptions),a.__defineGetter__("items",a.getOptions),a.__defineSetter__("items",a.setItems),a.__defineGetter__("selectedIndex",a.getSelectedIndex),a.__defineSetter__("selectedIndex",a.setSelectedIndex),a.__defineGetter__("value",a.getValue),a.__defineSetter__("value",a.setValue)):Object.defineProperty&&(Object.defineProperty(a,"options",{get:a.getOptions}),Object.defineProperty(a,"items",{get:a.getOptions,set:a.setItems}),Object.defineProperty(a,
"selectedIndex",{get:a.getSelectedIndex,set:a.setSelectedIndex}),Object.defineProperty(a,"value",{get:a.getValue,set:a.setValue}));typeof c!="undefined"&&a.setItems(c);disableSelection(a);disableSelection(a._expander);return a}
function DomListBox(){var c=$("div","DomListBox");EnableCustomEventListeners(c);c._options=[];c._selectedIndex=-1;c._focusedIndex=-1;c._parentDropDown=c;c._multiple=false;c.tabIndex=0;c.getOptions=function(){return c._options};c.setFocusedIndex=function(a){for(var f=0;f<c._options.length;f++)(f==a?addStyle:removeStyle)(c._options[f],"hover");c._focusedIndex=a<-1?-1:a>c._options.length-1?c._options.length-1:a};c.getFocusedIndex=function(){return c._focusedIndex};c.getSelectedIndex=function(){for(var a=
0;a<c._options.length;a++)if(c._options[a].getSelected())return a;return-1};c.setSelectedIndex=function(a,f){f=typeof f!="undefined"?f:true;if(a>=0&&a<c._options.length){if(f)for(var g=0;g<c._options.length;g++)g!=a&&c._options[g].setSelected(false,false);c._selectedIndex=a;c._focusedIndex=a;addStyle(c._options[a],"selected")}else if(a==-1)f&&c._selectedIndex>=0&&c._selectedIndex<c._options.length&&c._options[c._selectedIndex].setSelected(false,false),c._selectedIndex=-1;else throw c._selectedIndex=
-1,"DomDropDown.selectedIndex: invalid index!";};c.getMultiple=function(){return c._multiple};c.setMultiple=function(a){c._multiple=a?true:false};c.add=function(a){c._options.push(a);c.appendChild(a);(c._options.length==1||a.getSelected())&&c.setSelectedIndex(c._options.length-1)};c.remove=function(a){if(a>=0&&a<c._options.length)c._selectedIndex==a?c.setSelectedIndex(-1):c._selectedIndex>a&&c._selectedIndex--,c.removeChild(c._options.splice(a,1)[0]);else throw'DomDropDown.remove: Invalid index "'+
a+'"';};c.focusNextOption=function(a){cancelEvent(a);c._options.length!=0&&(c.setFocusedIndex(c._focusedIndex+1<c._options.length?c._focusedIndex+1:0),assureVisibility(c._options[c._focusedIndex]))};c.focusPrevOption=function(a){cancelEvent(a);c._options.length!=0&&(c.setFocusedIndex(c._focusedIndex-1>=0?c._focusedIndex-1:c._options.length-1),assureVisibility(c._options[c._focusedIndex]))};c.switchToFocusedOption=function(a){cancelEvent(a);c._options.length!=0&&(c._focusedIndex<0||c._options[c._focusedIndex].clickHandler())};
c.keyboardHandler=function(a){a=a||window.event;charCode=Math.max(a.keyCode?a.keyCode:0,a.charCode?a.charCode:0);if(charCode!=0)switch(charCode){case 40:return c.focusNextOption(a),false;case 38:return c.focusPrevOption(a),false;case 13:case 32:return c.switchToFocusedOption(a),false;case 27:if(c._multiple)for(var f=0;f<c._options.length;f++)c._options[f]._selected=false,removeStyle(c._options[f],"selected");cancelEvent(a);c.onCustomEvent("change",{srcElement:c});return false;case 65:if(c._multiple&&
a.ctrlKey)for(f=0;f<c._options.length;f++)addStyle(c._options[f],"selected"),c._options[f]._selected=true,c._selectedIndex=f;cancelEvent(a);c.onCustomEvent("change",{srcElement:c});return false}};try{c.addEventListener("keydown",c.keyboardHandler,false),c.addEventListener("keypress",function(a){cancelEvent(a)},false)}catch(a){c.attachEvent("onkeydown",c.keyboardHandler),c.attachEvent("onkeypress",function(){window.event.cancelBubble=true;return false})}c.addItem=function(a,f,g){var i=new DomOption;
i.setValue(a);typeof g!="undefined"?i.innerHTML=g:i.setText(typeof f!="undefined"?f:a);c.add(i);return i};c.setItems=function(a){for(;c._options.length;)c.remove(0);for(var f,g=0;g<a.length;g++)f=c.addItem(a[g].value,a[g].text,items[g].html),a[g].selected&&f.setSelected(true)};c.getValue=function(){if(c._multiple){for(var a=[],f=0;f<c._options.length;f++)c._options[f].getSelected()&&a.push(c._options[f].getValue());return a}else{for(f=0;f<c._options.length;f++)if(c._options[f].getSelected())return c._options[f].getValue();
return""}};c.setValue=function(a){if(!(a instanceof Array)||c._multiple==false){c._multiple==false&&a instanceof Array&&(a=someting[0]||"");for(var f=0;f<c._options.length;f++)if(c._options[f].getValue()==a)return c._options[f].setSelected(true,true),a;c.setSelectedIndex(-1,true);return""}else{c.setSelectedIndex(-1,true);for(var g=0;g<a.length;g++)for(f=0;f<c._options.length;f++)if(c._options[f].getValue()==a[g]){c._options[f].setSelected(true,false);break}}};c.__defineGetter__?(c.__defineGetter__("options",
c.getOptions),c.__defineGetter__("items",c.getOptions),c.__defineSetter__("items",c.setItems),c.__defineGetter__("selectedIndex",c.getSelectedIndex),c.__defineSetter__("selectedIndex",c.setSelectedIndex),c.__defineGetter__("value",c.getValue),c.__defineSetter__("value",c.setValue),c.__defineGetter__("multiple",c.getMultiple),c.__defineSetter__("multiple",c.setMultiple)):Object.defineProperty&&(Object.defineProperty(c,"options",{get:c.getOptions}),Object.defineProperty(c,"items",{get:c.getOptions,
set:c.setItems}),Object.defineProperty(c,"selectedIndex",{get:c.getSelectedIndex,set:c.setSelectedIndex}),Object.defineProperty(c,"value",{get:c.getValue,set:c.setValue}),Object.defineProperty(c,"multiple",{get:c.getMultiple,set:c.setMultiple}));typeof items!="undefined"&&c.setItems(items);disableSelection(c);return c}
function Effect(c){var a=this;this.effectElement=c;this.effectElement.___effectStack=this.effectElement.___effectStack||[];this.effectThreadID=null;this.threadSpeed=1;this.setSpeed=function(b){if(a.effectThreadID)window.clearInterval(a.effectThreadID),a.effectThreadID=window.setInterval(a.poolQueue,a.threadSpeed);a.threadSpeed=b};this.runOperation=function(b){switch(b.type){case "speed":sp=b.speed;this.setSpeed(sp);break;case "style":for(var c=0;c<b.args.length;c++)a.effectElement.style[b.args[c].param]=
b.args[c].value;break;case "finish":b.callback&&b.callback()}};this.poolQueue=function(){!a.effectElement.___effectStack.length&&a.effectThreadID?(window.clearInterval(a.effectThreadID),a.effectThreadID=null):a.runOperation(a.effectElement.___effectStack.shift())};this.push=function(b){a.effectElement.___effectStack.push(b)};this.start=function(b){typeof b!="undefined"&&a.push({type:"speed",speed:b});if(!a.effectThreadID)a.effectThreadID=window.setInterval(a.poolQueue,a.threadSpped)};this.goTo=function(b,
c,g,i,h){var j=a.effectElement.offsetLeft,k=a.effectElement.offsetTop,l=Math.max(j-b,k-c),i=i>l?l:i,l=(j-b)/i,m=(k-c)/i;a.push({type:"speed",speed:g});for(g=0;g<i;g++)a.push({type:"style",args:[{param:"left",value:Math.floor(j)+"px"},{param:"top",value:Math.floor(k)+"px"}]}),j-=l,k-=m;a.push({type:"style",args:[{param:"left",value:b+"px"},{param:"top",value:c+"px"}]});a.push({type:"finish",callback:h});return a};return this}
(function(){function c(a,b,c){var g=0;this.run=function(){g?g++:(g=1,setTimeout(function(){g=0;a()},b));return this};(typeof c=="undefined"||c)&&this.run();return this}Object.defineProperty(window,"throttle",{get:function(){return function(a,b){return new c(a,b)}}})})();
function StringRegexParser(c,a){if(!c)return a?"/^/":/^/;a=typeof a=="undefined"?true:!!a;if(c instanceof RegExp)return a?c.toString():c;var b=c.toString(),f;if(f=/\/([^*]+)?\/([gi]+)?/.exec(b))try{var g=RegExp(f[1]||"",f[2]||"");return a?g.toString():g}catch(i){return console.warn("String: "+c+" is not a valid regex!"),a?"":/^/}else try{return a?b:RegExp(b)}catch(h){return console.warn("String: "+c+" is not a valid regex!"),a?"":/^/}}
function DOMFile(c){var a=$("div","DOMFile"),c=c||{};EnableCustomEventListeners(a);var b,f=a.appendChild($("div","label")),g;(function(){var b=false;Object.defineProperty(a,"disabled",{get:function(){return b},set:function(c){((b=!!c)?addStyle:removeStyle)(a,"disabled")}})})();var i={chunks:[],chunkIndex:0,aborted:false,isReading:false,serverID:false,setChunks:function(b){i.chunks=b;i.chunkIndex=0;i.serverID=false;i.isReading=true;a.addClass("is-reading");b.length?i.readNext():(a.destination=="memory"&&
(k=""),i.ready());i.serverID=h(a.file.name)},abort:function(b){i.aborted=true;i.isReading=false;a.removeClass("is-reading");a.caption=b||"unknown error";f.appendChild($("a").setHTML("ok").setAttr("src","javascript: ;").setAttr("style","position: absolute; color: red; cursor: pointer; display: block; right: 10px; top: 0px; background-color: white;")).onclick=function(){i.ready();j.value=0;a.caption=""};a.onCustomEvent("error",{reason:b||"unknown error"})},ready:function(){i.isReading=false;a.removeClass("is-reading");
i.aborted=false;j.maxValue=100;j.value=100;if(a.file)a.caption=a.file.name+" ("+a.file.size+" bytes)";b&&b.parentNode&&b.parentNode.removeChild(b);b=a.appendChild($("input").setAttr("type","file").setAttr("title","Load a single file"));b.addEventListener("change",function(b){if(!window.File||!window.FileReader||!window.FileList||!window.Blob)a.caption="HTML5 File support not detected!";else if(b=b.target.files,b.length)a.file=b[0]},true)},readNext:function(){if(!i.aborted){if(i.chunkIndex==0)k=null,
b.disabled=true;(new FileReader).chain(function(){this.addEventListener("load",function(b){if(!i.aborted)i.onCustomEvent("receive",b.target.result);j.value=i.chunks[i.chunkIndex].stop;g=i.chunks[i.chunkIndex].stop/(a.file.size/100)>>0;a.onCustomEvent("progress",{total:a.file.size,current:i.chunks[i.chunkIndex].stop,percent:g});a.caption=a.file.name+" ("+g+"%)";f.appendChild($("a").setHTML("cancel").setAttr("src","javascript: ;").setAttr("style","position: absolute; color: red; cursor: pointer; display: block; right: 10px; top: 0px; background-color: white;")).onclick=
function(){i.abort("Transfer canceled!");j.value=0};l(b.target.result,function(){setTimeout(function(){if(i.chunkIndex<i.chunks.length-1)i.aborted||(i.chunkIndex++,i.readNext());else if(!i.aborted)a.destination=="memory"&&a.dataType=="base64"&&(k="data:"+(a.file?a.file.type:"")+";base64,"+k),a.destination=="memory"&&a.dataType=="binary"&&(k=atob(k)),i.isReading=false,a.onCustomEvent("change")?i.ready():i.abort("File could not be processed")},50)})},true);switch(a.dataType){case "text":this.readAsText(a.file.slice(i.chunks[i.chunkIndex].start,
i.chunks[i.chunkIndex].stop));break;case "binary":this.readAsDataURL(a.file.slice(i.chunks[i.chunkIndex].start,i.chunks[i.chunkIndex].stop));break;case "base64":this.readAsDataURL(a.file.slice(i.chunks[i.chunkIndex].start,i.chunks[i.chunkIndex].stop))}});return true}}},h=function(b){if(a.destination=="memory")return null;var c=[];c.addPOST("do","fopen");c.addPOST("name",b||"");b=$_POST("sessions/0/lib/file-uploader/handler.php",c);if(!b)return i.abort("NULL webservice response"),null;try{b=JSON.parse(b)}catch(h){return i.abort("Unparseable webservice response: "+
b),null}return!b?(i.abort("Bad webservice fopen file id!"),null):b};EnableCustomEventListeners(i);(function(){Object.defineProperty(a,"caption",{get:function(){return""},set:function(a){f.innerHTML="";f.appendChild($text(a))}})})();var j=a.appendChild(new ProgressBar({value:0,minValue:0,maxValue:100}));(function(){var b=false;Object.defineProperty(a,"mime",{get:function(){return b?b.toString():""},set:function(a){i.isReading&&i.abort("Input properties changed!");b=StringRegexParser(a)}})})();(function(){var b=
false;Object.defineProperty(a,"fileNameRegex",{get:function(){return b?b.toString():""},set:function(a){i.isReading&&i.abort("Input properties changed!");b=StringRegexParser(a)}})})();(function(){var b=8388608;Object.defineProperty(a,"maxSize",{get:function(){return b},set:function(a){i.isReading&&i.abort("Input properties changed!");a=parseInt(a);b=isNaN(a)||a<0?0:a}})})();(function(){var b="text";Object.defineProperty(a,"dataType",{get:function(){return b},set:function(a){i.isReading&&i.abort("Input properties changed!");
switch(a){case "text":case "binary":case "base64":b=a;break;default:throw"Bad file dataType: "+a+". Allowed only: text, binary, dataURI!";}}})})();(function(){var b="memory";Object.defineProperty(a,"destination",{get:function(){return b},set:function(c){i.isReading&&i.abort("Input properties changed!");var h=c.toString();if(["memory","server"].indexOf(c)==-1)throw"Invalid destination: '"+c+"' !";b=h;if(b=="server")a.dataType="binary"}})})();var k=null,l=function(b,c){["binary","base64"].indexOf(a.dataType)>=
0&&(b=b.split("base64,").last());if(a.destination=="memory")k=null==k?b:k+b,c();else{var h=[];h.addPOST("do","fwrite");h.addPOST("data",b);h.addPOST("file",i.serverID);b="";$_POST("sessions/0/lib/file-uploader/handler.php",h,function(a){a!="ok"?i.abort(a||"could not write to server"):c()})}};Object.defineProperty(a,"value",{get:function(){return i.isReading?null:k},set:function(){throw"ReadOnly property";}});(function(){var b=null;Object.defineProperty(a,"file",{get:function(){return b},set:function(c){i.isReading&&
i.abort("Input properties changed!");if(!c||!(c instanceof File))throw a.onCustomEvent("error",{reason:"File is too big"}),"Bad file object!";if(a.maxSize&&c.size>a.maxSize)a.caption="File too large ( max = "+a.maxSize.toSize()+" )",a.onCustomEvent("error",{reason:"File is too big"});else if(StringRegexParser(a.mime,false).test(c.type||""))if(a.destination=="server"&&a.dataType!="binary")a.caption="Data type mismatch (server needs binary dataType)",a.onCustomEvent("error",{reason:"When uploading to server, you need a binary data type"});
else if(StringRegexParser(a.fileNameRegex,false).test(c.name||"")){b=c;a.caption=b.name+" (0%)";j.value=0;j.maxValue=b.size;for(var c=[],h=1048576*(a.destination=="memory"?32:0.1)>>0,f=0;f<b.size-1;)c.push({start:f,stop:Math.min(function(){f+=h;return f}(),b.size)});i.setChunks(c);c=void 0}else a.caption="Bad file name or extension!",a.onCustomEvent("error",{reason:"The name of the file did not matched a filter"});else a.caption="Bad file type!",a.onCustomEvent("error",{reason:"The mime-type of the file did not matched a filter"})}})})();
Object.defineProperty(a,"fileName",{get:function(){return a.file?a.file.name:null}});Object.defineProperty(a,"fileSize",{get:function(){return a.file?a.file.size:null}});Object.defineProperty(a,"fileMime",{get:function(){return a.file?a.file.type||"unknown":null}});Object.defineProperty(a,"serverPath",{get:function(){return i.isReading?null:JSON.parse(JSON.stringify(i.serverID))}});a.abort=function(a){i.isReading&&i.abort(a||"Aborted at user request")};i.ready();j.value=0;if(typeof c.maxSize!="undefined")a.maxSize=
c.maxSize;if(typeof c.mime!="undefined")a.mime=c.mime;if(typeof c.fileNameRegex!="undefined")a.fileNameRegex=c.fileNameRegex;if(typeof c.dataType!="undefined")a.dataType=c.dataType;if(typeof c.destination!="undefined")a.destination=c.destination;if(typeof c.disabled!="undefined")a.disabled=!!c.disabled;a.oncontextmenu=function(a){cancelEvent(a)};return a}
function DOMMultipleFile(c){var a=$("div","DOMMultipleFile");EnableCustomEventListeners(a);var b=a.appendChild($("input").setAttr("type","file").setAttr("multiple","multiple").addClass("btn-file").setAttr("title","Upload file(s)")),f=a.appendChild($("input").setAttr("type","file").setAttr("multiple","multiple").addClass("btn-dir").setAttr("webkitdirectory","").setAttr("mozdirectory","").setAttr("directory","").setAttr("title","Upload a Folder")),g=a.appendChild($("div","filesList")),i=[];Object.defineProperty(a,
"files",{get:function(){return i},set:function(a){for(var b=0,c=a.length;b<c;b++)[".",".."].indexOf(a[b].name)==-1&&i.push(a[b]);t()}});a.addEventListener("dragover",function(a){cancelEvent(a);a.dataTransfer.dropEffect="copy"},false);a.addEventListener("drop",function(b){cancelEvent(b);if((b=b.dataTransfer.files)&&b.length)a.files=b},false);b.addEventListener("change",function(c){a.files=c.target.files||[];b.value=null},false);f.addEventListener("change",function(b){for(var c=b.target.files||[],b=
{},i=0,h=0,j=c.length;h<j;h++)i+=c[h].size||0;i=i.toSize();b["<b>Add "+c.length+" file"+(c.length>1?"s":"")+" ("+i+")</b> "]=function(){a.files=c;f.value=null};b["Ooops, cancel that!"]=function(){};DialogBox("You are about to add the whole contents of a folder from your\ncomputer, containing "+c.length+" files.",{type:"warning",childOf:getOwnerWindow(a),buttons:b,caption:"Warning"})},false);var h=false,j=function(){return"["+(new Date).toString("%H:%i:%s")+"]"},k=a.appendChild($("div","label").setHTML('Click on "Choose files" or drop files in this box')),
l=0,m=0,o=0,n=0,q=0,p=0,r=function(){k.innerHTML='<div><b title="Total transfered size" style="color: black">Total</b>: '+(l+p).toSize()+'</div><div><b title="USEFULL UPLOAD SIZE" style="color: green">Ok</b>: '+m.toSize()+'</div><div><b title="GARBAGE UPLOAD SIZE" style="color: red">Fail</b>: '+o.toSize()+"</div>"},t=function(){r();if(!h)if(i.length){h=true;var b=i.shift(),f=new DOMFile(c);console.log("File settings: ",c);g.appendChild(f);f.scrollIntoViewIfNeeded();f.addCustomEventListener("progress",
function(a){p=a.current;r();return true});f.addCustomEventListener("change",function(){if(!a.onCustomEvent("change",{file:f}))return false;m+=b.size;l+=b.size;n++;p=0;r();f.addAfter($("p","succes").setHTML(j()+" <b>"+b.name.htmlEntities()+"</b> ("+b.size.toSize()+")"));f.parentNode.removeChild(f);f=void 0;h=false;i.length||g.appendChild($("p","info").setHTML(j()+" All transfers are complete!")).scrollIntoViewIfNeeded();t();return true});f.addCustomEventListener("error",function(c){f.addAfter($("p",
"error").setHTML(j()+" <b>"+b.name.htmlEntities()+"</b>: "+c.reason.htmlEntities()));f.parentNode.removeChild(f);o+=b.size;l+=b.size;q++;p=0;r();a.onCustomEvent("error",{file:b,reason:c.reason});f=void 0;h=false;i.length||g.appendChild($("p","info").setHTML(j()+" All transfers are complete!")).scrollIntoViewIfNeeded();t();return true});f.disabled=true;f.file=b}else h=false};g.addContextMenu([{caption:"Clear",handler:function(){p=q=n=o=m=l=0;r();for(var a=0,b=g.querySelectorAll("p"),c=b.length;a<c;a++)b[a].parentNode.removeChild(b[a])}},
{caption:"Abort all transfers",handler:function(){!i.length&&!g.querySelectorAll(".DOMFile").length?DialogBox("No transfers are currently in progress!",{type:"info",childOf:getOwnerWindow(a)}):DialogBox("Are you sure you want to cancel all operations?",{type:"question",childOf:getOwnerWindow(a),modal:true,buttons:{"Abort All":function(){for(h=false;i.length>0;)g.appendChild($("p","error")).setHTML(j()+" File <b>"+i[0].name.htmlEntities()+"</b> was aborted"),i.splice(0,1),o+=i.size,l+=fileStack.size;
for(var a=0,b=g.querySelectorAll(".DOMFile"),c=b.length;a<c;a++)b[a].abort(j()+" Aborted by user!");r()},"No, I'll wait":function(){}}})}}]);return a}
var grayscale=function(){var c="color,backgroundColor,borderBottomColor,borderTopColor,borderLeftColor,borderRightColor,backgroundImage".split(","),a={init:function(a,b){if(a.nodeName.toLowerCase()!=="img")f(a).backgroundImageSRC=b,a.style.backgroundImage=""},reset:function(a){if(a.nodeName.toLowerCase()!=="img")a.style.backgroundImage="url("+(f(a).backgroundImageSRC||"")+")"}},b=function(a){return RegExp("https?://(?!"+window.location.hostname+")").test(a)},f=function(){var a=[0],b="data"+ +new Date;
return function(c){var i=c[b],h=a.length;i||(i=c[b]=h,a[i]={});return a[i]}}(),g=function(a,b,c){var i=document.createElement("canvas"),j=i.getContext("2d"),k=a.naturalHeight||a.offsetHeight||a.height,r=a.naturalWidth||a.offsetWidth||a.width,t;i.height=k;i.width=r;j.drawImage(a,0,0);try{t=j.getImageData(0,0,r,k)}catch(w){}if(b){g.preparing=true;var u=0;(function(){if(g.preparing){if(u===k)j.putImageData(t,0,0,0,0,r,k),c?f(c).BGdataURL=i.toDataURL():f(a).dataURL=i.toDataURL();for(var b=0;b<r;b++){var m=
(u*r+b)*4;t.data[m]=t.data[m+1]=t.data[m+2]=h(t.data[m],t.data[m+1],t.data[m+2])}u++;setTimeout(arguments.callee,0)}})()}else{g.preparing=false;for(u=0;u<k;u++)for(b=0;b<r;b++){var x=(u*r+b)*4;t.data[x]=t.data[x+1]=t.data[x+2]=h(t.data[x],t.data[x+1],t.data[x+2])}j.putImageData(t,0,0,0,0,r,k);return i}},i=function(a,b){var c=document.defaultView&&document.defaultView.getComputedStyle?document.defaultView.getComputedStyle(a,null)[b]:a.currentStyle[b];c&&/^#[A-F0-9]/i.test(c)&&(c=c.match(/[A-F0-9]{2}/ig),
c="rgb("+parseInt(c[0],16)+","+parseInt(c[1],16)+","+parseInt(c[2],16)+")");return c},h=function(a,b,c){return parseInt(0.2125*a+0.7154*b+0.0721*c,10)},j=function(a){var b=Array.prototype.slice.call(a.getElementsByTagName("*"));b.unshift(a);return b},k=function(l){if(l&&l[0]&&l.length&&l[0].nodeName)for(var l=Array.prototype.slice.call(l),m=-1,o=l.length;++m<o;)k.call(this,l[m]);else if(l=l||document.documentElement,document.createElement("canvas").getContext){l=j(l);m=-1;for(o=l.length;++m<o;){var n=
l[m];if(n.nodeName.toLowerCase()==="img"){var q=n.getAttribute("src");if(q)if(b(q))a.init(n,q);else{f(n).realSRC=q;try{n.src=f(n).dataURL||g(n).toDataURL()}catch(p){a.init(n,q)}}}else for(var q=0,r=c.length;q<r;q++){var t=c[q],w=i(n,t);if(w)if(n.style[t]&&(f(n)[t]=w),w.substring(0,4)==="rgb(")w=h.apply(null,w.match(/\d+/g)),n.style[t]=w="rgb("+w+","+w+","+w+")";else if(w.indexOf("url(")>-1){var u=/\(['"]?(.+?)['"]?\)/,x=w.match(u)[1];if(b(x))a.init(n,x),f(n).externalBG=true;else try{var B=f(n).BGdataURL||
function(){var a=document.createElement("img");a.src=x;return g(a).toDataURL()}();n.style[t]=w.replace(u,function(){return"("+B+")"})}catch(A){a.init(n,x)}}}}}else l.style.filter="progid:DXImageTransform.Microsoft.BasicImage(grayscale=1)",l.style.zoom=1};k.reset=function(i){if(i&&i[0]&&i.length&&i[0].nodeName)for(var i=Array.prototype.slice.call(i),h=-1,g=i.length;++h<g;)k.reset.call(this,i[h]);else if(i=i||document.documentElement,document.createElement("canvas").getContext){i=j(i);h=-1;for(g=i.length;++h<
g;){var n=i[h];if(n.nodeName.toLowerCase()==="img"){var q=n.getAttribute("src");b(q)&&a.reset(n,q);n.src=f(n).realSRC||q}else for(var q=0,p=c.length;q<p;q++){f(n).externalBG&&a.reset(n);var r=c[q];n.style[r]=f(n)[r]||""}}}else i.style.filter="progid:DXImageTransform.Microsoft.BasicImage(grayscale=0)"};k.prepare=function(a){if(a&&a[0]&&a.length&&a[0].nodeName)for(var a=Array.prototype.slice.call(a),c=-1,h=a.length;++c<h;)k.prepare.call(null,a[c]);else if(a=a||document.documentElement,document.createElement("canvas").getContext){a=
j(a);c=-1;for(h=a.length;++c<h;){var n=a[c];if(f(n).skip)break;if(n.nodeName.toLowerCase()==="img")n.getAttribute("src")&&!b(n.src)&&g(n,true);else{var q=i(n,"backgroundImage");if(q.indexOf("url(")>-1&&(q=q.match(/\(['"]?(.+?)['"]?\)/)[1],!b(q))){var p=document.createElement("img");p.src=q;g(p,true,n)}}}}};return k}();function RenderText(c,a){c.innerHTML="";c.appendChild(document.createTextNode(a===null?"[NULL]":a==""?" ":a))}
function DataRow(){var c=$("div");c.cells=[];c._selected=false;c._selectable=false;c._top=0;c._parent=false;c._visible=false;c.__defineGetter__("selected",function(){return c._selected});c.__defineSetter__("selected",function(a){switch(a){case true:case 1:c._selected=true;addStyle(c,"DOMRowSelected");try{c._parent.parentNode.parentNode.selectedIndex=c.rowIndex}catch(b){}break;case false:case 0:c._selected=false;removeStyle(c,"DOMRowSelected");break;default:throw"DOMRow.property.selected: Invalid value ("+
a+")";}});c._selectHandler=function(a){c._parent.parentNode.parentNode.multiple?a.ctrlKey?c.selected=!c.selected:(c._parent.parentNode.parentNode.multiple=false,c.selected=true,c._parent.parentNode.parentNode.multiple=true):c.selected=true};c.__defineGetter__("selectable",function(){return c._selectable});c.__defineSetter__("selectable",function(a){switch(a){case true:case 1:c._selectable||c.addEventListener("click",c._selectHandler,true);c._selectable=true;break;case false:case 0:c._selectable&&
c.removeEventListener("click",c._selectHandler,true);c._selectable=false;break;default:throw"DataGridRow: invalid value for selectable property ("+a+")";}});c.insertCell=function(a){var b=$("div");b.className="DOMCell";if(typeof a=="undefined"||c.cells.length==0||a>=c.cells.length)b.cellIndex=this.cells.length,c.cells.push(b);else{c.cells.splice(a,0,b);for(var f=a;f<c.cells[a].length;f++)c.cells[f].cellIndex=f}b._renderer=RenderText;b._value=null;b._visible=true;b.html=$("div");b.html.className="DOMCellHTML";
b.appendChild(b.html);b.isEditing=false;b.editor=false;b._editable=false;b.__defineGetter__("value",function(){return this._value});b.__defineSetter__("value",function(a){this._value=a;this._renderer(this.html,a)});b.__defineGetter__("visible",function(){return this._visible});b.__defineSetter__("visible",function(a){this._visible=a;this.style.display=a?"":"none"});b.__defineGetter__("render",function(){return this._renderer});b.__defineSetter__("render",function(a){this._renderer=a;this._renderer(this.html,
this._value)});b.__defineSetter__("width",function(a){this.html.style.width=a});b.__defineGetter__("grid",function(){return this.parentNode.parentNode.parentNode.parentNode});b.__defineGetter__("row",function(){return this.parentNode});b.__defineSetter__("editable",function(a){this._editable=a;if(this._editable===true)this.tabIndex=0});b.__defineGetter__("editable",function(){return this._editable});b.refresh=function(){this.isEditing=false;this._renderer(this.html,this._value)};b.onfocus=function(){if(this._editable!==
false)try{var a;a=this.parentNode.rowIndex===null?"":this.cellIndex+1+","+(this.parentNode.rowIndex+1);this.grid.cellXY.innerHTML="";this.grid.cellXY.appendChild(document.createTextNode(a))}catch(b){}};b.onblur=function(){try{this.grid.cellXY.innerHTML=""}catch(a){}};b.edit=function(){if(this._editable!==false&&this.row.primaryKey!==null&&(this.editor=this.grid.createEditor(this)))this.isEditing=true};b.ondblclick=function(a){!this.isEditing&&this._editable&&this.row.primaryKey&&(this.edit(),cancelEvent(a))};
b.validate=function(a){return this.grid.update(this.grid.getColumnName(this.cellIndex),this.row.primaryKey,a)};return b};c.className="DOMRow";c.enableResizing=function(a,b){var f;f=$("div");f.className="DOMCellResize";f.setAttribute("dragable","1");c.cells[a].resizer=f;c.cells[a].targetGrid=b;c.cells[a].html.appendChild(f);c.cells[a].resizer.cellIndex=a;cell=c.cells[a];f.onclick=function(a){cancelEvent(a)};f.ondblclick=function(a){cancelEvent(a);this.parentNode.parentNode.targetGrid.setAutoColumnWidth(this.cellIndex)};
cell.onColResize=function(a,b){b.offsetLeft<2?b.style.left="2px":b.parentNode.parentNode.targetGrid.setColumnWidth(b.cellIndex,b.offsetLeft+3)};c.cells[a].resizeObject=new dragObject(c.cells[a].resizer,null,new Position(0,0),new Position(1E3,0),null,c.cells[a].onColResize,null,null,true)};c.rowIndex=null;c.primaryKey=null;c.deleteRow=function(){c.parentNode.parentNode.parentNode.delrow(c.primaryKey?c.primaryKey:c.rowIndex)&&c.parentNode.parentNode.parentNode.deleteRow(c.rowIndex)};c.addContextMenu([{caption:"Delete",
handler:c.deleteRow}],function(){if(c.parentNode.parentNode.hasContextMenu){if(c.parentNode.parentNode.parentNode.selectable)c.parentNode.parentNode.parentNode.selectedIndex=c.rowIndex;return true}else return false});c.__defineSetter__("top",function(a){this._top=a;this.style.top=a+"px"});c.__defineGetter__("top",function(){return this._top});c.__defineSetter__("parent",function(a){this._parent=a});c.__defineSetter__("visible",function(a){if(a===true){if(this._visible!==true){for(a=0;a<this.cells.length;a++)this.appendChild(this.cells[a]);
this._parent.appendChild(this);this._visible=true}}else if(this._visible===true){for(a=0;a<this.cells.length;a++)this.removeChild(this.cells[a]);try{this._parent.removeChild(this)}catch(b){}this._visible=false}});c.__defineGetter__("visible",function(){return this._visible});c.__defineGetter__("value",function(){for(var a=[],b=0;b<c.cells.length;b++)a.push(c.cells[b].value);return a});return c}
function CellTextEditor(c){var a=$("input");a.style.backgroundColor="white";a.style.color="black";c.style.backgroundColor="#668";a.className="TextEditor";c.html.innerHTML=" ";c.html.appendChild(a);a.value=c.value===null?"":c.value;a.focus();a.cell=c;a.cellBlur=c.onblur;a.onblur=function(){this.cell.isEditing=false;this.value!=this.cell.value?this.cell.validate(this.value)?this.cell.value=this.value:this.cell.refresh():this.cell.refresh();this.cell.onblur=this.cellBlur;this.cell.style.backgroundColor=
"";this.cell.style.color="";if(this.cellBlur)this.cell.onblur()};return this}
function DataGrid(){var c=$("div");c.className="DOMGrid";var a=$("div");a.className="DOMThead";var b=$("div");b.className="DOMTbody";var f=$("div");f.className="DOMTfoot";var g=$("div");g.className="DOMRowsHolder";b.hasContextMenu=true;c._selectable=false;c._multiple=false;c.__defineGetter__("selectable",function(){return c._selectable});c.__defineSetter__("selectable",function(a){for(var b=0;b<c.tbody.rows.length;b++)c.tbody.rows[b].selectable=a;c._selectable=a});c.__defineGetter__("multiple",function(){return c._multiple});
c.__defineSetter__("multiple",function(a){c._multiple=a?true:false});c._selectedIndex=-1;c._inLoop=false;c.__defineGetter__("selectedIndex",function(){return c._selectedIndex});c.__defineSetter__("selectedIndex",function(a){if(c._inLoop!=true){if(a<-1||a>c.tbody.rows.length-1)throw"DataGrid: invalid selectedIndex ("+a+")";c._inLoop=true;for(var b=0;b<c.tbody.rows.length;b++)if(b==a){if(!c._multiple)c.tbody.rows[b].selected=true}else if(!c._multiple)c.tbody.rows[b].selected=false;c._inLoop=false;c._selectedIndex=
a}});c.__defineGetter__("options",function(){return c.tbody.rows});c.__defineSetter__("options",function(){throw"You tried to modify a read-only property!";});c.cellXY=$("div","DOMGridStatusXY");c.cellXY.title="Current focused cell";f.appendChild(c.cellXY);c.colWidths=false;c.sortFuncs=[];c.currentSortOrder=1;c.currentSortColumn=false;a.rows=[];b.rows=[];c.appendChild(a);c.appendChild(b);c.appendChild(f);c.thead=a;c.tbody=b;c.tfoot=f;c.tholder=g;c.tbody.appendChild(g);c.tholder.noResize=true;c.StringSorter=
function(a,b){return a.value==b.value?0:a.value>b.value?1:-1};c.NumericSorter=function(a,b){if(a.value===b.value)return 0;if(a.value===null)return 1;if(b.value===null)return-1;aa=parseFloat(a.value.replace(/[^0-9.-]/g,""));isNaN(aa)&&(aa=0);bb=parseFloat(b.value.replace(/[^0-9.-]/g,""));isNaN(bb)&&(bb=0);return aa-bb};c.BoolSorter=function(a,b){return a.value&&b.value?0:a.value?1:-1};c.th=function(){var b=new DataRow;b.parent=a;if(arguments.length>0){if(arguments[0]instanceof Array)for(var h=0;h<
arguments[0].length;h++)b.insertCell().setAttr("title",arguments[0][h]).value=arguments[0][h];else for(h=0;h<arguments.length;h++)b.insertCell().setAttr("title",arguments[h]).value=arguments[h];b.visible=true;b.appendChild($("div")).setAttr("class","DOMHeaderPreserveScroll").innerHTML="&nbsp;";if(c.colWidths!==false)try{for(h=0;h<b.cells.length;h++)b.cells[h].width=c.colWidths[h]+"px"}catch(f){throw"DataGrid: Error setting columns widths: "+f;}}a.rows.push(b);a.appendChild(b);if(c.sortFuncs.length<
b.cells.length)for(h=0;h<b.cells.length;h++)c.sortFuncs.push(false);return b};c.insertRow=function(a){var c=new DataRow;c.parent=g;if(typeof a=="undefined"||b.rows.length==0||a>=b.rows.length)c.rowIndex=b.rows.length,c.top=b.rows.length*21,b.rows.push(c);else for(b.rows.splice(a,0,c);a<b.rows.length;a++)b.rows[a].rowIndex=a,b.rows[a].top=a*21;g.style.height=b.rows.length*21+"px";return c};c.deleteRow=function(a){if(a<0||a>b.rows.length-1)throw"DataGrid::deleteRow("+a+"):: Index out of bounds";b.rows[a].visible=
false;for(b.rows.splice(a,1);a<b.rows.length;a++)b.rows[a].rowIndex=a,b.rows[a].top=a*21;c.selectedIndex=-1;c.render()};c.render=function(){for(var a=b.scrollTop,c=Math.floor(a/21),a=Math.ceil((a+b.offsetHeight-a)/21)+c,f=c;f<Math.min(a,b.rows.length);f++)b.rows[f].visible=true;for(f=0;f<c;f++)if(b.rows[f]._visible)b.rows[f].visible=false;for(f=a+1;f<b.rows.length;f++)if(b.rows[f]._visible)b.rows[f].visible=false};b.onscroll=function(){a.scrollLeft=this.scrollLeft;c.render()};c.tr=function(){var a=
c.insertRow();a.selectable=c.selectable;if(arguments.length>0){if(arguments[0]instanceof Array)for(var b=0;b<arguments[0].length;b++)a.insertCell().value=arguments[0][b];else for(b=0;b<arguments.length;b++)a.insertCell().value=arguments[b];if(c.colWidths!==false)try{for(b=0;b<a.cells.length;b++)a.cells[b].width=c.colWidths[b]+"px"}catch(f){throw"DataGrid: Error setting columns widths: "+f;}}return a};c.orderRows=function(a){for(var c=[],f=0;f<b.rows.length;f++)b.rows[a[f]].top=f*21,c.push(b.rows[a[f]]),
c[f].rowIndex=f;b.rows=c;this.render()};c.sortColumn=function(i,h){var f;f=typeof h=="undefined"?i==c.currentSortColumn?1-c.currentSortOrder:0:h;c.currentSortColumn=i;c.currentSortOrder=f;for(var g=0;g<c.thead.rows[0].cells.length;g++)a.rows[0].cells[g].sort_sign.className=g!=i?"sorter":f==0?"sorter DOMSortAscending":"sorter DOMSortDescending";if(!(b.rows.length<2)){var l=false,m=c.NumericSorter;c.sortFuncs[i]||(l=true);for(var o=[],n,g=0;g<b.rows.length;g++){n=b.rows[g].cells[i].value;if(l&&n!==
null&&!n.toString().isDecimal())l=false,c.sortFuncs[i]=c.StringSorter;o.push({ind:g,value:n===null?"":n.toString().toUpperCase()})}l&&(c.sortFuncs[i]=m);o.sort(c.sortFuncs[i]);f==1&&(o=o.reverse());f=[];for(g=0;g<o.length;g++)f.push(o[g].ind);c.orderRows(f)}};c.enableSorting=function(){for(var b,h=0;h<a.rows[0].cells.length;h++)b=$("div"),b.className="sorter",disableSelection(a.rows[0].cells[h]),a.rows[0].cells[h].html.appendChild(b),a.rows[0].cells[h].sort_sign=b,a.rows[0].cells[h].onclick=function(){c.sortColumn(this.cellIndex)}};
c.updateColumnWidths=function(){c.colWidths=[];for(var b=0;b<a.rows[0].cells.length;b++)c.colWidths.push(a.rows[0].cells[b].html.offsetWidth)};c.setColumnWidth=function(i,h){for(var f=0;f<a.rows.length;f++)a.rows[f].cells[i].width=h+"px";for(f=0;f<b.rows.length;f++)b.rows[f].cells[i].width=h+"px";c.updateColumnWidths()};c.setAutoColumnWidth=function(i){for(var h=10,f=0;f<b.rows.length;f++)if(b.rows[f].cells[i].width="auto",h<b.rows[f].cells[i].html.offsetWidth)h=b.rows[f].cells[i].html.offsetWidth;
c.setColumnWidth(i,h);for(f=0;f<a.rows[0].cells.length;f++)a.rows[0].cells[f].resizer.style.left=""};c.enableResizing=function(){if(this.thead.rows.length!=0)for(var a=0;a<c.thead.rows[0].cells.length;a++)c.thead.rows[0].enableResizing(a,this)};c.clear=function(){g.innerHTML="";b.rows=[];g.style.height="0px";c.render();c.selectedIndex=-1};c.getColumnName=function(b){return a.rows[0].cells[b].value};c.createEditor=function(a){return new CellTextEditor(a)};c.delrow=function(){try{console.log("Debug: DataGrid.delrow - You should define the DataGrid.delrow property of this grid!")}catch(a){}return true};
c.update=function(){try{console.log("Debug: DataGrid.update - You should define the DataGrid.update property of this grid!")}catch(a){}return false};c.thead.noResize=true;c.tbody.noResize=true;c.tfoot.noResize=true;c.tbody.DOManchors={__dummy:function(){c.render();return""}};return c}
function HTMLEditor(c,a){var b=$("div","HTMLEditor"),f=b.appendChild($("div").setAttr("id","htmled_"+getUID())),g=false,i=null;Object.defineProperty(b,"value",{get:function(){return g?i.getContent():c},set:function(a){g?i.setContent(a):c=a}});Object.defineProperty(b,"loaded",{get:function(){return!!g}});Object.defineProperty(b,"nativeEditor",{get:function(){return i}});a=a||{};a.plugins=a.plugins||["advlist autolink lists image print preview","visualblocks code fullscreen","insertdatetime media table paste tabfocus"];
b.addContextMenu(function(a){console.log("on: ",a);return[{caption:"here"}]},function(a){return!a.fake?false:true});a.setup=function(h){i=h;i.on("init",function(){i.setContent(c);i.dom.doc.addEventListener("contextmenu",function(a){a.preventDefault();a.stopPropagation();b._contextClickListener(function(a){var c=getXY(b);return{x:a.x+c[0],y:a.y+c[1],clientX:a.clientX+c[0],clientY:a.clientY+c[1],layerX:a.layerX+c[0],layerY:a.layerY+c[1],target:b,fake:true,originalEvent:a}}(a))});i.dom.doc.addEventListener("mousedown",
function(a){try{b._checkClickFunction(a)}catch(c){}});try{getOwnerWindow(b).paint()}catch(h){}g=true;if(a.onload&&a.onload instanceof Function)a.onload()})};a.menubar=false;a.content_css=a.content_css||[];a.width=a.width||100;a.height=a.height||100;a.selector="#"+f.getAttribute("id");a.toolbar=false;var h={_dummy:function(a,c){var i=b.querySelector("iframe");if(i)i.style.width=a+"px",i.style.height=c+"px"}};Object.defineProperty(b,"DOManchors",{get:function(){return h},set:function(a){var a=a||{},
b;for(b in h)b!="_dummy"&&h.propertyIsEnumerable(b)&&(h[b]=void 0,delete h[b]);for(b in a)b!="_dummy"&&a.propertyIsEnumerable(b)&&(h[b]=a[b])}});setTimeout(function(){tinymce.init(a)},10);b.destroy=function(){g&&i.remove();f.innerHTML=""};b.queryCommandState=function(a){return!g?false:i.queryCommandState(a)};b.queryCommandValue=function(a){return!g?false:i.queryCommandValue(a)};b.insertContent=function(a){g?i.insertContent(a):c+=a};Object.defineProperty(b,"document",{get:function(){return!g?false:
i.getDoc()}});Object.defineProperty(b,"body",{get:function(){return!g?false:i.getDoc().body}});Object.defineProperty(b,"window",{get:function(){return!g?false:i.getWin()}});var j=b.focus;b.focus=function(){g?i.focus():j()};Object.defineProperty(b,"selection",{get:function(){return g?i.selection:false}});b.execCommand=function(a,b,c,h){if(g)return i.execCommand(a,b,c,h)};b.on=function(a,b){return g?i.on(a,b):false};b.off=function(a,b){return g?i.off(a,b):false};b.addQueryStateHandler=function(a,b,
c){return g?i.addQueryStateHandler(a,b,c):false};b.addQueryValueHandler=function(a,b,c){return g?i.addQueryValueHandler(a,b,c):false};b.fire=function(){if(g)i.fire.apply(i,Array.prototype.slice.call(arguments,0));else return false};b.addCommand=function(a,b,c){if(g)i.addCommand(a,b,c);else return false};Object.defineProperty(b,"undoManager",{get:function(){return g?i.undoManager:false}});Object.defineProperty(b,"convertURL",{get:function(){return g?i.convertURL:false},set:function(){if(g)i.convertURL=
true;else return false}});return b}
function DOM__HyperDataGrid__Exporter(){var c=new Dialog({width:500,height:400,caption:"Export Grid",modal:true});c.props=c.insert((new PropertyGrid([{name:"selection",label:"What to export",type:"dropdown",values:[{id:"all",name:"All Rows"},{id:"selection",name:"Selection"},{id:"rows",name:"Rows"}],value:"all"},{name:"rows",type:"varchar",value:"",label:"Rows",placeholder:"e.g.: 1, 2-4, 7, 9"},{name:"format",label:"Format",type:"dropdown",values:[{id:"xls",name:"XLS - Microsoft \u00ae Excel"},{id:"pdf",
name:"PDF - Portable Document Format"},{id:"csv",name:"CSV - Comma Sepparated Values"}],value:"xls"},{name:"name",type:"varchar",value:"",label:"Document Name",placeholder:"e.g.: My File (do not use extension)"},{name:"style",expanded:false,label:"Formatting (only for XLS and PDF)",items:[{name:"fontFamily",type:"dropdown",label:"Font Family",values:[{id:"arial",name:"Arial"},{id:"courier",name:"Courier"},{id:"times new roman",name:"Times New Roman"},{id:"verdana",name:"Verdana"}],value:"arial"},
{name:"fontSize",label:"Font Size",type:"int",min:4,max:72,value:12}]},{name:"pdf",label:"PDF Options",expanded:false,items:[{name:"pageSize",label:"Page Size",type:"dropdown",values:[{id:"A6",name:"A6"},{id:"A5",name:"A5"},{id:"A4",name:"A4"},{id:"A3",name:"A3"},{id:"A2",name:"A2"},{id:"A1",name:"A1"},{id:"A0",name:"A0"}],value:"A4"},{name:"pageOrientation",label:"Page Orientation",type:"dropdown",values:[{id:"portrait",name:"Portrait"},{id:"landscape",name:"Landscape"}],value:"portrait"},{name:"marginLeft",
label:"Margin Left",value:"",type:"varchar",placeholder:"e.g.: 1.5cm",regexp:/^([0-9]+(px|cm|mm|inch))?$/},{name:"marginRight",label:"Margin Right",value:"",type:"varchar",placeholder:"e.g.: 1.5cm",regexp:/^([0-9]+(px|cm|mm|inch))?$/},{name:"marginTop",label:"Margin Top",value:"",type:"varchar",placeholder:"e.g.: 1.5cm",regexp:/^([0-9]+(px|cm|mm|inch))?$/},{name:"marginBottom",label:"Margin Bottom",value:"",type:"varchar",placeholder:"e.g.: 1.5cm",regexp:/^([0-9]+(px|cm|mm|inch))?$/}]},{name:"csv",
expanded:false,label:"CSV Options",items:[{name:"fieldDelimiter",type:"varchar",value:"",placeholder:'e.g.: "',label:"Field Delimiter"},{name:"fieldSeparator",type:"varchar",value:"",placeholder:"e.g.: \\t",label:"Field Separator"},{name:"lineSeparator",type:"varchar",value:"",placeholder:"e.g.: \\r\\n (windows), \\n (unix, default)",label:"Line Separator"},{name:"columnNames",type:"dropdown",label:"Column Options",values:[{id:"names",name:"Export Names"},{id:"captions",name:"Export Caption"},{id:"",
name:"Do not export columns"}],value:"names"},{name:"encoding",type:"dropdown",label:"Text Encoding",values:[{id:"utf8",name:"UTF-8"}],value:"utf8"}]}])).setAnchors({width:function(a){return a+"px"},height:function(a,b){return b-45+"px"}}).setAttr("style","display: block; margin-bottom: 5px; margin-top: 5px"));c.insert(new Button("Export",function(){c.doExport()}));c.onFormatChange=function(a){c.props.groups[0].expanded=["xls","pdf"].indexOf(a)!=-1;c.props.groups[1].expanded=["pdf"].indexOf(a)!=-1;
c.props.groups[2].expanded=["csv"].indexOf(a)!=-1};c.onFormatChange("xls");c.props.inputs.format.addEventListener("change",function(){c.onFormatChange(c.props.values.format);c.props.splitPosition=c.props.splitPosition},true);c.props.splitPosition=150;c.doExport=function(){};c.paint();return c}
function HyperDataGrid(c){c=c||{};c.settings=c.settings||{};var a=$("div","DOM_HyperDataGrid");a._bodyHolder=a.appendChild($("div"));a[".body"]=a._bodyHolder.appendChild($("div","DOM_HyperDataGrid_Body"));a.__defineGetter__("body",function(){return a[".body"]});a[".edges"]={".top":a._bodyHolder.appendChild($("div","DOM_HyperDataGrid_TopEdge")),".left":a._bodyHolder.appendChild($("div","DOM_HyperDataGrid_LeftEdge").setAttr("style","bottom: "+(scrollbarWidth+1)+"px"))};a[".edges"][".left"].addContextMenu([{caption:"Hide",
handler:function(){var b=a.selection.byRows;if(b.length){for(var c=0,f=b.length;c<f;c++)b[c].$.row.visible=false;a.onViewportChange()}else if(a.focusedRowIndex>=0)a[".rows"][a.focusedRowIndex].$.row.visible=false,a.onViewportChange()}},{caption:"Show",handler:function(){var b=a.selection.byRowsIndexes;if(b.length<2)alert("At least two rows have to be selected for this operation");else{for(var c=b[0],b=b[b.length-1];c<=b;c++)a[".rows"][c].$.row.visible=true;a.onViewportChange()}}}]);a.__defineGetter__("edges",
function(){return a[".edges"]});a[".edges"][".top"]._inner=a[".edges"][".top"].appendChild($("div"));a[".edges"][".left"]._inner=a[".edges"][".left"].appendChild($("div"));a[".scrollbars"]={".vertical":a._bodyHolder.appendChild($("div","DOM_HyperDataGrid_VerticalScrollbar").setAttr("style","width: "+(scrollbarWidth+1)+"px;")),".horizontal":a._bodyHolder.appendChild($("div","DOM_HyperDataGrid_HorizontalScrollbar").setAttr("style","height: "+(Math.max(scrollbarWidth,20)+1)+"px"))};a[".scrollbars"][".vertical"][".height"]=
a[".scrollbars"][".vertical"].appendChild($("div","DOM_HyperDataGrid_ScrollbarSize"));a[".scrollbars"][".horizontal"][".width"]=a[".scrollbars"][".horizontal"].appendChild($("div","DOM_HyperDataGrid_ScrollbarSize"));a[".topLeftCorner"]=a._bodyHolder.appendChild($("div","DOM_HyperDataGrid_TopLeftCorner"));a[".viewport"]={".top":0,".left":0,".width":0,".height":0};a[".settings"]=c.settings||{};a[".settings"].defaultRowHeight=c.settings.defaultRowHeight||20;a[".settings"].defaultColumnWidth=c.settings.defaultColumnWidth||
100;a.__defineGetter__("settings",function(){return a[".settings"]});a[".selection"]={};a.__defineGetter__("selection",function(){return a[".selection"]});(function(){var b={};b.add=function(c,f){if(!/^[a-z_]([0-9a-z_]+)?$/i.test(c))throw"HyperDataGrid.dataSources.add: Invalid dataSource name. Please use variable-like names!";if(typeof b[c]!="undefined"&&typeof b[".".concat(c)]=="undefined")throw"HyperDataGrid.dataSources.add: Illegal dataSource name!";if(typeof b[".".concat(c)]!="undefined")console.warn("HyperDataGrid.dataSources.add: Warning: Tried to add more than one time the dataSource '"+
c+"', updating it instead. Please use created setter '"+c+"' instead!"),b[c]=f;else{b[".".concat(c)]={};b.__defineGetter__(c,function(){var a;a=b[".".concat(c)];a.__defineGetter__("toArray",function(){var b=[],c;for(c in a)c!="toArray"&&a.propertyIsEnumerable(c)&&b.push({id:c,name:a[c]});return b.sort(function(a,b){var c=a.name.toLowerCase(),i=b.name.toLowerCase();switch(true){case c==i:return 0;case c<i:return-1;default:return 1}})});return a});b.__defineSetter__(c,function(f){var g,j={},k;switch(g=
typeOf(f)){case "object.array":for(k=0,g=f.length;k<g;k++)if(f[k]&&f[k].id&&f[k].name)j[f[k].toString()]=c.toString();else throw"HyperDataGrid.dataSources: Invalid array index found while assigning dataSource '"+c+"'";break;case "object":for(k in f)f.propertyIsEnumerable(k.toString())&&(j[k.toString()]=f[k.toString()].toString());break;default:throw"Illegal data assigned to dataSource '"+c+"': got <"+g+">, but expected a [{id:...,name...}, ...], or a {key:value,...} pattern";}b[".".concat(c)]=j;setTimeout(function(){a.onCustomEvent("dataSourceUpdate",
c)},1)});try{b[c]=f}catch(g){throw delete b[".".concat(c)],delete b[c],g;}a.onCustomEvent("dataSourceAdd","name")}};b.remove=function(c){if(typeof b[".".concat(c)]=="undefined")throw"HyperDataGrid.dataSources.remove: Tried to remove a non-existent dataSource called '"+c+"'";delete b[".".concat(c)];delete b[c];a.onCustomEvent("dataSourceDelete",c)};a.__defineGetter__("dataSources",function(){return b})})();a[".renders"]={string:function(a,b){a.className="DOM_HyperDataGrid_Cell string";a.innerHTML=
"";a.appendChild($text(b===null?"[null]":b==void 0?"[undefined]":b))},"int":function(a,b){a.className="DOM_HyperDataGrid_Cell number";a.innerHTML="";a.appendChild($text(b===null?"[null]":b==void 0?"[undefined]":isNaN(b)?"[NaN]":Math.round(b)))},"float":function(a,b,c,f){a.className="DOM_HyperDataGrid_Cell number";a.innerHTML="";a.appendChild($text(b===null?"[null]":b==void 0?"[undefined]":isNaN(b)?"[NaN]":function(){var a=b.toString().split(".");c&&(a[0]=a[0].lPad(parseInt(c),"0"));f&&(a[1]=a[1]||
"0",a[1]=a[1].rPad(parseInt(f||0),"0").substr(0,parseInt(f)));return f?[a[0],a[1]].join("."):a[0]}()))},"boolean":function(a,b){a.className="DOM_HyperDataGrid_Cell boolean";a.innerHTML="";switch(true){case b===null:a.innerHTML="[null]";removeStyle(a,"true");break;default:b?addStyle(a,"true"):removeStyle(a,"true")}},text:function(a,b,c){a.className="DOM_HyperDataGrid_Cell text";a.innerHTML="";c=c||50;a.appendChild($text(b===null?"[null]":b.toString().substr(0,c).concat(b.toString().length>c?"...":
"")));a.appendChild($("b","text"))},multiple:function(b,c,f){b.className="DOM_HyperDataGrid_Cell multiple";b.innerHTML="";c===null?(b.innerHTML="[null]",b.appendChild($("b","warning"))):a.dataSources[f]?(f=a.dataSources[f],b.appendChild($text(typeof f[c.toString()]=="undefined"?"[not set]":f[c.toString()]))):(b.appendChild($text(c)),b.appendChild($("b","warning")))},date:function(a,b,c,f){a.className="DOM_HyperDataGrid_Cell date";a.innerHTML="";if(b===null)a.innerHTML="[null]",a.appendChild($("b",
"warning"));else try{a.appendChild($text((new Date).fromString(b,c||"%Y-%m-%d").toString(f||"%Y-%m-%d")))}catch(g){a.appendChild($text("[date error]")),console.error(g)}}};a.__defineGetter__("renders",function(){return a[".renders"]});var b;a[".editors"]={string:function(b,c,f){b.innerHTML="";b.editor=b.appendChild((new TextBox("")).setAttr("style","position: absolute; left: 0px; top: 0px; right: 0px; bottom: 0px; display: block; padding: 0px; margin: 0px; border: none; width: 100%; height: 100%"));
b.editor.value=c.$.cells.byName[b.name];b.editor.select();b.editor.focus();b.isEditing=true;b.doneEditing=function(f){if(b.isEditing)b.innerHTML="",c.$.cells.byName[b.name]=f,a.onCustomEvent("rowChange",c)?(delete b.editor,delete b.doneEditing,delete b.cancelEditing,b.isEditing=false):b.cancelEditing()};b.cancelEditing=function(){b.innerHTML="";b.revert();delete b.editor;delete b.cancelEditing;delete b.doneEditing};b.editor.addEventListener("blur",b.editor.done=function(){if(b.isEditing)b.editor.value==
c.$.cells.byName[b.name]?b.cancelEditing():f(b.editor.value,c)&&a.onCustomEvent("rowChange",c)?b.doneEditing(b.editor.value):b.cancelEditing(),b.isEditing=false},true);Keyboard.bindKeyboardHandler(b.editor,"enter",function(){b.editor.done()});Keyboard.bindKeyboardHandler(b.editor,"esc",b.cancelEditing)},text:function(b,c,f){b.innerHTML="";b.editor=b.appendChild((new TextArea("")).setAttr("style","position: absolute; left: 0px; top: 0px; right: 0px; bottom: 0px; display: block; padding: 0px; margin: 0px; border: none; width: 100%; height: 100%"));
b.editor.value=c.$.cells.byName[b.name];b.editor.select();b.editor.focus();b.isEditing=true;b.doneEditing=function(f){if(b.isEditing)b.innerHTML="",c.$.cells.byName[b.name]=f,a.onCustomEvent("rowChange",c)?(delete b.editor,delete b.doneEditing,delete b.cancelEditing,b.isEditing=false):b.cancelEditing()};b.cancelEditing=function(){b.innerHTML="";b.revert();delete b.editor;delete b.cancelEditing;delete b.doneEditing};b.editor.addEventListener("blur",b.editor.done=function(){if(b.isEditing)b.editor.value==
c.$.cells.byName[b.name]?b.cancelEditing():f(b.editor.value,c)&&a.onCustomEvent("rowChange",c)?b.doneEditing(b.editor.value):b.cancelEditing(),b.isEditing=false},true);Keyboard.bindKeyboardHandler(b.editor,"ctrl enter",function(){b.editor.done()});Keyboard.bindKeyboardHandler(b.editor,"esc",b.cancelEditing)},"int":b=function(b,c,f){b.innerHTML="";b.editor=b.appendChild((new Spinner({value:c.$.cells.byName[b.name]})).setAttr("style","position: absolute; left: 0px; top: 0px; right: 0px; bottom: 0px; display: block; padding: 0px; margin: 0px; border: none; width: 100%; height: 100%"));
b.editor.value=c.$.cells.byName[b.name];b.editor.ctl.select();b.editor.ctl.focus();b.isEditing=true;b.doneEditing=function(f){if(b.isEditing)b.innerHTML="",c.$.cells.byName[b.name]=f,a.onCustomEvent("rowChange",c)?(b.isEditing=false,delete b.editor,delete b.doneEditing,delete b.cancelEditing):b.cancelEditing()};b.cancelEditing=function(){b.innerHTML="";b.revert();delete b.editor;delete b.cancelEditing;delete b.doneEditing};b.editor.ctl.addEventListener("blur",b.editor.ctl.done=function(){if(b.isEditing)b.editor.value==
c.$.cells.byName[b.name]?b.cancelEditing():f(b.editor.value,c)&&a.onCustomEvent("rowChange",c)?b.doneEditing(b.editor.value):b.cancelEditing(),b.isEditing=false},true);Keyboard.bindKeyboardHandler(b.editor.ctl,"enter",b.editor.ctl.done);Keyboard.bindKeyboardHandler(b.editor.ctl,"esc",b.cancelEditing)},"float":b,"boolean":function(b,c,f){b.innerHTML="";removeStyle(b,"true");b.isEditing=true;b.editor=b.appendChild($("input").setAttr("type","checkbox"));b.editor.checked=c.$.cells.byName[b.name];b.editor.tabIndex=
0;b.editor.focus();b.cancelEditing=function(){b.isEditing&&(b.removeChild(b.editor),b.revert(),delete b.editor,delete b.cancelEditing,delete b.doneEditing,delete b.onEditReady)};b.doneEditing=function(f){if(b.isEditing)b.removeChild(b.editor),c.$.cells.byName[b.name]=f,a.onCustomEvent("rowChange",c)?(delete b.editor,delete b.doneEditing,delete b.cancelEditing,delete b.onEditReady,b.isEditing=false):b.cancelEditing()};b.onEditReady=function(){if(b.isEditing)b.editor.checked==c.$.cells.byName[b.name]?
b.cancelEditing():f(b.editor.checked,c)&&a.onCustomEvent("rowChange",c)?b.doneEditing(b.editor.checked):b.cancelEditing(),b.isEditing=false};b.editor.addEventListener("blur",b.onEditReady,false);b.editor.addEventListener("mousedown",function(a){cancelEvent(a||window.event)},true);Keyboard.bindKeyboardHandler(b.editor,"enter",b.onEditReady)},multiple:function(b,c,f){var g=a[".columnsByName"][b.name].type.split("|")[1];if(typeof g=="undefined")throw"HyperDataGrid.editCell: No dataSource specified, please use type 'multiple:<data_source_name>', after you add the dataSource with this.dataSources.add() method";
if(typeof a.dataSources[g]=="undefined")throw"HyperDataGrid.editCell: dataSource '"+g+"' is not added (add it with this.dataSources.add() first)!";g=a.dataSources[g].toArray;g.splice(0,0,{id:"",name:"\u25be UnSelected"});var l=c.$.cells.byName[b.name];b.innerHTML="";b.editor=b.appendChild((new DropDown).setItems(g));if(l)b.editor.value=l.toString();b.cancelEditing=function(){b.isEditing&&(b.revert(),delete b.editor,delete b.cancelEditing,delete b.doneEditing,delete b.onEditReady)};b.doneEditing=function(f){if(b.isEditing)b.innerHTML=
"",c.$.cells.byName[b.name]=f,a.onCustomEvent("rowChange",c)?(delete b.editor,delete b.doneEditing,delete b.cancelEditing,delete b.onEditReady,b.isEditing=false):b.cancelEditing()};b.onEditReady=function(){if(b.isEditing)b.editor.value==c.$.cells.byName[b.name]?b.cancelEditing():f(b.editor.value,c)&&a.onCustomEvent("rowChange",c)?b.doneEditing(b.editor.value):b.cancelEditing(),b.isEditing=false};b.editor.addEventListener("change",b.onEditReady,false);b.editor.addEventListener("blur",b.onEditReady,
true);Keyboard.bindKeyboardHandler(b.editor,"enter",b.onEditReady);b.editor.focus();b.isEditing=true},date:function(b,c){var f=a[".columnsByName"][b.name].type.split("|"),g=f[1]||"%Y-%m-%d",l=f[2]||"%Y-%m-%d",f=c.$.cells.byName[b.name];b.innerHTML="";b.editor=b.appendChild(new TextBox((new Date).fromString(f,g).toString(l)));b.isEditing=true;b.editor.focus();b.editor.noEnter=true;b.editor.select();b.editor.overlay=document.body.appendChild(new DatePicker(null,a.inputFormat,f));b.editor.pinner=new Pinner(b.editor,
b.editor.overlay,"top");b.editor.overlay.offsetTop<0&&b.editor.pinner.setPinMode("bottom");b.onBodyScrollFunc=function(){try{b.parentNode.offsetTop+b.parentNode.offsetHeight<0||b.parentNode.offsetTop>a[".body"].offsetHeight?b.editor.overlay.style.display="none":(b.editor.overlay.style.display="block",b.editor.pinner.setPinMode("top",true),b.editor.overlay.offsetTop<0&&b.editor.pinner.setPinMode("bottom",true))}catch(c){}};a.addCustomEventListener("viewportChange",b.onBodyScrollFunc);b.editor.overlay.addCustomEventListener("change",
function(a){b.editor.value=a.DT.toString(l);b.editor.onCustomEvent("change");b.doneEditing()});b.cancelEditing=function(){if(b.isEditing){a.removeCustomEventListener("viewportChange",b.onBodyScrollFunc);try{b.removeChild(b.editor),document.body.removeChild(b.editor.overlay)}catch(c){}try{delete b.editor,delete b.cancelEditing,delete b.doneEditing}catch(h){}b.revert()}};b.doneEditing=function(){if(!b.isEditing||!b.deFocuseable)return false;try{c.$.cells.byName[b.name]=(new Date).fromString(b.editor.value,
l).toString(g)}catch(f){return false}if(a.onCustomEvent("rowChange",c)){try{document.body.removeChild(b.editor.overlay),b.isEditing=false}catch(j){}try{delete b.editor,delete b.cancelEditing,delete b.doneEditing}catch(n){}}else return b.cancelEditing(),false;return true};(function(){var a=true;b.editor.__defineGetter__("deFocuseable",function(){return a});b.editor.__defineSetter__("deFocuseable",function(c){if(!!c!=a)switch(a=!!c,a){case true:removeStyle(b.editor,"disable-focus");break;case false:addStyle(b.editor,
"disable-focus")}})})();b.editor.addCustomEventListener("change",function(){try{(new Date).fromString(b.editor.value,g),b.editor.deFocuseable=true}catch(a){b.editor.deFocuseable=false}});b.editor.addEventListener("blur",function(){b.isEditing&&b.cancelEditing()},true);Keyboard.bindKeyboardHandler(b.editor,"esc",b.cancelEditing);Keyboard.bindKeyboardHandler(b.editor,"enter",f=function(){try{b.doneEditing()||cancelEvent(e),a.focusedRowIndex++}catch(c){}});Keyboard.bindKeyboardHandler(b.editor,"f4",
f)}};a.__defineGetter__("editors",function(){return a[".editors"]});(function(){var b={};a.__defineGetter__("cellParsers",function(){return b});b.addCellParser=function(a,c){if(typeof c!="function")throw"HyperDataGrid: Could not add cellParser '"+a+"': Provided parameter is not a function!";b[a]=c}})();a.cellParsers.addCellParser("int",function(a){return isNaN(a)||!a?0:a});a.cellParsers.addCellParser("float",function(a){return isNaN(a)||!a?0:a});a.cellParsers.addCellParser("boolean",function(a){return a?
0:1});a.cellParsers.addCellParser("string",function(a){return!a?"":a.toString().toLowerCase()});a.cellParsers.addCellParser("text",function(a){return!a?"":a.toString().toLowerCase()});a.cellParsers.addCellParser("date",function(a,b){try{return(new Date).fromString(a,b).getTime()}catch(c){return 0}});a.cellParsers.addCellParser("multiple",function(b,c){try{return!a.dataSources[c][b]?"":a.dataSources[c][b].toString().toLowerCase()}catch(f){return""}});(function(){a[".primaryKey"]=null;a.__defineGetter__("primaryKey",
function(){return a[".primaryKey"]});a.__defineSetter__("primaryKey",function(b){a[".primaryKey"]=b;for(var c=0,f=a[".bindings"].length;c<f;c++)a[".bindings"][c].primaryKey=b})})();a[".columns"]=[];a.__defineGetter__("columns",function(){return a[".columns"]});(function(){var b=false;a[".columns"].__defineGetter__("dragable",function(){return b});a[".columns"].__defineSetter__("dragable",function(c){c=!!c;if(c!=b){for(var f=0,g=a[".columns"].length;f<g;f++)a[".columns"][f].dragable=c;b=c}})})();a[".columnsByName"]=
{};a.__defineGetter__("columnsByName",function(){return a[".columnsByName"]});a[".rows"]=[];a.__defineGetter__("rows",function(){return a[".rows"]});a[".bindings"]=[];a.__defineGetter__("bindings",function(){return a[".bindings"]});a.__defineGetter__("scrollbars",function(){return a[".scrollbars"]});a.__defineGetter__("viewport",function(){return a[".viewport"]});a[".edges"].__defineGetter__("top",function(){return a[".edges"][".top"]});a[".edges"].__defineGetter__("left",function(){return a[".edges"][".left"]});
a.__defineGetter__("topLeftCorner",function(){return a[".topLeftCorner"]});a[".topLeftCorner"].appendChild(a[".topLeftCorner"].rowsSelector=$("div")).appendChild($text("\u25be"));setupTooltip(a[".topLeftCorner"].rowsSelector,'<b style="color: orange">Select or Invert all Rows</b><br />To Invert Selection, hold down<br />the Ctrl key while clicking');a[".topLeftCorner"].appendChild(a[".topLeftCorner"].colsSelector=$("div")).appendChild($text("\u25b8"));setupTooltip(a[".topLeftCorner"].colsSelector,
'<b style="color: orange">Select / Invert all selectable Columns</b><br />To Invert Selection, hold down<br />the Ctrl key while clicking');a[".topLeftCorner"].appendChild(a[".topLeftCorner"].nullSelector=$("div")).appendChild($text("\u2612"));setupTooltip(a[".topLeftCorner"].nullSelector,'<b style="color: orange">Deleselect All</b><br />Rows and Columns');a[".topLeftCorner"].rowsSelector.addEventListener("click",function(b){b=b||window.event;if(a.selectable)for(var c=0,f=a[".rows"].length;c<f;c++)a[".rows"][c].$.row.selected=
!b.ctrlKey?true:!a[".rows"][c].$.row.selected},false);a[".topLeftCorner"].colsSelector.addEventListener("click",function(b){b=b||window.event;if(a.selectable)for(var c=0,f=a[".columns"].length;c<f;c++)if(a[".columns"][c].selectable)a[".columns"][c].selected=!b.ctrlKey?true:!a[".columns"][c].selected},false);a[".topLeftCorner"].nullSelector.addEventListener("click",function(){for(var b=0,c=a[".columns"].length;b<c;b++)if(a[".columns"][b].selectable)a[".columns"][b].selected=false;b=0;for(c=a[".rows"].length;b<
c;b++)a[".rows"][b].$.row.selected=false},false);a[".scrollbars"].__defineGetter__("horizontal",function(){return a[".scrollbars"][".horizontal"]});a[".scrollbars"].__defineGetter__("vertical",function(){return a[".scrollbars"][".vertical"]});a[".edges"][".top"][".height"]=20;a[".edges"][".top"].__defineGetter__("height",function(){return a[".edges"][".top"][".height"]});a[".edges"][".top"].__defineSetter__("height",function(b){b=b||0;b=b>=0?b:0;a[".edges"][".top"][".height"]=b;a[".edges"][".top"].style.height=
b+"px";a[".edges"][".left"].style.top=b+"px";a[".topLeftCorner"].style.height=b+"px";a[".menuHolder"].style.height=b+3+"px";a.body.style.top=b+1+"px";a[".edges"][".top"].onDOMresize(0,0);for(var c=0;c<a[".columns"].length;c++)if(typeof a[".columns"][c]._resizeHandle!="undefined")a[".columns"][c]._resizeHandle.style.height=b+"px";a[".scrollbars"][".vertical"].style.top=b+1+"px";a[".body"].onDOMresize(a.offsetWidth,a.offsetHeight)});a[".edges"][".left"][".width"]=50;a[".edges"][".left"].__defineGetter__("width",
function(){return a[".edges"][".left"][".width"]});a[".edges"][".left"].__defineSetter__("width",function(b){b=b||0;b=b>=0?b:0;a[".edges"][".left"][".width"]=b;a[".edges"][".left"].style.width=b+"px";a[".edges"][".top"].style.left=b+1+"px";a[".topLeftCorner"].style.width=b+"px";a[".scrollbars"][".horizontal"].style.left=b+1+"px";a.body.style.left=b+2+"px";if(a[".lazyInsert"].progress)a[".lazyInsert"].progress.style.width=b-6+"px"});a[".edges"][".top"][".columnShift"]=0;a[".edges"][".top"].__defineGetter__("columnShift",
function(){return a[".edges"][".top"][".columnShift"]});a[".edges"][".top"].__defineSetter__("columnShift",function(b){b=b||0;if(b!=a[".edges"][".top"][".columnShift"]){a[".edges"][".top"][".columnShift"]=b;for(var c=0;c<a[".columns"].length;c++)a[".columns"][c].columnShift=b}});a[".topLeftCorner"].__defineGetter__("width",function(){return a[".edges"][".left"][".width"]});a[".topLeftCorner"].__defineSetter__("width",function(b){a[".edges"][".left"].width=b});a[".topLeftCorner"].__defineGetter__("height",
function(){return a[".edges"][".top"][".height"]});a[".topLeftCorner"].__defineSetter__("height",function(b){a[".edges"][".top"].height=b});a[".scrollbars"][".vertical"][".height"].scSize=0;a[".scrollbars"][".horizontal"][".width"].scSize=0;a[".scrollbars"][".vertical"].__defineGetter__("much",function(){return a[".scrollbars"][".vertical"][".height"].scSize});a[".scrollbars"][".vertical"].__defineSetter__("much",function(b){b=b||0;b=b>=0?b:0;a[".scrollbars"][".vertical"][".height"].scSize=b;a[".scrollbars"][".vertical"][".height"].style.height=
b+"px"});a[".scrollbars"][".vertical"].__defineGetter__("pos",function(){return a[".scrollbars"][".vertical"].scrollTop});a[".scrollbars"][".vertical"].__defineSetter__("pos",function(b){a[".scrollbars"][".vertical"].scrollTop=b||0;a.viewport.top=a[".scrollbars"][".vertical"].scrollTop});a[".scrollbars"][".horizontal"].__defineGetter__("much",function(){return a[".scrollbars"][".horizontal"][".width"].scSize});a[".scrollbars"][".horizontal"].__defineSetter__("much",function(b){b=b||0;b=b>=0?b:0;a[".scrollbars"][".horizontal"][".width"].scSize=
b;a[".scrollbars"][".horizontal"][".width"].style.width=b+"px";for(var c=0;c<a[".bindings"].length;c++)a[".bindings"][c].width=b});a[".scrollbars"][".horizontal"].__defineGetter__("pos",function(){return a[".scrollbars"][".horizontal"].scrollLeft});a[".scrollbars"][".horizontal"].__defineSetter__("pos",function(b){a[".scrollbars"][".horizontal"].scrollLeft=b||0;a.viewport.left=a[".scrollbars"][".horizontal"].scrollLeft});a[".scrollbars"][".horizontal"].addEventListener("scroll",function(){a.viewport.left=
a[".scrollbars"][".horizontal"].scrollLeft},false);a[".scrollbars"][".vertical"].addEventListener("scroll",function(){a.viewport.top=a[".scrollbars"][".vertical"].scrollTop},false);a.body.scrollFunction=function(b){b=b||window.event;switch(true){case typeof window.opera!="undefined":var c=b.wheelDelta/40;break;case typeof b.wheelDelta!="undefined":c=b.wheelDelta/40;break;case typeof b.detail!="undefined":c=-b.detail/3;break;default:c=0}c*=5;b.shiftKey?a.scrollbars.horizontal.pos-=c:a.scrollbars.vertical.pos-=
c};try{a.body.addEventListener("mousewheel",a.body.scrollFunction,false),a.body.addEventListener("DOMMouseScroll",a.body.scrollFunction,false),a[".edges"].left.addEventListener("mousewheel",a.body.scrollFunction,false),a[".edges"].left.addEventListener("DOMMouseScroll",a.body.scrollFunction,false)}catch(f){a.body.attachEvent("onmousewheel",a.body.scrollFunction),a[".edges"].left.attachEvent("onmousewheel",a.body.scrollFunction)}a.onViewportChange=function(){a.onCustomEvent("viewportChange",{top:a[".viewport"][".top"],
left:a[".viewport"][".left"],width:a[".viewport"][".width"],height:a[".viewport"][".height"]})};a[".viewport"].contains=function(b){return b.$.row[".top"]+b.$.row[".height"]>=a[".viewport"][".top"]&&b.$.row[".top"]<=a[".viewport"][".top"]+a[".viewport"][".height"]};a[".viewport"].__defineGetter__("top",function(){return a[".viewport"][".top"]});a[".viewport"].__defineSetter__("top",function(b){b=b||0;b=b>=0?b:0;if(b!=a[".viewport"][".top"]){a[".viewport"][".top"]=b;a[".viewport"][".bottom"]=a[".viewport"][".top"]+
a[".viewport"][".height"];for(b=0;b<a[".bindings"].length;b++)a[".bindings"][b].top=a[".bindings"][b].display.top;a.onViewportChange()}});a[".viewport"].__defineGetter__("left",function(){return a[".viewport"][".left"]});a[".viewport"].__defineSetter__("left",function(b){b=b||0;b=b>=0?b:0;if(b!=a[".viewport"][".left"]){a[".viewport"][".left"]=b;for(var c=0;c<a[".bindings"].length;c++)a[".bindings"][c].left=b;a.onViewportChange()}});a[".viewport"].__defineGetter__("width",function(){return a[".viewport"][".width"]});
a[".viewport"].__defineSetter__("width",function(b){b=b||0;b=b>=0?b:0;b!=a[".viewport"][".width"]&&(a[".viewport"][".width"]=b,a.onViewportChange())});a[".viewport"].__defineGetter__("height",function(){return a[".viewport"][".height"]});a[".viewport"].__defineSetter__("height",function(b){b=b||0;b=b>=0?b:0;b!=a[".viewport"][".height"]&&(a[".viewport"][".height"]=b,a[".viewport"][".bottom"]=a[".viewport"][".top"]+a[".viewport"][".height"],a.onViewportChange())});EnableCustomEventListeners(a);a[".isRendering"]=
false;(function(){a.addCustomEventListener("viewportChange",function(b){a[".isRendering"]=true;a[".edges"][".top"].columnShift=b.left;var c=0,f=a[".rows"].length-1;a[".bindings"].length&&(c=a[".bindings"][0].row.$.row[".index"],f=a[".bindings"][0].row.$.row[".top"]>=a[".scrollbars"][".vertical"].pos?0:a[".rows"].length-1);for(b=a[".bindings"].length-1;b>=0;b--)a[".viewport"].contains(a[".bindings"][b].row)||a.unbindRow(b);c=a.findViewportDisplayIndexes(c,f);if(c!=null)for(b=c.start;b<=c.stop;b++)try{a.bindRow(a[".rows"][b])}catch(g){}a[".isRendering"]=
false;return true})})();a.body.__defineGetter__("width",function(){return a.scrollbars.horizontal.much});a.body.__defineGetter__("height",function(){return a.scrollbars.vertical.much});a.body.__defineSetter__("width",function(b){a.scrollbars.horizontal.much=b});a.body.__defineSetter__("height",function(b){a.scrollbars.vertical.much=b});a.body.__defineGetter__("top",function(){return a.scrollbars.vertical.pos});a.body.__defineGetter__("left",function(){return a.scrollbars.horizontal.pos});a.body.__defineSetter__("top",
function(b){a.scrollbars.vertical.pos=b});a.body.__defineSetter__("left",function(b){a.scrollbars.horizontal.pos=b});a.body.DOManchors={height:function(b,c){return c-a.edges.top.height-Math.max(scrollbarWidth,20)-3+"px"},_dummy:function(){if(a.viewport.width!=a.body.offsetWidth||a.viewport.height!=a.body.offsetHeight)a.viewport.height=a.body.offsetHeight,a.viewport.width=a.body.offsetWidth}};a[".columns"].paint=function(){for(var b=XStart=0;b<a[".columns"].length;b++)a[".columns"][b].left=XStart,
XStart+=a[".columns"][b].visible?a[".columns"][b]._config.width+2:0;return XStart};a.createColumn=function(b,c){c=typeof c!="undefined"?parseInt(c):a[".columns"].length;if(isNaN(c))throw"HyperDataGrid.createColumn: columnIndex is NaN!";if(c<0||c>a[".columns"].length)throw"HyperDataGrid.createColumn: columnIndex outside of bounds!";var f=a[".edges"][".top"]._inner.appendChild($("div","HyperDataGrid_Column"));f._inner=f.appendChild($("div"));f._config={name:null,caption:null,width:a[".settings"][".defaultColumnWidth"],
align:"left",sortable:false,selectable:false,visible:true,type:"string",resizeable:false,left:0,editable:false};f[".columnShift"]=a[".edges"][".top"][".columnShift"];f.__defineGetter__("columnShift",function(){return f[".columnShift"]});f.__defineSetter__("columnShift",function(a){a=a||0;if(a!=f[".columnShift"]){f[".columnShift"]=a;f.style.left=f._config.left-a+"px";if(typeof f._selectOverlay!="undefined")f._selectOverlay.style.left=f.style.left;if(typeof f._resizeHandle!="undefined")f._resizeHandle.style.left=
f._config.left+f._config.width-f[".columnShift"]+1+"px"}});f.__defineGetter__("editable",function(){return f._config.editable});f.__defineSetter__("editable",function(a){a=!!a;if(a!=f._config.editable)switch(f._config.editable=a,a){case true:f._config.validator=f._config.validator||b.validator||function(){console.info("HyperDataGrid.columns["+f.columnIndex+"].validator: Returning TRUE");return true};f.__defineGetter__("validator",function(){return f._config.validator});f.__defineSetter__("validator",
function(a){f._config.validator=a});break;case false:delete f.validator}});a[".columns"].splice(c,0,f);f._config.visible&&(a.body.width+=f._config.width+2);for(var g=f[".columnIndex"]=c;g<a[".columns"].length;g++)a[".columns"][g][".columnIndex"]=g;f.__defineGetter__("columnIndex",function(){return f[".columnIndex"]});f.__defineSetter__("columnIndex",function(b){b=b||0;if(b<0||b>a[".columns"].length-1)throw"HyperDataGrid.column.columnIndex: Index outside bounds!";if(b!=f[".columnIndex"]){var c=f[".columnIndex"];
a[".columns"].swap(c,b);a[".columns"][c][".columnIndex"]=c;a[".columns"][b][".columnIndex"]=b;a[".columns"].paint();try{for(var i=a[".bindings"].length-1;i>=0;i--){try{a[".bindings"][i].cells[a.focusedColumnIndex].cancelEditing()}catch(h){}a.unbindRow(i,true)}a.onCustomEvent("viewportChange",a.viewport)}catch(g){}a[".updateMenu"]()}});f._caption=f._inner.appendChild($("div","HyperDataGrid_ColumnCaption"));f.__defineGetter__("name",function(){return f._config.name});f.__defineSetter__("name",function(b){if(typeof b!=
"string")throw"HyperDataGrid.column.name[setter]: expected string but provided "+typeof b;if(!b.length)throw"HyperDataGrid.column.name[setter]: cannot set an empty name!";if(!/^[a-z0-9_\.]+$/i.test(b))throw'HyperDataGrid.column.name[setter]: property "name" should express a standard programming variable name';if(f._config.name!==null){delete a[".columnsByName"][f._config.name];for(var c=0;c<a[".rows"].length;c++)a.renameDataBindingProperty(a[".rows"][c],f._config.name,b)}f._config.name=b;a[".columnsByName"].__defineGetter__(b,
function(){return f})});f.__defineGetter__("align",function(){return f._config.align});f.__defineSetter__("align",function(b){if(["","left","center","right"].indexOf(b)==-1)throw"HyperDataGrid.column.align[setter]: invalid alignment value!";f._config.align=b;f._caption.style.textAlign=b;for(var c=0;c<a[".bindings"].length;c++)a[".bindings"][c].cells[f[".columnIndex"]].align=b});f.__defineGetter__("caption",function(){return f._config.caption});f.__defineSetter__("caption",function(a){if(typeof a!=
"string")throw"HyperDataGrid.column.caption[setter]: expected string bud provided "+typeof a;f._caption.innerHTML="";f._caption.appendChild($text(a));f._config.caption=a});f.__defineGetter__("width",function(){return f._config.width});f.__defineSetter__("width",function(b){b=b||0;b=b>=0?b:0;f.style.width=b+"px";f._config.width=b;if(typeof f._selectOverlay!="undefined")f._selectOverlay.style.width=b+2+"px";if(typeof f._resizeHandle!="undefined")f._resizeHandle.style.left=f._config.left+f._config.width-
f[".columnShift"]+1+"px";var c=a[".columns"].paint(f[".columnIndex"]);a[".body"].width=c;for(c=0;c<a[".bindings"].length;c++)a[".bindings"][c].width=a.body.width,a[".bindings"][c].cells[f[".columnIndex"]].width=b});f.__defineGetter__("sortable",function(){return f._config.sortable});f.__defineSetter__("sortable",function(b){b=!!b;if(b!=f._config.sortable)switch(f._config.sortable=b,b){case true:f._caption.style.right="16px";f._sortSign=f._inner.appendChild($("div","HyperDataGrid_SortSign"));f._config.sortFunc=
null;f._config.sortOrder=0;f.__defineGetter__("sortFunc",function(){return f._config.sortFunc});f.__defineSetter__("sortFunc",function(a){f._config.sortFunc=a});f.__defineGetter__("sortOrder",function(){return f._config.sortOrder});f.__defineSetter__("sortOrder",function(b){if([-1,0,1].indexOf(b)==-1)throw"HyperGrid.column.sortOrder[setter]: invalid sortOrderValue: expected -1, 0 or 1";f._config.sortOrder=b;a.sortColumnByName(f._config.name,b)});f.clickFunction=function(a){a=a||window.event;if(!a.ctrlKey){switch(f.sortOrder){case 0:case -1:f.sortOrder=
1;break;case 1:f.sortOrder=-1}cancelEvent(a)}};f.addEventListener("click",f.clickFunction,false);break;case false:f._caption.style.right="0px",f._inner.removeChild(f._sortSign),delete f._sortSign,delete f._config.sortOrder,delete f.sortOrder,delete f._config.sortFunc,delete f.sortFunc,f.removeEventListener("click",f.clickFunction,false),delete f.clickFunction}});f.__defineGetter__("selectable",function(){return f._config.selectable});f.__defineSetter__("selectable",function(b){b=!!b;if(b!=f._config.selectable)switch(f._config.selectable=
b,b){case true:f._config.selected=false;f.__defineGetter__("selected",function(){return f._config.selected});f.__defineSetter__("selected",function(b){b=!!b;if(b!=f._config.selected){switch(b){case true:f._selectOverlay=a[".edges"][".top"]._inner.appendChild($("div","HyperDataGrid_ColumnSelector").setAnchors({left:function(){return f.left-f[".columnShift"]+"px"},height:function(){return a.body.offsetHeight+"px"},top:function(){return a[".edges"][".top"].height+1+"px"}}));f._selectOverlay.style.height=
a.body.offsetHeight+"px";f._selectOverlay.style.width=f.width+2+"px";f._selectOverlay.style.left=f.left-f[".columnShift"]+"px";f._selectOverlay.style.top=a[".edges"][".top"].height+1+"px";f._selectOverlay.style.zIndex=0;try{f._selectOverlay.addEventListener("mousewheel",a.body.scrollFunction,false),f._selectOverlay.addEventListener("DOMMouseScroll",a.body.scrollFunction,false)}catch(c){f._selectOverlay.attachEvent("onmousewheel",a.body.scrollFunction)}break;case false:a[".edges"][".top"]._inner.removeChild(f._selectOverlay),
delete f._selectOverlay}f._config.selected=b;a.onCustomEvent("columnsSelectionChanged",f)}});f.toggleSelectClickFunction=function(b){b=b||window.event;if(b.ctrlKey)f.selected=!f.selected;else for(b=0;b<a.columns.length;b++)a.columns[b].selected=a.columns[b]==f?true:false};f.addEventListener("click",f.toggleSelectClickFunction,true);break;case false:f.selected=false,delete f._config.selected,delete f.selected,f.removeEventListener("click",f.toggleSelectClickFunction,true),delete f.toggleSelectClickFunction}});
f.__defineGetter__("visible",function(){return f._config.visible});f.__defineSetter__("visible",function(b){b=!!b;if(b!=f._config.visible){a[".body"].width+=(b?1:-1)*(f._config.width+2);f._config.visible=b;f.style.display=b?"":"none";if(typeof f._selectOverlay!="undefined")f._selectOverlay.style.display=f.style.display;if(typeof f._resizeHandle!="undefined")f._resizeHandle.style.display=f.style.display;a[".columns"].paint(f[".columnIndex"]);for(var c=0;c<a[".bindings"].length;c++)a[".bindings"][c].cells[f[".columnIndex"]].visible=
b}});f.__defineGetter__("type",function(){return f._config.type});f.__defineSetter__("type",function(b){f._config.type=b;for(var c=0;c<a[".bindings"].length;c++)a[".bindings"][c].cells[f[".columnIndex"]].type=b});f.__defineGetter__("left",function(){return f._config.left});f.__defineSetter__("left",function(a){a=a||0;f.style.left=a-f[".columnShift"]+"px";if(typeof f._selectOverlay!="undefined")f._selectOverlay.style.left=f.style.left;f._config.left=a;if(typeof f._resizeHandle!="undefined")f._resizeHandle.style.left=
f._config.left+f._config.width-f[".columnShift"]+1+"px"});f.__defineGetter__("resizeable",function(){return f._config.resizeable});f.__defineSetter__("resizeable",function(b){b=!!b;if(b!=f._config.resizeable)switch(f._config.resizeable=b,b){case true:f._resizeHandle=a[".edges"][".top"]._inner.appendChild($("div","HyperDataGrid_Resizer"));(function(b){b.style.left=f._config.left+f._config.width-f[".columnShift"]+1+"px";b.setAttr("dragable","1");var c;b.onDragBegin=function(){b.style.height=a.offsetHeight-
scrollbarWidth+"px";addStyle(b,"onDrag");c=b.parentNode.appendChild($("div","HyperDataGrid_Resizer_Tooltip_TopHeader"));c.style.left=b.offsetLeft+10+"px";c.innerHTML=f.width+" px"};b.onDragStop=function(){b.style.height=a[".edges"][".top"].height+"px";removeStyle(b,"onDrag");f.width=b.offsetLeft-f._config.left+f[".columnShift"]+1;for(var i=0;i<a[".columns"].length;i++)if(a[".columns"][i]!=f&&a[".columns"][i].selected)a[".columns"][i].width=f.width;c.parentNode.removeChild(c)};b.onDragRun=function(i,
h,g){g=g||window.event;if(g.shiftKey){f.width=b.offsetLeft-f._config.left+f[".columnShift"]+1;c.innerHTML=f.width+" px";for(i=0;i<a[".bindings"].length;i++)a[".bindings"][i].cells[f[".columnIndex"]].width=f._config.width}else i=b.offsetLeft-f._config.left+f[".columnShift"]+1,c.innerHTML=(i>0?i:1)+" px";c.style.left=b.offsetLeft+10+"px"};b.dragger=new dragObject(b,null,new Position(0,0),new Position(1E6,0),b.onDragBegin,b.onDragRun,b.onDragStop,null,true)})(f._resizeHandle);break;case false:a[".edges"][".top"]._inner.removeChild(f._resizeHandle),
f._resizeHandle.dragger.Dispose(),delete f._resizeHandle.dragger,delete f._resizeHandle}});(function(){var b=false,c,i=null;f.__defineGetter__("dragable",function(){return b});f.__defineSetter__("dragable",function(h){h=!!h;if(h!=b){switch(h){case true:f._caption.setAttr("dragable","1");f[".onDragStart"]=function(){c=f.parentNode.appendChild(f.cloneNode(true));alpha(f,50);f.style.zIndex=1E4;f.style.cursor="col-resize";i=f.columnIndex;document.activeElement.blur()};f[".onDragRun"]=function(){if(Math.abs(f.offsetLeft-
c.offsetLeft)<5)h=f.columnIndex,addStyle(c,"DOM_HyperDataGrid_SwapCandidate");else{var b=f.offsetLeft,h=0;if(b>c.offsetLeft&&b<=c.offsetLeft+c.offsetWidth)h=f.columnIndex,addStyle(c,"DOM_HyperDataGrid_SwapCandidate");else for(removeStyle(c,"DOM_HyperDataGrid_SwapCandidate");b>a[".columns"][h].offsetLeft+a[".columns"][h].offsetWidth||h==f.columnIndex;)if(h++,h>=a[".columns"].length-1)break}h>a[".columns"].length-1&&(h=a[".columns"].length-1);h!=i&&(removeStyle(a[".columns"][i],"DOM_HyperDataGrid_SwapCandidate"),
i=h,addStyle(a[".columns"][i],"DOM_HyperDataGrid_SwapCandidate"))};f[".onDragStop"]=function(){c.parentNode.removeChild(c);c=null;alpha(f,100);f.style.cursor="";f.style.zIndex="";f.left=f.left;removeStyle(a[".columns"][i],"DOM_HyperDataGrid_SwapCandidate");f.columnIndex=i};f.setAttr("dragable","1");f[".dragger"]=new dragObject(f,null,new Position(0,0),new Position(5E4,0),f[".onDragStart"],f[".onDragRun"],f[".onDragStop"],null,true);break;case false:f._caption.removeAttribute("dragable"),f[".dragger"].Dispose(),
delete f[".onDragStart"],delete f[".onDragRun"],delete f[".onDragStop"],delete f[".dragger"]}b=h}})})();f.name=b.name;f.caption=b.caption||b.name;f.width=typeof b.width!="undefined"?b.width:100;f.align=typeof b.align!="undefined"?b.align:"left";f.sortable=typeof b.sortable!="undefined"?b.sortable:false;if(f.sortable)f.sortFunc=b.sortFunc||null,f.sortOrder=b.sortOrder||0;f.selectable=typeof b.selectable!="undefined"?b.selectable:true;if(f.selectable)f.selected=typeof b.selected!="undefined"?b.selected:
false;f.visible=typeof b.visible!="undefined"?b.visible:true;f.type=typeof b.type!="undefined"?b.type:"string";f.resizeable=typeof b.resizeable!="undefined"?b.resizeable:false;f.editable=typeof b.editable!="undefined"?b.editable?true:false:false;a[".columns"].paint(c);f.dragable=a[".columns"].dragable;f.addContextMenu([{caption:"Hide",icon:"jsplatform/img/hyperdatagrid/table_column_visible-16x16.png",handler:function(){f.visible=false;a[".updateMenu"]()}}]);a[".updateMenu"]()};(function(){var b=[];
a.__defineGetter__("sortFilters",function(){return b});a.__defineSetter__("sortFilters",function(c){a.onCustomEvent("beforeSort");for(var f=0;f<c.length;f++){if(!c[f]instanceof Object)throw"Sort Item #"+(f+1)+" is not an object!";if(!c[f].name)throw"Sort Item #"+(f+1)+" does not have the name configured!";if(typeof a.columnsByName[c[f].name]=="undefined")throw"Sort Item #"+(f+1)+" column '"+c[f].name+"' is not defined";if(![-1,0,1].indexOf(c[f].order)==-1)throw"Sort Item #"+(f+1)+" column '"+c[f].name+
"': Invalid sort order value!";}var g=[];b=[];for(f=0;f<c.length;f++){var l=c[f];l.order=l.order||1;if(l.order!=0)b.push(l),a[".columnsByName"][l.name]._sortSign.className="HyperDataGrid_SortSign".concat(l.order==1?" SortAscending":" SortDescending"),g.push(l.name)}for(f=0;f<a.columns.length;f++)if(g.indexOf(a.columns[f].name)==-1&&a.columns[f]._sortSign)a.columns[f]._sortSign.className="HyperDataGrid_SortSign";c=null;if(b.length){for(f=a[".bindings"].length-1;f>=0;f--)a.unbindRow(f);for(f=0;f<b.length;f++){for(var g=
[],c=c||[[0,a[".rows"].length-1]],l=b[f].name,m=b[f].order,o=void 0,n=0;n<c.length;n++)for(var o=a.arraySubSortByKey(l,m,c[n][0],c[n][1]),q=0;q<o.length;q++)o[q][0]!=o[q][1]&&g.push(o[q]);c=g;if(!c.length)break}a[".rows"].__updateAfter__(0,true);a.onViewportChange(a.viewport)}a.onCustomEvent("afterSort")})})();a.arraySubSortByKey=function(b,c,f,g){if(g<=f)return[[f,f]];for(var l=[],m=f;m<=g;m++)l.push({index:m,value:a[".rows"][m].$.cells.toString[b]});a._currentSortOrder=c;l.sort(a.columnsByName[b].sortFunc||
function(a,b){return a.value==b.value?0:c*(a.value<b.value?-1:1)});for(var b=l[0].value,g=[f,f],o=[],n=[a[".rows"][l[0].index]],m=1;m<l.length;m++)n.push(a[".rows"][l[m].index]),b==l[m].value?g[1]++:(b=l[m].value,o.push(g),g=[g[1]+1,g[1]+1]);o.push(g);for(m=0;m<n.length;m++)a[".rows"][m+f]=n[m];return o};a.sortColumnByName=function(b,c,f){!c&&a.columns[b]?a.columns[b]._sortSign.className="HyperDataGrid_SortSign":f?(f=a.sortFilters,f.push({name:b,order:c}),a.sortFilters=f):a.sortFilters=[{name:b,order:c}]};
a.addDataBindingProperty=function(b,c){b.$.cells.byName.__defineSetter__(c,function(f){b[c]=f;if(b.$.binding)b.$.binding.cells[a.columnsByName[c].columnIndex].type=a.columnsByName[c].type});b.$.cells.byName.__defineGetter__(c,function(){return typeof b[c]=="undefined"?null:b[c]});b.$.cells.toString.__defineGetter__(c,function(){var f=a[".columnsByName"][c]._config.type.split("|");try{return typeof b[c]=="undefined"?"":a.cellParsers[f[0]](b[c],f[1],f[2])}catch(g){return""}})};a.removeDataBindingProperty=
function(a,b){delete a.$.cells.byName[b];delete a.$.cells.toString[b]};a.renameDataBindingProperty=function(b,c,f){var g=typeof b[c]=="undefined"?null:b[c];delete b[c];a.removeDataBindingProperty(b,c);b[f]=g;a.addDataBindingProperty(b,f)};a[".rows"].enableRowTag=function(a,b){typeof a.$.tags[b]=="undefined"&&function(){var c=null;a.$.tags.__defineGetter__(b,function(){return c});a.$.tags.__defineSetter__(b,function(f){c=f?f:null;a.$.binding&&(f?a.$.binding.handle.setTag(b,f):a.$.binding.handle.setTag(b))})}()};
a[".rows"].setPossibleRowTags=function(b,c,f){var g;if(f)for(g in b.$.tags)b.$.tags.propertyIsEnumerable(g)&&!c[g]&&delete b.$.tags[g];else b.$.tags={};for(g in c)c.propertyIsEnumerable(g)&&!b.$.tags[g]&&a[".rows"].enableRowTag(b,g)};a.getDataBinding=function(b,c){if(typeof b.$!="undefined")return b;b.$={row:{".height":c.height||a[".settings"].defaultRowHeight,".selected":c.selected||false,".visible":typeof c.visible!="undefined"?!!c.visible:true,".top":null,".index":c.index,".selectable":typeof c.selectable!=
"undefined"?!!c.selectable:a[".selectable"],".resizeable":typeof c.resizeable!="undefined"?!!c.resizeable:a[".rows"][".resizeable"]},cells:{byName:{},toString:{}}};a[".rows"].setPossibleRowTags(b,a.tags);b.$.row.__defineGetter__("resizeable",function(){return b.$.row[".resizeable"]});b.$.row.__defineSetter__("resizeable",function(a){a=!!a;if(a!=b.$.row[".resizeable"]&&(b.$.row[".resizeable"]=a,b.$.binding))b.$.binding.resizeable=a});b.$.row.__defineGetter__("height",function(){return b.$.row[".visible"]?
b.$.row[".height"]+1:0});b.$.row.__defineSetter__("height",function(c){c=c||0;if(c!=b.$.row[".height"]){a.body.height+=c-b.$.row[".height"];b.$.row[".height"]=c;if(b.$.binding)b.$.binding.height=c,setTimeout(a.onViewportChange,1);b.$.row[".visible"]&&a[".rows"].__updateAfter__(b.$.row[".index"])}});b.$.row.__defineGetter__("top",function(){return b.$.row[".top"]});b.$.row.__defineSetter__("top",function(c){c=c||0;if(c!=b.$.row[".top"]){b.$.row[".top"]=c;if(b.$.binding)b.$.binding.top=c;a[".rows"].__updateAfter__(b.$.row[".index"]+
1)}});b.$.row.top=c.index==0?0:a[".rows"][c.index-1].$.row[".top"]+a[".rows"][c.index-1].$.row.height;b.$.row.__defineGetter__("selected",function(){return b.$.row[".selected"]});b.$.row.__defineSetter__("selected",function(a){a=!!a;if(a!=b.$.row[".selected"]&&(b.$.row[".selected"]=a,b.$.binding))b.$.binding.selected=a});b.$.row.__defineGetter__("visible",function(){return b.$.row[".visible"]});b.$.row.__defineSetter__("visible",function(c){c=!!c;if(c!=b.$.row[".visible"]){b.$.row[".visible"]=c;if(b.$.binding)b.$.binding.visible=
c;a.body.height+=(c?1:-1)*(b.$.row[".height"]+1);a[".rows"].__updateAfter__(b.$.row[".index"]+1)}});b.$.row.__defineSetter__("selectable",function(a){if(a==!!a!=b.$.row[".selectable"]&&(b.$.row[".selectable"]=a,b.$.binding))b.$.binding.selectable=a});for(var f=0;f<a[".columns"].length;f++)(function(c){b.$.cells.__defineGetter__(c,function(){return typeof b[a[".columns"][c]._config.name]!="undefined"?b[a[".columns"][c]._config.name]:null});b.$.cells.__defineSetter__(c,function(f){b[a[".columns"][c]._config.name]=
f;if(b.$.binding)b.$.binding.cells[c].type=a[".columns"][c]._config.type});a.addDataBindingProperty(b,a[".columns"][c]._config.name)})(f);b.$.cells.__defineGetter__("length",function(){return a[".columns"].length});b.$.__defineGetter__("primaryKey",function(){return a[".primaryKey"]===null?b.$.row[".index"]+1:b.$.cells.byName[a[".primaryKey"]]});return b};a[".rows"][".updateAfterEnabled"]=true;a[".rows"].__defineGetter__("rowUpdatesEnabled",function(){return a[".rows"][".updateAfterEnabled"]});a[".rows"].__defineSetter__("rowUpdatesEnabled",
function(b){b=!!b;b!=a[".rows"][".updateAfterEnabled"]&&(a[".rows"][".updateAfterEnabled"]=b)&&a[".rows"].__updateAfter__(0,true)});a[".rows"].__updateAfter__=function(b,c){if(!(b>=a[".rows"].length)&&a[".rows"][".updateAfterEnabled"])for(var f=b==0?0:a[".rows"][b-1].$.row[".top"]+a[".rows"][b-1].$.row.height,g=b;g<a[".rows"].length;g++){if(c&&(a[".rows"][g].$.row[".index"]=g,a[".primaryKey"]===null&&a[".rows"][g].$.binding))a[".rows"][g].$.binding.primaryKey=null;a[".rows"][g].$.row[".top"]=f;if(a[".rows"][g].$.binding)a[".rows"][g].$.binding.top=
f;a[".rows"][g].$.row[".index"]=g;f+=a[".rows"][g].$.row.height}};var g=function(){var b=null;return function(){b||(b=throttle(function(){var b=a.sortFilters;if(b&&b.length)a.sortFilters=b},50));b.run()}}();a[".lazyInsert"]={threadID:null,progress:null,stack:null,insertPos:0,thread:function(){try{for(var b=0;b<50&&a[".lazyInsert"].insertPos<a[".lazyInsert"].stack.length;)a[".rows"].add(a[".lazyInsert"].stack[a[".lazyInsert"].insertPos].o,a[".lazyInsert"].stack[a[".lazyInsert"].insertPos].i,a[".lazyInsert"].stack[a[".lazyInsert"].insertPos].c,
true),a[".lazyInsert"].insertPos++,b++;a[".lazyInsert"].stack.length==a[".lazyInsert"].insertPos?(a[".lazyInsert"].stack=[],a[".lazyInsert"].insertPos=0,a.lazyInsert=false):(a[".lazyInsert"].progress.maxValue=a[".lazyInsert"].stack.length,a[".lazyInsert"].progress.value=a[".lazyInsert"].insertPos);g()}catch(c){}}};a.__defineGetter__("lazyInsert",function(){return a[".lazyInsert"].stack!==null});a.abortLoading=function(){try{if(a[".lazyInsert"].threadID)window.clearInterval(a[".lazyInsert"].threadID),
a[".lazyInsert"].threadID=null;a[".lazyInsert"].stack=[];a[".lazyInsert"].insertPos=0;try{a._bodyHolder.removeChild(a[".lazyInsert"].progress)}catch(b){}try{a[".lazyInsert"].progress=null}catch(c){}}catch(f){}a.clear()};a.__defineSetter__("lazyInsert",function(b){b=!!b;if(b!=(a[".lazyInsert"].stack!==null))switch(b){case true:a[".lazyInsert"].stack=[];a[".lazyInsert"].threadID=window.setInterval(a[".lazyInsert"].thread,50);a[".lazyInsert"].progress=a._bodyHolder.appendChild((new ProgressBar({value:0,
minValue:0,maxValue:0})).setAttr("style","position: absolute; left: 2px; width: "+(a[".edges"][".left"].width-6)+"px; bottom: 2px; height: 10px; z-index: 1000; display: block;"));a[".lazyInsert"][".startTime"]=(new Date).getTime();break;case false:if(a[".lazyInsert"].stack.length){setTimeout(function(){a.lazyInsert=false},1E3);break}window.clearInterval(a[".lazyInsert"].threadID);a[".lazyInsert"].threadID=null;try{a._bodyHolder.removeChild(a[".lazyInsert"].progress)}catch(c){}a[".lazyInsert"].stack=
null;try{a.onViewportChange()}catch(f){}a.onCustomEvent("ready",{time:(new Date).getTime()-a[".lazyInsert"][".startTime"],rows:a[".lazyInsert"].progress.value});a[".lazyInsert"].progress=null}});a[".rows"][".resizeable"]=false;a[".rows"].__defineGetter__("resizeable",function(){return a[".rows"][".resizeable"]});a[".rows"].__defineSetter__("resizeable",function(b){b=!!b;if(b!=a[".rows"][".resizeable"]){a[".rows"][".resizeable"]=b;for(var c=0;c<a[".rows"].length;c++)a[".rows"][c].$.row.resizeable=
b}});a[".rows"].deleteRow=function(b){if(!a.onCustomEvent("delete",b))return false;a.body.height-=b.$.row[".height"];a.selectable&&a.selectedIndex==b.$.row[".index"]?(a.selectedIndex=-1,a.onCustomEvent("change")):(a[".selectedIndex"]>b.$.row[".index"]&&(a[".selectedIndex"]--,a.onCustomEvent("change")),a[".selectedIndex"]=a[".selectedIndex"]);var c=false;b.$.binding&&(a.unbindRow(b.$.row[".index"],true),c=true);a[".rows"].splice(b.$.row[".index"],1);a[".rows"].__updateAfter__(b.$.row[".index"],true);
if(c)a.onViewportChange()};a[".rows"].clear=function(){if(a.onCustomEvent("clear")){if(a.selectable)a.selectedIndex=-1,a.onCustomEvent("change");a.body.height=0;for(a[".rows"].splice(0,a[".rows"].length);a[".bindings"].length;)a.unbindRow(0,true);var b=a[".lazyInsert"];if(a[".lazyInsert"].stack!==null){window.clearInterval(a[".lazyInsert"].threadID);a[".lazyInsert"].threadID=null;try{a._bodyHolder.removeChild(a[".lazyInsert"].progress)}catch(c){}a[".lazyInsert"].progress=null}b.stack=null}};a[".rows"].add=
function(b,c,f,k){k=k||false;if(!k&&a[".lazyInsert"].stack==null)a.lazyInsert=true;if(!k&&a[".lazyInsert"].stack)return a[".lazyInsert"].stack.push({o:b,i:c,c:f});f=f||{};a[".scrollbars"][".vertical"].much+=f.height||a[".settings"].defaultRowHeight+1;if(a[".scrollbars"][".vertical"][".height"].scSize<=a[".body"].offsetHeight+100)a.onViewportChange();if(c){if(c>a[".rows"].length-1||c<0)throw"HyperDataGrid.add: Index out of bounds!";}else c=a[".rows"].length;f.index=c;b=a.getDataBinding(b,f);a[".rows"].splice(f.index,
0,b);g();a.onCustomEvent("rowInserted",b)};a.findViewportDisplayIndexes=function(b,c){var b=b<0?0:b,b=b>=a[".rows"].length?a[".rows"].length-1:b,c=c<0?0:c,c=c>=a[".rows"].length?a[".rows"].length-1:c,f=b<=c?1:-1;c+=f*300;b-=f*300;b=b<0?0:b;b=b>=a[".rows"].length?a[".rows"].length-1:b;c=c<0?0:c;c=c>=a[".rows"].length?a[".rows"].length-1:c;if(b>=0&&b==c)return{start:b,stop:c};for(var g=b;g!=c;g+=f)if(a[".viewport"].contains(a[".rows"][g])){var l=g;do if(g==c)break;else if(g+=f,!a[".viewport"].contains(a[".rows"][g]))break;
while(g!=c);start1=Math.min(l,g)-1;stop1=Math.max(l,g)+1;l=start1>=0?start1:0;g=stop1<a[".rows"].length?stop1:a[".rows"].length;return{start:l,stop:g}}return null};a.unbindRow=function(b,c){if(!c)for(var f=0;f<a[".columns"].length;f++)if(a[".bindings"][b].cells[f].isEditing)return;a[".edges"][".left"]._inner.removeChild(a[".bindings"][b].handle);a[".bindings"][b].resizer&&a[".edges"][".left"]._inner.removeChild(a[".bindings"][b].resizer);delete a[".body"].removeChild(a[".bindings"].splice(b,1)[0]).row.$.binding};
a.bindRow=function(b){if(!b.$.binding){b.$.binding=$("div","DOM_HyperDataGrid_Row");b.$.binding.addEventListener("dblclick",function(){a.onCustomEvent("dblclick",b)},true);a.focusedRowIndex==b.$.row[".index"]&&addStyle(b.$.binding,"focused");b.$.binding.display={width:0,height:0,top:0,visible:true,left:a[".scrollbars"][".horizontal"].offsetLeft,selectable:false,selectClickFunction:function(c){c=c||window.event;if(c.which!=1)cancelEvent(c);else{var f=false;switch(true){case c.ctrlKey:b.$.row.selected=
!b.$.row.selected;f=true;break;case !c.ctrlKey:f=a.selectedIndex!=b.$.row[".index"]||a.selection.byRows.length!=1,a.selectedIndex=b.$.row[".index"]}if(c.shiftKey&&a[".selectedIndex"]!=-1){f=true;for(c=Math.min(a[".selectedIndex"],b.$.row[".index"]);c<=Math.max(a[".selectedIndex"],b.$.row[".index"]);c++)if(c!=b.$.row[".index"])a[".rows"][c].$.row.selected=b.$.row.selected}b.$.row[".selected"]?c=b.$.row[".index"]:(c=a.selection.byRowsIndexes,f=true,c=c.length?c[c.length-1]:-1);a[".selectedIndex"]=c;
if(f)a.onCustomEvent("change")}},resizeable:false};b.$.binding.handle=a[".edges"][".left"]._inner.appendChild(function(){var b=$("div","DOM_HyperDataGrid_RowHandle");b.tagsHolder=b.appendChild($("div"));b.tagsHolder.style.width=a.tags.length*20+"px";b.b=b.appendChild($("b"));b.tags={};b.setTag=function(c,f){if(typeof f=="undefined"&&b.tags[c])b.tagsHolder.removeChild(b.tags[c]),delete b.tags[c];else if(f)(b.tags[c]=(b.tags[c]||b.tagsHolder.appendChild($("div","DOM_HyperDataGrid_TAG ".concat(a.tags[c].className)))).setAttr("title",
f)).style.left=a.tags[c].left,b.tags[c].style.display="block"};return b}());b.$.binding.onFocusEvent=function(c){if(a.selection.byRowsIndexes.indexOf(b.$.row[".index"])==-1&&!c.ctrlKey)a.selection.byRowsIndexes=[];a.focusedRowIndex=b.$.row[".index"]};b.$.binding.handle.addEventListener("mousedown",b.$.binding.onFocusEvent,true);b.$.binding.addEventListener("focus",b.$.binding.onFocusEvent,true);b.$.binding.__defineSetter__("selectable",function(a){b.$.binding.display.selectable=!!a;switch(b.$.binding.display.selectable){case false:b.$.binding.handle.removeEventListener("mousedown",
b.$.binding.display.selectClickFunction,true);break;case true:b.$.binding.handle.addEventListener("mousedown",b.$.binding.display.selectClickFunction,true)}});b.$.binding.__defineSetter__("width",function(a){b.$.binding.style.width=(b.$.binding.display.width=a||0)+"px"});b.$.binding.__defineSetter__("top",function(c){var f=a[".scrollbars"][".vertical"].scrollTop;b.$.binding.style.top=b.$.binding.handle.style.top=(b.$.binding.display.top=c||0)-f+"px";if(b.$.binding.resizer)b.$.binding.resizer.style.top=
b.$.binding.display.top-f+b.$.binding.display.height+"px"});b.$.binding.__defineSetter__("visible",function(a){b.$.binding.style.display=b.$.binding.handle.style.display=(b.$.binding.display.visible=!!a)?"":"none";if(b.$.binding.resizer)b.$.binding.resizer.style.display=a?"":"none"});b.$.binding.__defineSetter__("height",function(c){for(var f=b.$.binding.style,h=b.$.binding.handle.style,g=b.$.binding.display,c=c||0,j=0;j<a[".columns"].length;j++)b.$.binding.cells[j].style.height=c-4+"px";f.height=
h.height=(g.height=c)+"px";if(b.$.binding.resizer)b.$.binding.resizer.style.top=b.$.binding.display.top-a[".scrollbars"][".vertical"].scrollTop+b.$.binding.display.height+"px"});b.$.binding.__defineSetter__("left",function(a){b.$.binding.style.left=-(b.$.binding.display.left=a||0)+"px"});b.$.binding.__defineSetter__("selected",function(a){switch(!!a){case true:addStyle(b.$.binding,"selected");addStyle(b.$.binding.handle,"selected");break;case false:removeStyle(b.$.binding,"selected"),removeStyle(b.$.binding.handle,
"selected")}});b.$.binding.__defineSetter__("primaryKey",function(a){b.$.binding.handle.b.innerHTML="";b.$.binding.handle.b.appendChild($text(a===null||c.forceNumberedRows?b.$.row[".index"]+1:b.$.cells.byName[a]))});b.$.binding.editCell=function(a){a=a||window.event;if(!a||!a.ctrlKey)(a=a.target||a.srcElement)&&a.parentNode==b.$.binding&&a.editCell()};b.$.binding.cells={};for(var f=0;f<b.$.cells.length;f++)(function(c){b.$.binding.cells[c]=b.$.binding.appendChild($("div","DOM_HyperDataGrid_Cell"));
(function(c){var f=false;b.$.binding.cells[c].__defineGetter__("isEditing",function(){return f});b.$.binding.cells[c].__defineSetter__("isEditing",function(h){if(f==!!h&&f)throw"Warning: Attempted to assign the isEditing the same value!";((f=!!h)?addStyle:removeStyle)(b.$.binding.cells[c],"editing");switch(f){case true:b.$.binding.cells[c][".previousValue"]=b.$.cells[c];b.$.binding.cells[c].revert=function(){b.$.cells[c]=b.$.binding.cells[c][".previousValue"];b.$.binding.cells[c].isEditing=false};
b.$.lastEditedRowName=b.$.binding.cells[c].name;break;case false:setTimeout(function(){isChildOf(document.activeElement,a)||a.focus()},4)}})})(c);b.$.binding.cells[c].__defineGetter__("name",function(){return a[".columns"][c].name});b.$.binding.cells[c].__defineGetter__("editable",function(){return a[".columns"][c].editable});b.$.binding.cells[c].__defineSetter__("width",function(a){b.$.binding.cells[c].style.width=(a||0)+"px"});b.$.binding.cells[c].__defineSetter__("height",function(a){b.$.binding.cells[c].style.height=
(a||0)-4+"px"});b.$.binding.cells[c].__defineGetter__("type",function(){return a[".columns"][c].type.split("|")[0]});b.$.binding.cells[c].__defineSetter__("type",function(f){f=f.split("|");a[".renders"][f[0]](b.$.binding.cells[c],b.$.cells[c],f[1],f[2])});b.$.binding.cells[c].__defineSetter__("align",function(a){b.$.binding.cells[c].style.textAlign=a});b.$.binding.cells[c].__defineSetter__("visible",function(a){b.$.binding.cells[c].style.display=a?"":"none"});b.$.binding.cells[c].tabIndex=0;b.$.binding.cells[c].style.display=
a[".columns"][f].visible?"":"none";(function(c){var f=null;c.editCell=function(){if(!f&&(f=true,c.editable)){if(typeof a[".editors"][c.type]=="undefined")throw"No editor is configured for cell type '"+c.type+"', at column "+c.name;new a[".editors"][c.type](c,b,a.columnsByName[c.name].validator);f=false}};c.addEventListener("mousedown",function(){a.focusedCellIndex=a[".columnsByName"][c.name].columnIndex},true)})(b.$.binding.cells[c])})(f),b.$.binding.cells[f].width=a[".columns"][f]._config.width,
b.$.binding.cells[f].height=b.$.row[".height"],b.$.binding.cells[f].type=a[".columns"][f]._config.type,b.$.binding.cells[f].align=a[".columns"][f]._config.align;b.$.binding.__defineSetter__("focusedCellIndex",function(c){a.activeCell&&removeStyle(a.activeCell,"focused");a.activeCell=addStyle(b.$.binding.cells[c],"focused");a.activeCell.editCell()});b.$.binding.width=a[".scrollbars"][".horizontal"][".width"].scSize;b.$.binding.visible=b.$.row[".visible"];b.$.binding.height=b.$.row[".height"];b.$.binding.top=
b.$.row[".top"];b.$.binding.style.left=-a.body.left+"px";b.$.binding.primaryKey=a[".primaryKey"];b.$.binding.row=b;b.$.binding.selectable=b.$.row[".selectable"];b.$.binding.selected=b.$.row[".selected"];b.$.binding.__defineSetter__("resizeable",function(c){c=!!c;if(c!=b.$.binding.display.resizeable)switch(c){case true:b.$.binding.resizer=a[".edges"][".left"]._inner.appendChild($("div","DOM_HyperDataGrid_Row_Resizer").setAttr("style",b.$.binding.display.visible?"":"none"));b.$.binding.resizer.addEventListener("mousedown",
function(a){cancelEvent(a)},true);(function(c){var f;c.onDragBegin=function(){c.style.right="auto";c.style.width=a.offsetWidth+"px";f=a[".edges"][".left"]._inner.appendChild($("div","HyperDataGrid_Resizer_Tooltip_VerticalColumn"));f.style.top=c.offsetTop+10+"px";f.innerHTML=b.$.row.top+"px"};c.onDragRun=function(){var a=c.offsetTop-b.$.binding.handle.offsetTop;b.$.row.height=a>=0?a:0;f.style.top=c.offsetTop+10+"px";f.innerHTML=b.$.row.height+" px"};c.onDragStop=function(){f.parentNode.removeChild(f);
f=void 0;c.style.right="";c.style.width="";a[".rows"].rowUpdatesEnabled=false;for(var h=0;h<a[".rows"].length;h++)if(a[".rows"][h].$.row.selected)a[".rows"][h].$.row.height=b.$.row.height;a[".rows"].rowUpdatesEnabled=true};c.setAttr("dragable","1");c.dragger=new dragObject(c,null,new Position(0,0),new Position(0,1E8),c.onDragBegin,c.onDragRun,c.onDragStop,null,true)})(b.$.binding.resizer);b.$.binding.resizer.style.top=b.$.binding.display.top-a[".scrollbars"][".vertical"].scrollTop+b.$.binding.display.height+
"px";break;case false:a[".edges"][".left"]._inner.removeChild(b.$.binding.resizer),delete b.$.binding.resizer}});b.$.binding.resizeable=b.$.row[".resizeable"];for(var g in b.$.tags)b.$.tags.propertyIsEnumerable(g)&&b.$.tags[g]&&b.$.binding.handle.setTag(g,b.$.tags[g]);a[".body"].appendChild(b.$.binding);a[".bindings"].push(b.$.binding);return b.$.binding}};a[".selection"].__defineGetter__("byColumns",function(){for(var b=[],c=0;c<a[".columns"].length;c++)a[".columns"][c]._config.selected&&b.push(a[".columns"][c]);
return b});a[".selection"].__defineGetter__("byColumnsIndexes",function(){for(var b=[],c=0;c<a[".columns"].length;c++)a[".columns"][c]._config.selected&&b.push(c);return b});a[".selection"].__defineSetter__("byColumnsIndexes",function(b){for(var c=0;c<a[".columns"].length;c++)a[".columns"][c].selected=b.indexOf(c)!=-1});a[".selection"].__defineGetter__("byColumnsNames",function(){for(var b=[],c=0;c<a[".columns"].length;c++)a[".columns"][c]._config.selected&&b.push(a[".columns"][c]._config.name);return b});
a[".selection"].__defineSetter__("byColumnsNames",function(b){for(var c=0;c<a[".columns"].length;c++)a[".columns"][c].selected=b.indexOf(a[".columns"][c]._config.name)!=-1});a[".selection"].__defineGetter__("byRows",function(){for(var b=[],c=0;c<a[".rows"].length;c++)a[".rows"][c].$.row[".selected"]&&b.push(a[".rows"][c]);return b});a[".selection"].invertByRows=function(){for(var b=0,c=a[".rows"].length;b<c;b++)a[".rows"][b].$.row.selected=!a[".rows"][b].$.row[".selected"]};a[".selection"].__defineGetter__("byRowsIndexes",
function(){for(var b=[],c=0;c<a[".rows"].length;c++)a[".rows"][c].$.row[".selected"]&&b.push(c);return b});a[".selection"].__defineSetter__("byRowsIndexes",function(b){for(var c=0;c<a[".rows"].length;c++)a[".rows"][c].$.row.selected=b.indexOf(c)!=-1});a[".selection"].__defineGetter__("byRowsPrimaryKeys",function(){for(var b=[],c=0;c<a[".rows"].length;c++)a[".rows"][c].$.row[".selected"]&&b.push(a[".rows"][c].$.primaryKey);return b.unique()});a[".selection"].__defineSetter__("byRowsPrimaryKeys",function(b){for(var c=
0;c<a[".rows"].length;c++)a[".rows"][c].$.row.selected=b.indexOf(a[".rows"][c].$.primaryKey)!=-1});a[".selectable"]=false;a.__defineGetter__("selectable",function(){return a[".selectable"]});a.__defineSetter__("selectable",function(b){b=!!b;if(b!==a[".selectable"]){a[".selectable"]=b;switch(b){case true:a[".selectedIndex"]=-1;a.__defineSetter__("selectedIndex",function(b){b=b||0;if(b<-1||b>=a[".rows"].length)throw"HyperDataGrid.selectedIndex: index out of range!";a[".selectedIndex"]=b;a.selection.byRowsIndexes=
[b];a.onCustomEvent("selectedIndexChange")});a.__defineGetter__("selectedIndex",function(){return a[".selectedIndex"]});break;case false:if(a.selectedIndex!=-1)a.selectedIndex=-1,a.onCustomEvent("change");delete a[".selectedIndex"];delete a.selectedIndex}for(var c=0;c<a[".rows"].length;c++)a[".rows"][c].$.row.selectable=b}});(function(){var b=0;a.__defineGetter__("focusedCellIndex",function(){return b=!a[".columns"].length?-1:b<0?0:b>a[".columns"].length-1?a[".columns"].length:b});a.__defineSetter__("focusedCellIndex",
function(c){if(a[".columns"].length&&(c=isNaN(c)?0:c<0?0:c>a[".columns"].length-1?a[".columns"].length-1:Math.floor(c),c!=b)){b=c;try{a[".rows"][a.focusedRowIndex].$.binding.focusedCellIndex=b}catch(f){console.warn("HyperDataGrid.focusedCellIndex: Error while applying visual cell index: "+f)}}})})();(function(){var b=0;a.__defineGetter__("focusedRowIndex",function(){return b=!a[".rows"].length?-1:b<0?0:b>a[".rows"].length-1?a[".rows"].length:b});a.__defineSetter__("focusedRowIndex",function(c){if(a[".rows"].length){b=
isNaN(c)?0:c<0?0:c>a[".rows"].length-1?a[".rows"].length-1:Math.floor(c);a.onCustomEvent("change",a[".rows"][b]);if(a[".rows"][b].$.binding)if(a[".rows"][b].$.row.top<a.body.top)a.body.top=a[".rows"][b].$.row.top-(a[".rows"][b].$.row.height<a[".body"].offsetHeight?(a.body.offsetHeight-a[".rows"][b].$.row.height)/2:0);else{if(a[".rows"][b].$.row.top>a.viewport.top+a.viewport.height-a[".rows"][b].$.row.height)a[".body"].top=a[".rows"][b].$.row.top+a[".rows"][b].$.row.height-a[".viewport"].height+(a[".rows"][b].$.row.height<
a[".body"].offsetHeight?(a.body.offsetHeight-a[".rows"][b].$.row.height)/2:0)}else a.bindRow(a[".rows"][b]),a[".body"].top=a[".rows"][b].$.row.top<a[".body"].top?a[".rows"][b].$.row.top:a[".rows"][b].$.row.top+a[".rows"][b].$.row.height-a[".viewport"].height;try{removeStyle(a[".body"].querySelectorAll("div.DOM_HyperDataGrid_Row.focused")[0],"focused")}catch(f){}addStyle(a[".rows"][b].$.binding,"focused");a[".rows"][b].$.binding.focusedCellIndex=a.focusedCellIndex}})})();(function(){var b=false,c=
a._bodyHolder.appendChild($("div","DOM_HyperDataGrid_Keyboard"));a.__defineGetter__("keyboardNavigation",function(){return b});a.__defineSetter__("keyboardNavigation",function(f){if(!!f!=b)switch(b=!!f,(b?addStyle:removeStyle)(c,"on"),b){case true:Keyboard.bindKeyboardHandler(a,"down",function(){a.selection.byRowsIndexes=[];a[".isRendering"]||(a.focus(),a.focusedRowIndex++)});Keyboard.bindKeyboardHandler(a,"enter",function(){typeof document.activeElement.noEnter||(a.focus(),a.focusedRowIndex++)});
Keyboard.bindKeyboardHandler(a,"up",function(){a.selection.byRowsIndexes=[];a[".isRendering"]||(a.focus(),a.focusedRowIndex--)});Keyboard.bindKeyboardHandler(a,"home",function(){a.selection.byRowsIndexes=[];a.focus();a.focusedRowIndex=0});Keyboard.bindKeyboardHandler(a,"end",function(){a.selection.byRowsIndexes=[];a.focus();a.focusedRowIndex=a[".rows"].length-1});Keyboard.bindKeyboardHandler(a,"page_up",function(){a.selection.byRowsIndexes=[];a.focus();a.focusedRowIndex-=10});Keyboard.bindKeyboardHandler(a,
"page_down",function(){a.selection.byRowsIndexes=[];a.focus();a.focusedRowIndex+=10});Keyboard.bindKeyboardHandler(a,"left",function(){a.selection.byRowsIndexes=[];a.focus();do a.focusedCellIndex--;while(a.focusedCellIndex>0&&!a[".columns"][a.focusedCellIndex].visible)});Keyboard.bindKeyboardHandler(a,"right",function(){a.selection.byRowsIndexes=[];a.focus();do a.focusedCellIndex++;while(!a[".columns"][a.focusedCellIndex].visible&&a[".columns"].length-1>a.focusedCellIndex)});break;default:Keyboard.unbindKeyboardHandlers(a,
"down,enter,up,home,end,page_up,page_down,left,right".split(","))}});c.addEventListener("click",function(){a.keyboardNavigation=!a.keyboardNavigation},false);setupTooltip(c,"<b>Keyboard Navigation (F2)</b><br />Enables or disables navigation<br />with the help of arrowkeys<br />through this grid.");Keyboard.bindKeyboardHandler(a,"tab",function(){})})();(function(){Keyboard.bindKeyboardHandler(a,"f2",function(){a.keyboardNavigation=!a.keyboardNavigation;console.warn("HyperDataGrid: Keyboard navigation is now: "+
a.keyboardNavigation)});a.keyboardNavigation=true})();disableSelection(a);a.tabIndex=0;(function(){a[".menuHolder"]=a._bodyHolder.appendChild($("div","DOM_HyperDataGrid_Menu"));a[".updateMenu"]=function(){a[".menuHolder"].innerHTML="";for(var b=[{caption:" ",items:[]}],c=0;c<a[".columns"].length;c++)b[0].items.push({caption:a[".columns"][c].caption,icon:"jsplatform/img/hyperdatagrid/table_column-16x16.png",items:function(b){return[{caption:"Visible",input:"checkbox",icon:"jsplatform/img/hyperdatagrid/table_column_visible-16x16.png",
checked:a.columnsByName[b].visible,id:"dummy",handler:function(c){a.columnsByName[b].visible=c}}]}(a[".columns"][c].name)});b[0].items.push(null);b[0].items.push({caption:"Sort...",icon:"jsplatform/img/hyperdatagrid/table_sort-16x16.png",handler:function(){new DOM__HyperDataGrid__Sorter(a)}});b[0].items.push(null);b[0].items.push({caption:"Export",icon:"jsplatform/img/hyperdatagrid/TAG_saved-16x16.png",handler:function(){new DOM__HyperDataGrid__Exporter(a)}});a[".menuHolder"].appendChild(new MenuBar(b))};
a[".updateMenu"]()})();(function(){var b={};a.__defineGetter__("tags",function(){return b});a.__defineSetter__("tags",function(c){if(!(c instanceof Array))throw"HyperDataGrid.tags: Expected an array as value";for(var f={},g=0;g<c.length;g++){if(typeof c[g]!="string")throw"HyperDataGrid.tags["+g+"]: expected string!";if(!/^[a-z0-9\-\_\.]+$/.test(c[g]))throw"HyperDataGrid.tags["+g+"]: Invalid tag name!";f[c[g]]=true}b={};c=0;for(g in f)f.propertyIsEnumerable(g)&&(b[g]={className:"HyperDataGrid_TAG_"+
g,left:(20*c++).toString()+"px"});a[".edges"][".left"].width=50+c*20;for(g=0;g<a[".rows"].length;g++)a[".rows"].setPossibleRowTags(a[".rows"][g],b,true);for(g=a[".bindings"].length-1;g>=0;g--)a.unbindRow(g,true);a.onViewportChange()})})();setTimeout(function(){a.focus()},2);return a}
function DOM__HyperDataGrid__Sorter(c){if(typeof c[".hgSorter"]!="undefined")return c[".hgSorter"].childOf=c._bodyHolder,c[".hgSorter"];c[".hgSorter"]=dlg=new Dialog({width:350,height:c.offsetHeight-100<200?200:c.offsetHeight-100,childOf:c._bodyHolder,caption:"Sort Grid",minimizeable:false,maximizeable:false,minHeight:150,appIcon:"jsplatform/img/hyperdatagrid/table_sort-16x16.png"});dlg.ovr=dlg.insert($("div","HyperDataGrid_TSortableHolder"));dlg.insert($("div").setHTML("Use the following sort options to customise your view").setAttr("style",
"position: absolute; left: 5px; top: 5px; right: 5px; height: 30px; overflow: hidden; display: block"));dlg.sortOptions=[];dlg.getAvailableColumns=function(){for(var a=[],f=0;f<c.columns.length;f++)a.push({id:c.columns[f].name,name:c.columns[f].caption});return a};dlg.createSortOption=function(a){var c=$("div");c.cmbColumnName=c.appendChild((new DropDown).setItems(a));c.cmbSortOrder=c.appendChild((new DropDown).setItems([{id:"1",name:"ASC"},{id:"-1",name:"DESC"}]));addStyle(c.cmbColumnName,"columnName");
addStyle(c.cmbSortOrder,"sortOrder");c.__defineGetter__("columnName",function(){return c.cmbColumnName.selectedIndex<=0?null:c.cmbColumnName.value});c.__defineGetter__("sortOrder",function(){return c.cmbSortOrder.value});c.prevValue="";c.cmbColumnName.addEventListener("change",function(){if(c.columnName){for(var a=0;a<dlg.sortOptions.length;a++)if(dlg.sortOptions[a]!=c&&c.columnName&&c.columnName==dlg.sortOptions[a].columnName){HighlightElement(dlg.sortOptions[a]);HighlightElement(c);c.cmbColumnName.value=
c.prevValue;return}c.prevValue=c.columnName}},true);c.deleteMyself=function(){for(var a=0;a<dlg.sortOptions.length;a++)if(dlg.sortOptions[a]==c){dlg.sortOptions.splice(a,1);c.parentNode.removeChild(c);break}};c.appendChild($("img").setAttr("src","jsplatform/img/hyperdatagrid/remove-16x16.png")).addEventListener("click",c.deleteMyself,true);return c};dlg.more=dlg.insert((new Button('<img src="jsplatform/img/hyperdatagrid/add-16x16.png" style="border: none" />',function(){dlg.addMore()})).setAttr("style",
"display: block; bottom: 5px; left: 5px; height: 25px; position: absolute;"));dlg.addMore=function(){var a=dlg.getAvailableColumns();a.splice(0,0,{id:"",name:"- Choose -"});dlg.sortOptions.push(a=dlg.ovr.appendChild(dlg.createSortOption(a),dlg.more));dlg.ovr.scrollTop=1E5;return a};dlg.getSortFilters=function(){for(var a=[],c=0;c<dlg.sortOptions.length;c++)dlg.sortOptions[c].columnName&&a.push({name:dlg.sortOptions[c].columnName,order:parseInt(dlg.sortOptions[c].sortOrder)});return a};dlg.insert((new Button("Ok",
function(){c.sortFilters=dlg.getSortFilters();dlg.close()})).setAttr("style","position: absolute; right: 5px; bottom: 5px; height: 25px; width: 90px;"));dlg.closeCallback=function(){delete c[".hgSorter"];dlg=void 0;return true};var a=false;(function(){for(var b,f=0;f<c.sortFilters.length;f++)b=dlg.addMore(),b.cmbColumnName.value=c.sortFilters[f].name,b.cmbSortOrder.value=c.sortFilters[f].order.toString(),a=true})();a||dlg.addMore()}
function DOMImage(c){var a=$("div","DOMImage"),c=c||{},b=$("img");b.onload=function(){a.addClass("state-loaded").removeClass("state-error").removeClass("state-loading");a.style.backgroundImage="url("+b.src+")"};b.onerror=function(){a.removeClass("state-loaded").removeClass("state-loading").addClass("state-error")};(function(){var c=c||"normal";Object.defineProperty(a,"displayMode",{get:function(){return c},set:function(g){g=g.toString();if(["normal","best","tiles","stretch"].indexOf(g)==-1)throw"Bad image display-mode: "+
g;g=="best"?a.appendChild(b):b.parentNode&&b.parentNode.removeChild(b);a.removeClass(c).addClass(c=g)}})})();(function(){var f=c.src||"";Object.defineProperty(a,"src",{get:function(){return f},set:function(c){a.removeClass("state-error").removeClass("state-loaded").addClass("state-loading");b.src=f=c}})})();if(c.src)a.src=c.src;a.displayMode=c.displayMode||"normal";return a}JSON=JSON||{};
JSON.beautify=JSON.beautify||function(c,a){function b(a){for(a=typeof a==="undefined"?false:a;x.length&&(x[x.length-1]===" "||x[x.length-1]===G||x[x.length-1]===T||a&&(x[x.length-1]==="\n"||x[x.length-1]==="\r"));)x.pop()}function f(a){return a.replace(/^\s\s*|\s\s*$/,"")}function g(){var a=M;M=false;i();M=a}function i(a){s.eat_next_space=false;if(!M||!m(s.mode))if(a=typeof a==="undefined"?true:a,s.if_line=false,b(),x.length){if(x[x.length-1]!=="\n"||!a)Q=true,x.push("\n");T&&x.push(T);for(a=0;a<
s.indentation_level;a+=1)x.push(G);s.var_line&&s.var_line_reindented&&x.push(G);s.case_body&&x.push(G)}}function h(){if(A==="TK_COMMENT")return i(true);if(s.eat_next_space)s.eat_next_space=false;else{var a=" ";x.length&&(a=x[x.length-1]);a!==" "&&a!=="\n"&&a!==G&&x.push(" ")}}function j(){Q=false;s.eat_next_space=false;x.push(B)}function k(){x.length&&x[x.length-1]===G&&x.pop()}function l(a){s&&F.push(s);s={previous_mode:s?s.mode:"BLOCK",mode:a,var_line:false,var_line_tainted:false,var_line_reindented:false,
in_html_comment:false,if_line:false,in_case:false,case_body:false,eat_next_space:false,indentation_baseline:-1,indentation_level:s?s.indentation_level+(s.case_body?1:0)+(s.var_line&&s.var_line_reindented?1:0):0,ternary_depth:0}}function m(a){return a==="[EXPRESSION]"||a==="[INDENTED-EXPRESSION]"}function o(a){return r(a,["[EXPRESSION]","(EXPRESSION)","(FOR-EXPRESSION)","(COND-EXPRESSION)"])}function n(){U=s.mode==="DO_BLOCK";if(F.length>0){var a=s.mode;s=F.pop();s.previous_mode=a}}function q(a,b){for(var c=
0;c<a.length;c++)if(f(a[c])[0]!=b)return false;return true}function p(a){return r(a,"case,return,do,if,throw,else".split(","))}function r(a,b){for(var c=0;c<b.length;c+=1)if(b[c]===a)return true;return false}function t(a){for(var b=v,c=u.charAt(b);r(c,L)&&c!=a;){b++;if(b>=H)return 0;c=u.charAt(b)}return c}function w(){N=0;if(v>=H)return["","TK_EOF"];S=false;var a=u.charAt(v);v+=1;if(M&&m(s.mode)){for(var c=0;r(a,L);){a==="\n"?(b(),x.push("\n"),Q=true,c=0):a==="\t"?c+=4:a!=="\r"&&(c+=1);if(v>=H)return["",
"TK_EOF"];a=u.charAt(v);v+=1}if(s.indentation_baseline===-1)s.indentation_baseline=c;if(Q){var g;for(g=0;g<s.indentation_level+1;g+=1)x.push(G);if(s.indentation_baseline!==-1)for(g=0;g<c-s.indentation_baseline;g++)x.push(" ")}}else{for(;r(a,L);){a==="\n"&&(N+=X?N<=X?1:0:1);if(v>=H)return["","TK_EOF"];a=u.charAt(v);v+=1}if(V&&N>1)for(g=0;g<N;g+=1)i(g===0),Q=true;S=N>0}if(r(a,I)){if(v<H)for(;r(u.charAt(v),I);)if(a+=u.charAt(v),v+=1,v===H)break;if(v!==H&&a.match(/^[0-9]+[Ee]$/)&&(u.charAt(v)==="-"||
u.charAt(v)==="+"))return c=u.charAt(v),v+=1,g=w(v),a+=c+g[0],[a,"TK_WORD"];if(a==="in")return[a,"TK_OPERATOR"];S&&A!=="TK_OPERATOR"&&A!=="TK_EQUALS"&&!s.if_line&&(V||z!=="var")&&i();return[a,"TK_WORD"]}if(a==="("||a==="[")return[a,"TK_START_EXPR"];if(a===")"||a==="]")return[a,"TK_END_EXPR"];if(a==="{")return[a,"TK_START_BLOCK"];if(a==="}")return[a,"TK_END_BLOCK"];if(a===";")return[a,"TK_SEMICOLON"];if(a==="/"){c="";g=true;if(u.charAt(v)==="*"){v+=1;if(v<H)for(;!(u.charAt(v)==="*"&&u.charAt(v+1)&&
u.charAt(v+1)==="/")&&v<H;){a=u.charAt(v);c+=a;if(a==="\r"||a==="\n")g=false;v+=1;if(v>=H)break}v+=2;return g&&N==0?["/*"+c+"*/","TK_INLINE_COMMENT"]:["/*"+c+"*/","TK_BLOCK_COMMENT"]}if(u.charAt(v)==="/"){for(c=a;u.charAt(v)!=="\r"&&u.charAt(v)!=="\n";)if(c+=u.charAt(v),v+=1,v>=H)break;v+=1;S&&i();return[c,"TK_COMMENT"]}}if(a==="'"||a==='"'||a==="/"&&(A==="TK_WORD"&&p(z)||z===")"&&r(s.previous_mode,["(COND-EXPRESSION)","(FOR-EXPRESSION)"])||A==="TK_COMMENT"||A==="TK_START_EXPR"||A==="TK_START_BLOCK"||
A==="TK_END_BLOCK"||A==="TK_OPERATOR"||A==="TK_EQUALS"||A==="TK_EOF"||A==="TK_SEMICOLON")){c=a;g=false;var h=a;if(v<H)if(c==="/")for(a=false;g||a||u.charAt(v)!==c;){if(h+=u.charAt(v),g?g=false:(g=u.charAt(v)==="\\",u.charAt(v)==="["?a=true:u.charAt(v)==="]"&&(a=false)),v+=1,v>=H)return[h,"TK_STRING"]}else for(;g||u.charAt(v)!==c;)if(h+=u.charAt(v),g=g?false:u.charAt(v)==="\\",v+=1,v>=H)return[h,"TK_STRING"];v+=1;h+=c;if(c==="/")for(;v<H&&r(u.charAt(v),I);)h+=u.charAt(v),v+=1;return[h,"TK_STRING"]}if(a===
"#"){if(x.length===0&&u.charAt(v)==="!"){for(h=a;v<H&&a!="\n";)a=u.charAt(v),h+=a,v+=1;x.push(f(h)+"\n");i();return w()}c="#";if(v<H&&r(u.charAt(v),P)){do a=u.charAt(v),c+=a,v+=1;while(v<H&&a!=="#"&&a!=="=");a!=="#"&&(u.charAt(v)==="["&&u.charAt(v+1)==="]"?(c+="[]",v+=2):u.charAt(v)==="{"&&u.charAt(v+1)==="}"&&(c+="{}",v+=2));return[c,"TK_WORD"]}}if(a==="<"&&u.substring(v-1,v+3)==="<\!--"){v+=3;for(a="<\!--";u[v]!="\n"&&v<H;)a+=u[v],v++;s.in_html_comment=true;return[a,"TK_COMMENT"]}if(a==="-"&&s.in_html_comment&&
u.substring(v-1,v+2)==="--\>")return s.in_html_comment=false,v+=2,S&&i(),["--\>","TK_COMMENT"];if(r(a,O)){for(;v<H&&r(a+u.charAt(v),O);)if(a+=u.charAt(v),v+=1,v>=H)break;return a==="="?[a,"TK_EQUALS"]:[a,"TK_OPERATOR"]}return[a,"TK_UNKNOWN"]}var u,x,B,A,z,C,D,s,F,G,L,I,O,v,J,P,E,R,U,S,Q,N,T="",a=a?a:{},K;if(a.space_after_anon_function!==void 0&&a.jslint_happy===void 0)a.jslint_happy=a.space_after_anon_function;a.braces_on_own_line!==void 0&&(K=a.braces_on_own_line?"expand":"collapse");K=a.brace_style?
a.brace_style:K?K:"collapse";D=a.indent_size?a.indent_size:4;J=a.indent_char?a.indent_char:" ";var V=typeof a.preserve_newlines==="undefined"?true:a.preserve_newlines,X=typeof a.max_preserve_newlines==="undefined"?false:a.max_preserve_newlines,Y=a.jslint_happy==="undefined"?false:a.jslint_happy,M=typeof a.keep_array_indentation==="undefined"?false:a.keep_array_indentation,Z=typeof a.space_before_conditional==="undefined"?true:a.space_before_conditional,W=typeof a.indent_case==="undefined"?false:a.indent_case;
Q=false;var H=c.length;for(G="";D>0;)G+=J,D-=1;for(;c&&(c[0]===" "||c[0]==="\t");)T+=c[0],c=c.substring(1);u=c;D="";A="TK_START_EXPR";C=z="";x=[];U=false;L="\n\r\t ".split("");I="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789_$".split("");P="0123456789".split("");O="+ - * / % & ++ -- = += -= *= /= %= == === != !== > < >= <= >> << >>> >>>= >>= <<= && &= | || ! !! , : ? ^ ^= |= ::";O+=" <%= <% %> <?= <? ?>";O=O.split(" ");J="continue,try,throw,return,var,if,switch,case,default,for,while,break,function".split(",");
F=[];l("BLOCK");for(v=0;;){R=w(v);B=R[0];R=R[1];if(R==="TK_EOF")break;switch(R){case "TK_START_EXPR":if(B==="["){if(A==="TK_WORD"||z===")"){r(z,J)&&h();l("(EXPRESSION)");j();break}if(s.mode==="[EXPRESSION]"||s.mode==="[INDENTED-EXPRESSION]")if(C==="]"&&z===","){if(s.mode==="[EXPRESSION]")s.mode="[INDENTED-EXPRESSION]",M||(s.indentation_level+=1);l("[EXPRESSION]");M||i()}else if(z==="["){if(s.mode==="[EXPRESSION]")s.mode="[INDENTED-EXPRESSION]",M||(s.indentation_level+=1);l("[EXPRESSION]");M||i()}else l("[EXPRESSION]");
else l("[EXPRESSION]")}else D==="for"?l("(FOR-EXPRESSION)"):r(D,["if","while"])?l("(COND-EXPRESSION)"):l("(EXPRESSION)");z===";"||A==="TK_START_BLOCK"?i():A==="TK_END_EXPR"||A==="TK_START_EXPR"||A==="TK_END_BLOCK"||z==="."?S&&i():A!=="TK_WORD"&&A!=="TK_OPERATOR"?h():D==="function"||D==="typeof"?Y&&h():(r(z,J)||z==="catch")&&Z&&h();j();break;case "TK_END_EXPR":if(B==="]")if(M){if(z==="}"){k();j();n();break}}else if(s.mode==="[INDENTED-EXPRESSION]"&&z==="]"){n();i();j();break}n();j();break;case "TK_START_BLOCK":D===
"do"?l("DO_BLOCK"):l("BLOCK");K=="expand"||K=="expand-strict"?(C=false,K=="expand-strict"?(C=t()=="}")||i(true):A!=="TK_OPERATOR"&&(z==="="||p(z)&&z!=="else"?h():i(true)),j(),C||(s.indentation_level+=1)):(A!=="TK_OPERATOR"&&A!=="TK_START_EXPR"?A==="TK_START_BLOCK"?i():h():m(s.previous_mode)&&z===","&&(C==="}"?h():i()),s.indentation_level+=1,j());break;case "TK_END_BLOCK":n();K=="expand"||K=="expand-strict"?z!=="{"&&i():A==="TK_START_BLOCK"?Q?k():b():m(s.mode)&&M?(M=false,i(),M=true):i();j();break;
case "TK_WORD":if(U){h();j();h();U=false;break}if(B==="function"){if(s.var_line)s.var_line_reindented=true;if((Q||z===";")&&z!=="{"&&A!="TK_BLOCK_COMMENT"&&A!="TK_COMMENT"){N=Q?N:0;V||(N=1);for(E=0;E<2-N;E++)i(false)}}if(B==="case"||B==="default"){z===":"||s.case_body?k():(W||s.indentation_level--,i(),W||s.indentation_level++);j();s.in_case=true;s.case_body=false;break}E="NONE";A==="TK_END_BLOCK"?r(B.toLowerCase(),["else","catch","finally"])?K=="expand"||K=="end-expand"||K=="expand-strict"?E="NEWLINE":
(E="SPACE",h()):E="NEWLINE":A==="TK_SEMICOLON"&&(s.mode==="BLOCK"||s.mode==="DO_BLOCK")?E="NEWLINE":A==="TK_SEMICOLON"&&o(s.mode)?E="SPACE":A==="TK_STRING"?E="NEWLINE":A==="TK_WORD"?(z==="else"&&b(true),E="SPACE"):A==="TK_START_BLOCK"?E="NEWLINE":A==="TK_END_EXPR"&&(h(),E="NEWLINE");if(r(B,J)&&z!==")"&&(E=z=="else"?"SPACE":"NEWLINE",B==="function"&&(z==="get"||z==="set")))E="SPACE";if(s.if_line&&A==="TK_END_EXPR")s.if_line=false;if(r(B.toLowerCase(),["else","catch","finally"]))A!=="TK_END_BLOCK"||
K=="expand"||K=="end-expand"||K=="expand-strict"?i():(b(true),h());else if(E==="NEWLINE"){if(!((A==="TK_START_EXPR"||z==="="||z===",")&&B==="function"))if(B==="function"&&z=="new")h();else if(p(z))h();else if(A!=="TK_END_EXPR"){if((A!=="TK_START_EXPR"||B!=="var")&&z!==":")B==="if"&&D==="else"&&z!=="{"?h():(s.var_line=false,s.var_line_reindented=false,i())}else if(r(B,J)&&z!=")")s.var_line=false,s.var_line_reindented=false,i()}else m(s.mode)&&z===","&&C==="}"?i():E==="SPACE"&&h();j();D=B;if(B==="var")s.var_line=
true,s.var_line_reindented=false,s.var_line_tainted=false;if(B==="if")s.if_line=true;if(B==="else")s.if_line=false;break;case "TK_SEMICOLON":j();s.var_line=false;s.var_line_reindented=false;if(s.mode=="OBJECT")s.mode="BLOCK";break;case "TK_STRING":A==="TK_END_EXPR"&&r(s.previous_mode,["(COND-EXPRESSION)","(FOR-EXPRESSION)"])?h():A=="TK_STRING"||A==="TK_START_BLOCK"||A==="TK_END_BLOCK"||A==="TK_SEMICOLON"?i():A==="TK_WORD"&&h();j();break;case "TK_EQUALS":if(s.var_line)s.var_line_tainted=true;h();j();
h();break;case "TK_OPERATOR":E=C=true;if(s.var_line&&B===","&&o(s.mode))s.var_line_tainted=false;if(s.var_line&&B===",")if(s.var_line_tainted){j();s.var_line_reindented=true;s.var_line_tainted=false;i();break}else s.var_line_tainted=false;if(p(z)){h();j();break}if(B===":"&&s.in_case){if(W)s.case_body=true;j();i();s.in_case=false;break}if(B==="::"){j();break}if(B===","){s.var_line?s.var_line_tainted?(j(),i(),s.var_line_tainted=false):(j(),h()):A==="TK_END_BLOCK"&&s.mode!=="(EXPRESSION)"?(j(),s.mode===
"OBJECT"&&z==="}"?i():h()):s.mode==="OBJECT"?(j(),i()):(j(),h());break}else r(B,["--","++","!"])||r(B,["-","+"])&&(r(A,["TK_START_BLOCK","TK_START_EXPR","TK_EQUALS","TK_OPERATOR"])||r(z,J))?(E=C=false,z===";"&&o(s.mode)&&(C=true),A==="TK_WORD"&&r(z,J)&&(C=true),s.mode==="BLOCK"&&(z==="{"||z===";")&&i()):B==="."?C=false:B===":"?s.ternary_depth==0?(s.mode="OBJECT",C=false):s.ternary_depth-=1:B==="?"&&(s.ternary_depth+=1);C&&h();j();E&&h();break;case "TK_BLOCK_COMMENT":C=B.split(/\x0a|\x0d\x0a/);if(q(C.slice(1),
"*")){i();x.push(C[0]);for(E=1;E<C.length;E++)i(),x.push(" "),x.push(f(C[E]))}else{C.length>1?i():A==="TK_END_BLOCK"?i():h();for(E=0;E<C.length;E++)x.push(C[E]),x.push("\n")}t("\n")!="\n"&&i();break;case "TK_INLINE_COMMENT":h();j();o(s.mode)?h():g();break;case "TK_COMMENT":S?i():h();j();t("\n")!="\n"&&g();break;case "TK_UNKNOWN":p(z)&&h(),j()}C=z;A=R;z=B}return T+x.join("").replace(/[\n ]+$/,"")};window.js_beautify=JSON.beautify;
function JSIde_Chain(c){this.implementFunction=c||function(){};this.register=function(a){return a.chain(eval("("+this.implementFunction+")"))};this.toString=function(){return"("+this.implementFunction.toString()+")"};this.setAttribute=function(){};return this}function JSIde_ApplicationCSS(c){var a=new CSS_Modifier(c);this.toString=function(b){return a.inject(b?"."+b+" ":".design-mode ")};this.setAttribute=function(){};return this}
function JSIde_CustomEventHandler(c,a){this.attach=function(b){b.chain(function(){try{eval("DOMNode.chain( function(){ if ( !this.customEventListeners ) EnableCustomEventListeners(this); this.addCustomEventListener("+JSON.stringify(c)+", "+a.toString()+"); } )")}catch(f){console.warn("Could not bind event "+c+" on ",b)}})};this.setAttribute=function(){};this.toString=function(){return"(new JSIde_CustomEventHandler("+JSON.stringify(c)+", "+a.toString()+"))"};return this}
function JSIde_EventHandler(c,a,b){this.attach=function(f){f.chain(function(){try{eval("DOMNode.chain( function(){ this.addEventListener("+JSON.stringify(c)+", "+a.toString()+", "+JSON.stringify(b)+"); } )")}catch(g){console.warn("Could not bind event "+c+" on ",f)}})};this.setAttribute=function(){};this.toString=function(){return"(new JSIde_EventHandler("+JSON.stringify(c)+", "+a.toString()+", "+JSON.stringify(b)+"))"};return this}
function JSIde_ApplicationExtender(c){this.implementation=c||function(){};this.register=function(a){eval("("+this.implementation.toString()+")").call(a,a)};this.toString=function(){return"dlg.chain( function() { "+this.implementation+"( this ); } )"};this.setAttribute=function(){};return this}
function JSIde_ApplicationHandler(c,a,b){a=a&&a.handlers?a:null;if(typeof c=="undefined")throw"Must specify a handler name!";this.handlerName=c;this.targetApplication=a;this.implementation=b||function(){alert("You must specify the code for this handler");return null};this.register=function(a){if(!a||!a.handlers)throw"Could not register application handler to application!";a.handlers[this.handlerName]=this.implementation};this.toString=function(){return"("+this.implementation.toString()+").chain(function() { /* Application handler: "+
this.handlerName+" */\n\ndlg.handlers["+JSON.stringify(this.handlerName)+"] = this; })"};this.setAttribute=function(){};return this}
function JSIde_MenuBar(c,a){var a=!!a,b=function(c){if(c&&c.length){for(var g=[],i,h=0,j=c.length;h<j;h++){i=c[h].cfg;if(typeof c[h].items!="undefined")i.items=b(c[h].items);if(a&&i.id)i.handler="%appHandler%";g.push(i)}return g}};this.menu=b(c.items||[]);Object.defineProperty(this,"setAttribute",{get:function(){return function(){}}});this.toString=function(){return this.menu?JSON.stringify(this.menu).replace(/\"%appHandler%\"/g,"dlg.appHandler"):"[]"};this.objectType="menubar";return this}
function JSIde_Toolbar(c,a){var a=!!a,b=function(c,g){g=typeof g=="undefined"?1:g;if(c&&c.length){for(var i=[],h,j=0,k=c.length;j<k;j++){h=c[j].cfg;if(typeof c[j].items!="undefined")h.items=b(c[j].items,g+1);if(a&&h.id)h.handler="%appHandler%";g==1&&h.renameProperty("caption","name");i.push(h)}return i}};this.toolbar=b(c.items||[]);Object.defineProperty(this,"setAttribute",{get:function(){return function(){}}});Object.defineProperty(this,"settings",{get:function(){return c.cfg}});this.toString=function(a){a=
a||"toolbar";switch(a){case "toolbar":return this.toolbar?JSON.stringify(this.toolbar).replace(/\"%appHandler%\"/g,"dlg.appHandler"):"[]";case "settings":return JSON.stringify(c.cfg);default:throw"Don't know how to convert to a string the '"+a+"'";}};this.objectType="toolbar";return this}function json_parse(c){return JSON.parse(c)}
window[".keyboard"]={keyBindings:{backspace:8,tab:9,enter:13,"break":19,capslock:20,esc:27,space:32,page_up:33,page_down:34,home:36,end:35,left:37,up:38,right:39,down:40,insert:45,"delete":46,0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90,num_0:96,num_1:97,num_2:98,num_3:99,num_4:100,num_5:101,num_6:102,num_7:103,num_8:104,num_9:105,"num_*":106,"num_+":107,"num_-":109,
"num_.":110,"num_/":111,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,numlock:144,scrolllock:145,";":186,"=":187,",":188,".":190,"/":191,"`":192,"[":219,"\\":220,"]":221,"'":222,"-":189},invisibleKeys:[112,113,114,115,116,117,118,119,120,121,122,123,8,9,13,19,20,27,32,37,38,39,40,45,46,35,36,33,34,144,145],translateKeyboardEventString:function(c){var c=c||window.event,a=c.keyCode||c.charCode,b=[];c.ctrlKey&&b.push("ctrl");c.altKey&&b.push("alt");c.shiftKey&&
b.push("shift");for(var f in Keyboard.keyBindings)if(Keyboard.keyBindings[f]===a)return b.push(f),b.join(" ");return null},unbindKeyboardHandlers:function(c,a){if(c&&c.__KEYBOARD_BINDINGS)for(var b=0;b<a.length;b++)typeof c.__KEYBOARD_BINDINGS[a[b]]!="undefined"&&delete c.__KEYBOARD_BINDINGS[a[b]]},bindKeyboardHandler:function(c,a,b){var a=a.toString().trim().toLowerCase(),f=/^(ctrl[\s]+?)?(alt[\s]+?)?(shift[\s]+?)?([^*]+)$/.exec(a);if(!f)return false;var g=f[1],i=f[2],h=f[3],f=f[4],j=false,k=false,
l;for(l in Keyboard.keyBindings)if(f==l){j=true;k=Keyboard.keyBindings[l];break}if(j===false){try{console.error("Keyboard.bindKeyboardHandler: Don't have a keybinding for key '"+f+"'")}catch(m){}return false}if(!g&&!i&&!h&&Keyboard.invisibleKeys.indexOf(k)==-1){try{console.warn("Keyboard.bindKeyboardHandler: the shortcut key does not contain (ctrl | alt | shift | invKey). aborted!")}catch(o){}return false}c.__KEYBOARD_BINDINGS=c.__KEYBOARD_BINDINGS||{};c.__KEYBOARD_BINDINGS[a]=b;if(typeof c.__KEYBOARD_HANDLER==
"undefined"){c.__KEYBOARD_HANDLER=function(a){var b=getOwnerWindow(a.srcElement);if(b!=getOwnerWindow(c)&&b!=c&&a.srcElement!=c)return true;if(typeof c.active=="undefined"||c.active)if(a=a||window.event,b=a.keyCode||a.charCode,a.ctrlKey||a.altKey||a.shiftKey||Keyboard.invisibleKeys.indexOf(b)!=-1)b=Keyboard.translateKeyboardEventString(a),b!==null&&typeof c.__KEYBOARD_BINDINGS[b]!="undefined"&&(c.__KEYBOARD_BINDINGS[b](),cancelEvent(a))};try{c.addEventListener("keydown",c.__KEYBOARD_HANDLER,true)}catch(n){c.attachEvent("onkeydown",
c.__KEYBOARD_HANDLER)}}},setFocusCycling:function(c){c.tabIndex=c.tabIndex||0;c.__FocusFirst=function(){for(var a=c.getElementsByTagName("*"),b=0;b<a.length;b++)if(a[b].offsetWidth||a[b].offsetHeight)if(a[b].focus(),a[b]==document.activeElement)return;c.focus()};c.__FocusLast=function(){for(var a=c.getElementsByTagName("*"),b=a.length-1;b>=0;b--)if(a[b].offsetWidth||a[b].offsetHeight)if(a[b].focus(),a[b]==document.activeElement)return;c.focus()};c.__FocusNext=function(){for(var a=c.getElementsByTagName("*"),
b=0;a[b]!=document.activeElement&&b<a.length;)b++;b++;if(!(b>=a.length))for(;b<a.length;){if(!(a[b].offsetWidth==0&&a[b].offsetHeight==0)){try{a[b].focus()}catch(f){}if(a[b]==document.activeElement)return}b++}c.__FocusFirst()};c.__FocusPrevious=function(){for(var a=c.getElementsByTagName("*"),b=a.length-1;a[b]!=document.activeElement&&b>=0;)b--;b--;if(!(b<0))for(;b>=0;){if(!(a[b].offsetWidth==0&&a[b].offsetHeight==0)){try{a[b].focus()}catch(f){}if(a[b]==document.activeElement)return}b--}c.__FocusLast()};
c.__OnTabKey=function(a){a=a||window.event;if((a.keyCode||a.charCode)==9&&isChildOf(document.activeElement,c))(a.shiftKey?c.__FocusPrevious:c.__FocusNext)(document.activeElement),cancelEvent(a)};c.addEventListener?c.addEventListener("keydown",c.__OnTabKey,false):c.attachEvent("onkeydown",c.__OnTabKey)}};try{window.__defineGetter__("Keyboard",function(){return window[".keyboard"]})}catch(ex$$75){window.Keyboard=window[".keyboard"],delete window[".keyboard"]}
addOnload(function(){Keyboard.bindKeyboardHandler(window,"alt left",function(){confirm("Do you want to navigate away (back) from this page?")&&window.history.back()})});
function DOMLabel(c,a){var a=a||{},b=$("div","DOMLabel".concat(a.x||a.y?" placement":""));c&&b.appendChild($text(c));(function(){var a=c||"";Object.defineProperty(b,"label",{get:function(){return a},set:function(c){b.innerHTML="";b.appendChild($text(a=c.toString()))}})})();if(a.x)b.style.left=a.x+"px";if(a.y)b.style.top=a.y+"px";if(a.align)b.style.textAlign=a.align;if(a.w)b.style.width=a.w+"px";if(a.width)b.style.width=a.width+"px";if(a.r)b.style.right=a.r+"px";if(a["for"])b.tabIndex=0,b.addEventListener("focus",
function(){try{a["for"].focus()}catch(b){}},false),typeof a["for"].checked!="undefined"&&b.addEventListener("click",function(){try{a["for"].click()}catch(b){a["for"].checked=!a["for"].checked}},false);b.insert=function(a){b.appendChild(a);return a};return b}
function AddContextMenu(c,a){console.log("domutils.js: AddContextMenu(node, menu): DEPRECATED!!!");c.contextMenu=a;window.opera&&c.addEventListener("mousedown",function(a){if(a.button==0&&a.shiftKey){if(this.oncontextmenu)this.oncontextmenu(a);cancelEvent(a)}},false);c.oncontextmenu=function(a){addStyle(c,"CONTEXT_MENU");var f=$("div","DOMContextMenu");f.tabIndex=0;f.style.left=a.clientX+"px";f.style.top=a.clientY+"px";f.style.zIndex=1E6;document.body.appendChild(f);f.focus();f.oncontextmenu=function(a){cancelEvent(a)};
f.onblur=function(){this.onclick()};f.onclick=function(){removeStyle(c,"CONTEXT_MENU");try{this.parentNode.removeChild(this)}catch(a){}};for(var g=0;g<this.contextMenu.length;g++)if(this.contextMenu[g]!==null){var i=$("a");i.appendChild(document.createTextNode(this.contextMenu[g].text));i.callback=this.contextMenu[g].callback;i.onclick=function(a){cancelEvent(a);f.onclick();this.callback()};if(this.contextMenu[g].important)i.style.fontWeight="bold";f.appendChild(i)}else f.appendChild($("hr"));f.style.width=
"150px";if(f.offsetHeight+a.clientY>getMaxY())f.style.top=a.clientY-f.offsetHeight+"px";if(f.offsetWidth+a.clientX>getMaxX())f.style.left=a.clientX-f.offsetWidth+"px";cancelEvent(a)}}var ___UID=0;function getUID(){return++___UID}var __cDomPopup=0;
function Popup(c,a){var b=$("table","DomPopup");b._icons=0;b._inputs=0;b._shortcuts=0;b._childs=0;b._focusedRow=false;b.rootElement=typeof a!="undefined"?a:null;b._visible=false;b.___dpName=++__cDomPopup;b.getIconsVisible=function(){return b._icons};b.setIconsVisible=function(a){for(var c=0;c<b.rows.length;c++)b.rows[c]._icon.style.display=a?"":"none";b._icons=a};b.getInputsVisible=function(){return b._inputs};b.setInputsVisible=function(a){for(var c=0;c<b.rows.length;c++)b.rows[c]._input.style.display=
a?"":"none";b._inputs=a};b.getShortcutsVisible=function(){return b._shortcuts};b.setShortcutsVisible=function(a){for(var c=0;c<b.rows.length;c++)b.rows[c]._shortcut.style.display=a?"":"none";b._shortcuts=a};b.getChildsVisible=function(){return b._childs};b.setChildsVisible=function(a){for(var c=0;c<b.rows.length;c++)b.rows[c]._child.style.display=a?"":"none";b._childs=a};b.getVisible=function(){return b._visible};b.getRootElement=function(){return b.rootElement};b.setVisible=function(a){var c=b.getRootElement();
b.style.display=a?"":"none";if(!a)for(var f=0;f<b.rows.length;f++)b.rows[f]._xchild&&b.rows[f]._xchild.setVisible(false);c.___stack=c.___stack||[];if(a)c.___stack.push(b);else{for(f=0;f<c.___stack.length;f++)c.___stack[f]==b&&c.___stack.splice(f,1);b.parentNode&&b.parentNode.removeChild(b)}if(a)for(f=0;f<b.rows.length;f++)try{if(b.rows[f]&&b.rows[f].setDisabled&&b.rows[f].setDisabled(b.rows[f]._disabled),b.rows[f]&&typeof b.rows[f]._checked=="function")try{b.rows[f].querySelector("input").checked=
b.rows[f]._checked()}catch(g){}}catch(l){console.warn(l+"")}};b.getFocusedRow=function(){return b._focusedRow};b.setFocusedRow=function(a){b._focusedRow&&removeStyle(b._focusedRow,"activeOption");b._focusedRow=a;b._focusedRow&&addStyle(b._focusedRow,"activeOption")};b.matchProperty=function(a,c){for(var f,g=0;g<b.rows.length;g++)if(!b.rows[g]._isSeparator&&(f=b.rows[g].matchProperty(a,c)))return f;return false};b.addOption=function(a,c){var f=b.insertRow(c?c:b.rows.length);(f._icon=f.insertCell(0)).className=
"DomPopupIconHolder";(f._input=f.insertCell(1)).className="DomPopupInputHolder";(f._caption=f.insertCell(2)).className="DomPopupCaptionHolder";(f._shortcut=f.insertCell(3)).className="DomPopupShortcutHolder";(f._child=f.insertCell(4)).className="DomPopupExpandHolder";f._icon.style.display=b._icons==0?"none":"";f._input.style.display=b._inputs==0?"none":"";f._shortcut.style.display=b._shortcuts==0?"none":"";f._child.style.display=b._childs==0?"none":"";a=a||{};f._xicon=false;f._xinput=false;f._xcaption=
false;f._xshortcut=false;f._xchild=false;f._expanded=false;f._xhandler=false;f._xmenuID=false;f._checked=typeof a.checked=="undefined"?false:a.checked;f._disabled=typeof a.disabled=="undefined"?false:a.disabled;f.matchProperty=function(a,b){try{if(f["_x".concat(a)]==b)return f}catch(c){throw'Invalid Property "'+a+'"!';}return f._xchild?f._xchild.matchProperty(a,b):false};f.getIcon=function(){return f._xicon};f.setIcon=function(a){a&&!f._xicon&&b.setIconsVisible(b.getIconsVisible()+1);!a&&f._xicon&&
b.setIconsVisible(b.getIconsVisible()-1);f._icon.style.backgroundImage=!a?"none":"url('"+a+"')";f._xicon=a?a:false};f.getChecked=function(){return f._checked};f.setChecked=function(a){f._checked=typeof a=="function"?a:!!a};f.getInput=function(){return f._xinput?f._xinput.getAttribute("type"):false};f.setInput=function(a,c){a&&!f._xinput&&b.setInputsVisible(b.getInputsVisible()+1);!a&&f._xinput&&b.setInputsVisible(b.getInputsVisible()-1);f._input.innerHTML="";if(a){f._xinput=$("input");var i=a.split(":");
f._input.innerHTML="";f._xinput=f._input.appendChild(i[0]=="checkbox"?(new DOMCheckBox).chain(function(){if(c)this.checked=true;this.setAttribute("name","internal"+b.___dpName+"_"+(i.length>1?i[1]:"0"))}):$("input").setAttr("type",i[0]).setAttr("name","internal"+b.___dpName+"_"+(i.length>1?i[1]:0)).chain(function(){if(c)this.checked=true}))}else f._xinput=false};f.getCaption=function(){return f._xcaption};f.setCaption=function(a){f._xcaption=a;f._caption.innerHTML="";a!==""&&f._caption.appendChild(document.createTextNode(a))};
f.getShortcut=function(){return f._xshortcut};f.setShortcut=function(a){a&&!f._xshortcut&&b.setShortcutsVisible(b.getShortcutsVisible()+1);!a&&f._xshortcut&&b.setShortcutsVisible(b.getShortcutsVisible()-1);f._shortcut.innerHTML="";a&&f._shortcut.appendChild(document.createTextNode(a))};f.getChild=function(){return f._xchild};f.setChild=function(a){a&&!f._xchild&&b.setChildsVisible(b.getChildsVisible()+1);!a&&f._xchild&&(f._xchild.parentNode&&f._xchild.parentNode.removeChild(f._xchild),b.setChildsVisible(b.getChildsVisible()-
1));f._xchild=a;f._xchild?addStyle(f._child,"expandable"):removeStyle(f._child,"expandable");a.rootMenu=f};f.getHandler=function(){return f._xhandler};f.setHandler=function(a){f._xhandler=a};f.getMenuID=function(){return f._xmenuID};f.setMenuID=function(a){f._xmenuID=a};f.getDisabled=function(){return f._disabled instanceof Function?f._disabled():f._disabled};f.setDisabled=function(a){f._disabled=a;(f.getDisabled()?addStyle:removeStyle)(f,"disabled");if(f._xinput)f._xinput.disabled=f.getDisabled()?
true:false};Object.defineProperty(f,"icon",{get:f.getIcon,set:f.setIcon});Object.defineProperty(f,"input",{get:f.getInput,set:f.setInput});Object.defineProperty(f,"caption",{get:f.getCaption,set:f.setCaption});Object.defineProperty(f,"shortcut",{get:f.getShortcut,set:f.setShortcut});Object.defineProperty(f,"child",{get:f.getChild,set:f.setChild});Object.defineProperty(f,"handler",{get:f.getHandler,set:f.setHandler});Object.defineProperty(f,"menuID",{get:f.getMenuID,set:f.setMenuID});Object.defineProperty(f,
"disabled",{get:f.getDisabled,set:f.setDisabled});Object.defineProperty(f,"checked",{get:f.getChecked,set:f.setChecked});if(typeof a!="undefined"){f.setIcon(a.icon||false);f.setCaption(a.caption||false);f.setShortcut(a.shortcut||false);if(a.input&&!a.checked)f.setInput(a.input||false);else if(a.input&&a.checked)try{f.setInput(a.input,a.checked())}catch(g){f.setInput(a.input,a.checked)}typeof a.handler!="undefined"&&f.setHandler(a.handler);typeof a.id!="undefined"&&f.setMenuID(a.id);typeof a.disabled!=
"undefined"&&f.setDisabled(a.disabled)}f.getExpanded=function(){return f._expanded};f.setExpanded=function(a){if(f._xchild)if(a){b.setFocusedRow(f);document.body.appendChild(f._xchild);f._xchild.setVisible(true);var a=f._xchild.offsetWidth,c=f._xchild.offsetHeight,i=getXY(f);i[0]+=document.body.scrollLeft||window.pageXOffset||(document.body.parentElement?document.body.parentElement.scrollLeft:0);i[1]+=document.body.scrollTop||window.pageYOffset||(document.body.parentElement?document.body.parentElement.scrollTop:
0);f._xchild.style.left=i[0]+a+f.offsetWidth<getMaxX()?i[0]+f.offsetWidth-2+"px":i[0]-a+"px";f._xchild.style.top=i[1]+c<getMaxY()?i[1]+"px":i[1]-f._xchild.offsetHeight+f.offsetHeight+"px";f._xchild.setFocusedRow(false);if(f._xchild)for(a=0;a<f._xchild.rows.length;a++)try{f._xchild.rows[a].setExpanded(false)}catch(g){}}else{try{document.body.removeChild(f._xchild)}catch(h){}f._xchild.setVisible(false)}};f.mouseHandler=function(a){if(!f.getDisabled()){a=a||window.event;try{var c=new MouseBoundaryCrossing(a,
f)}catch(i){return}switch(true){case c.leftLandmark:try{if((new MouseBoundaryCrossing(a,f._xchild)).enteredLandmark)break}catch(g){}f.setExpanded(false);break;case c.enteredLandmark:f.setExpanded(true);b.setFocusedRow(f);for(a=0;a<b.rows.length;a++)f.rowIndex!=a&&!b.rows[a]._isSeparator&&b.rows[a].setExpanded(false)}}};f.onmouseover=f.onmouseout=f.mouseHandler;f.clickListener=function(a){a=a||window.event;if(!f.getDisabled()){if(f._xinput)switch(f._xinput.getAttribute("type")){case "checkbox":if((a.target||
a.srcElement)!=f._xinput)f._xinput.checked=!f._xinput.checked,cancelEvent(a);else if(f._xinput.getAttribute("type")=="checkbox")f._xinput.checked=!f._xinput.checked,cancelEvent(a);f.getHandler()&&f.getHandler()(f._xinput.checked,f.getMenuID());break;case "radio":if((a.target||a.srcElement)!=f._xinput)f._xinput.checked=true,cancelEvent(a);f.getHandler()&&f.getHandler()(f.getMenuID())}else f.getHandler()&&(b.rootElement&&b.rootElement.resetMenu(),f.getHandler()(f.getMenuID()));return true}};f.addEventListener("click",
f.clickListener,false);return f};b.addSeparator=function(a){a=b.insertRow(typeof a=="undefined"?b.rows.length:a);(a._icon=a.insertCell(0)).className="DomPopupIconHolder";(a._input=a.insertCell(1)).className="DomPopupInputHolder";(a._caption=a.insertCell(2)).className="DomPopupCaptionHolder";(a._shortcut=a.insertCell(3)).className="DomPopupShortcutHolder";(a._child=a.insertCell(4)).className="DomPopupExpandHolder";a._icon.style.display=b._icons==0?"none":"";a._input.style.display=b._inputs==0?"none":
"";a._shortcut.style.display=b._shortcuts==0?"none":"";a._child.style.display=b._childs==0?"none":"";a._isSeparator=true;a.className="DomPopupSeparator";addStyle(a,"disabled");return a};for(var f=0;f<c.length;f++)if(c[f]){var g=b.addOption(c[f]);c[f].items&&g.setChild(new Popup(c[f].items,b.rootElement))}else g=b.addSeparator();return b}
function MenuBar(c){var a=$("div","DomMenuBar");a.mnu=a.appendChild($("table","DomMenuBarTable"));a.mnu=a.mnu.insertRow(0);a.___stack=[a];a._focusedCell=false;a._openOnHover=false;a.getFocusedCell=function(){return a._focusedCell};a.getRootElement=function(){return a};a.setOpenOnHover=function(b){if(b!=a._openOnHover)b?window.addEventListener("mousedown",a.checkClickFunction,true):window.removeEventListener("mousedown",a.checkClickFunction,true),a._openOnHover=b};a.setFocusedCell=function(b){a._focusedCell&&
removeStyle(a._focusedCell,"activeOption");a._focusedCell=b;a._focusedCell&&addStyle(a._focusedCell,"activeOption")};a.matchProperty=function(b,c){for(var f,g=0;g<a.mnu.cells.length;g++)if(f=a.mnu.cells[g].matchProperty(b,c))return f;return false};a.getItem=function(b,c){return a.matchProperty(c||"caption",b)};a.addOption=function(b,c){var f=a.mnu.insertCell(c?c:a.mnu.cells.length);f._icon=f.appendChild($("div","DomPopupIconHolder"));f._caption=f.appendChild($("div","DomPopupCaptionHolder"));f._icon.style.display=
"none";f._xhandler=false;f._xmenuID=false;f._xicon=false;f._xcaption=false;f._xchild=false;f._expanded=false;f._disabled=false;f.matchProperty=function(a,b){try{if(f["_x".concat(a)]==b)return f}catch(c){throw'Invalid Property "'+a+'"!';}return f._xchild?f._xchild.matchProperty(a,b):false};f.getIcon=function(){return f._xicon};f.setIcon=function(a){f._icon.style.backgroundImage=!a?"none":"url('"+a+"')";f._xicon=a?a:false;f._icon.style.display=a?"":"none"};f.getCaption=function(){return f._xcaption};
f.setCaption=function(a){f._xcaption=a;f._caption.innerHTML="";a!==""&&f._caption.appendChild(document.createTextNode(a))};f.getChild=function(){return row._xchild};f.setChild=function(a){!a&&f._xchild&&f._xchild.parentNode&&f._xchild.parentNode.removeChild(f._xchild);f._xchild=a;a.rootMenu=f};f.getHandler=function(){return f._xhandler};f.setHandler=function(a){f._xhandler=a};f.getMenuID=function(){return f._xmenuID};f.setMenuID=function(a){f._xmenuID=a};f.getDisabled=function(){return f._disabled instanceof
Function?!!f._disabled():!!f._disabled};f.setDisabled=function(a){f._disabled=a;(f.getDisabled()?addStyle:removeStyle)(f,"disabled")};Object.defineProperty(f,"icon",{get:f.getIcon,set:f.setIcon});Object.defineProperty(f,"caption",{get:f.getCaption,set:f.setCaption});Object.defineProperty(f,"child",{get:f.getChild,set:f.setChild});Object.defineProperty(f,"handler",{get:f.getHandler,set:f.setHandler});Object.defineProperty(f,"menuID",{get:f.getMenuID,set:f.setMenuID});Object.defineProperty(f,"disabled",
{get:f.getDisabled,set:f.setDisabled});typeof b!="undefined"&&(f.setIcon(b.icon||false),f.setCaption(b.caption||false),typeof b.id!="undefined"&&f.setMenuID(b.id),typeof b.handler!="undefined"&&f.setHandler(b.handler),typeof b.disabled!="undefined"&&f.setDisabled(b.disabled));f.getExpanded=function(){return f._expanded};f.setExpanded=function(b){if(!f._disabled&&f._xchild)if(b){a.setFocusedCell(f);document.body.appendChild(f._xchild);f._xchild.setVisible(true);var b=f._xchild.offsetHeight,c=getXY(f);
c[0]+=document.body.scrollLeft||window.pageXOffset||(document.body.parentElement?document.body.parentElement.scrollLeft:0);c[1]+=document.body.scrollTop||window.pageYOffset||(document.body.parentElement?document.body.parentElement.scrollTop:0);f._xchild.style.left=c[0]+"px";f._xchild.style.top=c[1]+f.offsetHeight+b<getMaxY()?c[1]+f.offsetHeight+"px":c[1]-f._xchild.offsetHeight+"px";if(f._xchild.offsetLeft+f._xchild.offsetWidth>getMaxX())f._xchild.style.left=c[0]+f.offsetWidth-f._xchild.offsetWidth-
16+"px";f._xchild.setFocusedRow(false);if(f._xchild)for(b=0;b<f._xchild.rows.length;b++)f._xchild.rows[b]._isSeparator||f._xchild.rows[b].setExpanded(false)}else{try{document.body.removeChild(f._xchild)}catch(i){}f._xchild.setVisible(false)}};f.mouseHandler=function(b){b=b||window.event;try{var c=new MouseBoundaryCrossing(b,f)}catch(i){return}switch(true){case c.leftLandmark:try{if((new MouseBoundaryCrossing(b,f._xchild)).enteredLandmark)break}catch(g){}f.setExpanded(false);break;case c.enteredLandmark:if(!a._openOnHover)break;
f.setExpanded(true);a.setFocusedCell(f);for(b=0;b<a.mnu.cells.length;b++)f.cellIndex!=b&&a.mnu.cells[b].setExpanded(false)}};f.mouseDownListener=function(){if(!f.getDisabled()){f.setExpanded(true);a.setFocusedCell(f);for(var b=0;b<a.mnu.cells.length;b++)f.cellIndex!=b&&a.mnu.cells[b].setExpanded(false);a.setOpenOnHover(true)}};try{f.addEventListener("mousedown",f.mouseDownListener,true)}catch(g){f.attachEvent("onmousedown",f.mouseDownListener)}f.onmouseover=f.onmouseout=f.mouseHandler;f.clickListener=
function(){!f.getDisabled()&&f.getHandler()&&(a.resetMenu(),f.getHandler()(f.getMenuID()))};try{f.addEventListener("click",f.clickListener,false)}catch(l){f.attachEvent("onclick",f.clickListener)}return f};for(var b=0;b<c.length;b++)if(c[b]){var f=a.addOption(c[b]);c[b].items&&f.setChild(new Popup(c[b].items,a))}a.resetMenu=function(){for(var b=0;b<a.mnu.cells.length;b++)a.mnu.cells[b]._xchild&&a.mnu.cells[b]._xchild.setVisible(false);a.setFocusedCell(false);a.setOpenOnHover(false)};a.checkClickFunction=
function(b){if(b=b.target||window.event.srcElement){var c=0;if(b!=a)for(;c<=6&&b.parentNode;){for(var f=0;f<a.___stack.length;f++)if(b==a.___stack[f])return;b=b.parentNode;c++}a.resetMenu()}};try{window.addEventListener("mousedown",a.checkClickFunction,false)}catch(g){document.attachEvent("onmousedown",a.checkClickFunction)}return a}
Node.prototype.addContextMenu=function(c,a){a=a||function(){return true};if(!(typeof c=="undefined"||!c.length&&typeof c!="function")){if(typeof this._contextMenuConf=="undefined")this._contextMenuConf=c;else return this._contextMenuConf=c,this;var b=this;this._contextClickListener=function(c){c=c||window.event;if(!a(c))return true;b.resetMenu&&b.resetMenu();var f=c.pageX||c.clientX+(window.pageXOffset||(document.body.parentElement?document.body.parentElement.scrollLeft:0)),h=c.pageY||c.clientY+(window.pageYOffset||
(document.body.parentElement?document.body.parentElement.scrollTop:0));b._popup=new Popup(typeof b._contextMenuConf=="function"?b._contextMenuConf():b._contextMenuConf,b);b.___stack=[];document.body.appendChild(b._popup);h+b._popup.offsetHeight>getMaxY()&&(h-=b._popup.offsetHeight);f+b._popup.offsetWidth>getMaxX()&&(f-=b._popup.offsetWidth);b._popup.style.left=f+"px";b._popup.style.top=h+"px";b._popup.setExpanded=function(){};b._popup.setVisible(true);b._checkClickFunction=function(a){if(a=a.target||
window.event.srcElement)if(a===b)b.resetMenu();else{var c=0;if(a!=b){for(;c<=6&&a.parentNode;){for(var f=0;f<b.___stack.length;f++)if(a==b.___stack[f])return;a=a.parentNode;c++}b.resetMenu()}}};b.resetMenu=function(){b._popup.setVisible(false);b._popup=null;b.resetMenu=null;b.___stack=null;try{window.removeEventListener("mousedown",b._checkClickFunction,true)}catch(a){document.detachEvent("onmousedown",b._checkClickFunction)}b._checkClickFunction=null};try{window.addEventListener("mousedown",b._checkClickFunction,
true)}catch(j){document.attachEvent("onmousedown",b._checkClickFunction)}cancelEvent(c);return false};try{this.oncontextmenu=this._contextClickListener}catch(f){this.setAttribute("oncontextmenu","return false;"),this.onmousedown=this._contextClickListener}return this}};
function VerticalPanel(c){var a=$("div","DomPanelHolder");a.tbl=a.appendChild($("table","DomPanelTable"));a.add=function(b,c){var i=a.tbl.insertRow(typeof c=="undefined"?a.tbl.rows.length:c),i=i.insertCell(0);i.appendChild(b);return b};a.remove=function(b){typeof b!="undefined"?a.tbl.deleteRow(b):a.tbl.deleteRow(a.tbl.rows.length-1)};a.getItems=function(){for(var b=[],c=0;c<a.tbl.rows.length;c++)a.tbl.rows[c].cells[0].firstChild&&b.push(a.tbl.rows[c].cells[0].firstChild);return b};a.setItems=function(b){if(a.tbl.rows.length)for(;a.tbl.rows.length;)a.tbl.deleteRow(0);
for(var c=0;c<b.length;c++)a.add(b[c])};typeof c!="undefined"&&a.setItems(c);try{a.__defineGetter__("items",a.getItems),a.__defineSetter__("items",a.setItems)}catch(b){Object.defineProperty&&Object.defineProperty(a,"items",{get:a.getItems,set:a.setItems})}return a}
function HorizontalPanel(c){var a=$("div","DomPanelHolder");a.tbl=a.appendChild($("table","DomPanelTable"));a.tbl.insertRow(0);a.add=function(b,c){a.tbl.rows[0].insertCell(typeof c=="undefined"?a.tbl.rows[0].cells.length:c).appendChild(b);return b};a.remove=function(b){typeof b!="undefined"?a.tbl.rows[0].deleteCell(b):a.tbl.rows[0].deleteCell(a.tbl.rows[0].cells.length-1)};a.getItems=function(){for(var b=[],c=0;c<a.tbl.rows[0].cells.length;c++)a.tbl.rows[0].cells[c].firstChild&&b.push(a.tbl.rows[0].cells[c].firstChild);
return b};a.setItems=function(b){if(a.tbl.rows[0].cells.length)for(;a.tbl.rows[0].cells.length;)a.tbl.rows[0].deleteCell(0);for(var c=0;c<b.length;c++)a.add(b[c])};typeof c!="undefined"&&a.setItems(c);try{a.__defineGetter__("items",a.getItems),a.__defineSetter__("items",a.setItems)}catch(b){Object.defineProperty&&Object.defineProperty(a,"items",{get:a.getItems,set:a.setItems})}return a}
function ToolbarButton(c,a){var b=$("div","DomToolbarButton");b._icon=b.appendChild($("img"));b._caption=b.appendChild($("span"));if(a){var f=$("nobr");f.appendChild(b._icon);f.appendChild(b._caption);b.appendChild(f)}b._disabled=c&&c.disabled?c.disabled:false;b._pressed=c&&typeof c.pressed!="undefined"?c.pressed:null;b._handler=c&&c.handler?c.handler:null;if(c.id||c.buttonID)b._buttonID=c.id||c.buttonID;b._xicon="";b._xcaption="";b.getIcon=function(){return b._xicon};b._icon.src="img/blank.gif";
b._icon.onerror=function(){this.src="img/blank.gif"};b.setIcon=function(a){b._xicon=a;b._icon.src=a?a:""};b.getCaption=function(){return b._xcaption};b.setCaption=function(a){b._caption.innerHTML="";(b._xcaption=a)?(b._caption.appendChild(document.createTextNode(a)),b.title=a):b.title=""};b.getDisabled=function(){return b._disabled};b.setDisabled=function(a){b._disabled=a;(a?addStyle:removeStyle)(b,"disabled")};b.getPressed=function(){return b._pressed};b.setPressed=function(a){b._pressed=a?true:
false;(a?addStyle:removeStyle)(b,"pressed")};b.getHandler=function(){return b._handler};b.setHandler=function(a){b._handler=a};b.getButtonID=function(){return typeof b._buttonID!="undefined"?b._buttonID:null};b.setButtonID=function(a){b._buttonID=a};b._clickHandlerHookFunc=null;b.clickHandler=function(a){a=a||window.event;if(!((a.which||a.button)>1)){var c=a.target||a.srcElement;b._expanded&&b.setExpanded&&b.setExpanded(false);if(!(c.tagName=="DIV"&&c!=b)&&!b._disabled)return b._pressed!==null?(b.setPressed(!b.getPressed()),
b._handler&&b._handler!="%appHandler%"&&b._handler(b._pressed,typeof b._buttonID!="undefined"?b._buttonID:null)):b._handler&&b._handler!="%appHandler%"&&b._handler(typeof b._buttonID!="undefined"?b._buttonID:null),cancelEvent(a),b._clickHandlerHookFunc&&b._clickHandlerHookFunc(),false}};try{b.addEventListener("click",b.clickHandler,false)}catch(g){b.attachEvent("onclick",b.clickHandler)}c.icon&&b.setIcon(c.icon);c.caption&&b.setCaption(c.caption);typeof c.pressed!="undefined"&&b.setPressed(c.pressed);
if(c.tooltip)b.title=c.tooltip;c.disabled&&b.setDisabled(true);b.tabIndex=0;try{b.attachEvent("onmousedown",function(){addStyle(b,"active")}),b.attachEvent("onmouseup",function(){removeStyle(b,"active")}),b.attachEvent("onmouseout",function(){removeStyle(b,"active")})}catch(i){}disableSelection(b);return b}
function ToolbarMultiButton(c){for(var a=null,b=0,f=0;f<c.length;f++)if(typeof c[f].selected!="undefined"&&c[f].selected){a=c[f];b=f;break}a===null&&(a=c[0]);var g=new ToolbarButton(a);g._expandBtn=g.appendChild($("div","DomToolbarButtonExpandBtn"));g._buttonIndex=b;addStyle(g,"DomToolbarMultiButton");g._selectedButton=a;g._buttonsList=c;g._expanded=false;g._expandMenu=false;g.getSelectedButton=function(){return g._selectedButton};g.getSelectedIndex=function(){return g._buttonIndex};g.setSelectedIndex=
function(a){var b=g.offsetWidth;g._selectedButton=g._buttonsList[a];g._buttonIndex=a;g._handler=g._selectedButton.handler||null;g.setCaption(g._selectedButton.caption||"");g.setButtonID(g._selectedButton.id||g._selectedButton.buttonID||null);g.setIcon(g._selectedButton.icon||"");g.setExpanded(false);try{if(b!=g.offsetWidth)for(var c=g.parentNode;c;)if(c=c.parentNode){if(hasStyle(c,"DomAppToolbarZone")){c.onCustomEvent("resize",c);break}}else break}catch(f){}};g.getExpanded=function(){return g._expanded};
g.setExpanded=function(a){g._expanded=a?true:false;if(a){addStyle(g,"expanded");g._expandMenu=new VerticalPanel;addStyle(g._expandMenu,"DomToolbarMultiButtonMenu");for(a=0;a<g._buttonsList.length;a++)if(a!=g._buttonIndex){var b=g._expandMenu.add(new ToolbarButton(g._buttonsList[a],true));b._buttonIndex=a;b._clickHandlerHookFunc=function(){g.setSelectedIndex(this._buttonIndex)}}a=getXY(g);a[0]+=document.body.scrollLeft||window.pageXOffset||(document.body.parentElement?document.body.parentElement.scrollLeft:
0);a[1]+=document.body.scrollTop||window.pageYOffset||(document.body.parentElement?document.body.parentElement.scrollTop:0);g._expandMenu.style.left=a[0]+"px";g._expandMenu.style.top=a[1]+g._expandBtn.offsetHeight+"px";document.body.appendChild(g._expandMenu);g._expandMenu.setTop=function(){var a=getXY(g);a[0]+=document.body.scrollLeft||window.pageXOffset||(document.body.parentElement?document.body.parentElement.scrollLeft:0);a[1]+=document.body.scrollTop||window.pageYOffset||(document.body.parentElement?
document.body.parentElement.scrollTop:0);g._expandMenu.style.left=a[0]+"px";g._expandMenu.style.top=a[1]+g.offsetHeight+"px"};g._expandMenu.setTop();for(a=g.parentNode;a;)if(a=a.parentNode){if(hasStyle(a,"DomAppToolbarZone")){g._expandMenu.appToolbarZoneParent=a;break}}else break;g._expandMenu.appToolbarZoneParent&&g._expandMenu.appToolbarZoneParent.addCustomEventListener("resize",g._expandMenu.setTop);g._expandMenu.bodyMouseDownListener=function(a){a=a||window.event;for(a=a.target||a.srcElement;a;){if(a==
g._expandMenu)return true;if(a.parentNode)a=a.parentNode;else{g.setExpanded(false);break}}};try{window.addEventListener("mousedown",g._expandMenu.bodyMouseDownListener,true)}catch(c){document.attachEvent("onmousedown",g._expandMenu.bodyMouseDownListener)}}else{removeStyle(g,"expanded");try{g._expandMenu&&g._expandMenu.appToolbarZoneParent&&g._expandMenu.appToolbarZoneParent.removeCustomEventListener("resize",g._expandMenu.setTop);try{window.removeEventListener("mousedown",g._expandMenu.bodyMouseDownListener,
true)}catch(f){document.detachEvent("onmousedown",g._expandMenu.bodyMouseDownListener)}document.body.removeChild(g._expandMenu)}catch(l){}g._expandMenu=false}};g._expandBtnClickHandler=function(a){a=a||window.event;g.setExpanded(!g.getExpanded());cancelEvent(a);return false};g._expandBtn.onclick=g._expandBtnClickHandler;return g}
function Toolbar(c,a){var b=$("div","DomToolbar icons-normal");b.toolbarTitle=b.appendChild($("div","DomToolbarNoTitle"));disableSelection(b.toolbarTitle);b.pane=b.appendChild(new HorizontalPanel);b._iconSize="normal";b._textVisible=false;b._isVisible=true;b._toolbarTitle="";b._visibleTitle=false;b.add=function(a){return b.pane.add(typeof a.innerHTML!="undefined"?a:!a.items?new ToolbarButton(a):new ToolbarMultiButton(a.items))};if(typeof c!="undefined")for(var f=0;f<c.length;f++)c[f]&&b.add(c[f]);
b.getIconSize=function(){return b._iconSize};b.setIconSize=function(a){switch(a){case "medium":case "normal":removeStyle(b,"icons-large");removeStyle(b,"icons-none");addStyle(b,"icons-normal");b._iconSize="normal";break;case "large":removeStyle(b,"icons-none");removeStyle(b,"icons-normal");addStyle(b,"icons-large");b._iconSize="large";break;default:addStyle(b,"icons-none"),removeStyle(b,"icons-normal"),removeStyle(b,"icons-large"),b._iconSize="none"}};b.getButtonLabels=function(){return b._textVisible};
b.setButtonLabels=function(a){switch(a){case true:addStyle(b,"textVisible");b._textVisible=true;break;case false:removeStyle(b,"textVisible");b._textVisible=false;break;default:removeStyle(b,"textVisible"),b._textVisible=false}};b.getItems=b.pane.getItems;b.getIsVisible=function(){return b._isVisible};b.setIsVisible=function(a){b.style.display=a?"":"none";b._isVisible=a?true:false};b.getToolbarTitle=function(){return b._toolbarTitle};b.setToolbarTitle=function(a){if(a!=b._toolbarTitle)b._toolbarTitle=
a,b.toolbarTitle.innerHTML="",b.toolbarTitle.appendChild(document.createTextNode(a))};b.getTitleVisibility=function(){return b._visibleTitle};b.setTitleVisibility=function(a){b._visibleTitle=a?true:false;b.toolbarTitle.className=a?"DomToolbarTitle":"DomToolbarNoTitle";a?addStyle(b,"DomToolbarCaptionVisible"):removeStyle(b,"DomToolbarCaptionVisible")};typeof a!="undefined"&&b.setToolbarTitle(a);return b}
function AppToolbarZone(c,a){var b=$("div","DomAppToolbarZone");EnableCustomEventListeners(b);b._toolbars=[];b.__isIE7=navigator.appName=="Microsoft Internet Explorer"&&navigator.appVersion.indexOf("MSIE 7")!=-1;b._iconSize=a&&a.iconSize?a.iconSize:"normal";b._textVisible=a&&a.buttonLabels?a.buttonLabels:false;b._titlesVisible=a&&a.titles?a.titles:false;b._toolbarClass=a&&a.toolbarClass?a.toolbarClass:false;b._isIconSizeNone=function(){return b._iconSize=="none"?true:false};b._isIconSizeNormal=function(){return b._iconSize==
"normal"?true:false};b._isIconSizeLarge=function(){return b._iconSize=="large"?true:false};b.getTitles=function(){return b._titlesVisible};b.setTitles=function(a){b._titlesVisible=a;for(var c=0;c<b._toolbars.length;c++)b._toolbars[c].toolbar.setTitleVisibility(a);b.onCustomEvent("resize",b)};b.getIconSize=function(){return b._iconSize};b.setIconSize=function(a){for(var c=0;c<b._toolbars.length;c++)b._toolbars[c].toolbar.setIconSize(a);b._iconSize=a;a=="none"&&!b.getButtonLabels()&&b.setButtonLabels(true);
b.onCustomEvent("resize",b)};b.getButtonLabels=function(){return b._textVisible};b.setButtonLabels=function(a){b._textVisible=a;for(var c=0;c<b._toolbars.length;c++)b._toolbars[c].toolbar.setButtonLabels(a);!a&&b._isIconSizeNone()&&b.setIconSize("normal");b.onCustomEvent("resize",b)};b.setToolbarVisibility=function(a,c){b._toolbars[c].toolbar.setIsVisible(a);b.onCustomEvent("resize",b);b.onCustomEvent("toggleToolbar",{toolbar:b._toolbars[c].toolbar,name:b._toolbars[c].name,index:c,on:a})};b.updateContextMenu=
function(){for(var a=[],c=0;c<b._toolbars.length;c++)a.push({caption:b._toolbars[c].name,input:"checkbox",checked:b._toolbars[c].toolbar.getIsVisible,handler:b.setToolbarVisibility,id:c});b.addContextMenu([{caption:"Toolbars",items:a},false,{caption:"Settings",items:[{caption:"Show Toolbars Titles",input:"checkbox:aaa",checked:b.getTitles,handler:b.setTitles},{caption:"Show Text Labels",input:"checkbox:aaa",checked:b.getButtonLabels,handler:b.setButtonLabels},false,{caption:"No Icons",input:"radio:bbb",
id:"none",checked:b._isIconSizeNone,handler:b.setIconSize},{caption:"Medium Icons",input:"radio:bbb",id:"normal",checked:b._isIconSizeNormal,handler:b.setIconSize},{caption:"Large Icons",input:"radio:bbb",id:"large",checked:b._isIconSizeLarge,handler:b.setIconSize}]}])};b.getToolbarClass=function(){return b._toolbarClass};b.setToolbarClass=function(a){b._toolbarClass=a};b.addToolbar=function(a,c){a.style.display=b.__isIE7?"inline":"inline-block";b._toolbars.push({toolbar:a,name:typeof c!="undefined"?
c:a.getToolbarTitle()});a.setIconSize(b._iconSize);a.setToolbarTitle(c?c:a.getToolbarTitle());a.setButtonLabels(b._textVisible);a.setTitleVisibility(b._titlesVisible);b.appendChild(a);b.updateContextMenu()};if(c&&c.length)for(var f=0;f<c.length;f++)b.addToolbar(c[f]);b.addCustomEventListener("resize",function(){setTimeout(function(){try{getOwnerWindow(b).paint()}catch(a){}},10);return true});return b}
function Pinner(c,a,b){this.source=c||null;this.target=a||null;this.pinMode=b||"bottom";this.getPinMode=function(){return this.pinMode};this.setPinMode=function(a){switch(a){case "left":case "right":case "top":case "top-left":case "bottom":case "bottom-left":break;default:throw'Invalid pin mode. Allowed only: "left", "right", "top", "bottom", "bottom-left"';}if(this.source&&this.source.parentNode&&this.target&&this.target.parentNode){var b=this.source.offsetWidth,c=this.source.offsetHeight;this.target.style.left=
"";this.target.style.right="";this.target.style.top="";this.target.style.bottom="";var h=this.target.offsetWidth,j=this.target.offsetHeight,k=getXY(this.source);k[0]+=document.body.scrollLeft||window.pageXOffset||(document.body.parentElement?document.body.parentElement.scrollLeft:0);k[1]+=document.body.scrollTop||window.pageYOffset||(document.body.parentElement?document.body.parentElement.scrollTop:0);switch(a){case "right":this.target.style.left=k[0]+b+"px";this.target.style.top=k[1]+Math.floor(c/
2)-Math.floor(j/2)+"px";break;case "left":this.target.style.left=k[0]-h+"px";this.target.style.top=k[1]+Math.floor(c/2)-Math.floor(j/2)+"px";break;case "top":this.target.style.left=k[0]+Math.floor(b/2)-Math.floor(h/2)+"px";this.target.style.top=k[1]-j+"px";break;case "top-left":this.target.style.left=k[0]+"px";this.target.style.top=k[1]-j+"px";break;case "bottom":this.target.style.left=k[0]+Math.floor(b/2)-Math.floor(h/2)+"px";this.target.style.top=k[1]+c+"px";break;case "bottom-left":this.target.style.left=
k[0]+"px",this.target.style.top=k[1]+c+"px"}}};this.setSourceElement=function(a){this.source=a;this.setPinMode(this.pinMode)};this.getSourceElement=function(){return this.source};this.setTargetElement=function(a){this.target=a;this.setPinMode(this.pinMode)};this.getTargetElement=function(){return this.target};this.setTargetElement(this.target)}
function DOMPlaceable(c){var a=$("div","DOMPlaceable appearence-opaque"),b=a.appendChild($("div").setAnchors({width:function(a){return a+"px"},height:function(a,b){return b+"px"}}));a.insert=function(a){return a&&a instanceof Node?b.appendChild(a):null};(function(){var b="opaque";Object.defineProperty(a,"appearence",{get:function(){return b},set:function(a){try{this.removeClass("appearence-"+b),this.addClass("appearence-"+(b=a.toString()))}catch(c){console.error(a)}}})})();(function(){var b="";Object.defineProperty(a,
"caption",{get:function(){return b},set:function(c){for(var i=0,h=a.querySelectorAll("legend"),j=h.length;i<Math.min(j,1);i++)h[i].parentNode.removeChild(h[i]);(b=c.toString())&&a.appendChild($("legend")).appendChild($text(b))}})})();c=c||{};if(typeof c.appearence!="undefined")a.appearence=c.appearence;if(typeof c.caption!="undefined")a.caption=c.caption;return a}
function ProgressBar(c){var a=$("div","DomProgressBar");a.config=c||{minValue:0,maxValue:100,value:0,captionFormat:"",caption:""};a.config.minValue=typeof a.config.minValue!="undefined"?a.config.minValue:0;a.config.maxValue=typeof a.config.maxValue!="undefined"?a.config.maxValue:100;a.config.value=typeof a.config.value!="undefined"?a.config.value:0;a.config.captionFormat=typeof a.config.captionFormat!="undefined"?a.config.captionFormat:"";a.config.caption=typeof a.config.caption!="undefined"?a.config.caption:
"";a.inner=a.appendChild($("div","inner"));a.bar=a.inner.appendChild($("div","ProgressBar"));a._caption=a.inner.appendChild($("div","ProgressBarCaption"));a.bar.aDiv=a.bar.appendChild($("div"));a._caption.appendChild($text(a.config.caption));a.getValue=function(){return a.config.value};a.setValue=function(b){var b=b<a.config.minValue?a.config.minValue:b>a.config.maxValue?a.config.maxValue:b,c=(b-a.config.minValue)/((a.config.maxValue-a.config.minValue)/100);a.config.value=b;a.bar.style.width=c+"%";
a.updateCaption()};a.getCaption=function(){return a.config.caption};a.setCaption=function(b){a._caption.innerHTML="";b?a._caption.appendChild($("span")).appendChild($text(a.config.caption=b)):a.config.caption=""};a.updateCaption=function(){a.setCaption(a.config.captionFormat?a.config.captionFormat.replace(/\/v/g,a.config.value).replace(/\/min/g,a.config.minValue).replace(/\/max/g,a.config.maxValue):"")};a.getMinValue=function(){return a.config.minValue};a.setMinValue=function(b){a.config.minValue=
b;a.setValue(a.config.value)};a.getMaxValue=function(){return a.config.maxValue};a.setMaxValue=function(b){a.config.maxValue=b;a.setValue(a.config.value)};a.getCaptionFormat=function(){return a.config.captionFormat};a.setCaptionFormat=function(b){a.config.captionFormat=b;a.updateCaption()};a.__defineGetter__?(a.__defineGetter__("value",a.getValue),a.__defineSetter__("value",a.setValue),a.__defineGetter__("minValue",a.getMinValue),a.__defineSetter__("minValue",a.setMinValue),a.__defineGetter__("maxValue",
a.getMaxValue),a.__defineSetter__("maxValue",a.setMaxValue),a.__defineGetter__("captionFormat",a.getCaptionFormat),a.__defineSetter__("captionFormat",a.setCaptionFormat),a.__defineGetter__("caption",a.getCaption),a.__defineSetter__("caption",a.setCaption)):Object.defineProperty&&(Object.defineProperty(a,"value",{get:a.getValue,set:a.setValue}),Object.defineProperty(a,"minValue",{get:a.getMinValue,set:a.setMinValue}),Object.defineProperty(a,"maxValue",{get:a.getMaxValue,set:a.setMaxValue}),Object.defineProperty(a,
"captionFormat",{get:a.getCaptionFormat,set:a.setCaptionFormat}),Object.defineProperty(a,"caption",{get:a.getCaption,set:a.setCaption}));saveVal=a.config.value;a.config.value=-1;a.setValue(saveVal);saveVal=void 0;return a}Node.prototype.evaluate=function(c){eval(c)};
function PropertyGridRow(c,a,b,f){var g=$("div","DOMPropertyGridRow");g._settings=f;if(typeof f=="undefined"||!(f instanceof Object))throw"PropertyGridRow: Third function should be an Object-based variable";if(typeof f.items=="undefined"){if(typeof f.name=="undefined")throw"PropertyGridRow Arguments[3]: name property required!";if(typeof f.type=="undefined")throw"PropertyGridRow Arguments[3]: .type property required on variable ("+f.name+")";if(typeof f.label=="undefined")throw"PropertyGridRow Arguments[3]: .label property required!";
}g._labelHolder=g.appendChild($("div","GridRowLabel"));g._labelStr=f.label||"Label";g._valueHolder=g.appendChild($("div","GridRowValue"));g.__defineSetter__("height",function(a){g.style.height=a+"px";g.onDOMresize(g.offsetWidth,g.offsetHeight)});g.__defineGetter__("height",function(){return g.offsetHeight});g.__defineGetter__("name",function(){return f.name});g._isResizeable=false;g.getVerticalResize=function(){return g._isResizeable};g.setVerticalResize=function(a){a=a?true:false;if(a!=g._isResizeable){if(a)g.resizeHandler=
g.appendChild($("div","DOMPropertyGridVerticalResize")).setAttr("dragable","1"),g.resizeHandler.moveStart=function(){},g.resizeHandler.moveStop=function(){g.resizeHandler.style.top=null},g.resizeHandler.moveRun=function(){g.height=g.resizeHandler.offsetTop},g._dragListener_=new dragObject(g.resizeHandler,null,new Position(0,20),new Position(0,5E3),g.resizeHandler.moveStart,g.resizeHandler.moveRun,g.resizeHandler.moveStop,null,true);else try{g.removeChild(g.resizeHandler),delete g.resizeHandler}catch(b){}g._isResizeable=
a}};g.__defineGetter__("verticalResize",g.getVerticalResize);g.__defineSetter__("verticalResize",g.setVerticalResize);g._nullRow=g.appendChild($("div","GridNullValue").setAttr("style","display: none").setHTML('<b style="color: #666">[NULL]</b>'));g.__defineGetter__("label",function(){return g._labelStr});g.__defineSetter__("label",function(a){g._labelHolder.innerHTML="";g._labelHolder.appendChild($text(a));g._labelStr=a});g.label=g.label;if(typeof f.items=="undefined"){addStyle(g,"multi");g.tabIndex=
0;if(typeof window["PropertyGrid__"+f.type]=="undefined")throw"PropertyGrid: No plugin found to handle type "+f.type+"!";else{window["PropertyGrid__"+f.type](g._valueHolder,f);for(var i=g.__inputs=g._valueHolder.querySelectorAll("input,select,textarea"),h=0;h<i.length;h++)(function(a){a.addEventListener("focus",function(){addStyle(g,"focused")},true);a.addEventListener("blur",function(){removeStyle(g,"focused")},true)})(i[h]);g._valueHolder.addEventListener("focus",function(){addStyle(g,"focused")},
true);g._valueHolder.addEventListener("blur",function(){removeStyle(g,"focused")},true);g.addEventListener("focus",function(){if(typeof g.__inputs!="undefined"&&g.__inputs.length){g.__inputs[g.__inputs.length-1].focus();try{g.__inputs[g.__inputs.length-1].select()}catch(a){}}},true);g.validate=function(){if(!g._settings)return true;var a=g._valueHolder.querySelectorAll('input[type="text"],textarea');if(!a.length)return true;switch(true){case typeof g._settings.minLength!="undefined":var b=parseInt(g._settings.minLength);
if(isNaN(b)||b<0)break;if(a[0].value.toString().length<b)throw"Field length must be at least "+b+" chars!";case typeof g._settings.maxLength!="undefined":b=parseInt(g._settings.maxLength);if(isNaN(b)||b<1)break;if(a[0].value.toString().length>b)throw"Field length must not exceed "+b+" chars!";case typeof g._settings.regexp!="undefined":b=g._settings.regexp instanceof RegExp?g._settings.regexp:RegExp(g._settings.regexp);if(!b)throw"Invalid regular expression: '"+g._settings.regexp+"'";if(!b.test(a[0].value.toString()))throw typeof g._settings.regexpError==
"undefined"?"Value '"+a[0].value.toString()+"' does not match regular expression '"+g._settings.regexp+"'":g._settings.regexpError;}return true};g.addEventListener("blur",function(a){if(!g._isNull)try{if(!g.validate())throw"Error validate row!";}catch(b){cancelEvent(a);alert(b);try{g.querySelectorAll("input[type=text],textarea")[0].focus().select()}catch(c){}}},true)}g._isNull=false;g.getValue=function(){return g._isNull?null:g._valueHolder.value};g.getInput=function(){if(typeof g._valueHolder.input!=
"undefined")return g._valueHolder.input;var a=g._valueHolder.querySelectorAll("input,select,textarea");return a.length?a[0]:null};g.setValue=function(a){if(a===null){g._isNull=true;try{g.removeChild(g._valueHolder)}catch(b){}}else g._isNull=false,g.appendChild(g._valueHolder),g._valueHolder.value=a;g._nullRow.style.display=g._isNull?"block":"none"};g.setInput=function(){throw"Property 'input' is readOnly";};g.__defineGetter__("value",g.getValue);g.__defineSetter__("value",g.setValue);g.__defineGetter__("input",
g.getInput);g.__defineSetter__("input",g.setInput);g.value=typeof f.value!="undefined"?f.value:null;g._defaultValue=g.value;a.__defineGetter__(f.name,g.getValue);a.__defineSetter__(f.name,g.setValue);b.__defineGetter__(f.name,g.getInput);b.__defineSetter__(f.name,g.setInput)}else{addStyle(g,"single");g._nameSpace={};g._inputSpace={};g.__defineGetter__("data",function(){return g._nameSpace});g.__defineSetter__("data",function(){throw"Property 'data' is readOnly";});g.__defineGetter__("inputSpace",
function(){return g._inputSpace});g.__defineSetter__("inputSpace",function(){throw"Property 'inputSpace' is readOnly";});a.__defineGetter__(f.name,function(){return g.data});a.__defineSetter__(f.name,function(){throw"Property "+f.name+" is readOnly!";});b.__defineGetter__(f.name,function(){return g.inputSpace});b.__defineSetter__(f.name,function(){throw"Property "+f.name+" is readOnly!";});g._rows=[];for(h=0;h<f.items.length;h++)g._rows.push(new PropertyGridRow(c,g._nameSpace,g._inputSpace,f.items[h]));
g._dumpChilds=function(){for(var a=g.nextSibling?g.nextSibling:null,b=0;b<g._rows.length;b++)a?g.parentNode.insertBefore(g._rows[b],a):g.parentNode.appendChild(g._rows[b])};g._isExpanded=false;g._expandHolder=g.appendChild($("div","DOMPropertyGridExpand"));g.__defineGetter__("expanded",function(){return g._isExpanded});g.__defineSetter__("expanded",function(a){(a?addStyle:removeStyle)(g._expandHolder,"expanded");for(var b=0;b<g._rows.length;b++)g._rows[b].style.display=a?"block":"none";g._isExpanded=
a?true:false;try{a&&getOwnerWindow(g).paint()}catch(c){}});g.onclick=function(){g.expanded=!g.expanded;c.splitPosition=c.splitPosition};disableSelection(g);g.expanded=typeof f.expanded=="undefined"?true:f.expanded}g.splitAt=function(a){if(hasStyle(g,"multi"))g._labelHolder.style.width=a-20+"px",g._valueHolder.style.width=g.offsetWidth-a-2+"px",g._nullRow.style.width=g.offsetWidth-a-2+"px";if(typeof g._rows!="undefined")for(var b=0;b<g._rows.length;b++)g._rows[b].splitAt(a)};g.reset=function(){if(typeof f.items==
"undefined")g.value=g._defaultValue;else for(var a=0;a<g._rows.length;a++)g._rows[a].reset()};return g}
function PropertyGrid(c){var a=$("div","DOMPropertyGrid");a.inner=a.appendChild($("div","DOMPropertyGridInner"));a.inner.DOManchors={width:function(a){return a+"px"},height:function(a,b){return b+"px"}};a.toolbarHolder=a.inner.appendChild($("div","DOMPropertyGridToolbarHolder"));a.body=a.inner.appendChild($("div","DOMPropertyGridBody"));(function(){var b=true;Object.defineProperty(a,"hasToolbar",{get:function(){return b},set:function(c){b=!!c;(!b?addStyle:removeStyle)(a,"no-toolbar")}})})();a.resizeBar=
a.appendChild($("div","DOMPropertyGridResizeHandle").setAttr("dragable","1"));a._lastSplitPosition=0;a._rows=[];a._nameSpace={};a._inputs={};a.getSplitPosition=function(){return a.resizeBar.offsetLeft};a.setSplitPosition=function(b){a.resizeBar.style.left=b+"px";for(var c=0;c<a._rows.length;c++)a._rows[c].splitAt(b)};EnableCustomEventListeners(a);a.resizeBar.moveStart=function(){};a.resizeBar.moveStop=function(){};a.resizeBar.moveRun=function(){var b;if(a._lastSplitPosition!=(b=a.getSplitPosition()))a._lastSplitPosition=
b,a.onCustomEvent("resize",a.getSplitPosition())};a.addCustomEventListener("resize",function(b){a.splitPosition=b});a._dragListener_=new dragObject(a.resizeBar,null,new Position(1,33),new Position(5E3,33),a.resizeBar.moveStart,a.resizeBar.moveRun,a.resizeBar.moveStop,null,true);a.__defineGetter__("splitPosition",a.getSplitPosition);a.__defineSetter__("splitPosition",a.setSplitPosition);a.insertRow=function(b){a._rows.push(a.body.appendChild(b=new PropertyGridRow(a,a._nameSpace,a._inputs,b)));b._dumpChilds&&
b._dumpChilds()};for(var b=0;b<c.length;b++)a.insertRow(c[b]);a.body.DOManchors={dummy:function(){a.splitPosition=a.splitPosition;return""}};a.__defineGetter__("values",function(){return a._nameSpace});a.__defineSetter__("values",function(){throw"Property 'values' is readOnly";});a.__defineGetter__("inputs",function(){return a._inputs});a.__defineSetter__("inputs",function(){throw"Property 'inputs' is readOnly";});a.bind=function(b,c,i,h){for(var j=c.split("."),k=a._inputs,l=0;l<j.length;l++){if(typeof k[j[l]]==
"undefined")throw'PropertyGrid.bind: invalid input path: "'+c+'"';k=k[j[l]]}k.addEventListener(b,i,typeof propagationType=="undefined"?false:h)};a.bindCustom=function(b,c,i){for(var h=c.split("."),j=a._inputs,k=0;k<h.length;k++){if(typeof j[h[k]]=="undefined")throw'PropertyGrid.bind: invalid input path: "'+c+'"';j=j[h[k]]}if(!j.addCustomEventListener)throw"Input '"+c+"' does not support custom event listeners!";j.addCustomEventListener(b,i)};a.views=[];a.__defineGetter__("rows",function(){for(var b=
[],c=0;c<a._rows.length;c++)if(hasStyle(a._rows[c],"multi"))b.push(a._rows[c]);else if(a._rows[c]._rows)for(var i=0;i<a._rows[c]._rows.length;i++)hasStyle(a._rows[c]._rows[i],"multi")&&b.push(a._rows[c]._rows[i]);return b});a.__defineSetter__("rows",function(){throw"Property 'rows' is readOnly!";});a.__defineGetter__("groups",function(){for(var b=[],c=0;c<a._rows.length;c++)if(hasStyle(a._rows[c],"single"))b.push(a._rows[c]);else if(a._rows[c]._rows)for(var i=0;i<a._rows[c]._rows.length;i++)hasStyle(a._rows[c]._rows[i],
"single")&&b.push(a._rows[c]._rows[i]);return b});a.__defineSetter__("groups",function(){throw"Property 'groups' is readOnly!";});a.__defineGetter__("all",function(){for(var b=[],c=a.rows,i=a.groups,h=0;h<c.length;h++)b.push(c[h]);for(h=0;h<i.length;h++)b.push(i[h]);return b});a.__defineSetter__("all",function(){throw"Property 'all' is readOnly!";});a.views.push({mode:"groupped",button:a.toolbarHolder.appendChild($("div","DOMPropertyGridButton ViewGroupped pressed")),func:function(){for(var b=a.all,
c=0;c<b.length;c++)try{b[c].parentNode.removeChild(b[c])}catch(i){}for(c=0;c<a._rows.length;c++)a.body.appendChild(a._rows[c]);for(c=0;c<a._rows.length;c++)a._rows[c]._dumpChilds&&a._rows[c]._dumpChilds();for(c=0;c<b.length;c++)removeStyle(b[c],"forceShow")}});a.views.push({mode:"sorted",button:a.toolbarHolder.appendChild($("div","DOMPropertyGridButton ViewSorted")),func:function(){for(var b=a.all,c=0;c<b.length;c++)try{b[c].parentNode.removeChild(b[c])}catch(i){}for(var b=a.rows,h=[],c=0;c<b.length;c++)h.push({label:b[c].label.toString().trim(),
row:b[c]});h.sort(function(a,b){return a.label==b.label?0:a.label>b.label?1:-1});for(c=0;c<h.length;c++)a.body.appendChild(h[c].row),addStyle(h[c].row,"forceShow")}});a._viewMode=null;a.getViewMode=function(){return a._viewMode};a.setViewMode=function(b){for(var c=false,i=0;i<a.views.length;i++)a.views[i].mode==b?(c=true,addStyle(a.views[i].button,"pressed"),a.views[i].func()):removeStyle(a.views[i].button,"pressed");if(c===false)throw"Invalid viewMode value! (hint: 'groupped' or 'sorted' should work";
a._viewMode=b};for(b=0;b<a.views.length;b++)(function(b,c,i){b.onclick=function(){a.setViewMode(i)}})(a.views[b].button,a.views[b].func,a.views[b].mode);Object.defineProperty(a,"viewMode",{get:a.getViewMode,set:a.setViewMode});a.reset=function(){for(var b=0;b<a._rows.length;b++)a._rows[b].reset()};a.applyValue=function(b,c){for(var i=b.split("."),h=0;h<i.length;h++)i[h]=JSON.stringify(i[h]);try{var j="this.values["+i.join("][")+"] = "+JSON.stringify(c);a.evaluate(j)}catch(k){alert(k)}};return a}
function PropertyGrid__Generic(c,a){c.__value=null;c.__defineGetter__("value",function(){return c.__value});c.__defineSetter__("value",function(a){c.__value=a;c.innerHTML="";c.appendChild($text(a===null?"null":typeof a=="undefined"?"undefined":a.toString()))});c.value=a.value;addStyle(c,"DOMPropertyGrid__Generic")}function PropertyGrid__FORCE_INT_CAST(c){c=parseInt(c);return isNaN(c)?0:c}function PropertyGrid__FORCE_FLOAT_CAST(c){c=parseFloat(c);return isNaN(c)?0:c}
function PropertyGrid__int(c,a){var a=a||{},b={};b.value=typeof a.value!="undefined"?PropertyGrid__FORCE_INT_CAST(a.value):typeof a.defaultValue!="undefined"?PropertyGrid__FORCE_INT_CAST(a.defaultValue):0;b.minValue=typeof a.min!="undefined"?PropertyGrid__FORCE_INT_CAST(a.min):-1E10;b.maxValue=typeof a.max!="undefined"?PropertyGrid__FORCE_INT_CAST(a.max):1E10;c.input=c.appendChild(new Spinner(b));addStyle(c.input,"DOMPropertyGrid__inputSpinner");c.__defineGetter__("value",function(){return c.input.value});
c.__defineSetter__("value",function(a){c.input.value=a})}
function PropertyGrid__float(c,a){var a=a||{},b={};b.value=typeof a.value!="undefined"?PropertyGrid__FORCE_FLOAT_CAST(a.value):typeof a.defaultValue!="undefined"?PropertyGrid__FORCE_FLOAT_CAST(a.defaultValue):0;if(typeof a.minValue!="undefined")b.minValue=PropertyGrid__FORCE_FLOAT_CAST(a.minValue);if(typeof a.maxValue!="undefined")b.maxValue=PropertyGrid__FORCE_FLOAT_CAST(a.maxValue);c.input=c.appendChild(new Spinner(b));addStyle(c.input,"DOMPropertyGrid__inputSpinner");c.__defineGetter__("value",
function(){return c.input.value});c.__defineSetter__("value",function(a){c.input.value=a})}
function PropertyGrid__date(c,a){var a=a||"",b={};typeof a.valueFormat!="undefined"?(b.valueFormat=a.valueFormat,b.displayFormat=a.valueFormat||a.displayFormat):(b.valueFormat="%Y/%m/%d",b.displayFormat="%Y/%m/%d");c.innerHTML="";c.appendChild(c.input=new DateBox(b));addStyle(c.input,"DOMPropertyGrid__inputDate");c.__defineGetter__("value",function(){return c.input.value});c.__defineSetter__("value",function(a){try{c.input.value=a}catch(b){}});Keyboard.bindKeyboardHandler(c.input,"backspace",function(){c.value=
""});Keyboard.bindKeyboardHandler(c.input,"delete",function(){c.value=""});if(typeof a.value!="undefined")c.value=a.value}
function PropertyGrid__bool(c,a){c.innerHTML="";c.input=c.appendChild(new DOMCheckBox);addStyle(c.input,"DOMPropertyGrid__inputCheckBox");c.__defineGetter__("value",function(){return c.input.checked});c.__defineSetter__("value",function(a){var f=c.input.checked;c.input.checked=a?true:false;if(f!=c.input.checked)c.input.onCustomEvent("change",c.input.checked)});c.value=typeof a.value=="undefined"?false:true;c.addEventListener("click",function(a){if(a.target==c||a.srcElement==c)c.value=!c.value},true);
c.input.addEventListener("click",function(){c.input.onCustomEvent("change",c.input.checked)},false);c.tabIndex=0}
function PropertyGrid__varchar(c,a){c.innerHTML="";c.input=c.appendChild((new TextBox("")).setAttr("type","text"));addStyle(c.input,"DOMPropertyGrid__inputTextBox");typeof a.placeholder!="undefined"&&c.input.setAttr("placeholder",a.placeholder);c.__defineGetter__("value",function(){return c.input.value});c.__defineSetter__("value",function(a){c.input.value=a});c.value=typeof a.value=="undefined"?"":a.value}
function PropertyGrid__password(c,a){c.innerHTML="";c.input=c.appendChild((new TextBox("")).setAttr("type","password"));addStyle(c.input,"DOMPropertyGrid__inputTextBox");typeof a.placeholder!="undefined"&&c.input.setAttr("placeholder",a.placeholder);c.__defineGetter__("value",function(){return c.input.value});c.__defineSetter__("value",function(a){c.input.value=a});c.value=typeof a.value=="undefined"?"":a.value}
function PropertyGrid__dropdown(c,a){c.innerHTML="";c.input=c.appendChild(new DropDown);addStyle(c.input,"DOMPropertyGrid__inputSelect");c.__defineGetter__("value",function(){return c.input.value});c.__defineSetter__("value",function(a){c.input.value=a});c.__defineSetter__("values",function(a){for(var f=0;f<a.length;f++)if(typeof a[f].id!="undefined"&&typeof a[f].name!="undefined")a[f].value=a[f].id,a[f].text=a[f].name;c.input.setItems(a)});c.input.__defineSetter__("values",function(a){c.values=a});
if(typeof a.values!="undefined")c.values=a.values;c.input.addEventListener("change",function(){c.input.onCustomEvent("change")},true);EnableCustomEventListeners(c.input)}
function PropertyGrid__textarea(c,a){c.innerHTML="";c.input=c.appendChild(new TextArea(""));c.input.style.resize="none";addStyle(c.input,"DOMPropertyGrid__textArea");c.__defineGetter__("value",function(){return c.input.value});c.__defineSetter__("value",function(a){c.input.value=a});c.parentNode.verticalResize=typeof a.resizeable!="undefined"?a.resizeable:true;c.input.placeholder=a.placeholder||"";if(typeof a.value!="undefined")c.value=a.value;c.parentNode.height=typeof a.height!="undefined"?a.height:
50}
function PropertyGrid__DOMStyle(c,a){c.innerHTML="";c.input=c.appendChild(new TextArea(""));c.input.style.resize="none";addStyle(c.input,"DOMPropertyGrid__textArea");Object.defineProperty(c,"value",{get:function(){return c.input.value},set:function(a){a=a.replace(/;/g,";\n");a=a.replace(/\n[\s]+/g,"\n");c.input.value=a;a=a.split("\n").length;try{c.parentNode.height=a*16}catch(f){}}});c.input.addCustomEventListener("change",function(){var a=c.input.value.split("\n").length;c.parentNode.height=a*16;
return true});c.parentNode.verticalResize=typeof a.resizeable!="undefined"?a.resizeable:true;if(typeof a.value!="undefined")c.value=a.value;c.input.addEventListener("mousewheel",function(a){for(var f=c.input.selectionStart,f=f||0,g=c.input.value;f>=0&&!/[\s\:\;\,\)]/.test(g.charAt(f));)f--;f++;for(var i=f;i<g.length&&/[\-\da-z\%]/.test(g.charAt(i));)i++;var h;if(h=/^([\-\d]+)(px|\%)?$/.exec(g.substr(f,i-f))){var j=parseInt(h[1]);h=h[2]||"";if(typeof a.wheelDelta!="undefined")a.wheelDelta>0?j+=a.shiftKey?
20:a.altKey?1:5:j-=a.shiftKey?20:a.altKey?1:5,a=j+""+h,g=g.substr(0,f)+a+g.substr(i),c.input.value=g,c.input.onCustomEvent("change"),c.input.selectionStart=f,c.input.selectionEnd=f+a.length}},true);c.parentNode.height=typeof a.height!="undefined"?a.height:50}
function PropertyGrid__color(c,a){c.innerHTML="";c.input=c.appendChild(new ColorPicker(a.value||"#000"));c.input.style.width="100%";addStyle(c.input,"DOMPropertyGrid__color");c.__defineGetter__("value",function(){return c.input.value});c.__defineSetter__("value",function(a){c.input.value=a});c.parentNode.height=20;c.input.style.borderColor="transparent"}
function PropertyGrid__image(c,a){c.input=c.appendChild($("img"));c.input.loaded=false;c.input.ok=false;EnableCustomEventListeners(c.input);Object.defineProperty(c,"value",{get:function(){return c.input.ok?c.input.src:""},set:function(a){c.input.ok=false;c.input.src=a;c.input.style.height="";c.input.style.maxHeight="";c.input.style.maxWidth="";c.input.style.display="none"}});c.input.style.height="auto";c.input.style.maxHeight="32px";c.input.style.maxWidth="32px";c.input.style.display="none";c.info=
c.appendChild($("span"));c.info.style.whiteSpace="nowrap";c.input.style.verticalAlign="middle";var b=c.appendChild($("input").setAttr("type","file").setAttr("style","padding: 0; float: right; display: block; width: 83px;"));b.addEventListener("click",function(){b.parentNode.scrollTop=0;c.scrollTop=0},true);c.input.onload=function(){var f;c.input.style.display="inline-block";if(typeof a.widthHeight!="undefined"&&(f=/^([\d]+)x([\d]+)$/.exec(a.widthHeight)))if(parseInt(f[1])!=c.input.width||parseInt(f[2])!=
c.input.height){DialogBox("Image size should be of "+a.widthHeight+" pixels, \nbut yours is "+c.input.width+"x"+c.input.height+" pixels, \nplease select other image!",{caption:"Bad image size",type:"error"});c.value="";c.info.innerHTML="none";return}if(typeof a.maxWidthHeight!="undefined"&&(f=/^([\d]+)x([\d]+)$/.exec(a.maxWidthHeight)))if(parseInt(f[1])<c.input.width||parseInt(f[2])<c.input.height){DialogBox("Image size should be maximum "+a.maxWidthHeight+" pixels, \nbut yours is "+c.input.width+
"x"+c.input.height+" pixels, \nplease select other image!",{caption:"Bad image size",type:"error"});c.value="";c.info.innerHTML="none";return}c.input.style.maxHeight="32px";c.input.style.maxWidth="32px";c.info.innerHTML="";c.input.style.visibility="visible";c.input.ok=true;c.input.onCustomEvent("change",c.input.src);f=Math.min(64,c.input.offsetHeight);f<20&&(f=20);c.parentNode.height=f;b.style.marginTop=(f-20)/2+"px"};c.input.onerror=function(){c.input.style.display="none";c.info.innerHTML="none";
c.input.ok=false;c.input.onCustomEvent("change","");c.input.style.visibility="hidden";c.parentNode.height=20};c.value=a.value||"";b.addEventListener("change",function(b){if(!window.File&&window.FileReader&&window.FileList&&window.Blob)DialogBox("Error: HTML5 File Api's not supported!",{type:"error",caption:"Error browsing file",childOf:getOwnerWindow(c),modal:true});else if(b=b.target.files,b.length)if(b=b[0],b.size&&a.maxFileSize&&b.size>a.maxFileSize)DialogBox("Error: File too large. Please select a file of maximum "+
a.maxFileSize+" bytes",{type:"error",caption:"Error browsing file",childOf:getOwnerWindow(c),modal:true});else{/^image(\/|$)/.test(b.type)||DialogBox("Error: File is not an image!",{type:"error",caption:"Error browsing file",childOf:getOwnerWindow(c),modal:true});var g=new FileReader;g.onload=function(){return function(a){c.value=a.target.result}}(b);g.readAsDataURL(b)}},true)}
function PropertyGrid__code(c,a){c.input=c.appendChild($("div","PropertyGrid_Code"));var b="editor_"+getUID();try{var f=eval(a.tabPanel);if(!(f instanceof Node)||!(f.addTab instanceof Function))throw"Not evaluated as a tabPanel!";}catch(g){a.tabPanel='function() { alert("No tab panel defined. Code editing is disabled!"); throw "ERR_NO_TAB_PANEL"; }'}EnableCustomEventListeners(c.input);(function(){var b="";try{a.evaluator=a.evaluator?eval("("+a.evaluator.toString()+")"):function(a){return a};if(!(a.evaluator instanceof
Function))throw"PropertyGrid.input[type=code]: using default evaluator";a.evaluator=a.evaluator.toString()}catch(f){a.evaluator="function( s ) { return s; }"}b.evaluate=function(){return eval("("+a.evaluator+")")(b)};Object.defineProperty(c.input,"value",{get:function(){return b},set:function(f){b=(f||a.template||"").toString();c.input.innerHTML="";c.input.appendChild($text(c.title=b.toString().substr(0,256)))}})})();Object.defineProperty(c,"value",{get:function(){return c.input.value},set:function(b){c.input.value=
a.syntax=="javascript"?js_beautify(b):b}});c.appendChild((new Button("...",c.browse=function(){for(var f=eval(a.tabPanel),h=f.getTabs(),g=0,k=h.length;g<k;g++)if(h[g]&&h[g].editor==c){h[g].active=true;return}var l=f.addTab({caption:function(){return a.snippetName?eval("("+a.snippetName+")")():"snippet"}(),id:b});l.getTab().editor=c;l.getTab().active=true;var m=new AceEditor;m.value=c.input.value||a.template||"";if(a.syntax)m.syntax=a.syntax;l.insert(m.setAnchors({width:function(a){return a+"px"},
height:function(a,b){return b-40+"px"}}).setAttr("style","margin-top: 40px"));var o=function(){if(a.compiler){var b=eval("("+a.compiler+")");if(b&&b instanceof Function&&!b(m.value))return false}if(a.validator&&(b=eval("("+a.validator+")"))&&b instanceof Function&&!b(m.value))return false;c.input.value=m.value;c.input.onCustomEvent("change");return true};l.insert((new Button("Save",function(){o()&&l.getTab().close()})).setAttr("style","position: absolute; left: 5px; top: 5px"));l.insert((new Button("Cancel",
function(){l.getTab().close()})).setAttr("style","position: absolute; left: 60px; top: 5px"));Keyboard.bindKeyboardHandler(m,"ctrl s",function(){o()&&l.getTab().close()})})).addClass("PropertyGrid_Code_Browse"));c.value=a.value||""}
function PropertyGrid__imageList(c,a){a.value=a.value||null;if(typeof a.values=="undefined"||!(a.values instanceof Array))a.values=[a.value];c.input=c.appendChild($("div"));EnableCustomEventListeners(c.input);var b=a.value,f=a.values;Object.defineProperty(c.input,"value",{get:function(){return b},set:function(a){b=a;for(var f=0,h=c.input.querySelectorAll("img"),j=h.length;f<j;f++)(a==h[f].getAttribute("src")?addStyle:removeStyle)(h[f],"selected")}});Object.defineProperty(c.input,"values",{get:function(){return f},
set:function(a){a=a||[];a instanceof Array||(a=[]);f=a;c.input.innerHTML="";for(var b=0,h=a.length;b<h;b++)if(a[b]){var j=$("img");j.onerror=function(){this.parentNode&&this.parentNode.removeChild(this)};j.setAttribute("src",a[b]);c.input.appendChild(j)}}});addStyle(c,"DOMPropertyGrid__ImageList");c.parentNode.height=a.height||70;c.parentNode.verticalResize=typeof a.resizeable!="undefined"?!!a.resizeable:true;c.input.addEventListener("click",function(a){if((a=a.srcElement||a.target)&&a.nodeName.toString().toLowerCase()==
"img")c.input.value=a.getAttribute("src"),c.input.onCustomEvent("change")},true);c.input.values=f;c.input.value=b;Object.defineProperty(c,"value",{get:function(){return c.input.value},set:function(a){c.input.value=a}})}
function PropertyGrid__OneDB_AceEditor(c,a){a.height=a.height||128;c.parentNode.height=a.height;c.input=c.appendChild((new AceEditor).setAnchors({width:function(a){return a+"px"},height:function(a,c){return c+"px"}}));Object.defineProperty(c,"value",{get:function(){return a._getter?a._getter(c.input.value):c.input.value},set:function(b){c.input.value=a._setter?a._setter(b):b}});c.value=a.value||"";if(typeof a.syntax!="undefined")c.input.syntax=a.syntax}
function Position(c,a){this.X=c;this.Y=a;this.Add=function(a){var c=new Position(this.X,this.Y);a!=null&&(isNaN(a.X)||(c.X+=a.X),isNaN(a.Y)||(c.Y+=a.Y));return c};this.Subtract=function(a){var c=new Position(this.X,this.Y);a!=null&&(isNaN(a.X)||(c.X-=a.X),isNaN(a.Y)||(c.Y-=a.Y));return c};this.Min=function(a){var c=new Position(this.X,this.Y);if(a==null)return c;if(!isNaN(a.X)&&this.X>a.X)c.X=a.X;if(!isNaN(a.Y)&&this.Y>a.Y)c.Y=a.Y;return c};this.Max=function(a){var c=new Position(this.X,this.Y);if(a==
null)return c;if(!isNaN(a.X)&&this.X<a.X)c.X=a.X;if(!isNaN(a.Y)&&this.Y<a.Y)c.Y=a.Y;return c};this.Bound=function(a,c){return this.Max(a).Min(c)};this.Check=function(){var a=new Position(this.X,this.Y);if(isNaN(a.X))a.X=0;if(isNaN(a.Y))a.Y=0;return a};this.Apply=function(a){typeof a=="string"&&(a=document.getElementById(a));if(a!=null){if(!isNaN(this.X))a.style.left=this.X+"px";if(!isNaN(this.Y))a.style.top=this.Y+"px"}}}
function hookEvent(c,a,b){typeof c=="string"&&(c=document.getElementById(c));c!=null&&(c.addEventListener?c.addEventListener(a,b,false):c.attachEvent&&c.attachEvent("on"+a,b))}function unhookEvent(c,a,b){typeof c=="string"&&(c=document.getElementById(c));c!=null&&(c.removeEventListener?c.removeEventListener(a,b,false):c.detachEvent&&c.detachEvent("on"+a,b))}function getMousePos(c){c=c?c:window.event;return isNaN(c.layerX)?new Position(c.offsetX,c.offsetY):new Position(c.layerX,c.layerY)}
function getEventTarget(c){c=c?c:window.event;return c.target?c.target:c.srcElement}function absoluteCursorPostion(c){c=c?c:window.event;return isNaN(window.scrollX)?new Position(c.clientX+document.documentElement.scrollLeft+document.body.scrollLeft,c.clientY+document.documentElement.scrollTop+document.body.scrollTop):new Position(c.clientX+window.scrollX,c.clientY+window.scrollY)}
function dragObject(c,a,b,f,g,i,h,j,k,l){function m(a){if(a.which==1){var b=getEventTarget(a);if(!b.getAttribute("dragable")||hasStyle(b,"nomove"))return true;if(!t&&w&&!u)if(hasStyle(b,"DOMWindowTitle")&&activateWindow(b.parentWnd),t=true,g!=null&&g(a,c)=="cancel")t=false;else return p=absoluteCursorPostion(a),r=new Position(parseInt(c.style.left?c.style.left:c.offsetLeft),parseInt(c.style.top?c.style.top:c.offsetTop)),r=r.Check(),hookEvent(document,"mousemove",o),hookEvent(document,"mouseup",n),
cancelEvent(a)}}function o(a){if(t&&!u){if(maintainXScrollElement!==null){var h=0,g=maintainXScrollElement.scrollLeft,j=maintainXScrollElement.scrollLeft,h=c.offsetLeft,k=c.offsetLeft+c.offsetWidth;maintainXScrollElement.scrollLeft>h&&maintainXScrollElement.scrollLeft>0?j=h:maintainXScrollElement.scrollLeft+maintainXScrollElement.clientWidth<k&&(j=k-maintainXScrollElement.clientWidth);h=g-j;Math.abs(h)>10&&!a.shiftKey&&(h=h<0?-10:10,j=g-h);if(j!=maintainXScrollElement.scrollLeft)maintainXScrollElement.scrollLeft=
j,r.X-=h}if(maintainYScrollElement!==null&&(h=0,j=g=maintainYScrollElement.scrollTop,h=c.offsetTop-10,k=c.offsetTop+c.offsetHeight+10,maintainYScrollElement.scrollTop>h&&maintainYScrollElement.scrollTop>0?j=h:maintainYScrollElement.scrollTop+maintainYScrollElement.clientHeight<k&&(j=k-maintainYScrollElement.clientHeight),h=g-j,Math.abs(h)>10&&!a.shiftKey&&(h=h<0?-10:10,j=g-h),j!=maintainYScrollElement.scrollTop))maintainYScrollElement.scrollTop=j,r.Y-=h;g=absoluteCursorPostion(a);g=g.Add(r).Subtract(p);
g=g.Bound(b,f);g.Apply(c);i!=null&&i(g,c,a);return cancelEvent(a)}}function n(a){q();return cancelEvent(a)}function q(){t&&!u&&(unhookEvent(document,"mousemove",o),unhookEvent(document,"mouseup",n),r=p=null,h!=null&&h(c),t=false)}maintainXScrollElement=typeof k!="undefined"&&k.tagName?k:null;maintainYScrollElement=typeof l!="undefined"&&l.tagName?l:null;typeof c=="string"&&(c=document.getElementById(c));if(c!=null){b!=null&&f!=null&&(k=b.Min(f),f=b.Max(f),b=k);var p=null,r=null,t=false,w=false,u=
false;this.Dispose=function(){u||(this.StopListening(true),h=i=g=f=b=a=c=null,u=true)};this.StartListening=function(){!w&&!u&&(w=true,hookEvent(a,"mousedown",m))};this.StopListening=function(b){w&&!u&&(unhookEvent(a,"mousedown",m),w=false,b&&t&&q())};this.IsDragging=function(){return t};this.IsListening=function(){return w};this.IsDisposed=function(){return u};typeof a=="string"&&(a=document.getElementById(a));a==null&&(a=c);j||this.StartListening()}}
var SERIALIZER={stringify:function(c,a){a=typeof a=="undefined"?100:a;if(a<=0)throw"Recursion detected!";switch(typeOf(c,2)){case "number.int":return"int:"+c.toString().length+":"+c.toString();case "number.float":return"float:"+c.toString().length+":"+c.toString();case "boolean":return"boolean:1:"+(c?"1":"0");case "null":return"null:0:";case "unknown.undefined":return"undefined:0:";case "infinity":return"infinity:0:";case "nan":return"nan:0:";case "unknown.string":return"string:"+c.length+":"+c;case "object.function":return"function:"+
c.toString().length+":"+c.toString();case "object.array":for(var b=[],f=0,g=c.length;f<g;f++)b.push(SERIALIZER.stringify(c[f],a-1));b=b.join("");return"array:"+b.length+":"+b;case "object":b=[];for(f in c)c.propertyIsEnumerable(f)&&c.hasOwnProperty(f)&&b.push("["+f.length+":"+f+"]"+SERIALIZER.stringify(c[f],a-1));b=b.join("");return"object:"+b.length+":"+b;default:return"null:0:"}},parse:function(c){if(typeof c!="string")throw"SERIALIZER.parse: Expected string";var a=function(a){for(var b=[],c;c=
/^([a-z]+)\:([\d]+)\:([^*]+)?/.exec(a);){var h=parseInt(c[2]),j=(c[3]||"").substr(0,h);if(h<j.length)throw"SERIALIZER: failed to parse array!";b.push(c=c[1]+":"+c[2]+":"+j);a=a.substr(c.length)}if(a.length)throw"Expected end of string!";return b},b=function(a){for(var b=[],c,h,j;c=/^\[([\d]+)\:/.exec(a);){h=c[1];j=a.substr(h.length+2,parseInt(h));a=a.substr(j.length+h.length+2);if(a.charAt(0)!="]")throw"Expected ']' character!"+a;a=a.substr(1);h=/^([a-z]+)\:([\d]+)\:/.exec(a);if(!c[1])throw"Unexpected sequence!";
a=a.substr(h[0].length);c={key:j,value:h[1]+":"+h[2]+":"+(j=a.substr(0,parseInt(h[2])))};a=a.substr(j.length);b.push(c)}if(a.length)throw"Expected end of string! "+a;return b};return function(){var f=/^([a-z]+)\:([\d]+)\:([^*]+)?$/.exec(c);if(!f)throw"SERIALIZER.parse: unserializeable string!";var g=f[1],i=f[2],f=f[3],i=parseInt(i),f=f||"";if(i!=f.length)throw"SERIALIZER.parse: corrupted data (len != dataLen)";switch(g){case "int":return parseInt(f);case "float":return parseFloat(f);case "boolean":return f.charAt(0)==
"1";case "null":if(i>0)throw"SERIALIZER.parse: unexpected data length!";return null;case "undefined":if(i>0)throw"SERIALIZER.parse: unexpected data length!";break;case "infinity":if(i>0)throw"SERIALIZER.parse: unexpected data length!";return Infinity;case "nan":if(i>0)throw"SERIALIZER.parse: unexpected data length!";return NaN;case "string":return f;case "function":return eval("("+f+")");case "array":g=a(f);i=0;for(f=g.length;i<f;i++)g[i]=SERIALIZER.parse(g[i]);return g;case "object":for(var g=b(f),
h={},i=0,f=g.length;i<f;i++)h[g[i].key]=SERIALIZER.parse(g[i].value);return h;default:throw"SERIALIZER.parse: unimplemented parser( "+g+")";}}()}};
function HSlider(c){var a=$("div","DomHSlider");EnableCustomEventListeners(a);a.config=c||{value:0,minValue:0,maxValue:100,step:1};a.config.value=typeof a.config.value!="undefined"?a.config.value:0;a.config.minValue=typeof a.config.minValue!="undefined"?a.config.minValue:0;a.config.maxValue=typeof a.config.maxValue!="undefined"?a.config.maxValue:100;a.config.step=typeof a.config.step!="undefined"?a.config.step:1;a.inner=a.appendChild($("div","inner"));a.handle=a.inner.appendChild($("div","handle"));
a.getValue=function(){return a.config.value};a.setValue=function(b){var c;b-=a.config.minValue;b-=c=b%a.config.step;b+=a.config.minValue;c>=a.config.step/2&&(b+=a.config.step);b=b<a.config.minValue?a.config.minValue:b>a.config.maxValue?a.config.maxValue:b;a.handle.style.left=(b-a.config.minValue)*((a.inner.offsetWidth-a.handle.offsetWidth)/(a.config.maxValue-a.config.minValue))+"px";return a.config.value==b?false:(a.config.value=b,true)};a.getStep=function(){return a.config.step};a.setStep=function(b){a.config.step=
b;a.setValue(a.config.value)};a.getMinValue=function(){return a.config.minValue};a.setMinValue=function(b){a.config.minValue=b;a.setValue(a.config.value)};a.getMaxValue=function(){return a.config.maxValue};a.setMaxValue=function(b){a.config.maxValue=b;a.setValue(a.config.value)};a.getValueInPixels=function(){return a.handle.offsetLeft};a.setValueInPixels=function(b){var c=(a.inner.offsetWidth-a.handle.offsetWidth)/(a.config.maxValue-a.config.minValue);b<0?b=0:b+a.handle.offsetWidth>a.inner.offsetWidth&&
(b=a.inner.offsetWidth-a.handle.offsetWidth);a.handle.style.left=b+"px";return a.setValue(a.config.minValue+b/c)};a.scrollFunction=function(b){b=b||window.event;switch(true){case typeof window.opera!="undefined":b=b.wheelDelta/40;break;case typeof b.wheelDelta!="undefined":b=b.wheelDelta/40;break;case typeof b.detail!="undefined":b=-b.detail/3;break;default:b=0}if(a.setValue((b<0?-1:1)*a.config.step+a.config.value))a.onCustomEvent("change",{ctl:a})};try{a.addEventListener("mousewheel",a.scrollFunction,
true),a.addEventListener("DOMMouseScroll",a.scrollFunction,true)}catch(b){a.attachEvent("onmousewheel",a.scrollFunction)}a.onDragStart=function(){};a.onDragRun=function(){if(a.setValueInPixels(a.handle.offsetLeft))a.onCustomEvent("change",{ctl:a})};a.onDragStop=function(){};a.handle.setAttribute("dragable","1");a.__dragListener=new dragObject(a.handle,null,new Position(0,0),new Position(5E3,0),a.onDragStart,a.onDragRun,a.onDragStop);a.kbThread=null;a.kbDelta=1;a.decrementThreadFunc=function(){a.kbDelta<
10&&(a.kbDelta*=1.1);if(a.setValue(Math.floor(a.kbDelta)*-a.config.step+a.config.value))a.onCustomEvent("change",{ctl:a})};a.incrementThreadFunc=function(){a.kbDelta<10&&(a.kbDelta*=1.1);if(a.setValue(Math.floor(a.kbDelta)*a.config.step+a.config.value))a.onCustomEvent("change",{ctl:a})};a.winKeyUpFunction=function(){try{window.removeEventListener("keyup",a.winKeyUpFunction,true)}catch(b){window.detachEvent("onkeyup",a.winKeyUpFunction)}window.clearInterval(a.kbThread);a.kbThread=null};a.startKeyDownThread=
function(b){a.kbDelta=1;b();a.kbThread!==null&&a.winKeyUpFunction();a.kbThread=window.setInterval(b,100);try{window.addEventListener("keyup",a.winKeyUpFunction,true)}catch(c){window.attachEvent("onkeyup",a.winKeyUpFunction)}};a.keyboardHandler=function(b){b=b||window.event;charCode=Math.max(b.keyCode?b.keyCode:0,b.charCode?b.charCode:0);if(charCode!=0)switch(charCode){case 37:a.startKeyDownThread(a.decrementThreadFunc);cancelEvent(b);break;case 39:a.startKeyDownThread(a.incrementThreadFunc),cancelEvent(b)}};
try{a.addEventListener("keydown",a.keyboardHandler,true)}catch(f){a.attachEvent("onkeydown",a.keyboardHandler)}a.__defineGetter__?(a.__defineGetter__("value",a.getValue),a.__defineSetter__("value",a.setValue),a.__defineGetter__("step",a.getStep),a.__defineSetter__("step",a.setStep),a.__defineGetter__("minValue",a.getMinValue),a.__defineSetter__("minValue",a.setMinValue),a.__defineGetter__("maxValue",a.getMaxValue),a.__defineSetter__("maxValue",a.setMaxValue),a.__defineGetter__("valueInPixels",a.getValueInPixels),
a.__defineSetter__("valueInPixels",a.setValueInPixels)):Object.defineProperty&&(Object.defineProperty(a,"value",{get:a.getValue,set:a.setValue}),Object.defineProperty(a,"step",{get:a.getStep,set:a.setStep}),Object.defineProperty(a,"minValue",{get:a.getMinValue,set:a.setMinValue}),Object.defineProperty(a,"maxValue",{get:a.getMaxValue,set:a.setMaxValue}));a.tabIndex=0;a.DOManchors={dummy:function(){a.setValue(a.getValue());return""}};(function(){var b={__dummy:function(){a.setValue(a.getValue())}};
Object.defineProperty(a,"DOManchors",{get:function(){return b},set:function(a){var c={},f;for(f in a)a.propertyIsEnumerable(f)&&(c[f]=a[f]),c.__dummy=b.__dummy;b=c}})})();return a}
function VSlider(c){var a=$("div","DomVSlider");EnableCustomEventListeners(a);a.config=c||{value:0,minValue:0,maxValue:100,step:1};a.config.value=typeof a.config.value!="undefined"?a.config.value:0;a.config.minValue=typeof a.config.minValue!="undefined"?a.config.minValue:0;a.config.maxValue=typeof a.config.maxValue!="undefined"?a.config.maxValue:100;a.config.step=typeof a.config.step!="undefined"?a.config.step:1;a.inner=a.appendChild($("div","inner"));a.handle=a.inner.appendChild($("div","handle"));
a.getValue=function(){return a.config.value};a.setValue=function(b){var c;b-=a.config.minValue;b-=c=b%a.config.step;b+=a.config.minValue;c>=a.config.step/2&&(b+=a.config.step);b=b<a.config.minValue?a.config.minValue:b>a.config.maxValue?a.config.maxValue:b;a.handle.style.top=(b-a.config.minValue)*((a.inner.offsetHeight-a.handle.offsetHeight)/(a.config.maxValue-a.config.minValue))+"px";return a.config.value==b?false:(a.config.value=b,true)};a.getStep=function(){return a.config.step};a.setStep=function(b){a.config.step=
b;a.setValue(a.config.value)};a.getMinValue=function(){return a.config.minValue};a.setMinValue=function(b){a.config.minValue=b;a.setValue(a.config.value)};a.getMaxValue=function(){return a.config.maxValue};a.setMaxValue=function(b){a.config.maxValue=b;a.setValue(a.config.value)};a.getValueInPixels=function(){return a.handle.offsetTop};a.setValueInPixels=function(b){var c=(a.inner.offsetHeight-a.handle.offsetHeight)/(a.config.maxValue-a.config.minValue);b<0?b=0:b+a.handle.offsetHeight>a.inner.offsetHeight&&
(b=a.inner.offsetHeight-a.handle.offsetHeight);a.handle.style.top=b+"px";return a.setValue(a.config.minValue+b/c)};a.scrollFunction=function(b){b=b||window.event;switch(true){case typeof window.opera!="undefined":b=b.wheelDelta/40;break;case typeof b.wheelDelta!="undefined":b=b.wheelDelta/40;break;case typeof b.detail!="undefined":b=-b.detail/3;break;default:b=0}if(a.setValue(-(b<0?-1:1)*a.config.step+a.config.value))a.onCustomEvent("change",{ctl:a})};try{a.addEventListener("mousewheel",a.scrollFunction,
true),a.addEventListener("DOMMouseScroll",a.scrollFunction,true)}catch(b){a.attachEvent("onmousewheel",a.scrollFunction)}a.onDragStart=function(){};a.onDragRun=function(){if(a.setValueInPixels(a.handle.offsetTop))a.onCustomEvent("change",{ctl:a})};a.onDragStop=function(){};a.handle.setAttribute("dragable","1");a.__dragListener=new dragObject(a.handle,null,new Position(0,0),new Position(0,5E3),a.onDragStart,a.onDragRun,a.onDragStop);a.kbThread=null;a.kbDelta=1;a.decrementThreadFunc=function(){a.kbDelta<
10&&(a.kbDelta*=1.1);if(a.setValue(Math.floor(a.kbDelta)*-a.config.step+a.config.value))a.onCustomEvent("change",{ctl:a})};a.incrementThreadFunc=function(){a.kbDelta<10&&(a.kbDelta*=1.1);if(a.setValue(Math.floor(a.kbDelta)*a.config.step+a.config.value))a.onCustomEvent("change",{ctl:a})};a.winKeyUpFunction=function(){try{window.removeEventListener("keyup",a.winKeyUpFunction,true)}catch(b){window.detachEvent("onkeyup",a.winKeyUpFunction)}window.clearInterval(a.kbThread);a.kbThread=null};a.startKeyDownThread=
function(b){a.kbDelta=1;b();a.kbThread!==null&&a.winKeyUpFunction();a.kbThread=window.setInterval(b,100);try{window.addEventListener("keyup",a.winKeyUpFunction,true)}catch(c){window.attachEvent("onkeyup",a.winKeyUpFunction)}};a.keyboardHandler=function(b){b=b||window.event;charCode=Math.max(b.keyCode?b.keyCode:0,b.charCode?b.charCode:0);if(charCode!=0)switch(charCode){case 38:a.startKeyDownThread(a.decrementThreadFunc);cancelEvent(b);break;case 40:a.startKeyDownThread(a.incrementThreadFunc),cancelEvent(b)}};
try{a.addEventListener("keydown",a.keyboardHandler,true)}catch(f){a.attachEvent("onkeydown",a.keyboardHandler)}a.__defineGetter__?(a.__defineGetter__("value",a.getValue),a.__defineSetter__("value",a.setValue),a.__defineGetter__("step",a.getStep),a.__defineSetter__("step",a.setStep),a.__defineGetter__("minValue",a.getMinValue),a.__defineSetter__("minValue",a.setMinValue),a.__defineGetter__("maxValue",a.getMaxValue),a.__defineSetter__("maxValue",a.setMaxValue),a.__defineGetter__("valueInPixels",a.getValueInPixels),
a.__defineSetter__("valueInPixels",a.setValueInPixels)):Object.defineProperty&&(Object.defineProperty(a,"value",{get:a.getValue,set:a.setValue}),Object.defineProperty(a,"step",{get:a.getStep,set:a.setStep}),Object.defineProperty(a,"minValue",{get:a.getMinValue,set:a.setMinValue}),Object.defineProperty(a,"maxValue",{get:a.getMaxValue,set:a.setMaxValue}));a.tabIndex=0;(function(){var b={__dummy:function(){a.setValue(a.getValue())}};Object.defineProperty(a,"DOManchors",{get:function(){return b},set:function(a){var c=
{},f;for(f in a)a.propertyIsEnumerable(f)&&(c[f]=a[f]),c.__dummy=b.__dummy;b=c}})})();return a}
function Spinner(c){var a=$("div","DomSpinner");EnableCustomEventListeners(a);a.config=c||{value:0,minValue:0,maxValue:100,step:1};a.config.value=typeof a.config.value!="undefined"?a.config.value:0;a.config.minValue=typeof a.config.minValue!="undefined"?a.config.minValue:0;a.config.maxValue=typeof a.config.maxValue!="undefined"?a.config.maxValue:Number.MAX_VALUE;a.config.step=typeof a.config.step!="undefined"?a.config.step:1;a.inner=a.appendChild($("div","DomSpinnerInner"));a.up=a.inner.appendChild($("div",
"up"));a.down=a.inner.appendChild($("div","down"));a.drag=a.inner.appendChild($("div","drag"));a.ctl=$("input","DomSpinnerCtl");a.inner.appendChild(a.ctl);a.getValue=function(){return a.config.value};a.setValue=function(b){b=b<a.config.minValue?a.config.minValue:b>a.config.maxValue?a.config.maxValue:b;return b!=a.config.value?(a.config.value=b,a.ctl.value=b,true):(a.ctl.value=b,false)};a.getMinValue=function(){return a.config.minValue};a.setMinValue=function(b){a.config.minValue=b;a.getValue()<b&&
a.setValue(b)};a.getMaxValue=function(){return a.config.maxValue};a.setMaxValue=function(b){a.config.maxValue=b;a.getValue()>b&&a.setValue(b)};a.getStep=function(){return a.config.step};a.setStep=function(b){a.config.step=b};a.setValue(a.config.value);a.drag.setAttribute("dragable","1");a.__oDragY=0;a.__oDragX=0;a.__oNowValue=0;a.onHandleDragStart=function(){a.__oDragY=a.drag.offsetTop;a.__oDragX=a.drag.offsetLeft;a.__oNowValue=a.getValue();a.drag.style.top=a.__oDragY+"px";a.drag.style.backgroundColor=
"transparent"};a.onHandleDragRun=function(){a.drag.style.left="";if(a.setValue((a.drag.offsetTop-a.__oDragY)*a.config.step+a.__oNowValue))a.onCustomEvent("change",{ctl:a})};a.onHandleDragStop=function(){a.drag.style.top="";a.drag.style.backgroundColor=""};a.__dragListener=new dragObject(a.drag,null,new Position(0,-5E3),new Position(0,5E3),a.onHandleDragStart,a.onHandleDragRun,a.onHandleDragStop);a.scrollFunction=function(b){b=b||window.event;switch(true){case typeof window.opera!="undefined":var c=
b.wheelDelta/40;break;case typeof b.wheelDelta!="undefined":c=b.wheelDelta/40;break;case typeof b.detail!="undefined":c=-b.detail/3;break;default:c=0}if(a.setValue((c<0?-1:1)*a.config.step+a.config.value))a.onCustomEvent("change",{ctl:a});cancelEvent(b)};try{a.addEventListener("mousewheel",a.scrollFunction,true),a.addEventListener("DOMMouseScroll",a.scrollFunction,true)}catch(b){a.attachEvent("onmousewheel",a.scrollFunction)}a.kbThread=null;a.kbDelta=1;a.decrementThreadFunc=function(){a.kbDelta<10&&
(a.kbDelta*=1.1);if(a.setValue(Math.floor(a.kbDelta)*-a.config.step+a.config.value))a.onCustomEvent("change",{ctl:a})};a.incrementThreadFunc=function(){a.kbDelta<10&&(a.kbDelta*=1.1);if(a.setValue(Math.floor(a.kbDelta)*a.config.step+a.config.value))a.onCustomEvent("change",{ctl:a})};a.winKeyUpFunction=function(){try{window.removeEventListener("keyup",a.winKeyUpFunction,true),window.removeEventListener("mouseup",a.winKeyUpFunction,true),a.removeEventListener("mouseout",a.winKeyUpFunction,true)}catch(b){document.body.detachEvent("onkeyup",
a.winKeyUpFunction),document.body.detachEvent("onmouseup",a.winKeyUpFunction),a.detachEvent("onmouseout",a.winKeyUpFunction)}window.clearInterval(a.kbThread);a.kbThread=null;removeStyle(a.up,"active");removeStyle(a.down,"active")};a.startKeyDownThread=function(b){a.kbDelta=1;switch(b){case a.decrementThreadFunc:addStyle(a.up,"active");break;case a.incrementThreadFunc:addStyle(a.down,"active")}b();a.kbThread!==null&&a.winKeyUpFunction();a.kbThread=window.setInterval(b,100);try{window.addEventListener("keyup",
a.winKeyUpFunction,true),window.addEventListener("mouseup",a.winKeyUpFunction,true),a.addEventListener("mouseout",a.winKeyUpFunction,true)}catch(c){document.body.attachEvent("onkeyup",a.winKeyUpFunction),document.body.attachEvent("onmouseup",a.winKeyUpFunction),a.attachEvent("mouseout",a.winKeyUpFunction)}};a.ctl.keyboardHandler=function(b){b=b||window.event;charCode=Math.max(b.keyCode?b.keyCode:0,b.charCode?b.charCode:0);if(charCode!=0)switch(charCode){case 38:b.ctrlKey&&a.startKeyDownThread(a.decrementThreadFunc);
cancelEvent(b);break;case 40:b.ctrlKey&&a.startKeyDownThread(a.incrementThreadFunc);cancelEvent(b);break;case 13:var c=a.ctl.value.toString().trim(),c=parseFloat(c);if(isNaN(c))console.log('Spinner: value "'+a.ctl.value+'" is NAN'),c=a.config.value;c!=a.config.value?(a.setValue(c),a.onCustomEvent("change",{ctl:a})):a.setValue(c);cancelEvent(b)}};try{a.up.addEventListener("mousedown",function(b){a.startKeyDownThread(a.decrementThreadFunc);b=b||window.event;cancelEvent(b)},true),a.down.addEventListener("mousedown",
function(b){a.startKeyDownThread(a.incrementThreadFunc);b=b||window.event;cancelEvent(b)},true)}catch(f){a.up.attachEvent("onmousedown",function(){a.startKeyDownThread(a.decrementThreadFunc);cancelEvent(window.event)}),a.down.attachEvent("onmousedown",function(){a.startKeyDownThread(a.incrementThreadFunc);cancelEvent(window.event)})}try{a.ctl.addEventListener("keydown",a.ctl.keyboardHandler,true),a.ctl.addEventListener("blur",function(){a.ctl.keyboardHandler({keyCode:13})},true)}catch(g){a.ctl.attachEvent("onkeydown",
a.ctl.keyboardHandler),a.ctl.attachEvent("onblur",function(){a.ctl.keyboardHandler({keyCode:13})})}a.__defineGetter__?(a.__defineGetter__("value",a.getValue),a.__defineSetter__("value",a.setValue),a.__defineGetter__("minValue",a.getMinValue),a.__defineSetter__("minValue",a.setMinValue),a.__defineGetter__("maxValue",a.getMaxValue),a.__defineSetter__("maxValue",a.setMaxValue),a.__defineGetter__("step",a.getStep),a.__defineSetter__("step",a.setStep)):Object.defineProperty&&(Object.defineProperty(a,"value",
{get:a.getValue,set:a.setValue}),Object.defineProperty(a,"minValue",{get:a.getMinValue,set:a.setMinValue}),Object.defineProperty(a,"maxValue",{get:a.getMaxValue,set:a.setMaxValue}),Object.defineProperty(a,"step",{get:a.getStep,set:a.setStep}));disableSelection(a);return a}
function SplitterSurface(c){var a=$("div","DomSplitterSurface");a.notifyParent=function(b,c){for(var g=a.parentNode;!hasStyle(g,"DomSplitter");)g=g.parentNode;return g.onCustomEvent(b,c)};a.inner=a.appendChild($("div","DomSplitterInner"));a.settings=c||{};a.__splits=[];a.__handles=[];a.__splitMode=false;a.cells=function(b){return typeof b!="undefined"?a.__splits[b]:a.__splits};a.handles=function(b){return typeof b!="undefined"?a.__handles[b]:a.__handles};a.attachVRHandler=function(b){b.setAttribute("dragable",
"1");b.onDragStart=function(){try{b.minX=b.previousSibling.offsetLeft,b.maxX=b.nextSibling.offsetLeft+b.nextSibling.offsetWidth}catch(a){}};b.onDragRun=function(){try{var c=parseInt(b.style.left)+1;if(c<b.minX)c=b.minX,b.style.left=c-2+"px";if(c>b.maxX)c=b.maxX,b.style.left=c-2+"px";b.previousSibling._width=c-b.minX;b.nextSibling._width=b.maxX-c;b.previousSibling.onDOMresize(a.inner.offsetWidth,a.inner.offsetHeight);b.nextSibling.onDOMresize(a.inner.offsetWidth,a.inner.offsetHeight)}catch(g){}};b.onDragStop=
function(){try{b.previousSibling.onDOMresize(a.inner.offsetWidth,a.inner.offsetHeight),b.nextSibling.onDOMresize(a.inner.offsetWidth,a.inner.offsetHeight),a.notifyParent("resize",a)}catch(c){}};b._dragListener=new dragObject(b,null,new Position(-5E3,0),new Position(5E3,0),b.onDragStart,b.onDragRun,b.onDragStop,null,true)};a.attachHRHandler=function(b){b.setAttribute("dragable","1");b.onDragStart=function(){b.minX=b.previousSibling.offsetTop;b.maxX=b.nextSibling.offsetTop+b.nextSibling.offsetHeight};
b.onDragRun=function(){var c=parseInt(b.style.top)+1;if(c<b.minX)c=b.minX,b.style.top=c-2+"px";if(c>b.maxX)c=b.maxX,b.style.top=c-2+"px";b.previousSibling._height=c-b.minX;b.nextSibling._height=b.maxX-c;b.previousSibling.onDOMresize(a.inner.offsetWidth,a.inner.offsetHeight);b.nextSibling.onDOMresize(a.inner.offsetWidth,a.inner.offsetHeight)};b.onDragStop=function(){b.previousSibling.onDOMresize(a.inner.offsetWidth,a.inner.offsetHeight);b.nextSibling.onDOMresize(a.inner.offsetWidth,a.inner.offsetHeight);
a.notifyParent("resize",a)};b._dragListener=new dragObject(b,null,new Position(0,-5E3),new Position(0,5E3),b.onDragStart,b.onDragRun,b.onDragStop,null,true)};a.split=function(b,c){var g=b.length+1;if(g<2)throw'A splitter cannot be "splitted" in less than 2 pieces';c=c||"V";if(c!="H"&&c!="V")throw'splitMode parameter should be "H" (horizontal) or "V" (vertical)';a.__splitMode=c;for(var i=0;i<g;i++)tmp=function(c,f){var k=a.inner.appendChild(k=$("div","Split".concat(f)));a.__splits.push(k);k.config=
b[i];k.splitIndex=c;k.splitter=null;if(c<g-1){k.handle=a.inner.appendChild($("div",f.concat("SplitHandle")));a.__handles.push(k.handle);if(f=="H")k._height=b[c];if(f=="V")k._width=b[c]}else{if(f=="H")k._width=false;if(f=="V")k._height=false}switch(f){case "V":k.getStart=function(){return k.previousSibling&&k.previousSibling.previousSibling?k.previousSibling.previousSibling.offsetLeft+k.previousSibling.previousSibling.offsetWidth:0};k.getStop=function(a,b){var c=k.nextSibling?k.parentNode.offsetWidth-
a-b:0;return c<0?0:c};k._dummyLeft=0;k.DOManchors={left:function(){k._dummyLeft=k.getStart();if(k.previousSibling)k.previousSibling.style.left=k._dummyLeft-2+"px";return k._dummyLeft+"px"},right:function(){return k.getStop(k._dummyLeft,k._width)+"px"}};k.previousSibling&&a.attachVRHandler(k.previousSibling);break;case "H":k.getStart=function(){return k.previousSibling&&k.previousSibling.previousSibling?k.previousSibling.previousSibling.offsetTop+k.previousSibling.previousSibling.offsetHeight:0},k.getStop=
function(a,b){var c=k.nextSibling?k.parentNode.offsetHeight-a-b:0;return c<0?0:c},k._dummyTop=0,k.DOManchors={top:function(){k._dummyTop=k.getStart();if(k.previousSibling)k.previousSibling.style.top=k._dummyTop-2+"px";return k._dummyTop+"px"},bottom:function(){return k.getStop(k._dummyTop,k._height)+"px"}},k.previousSibling&&a.attachHRHandler(k.previousSibling)}k.insert=function(){if(arguments.length){var a=arguments[0];if(a instanceof Node&&!hasStyle(a,"SplitH")&&!hasStyle(a,"SplitV")){for(var a=
null,b=0;b<arguments.length;b++)a=arguments[b],k.appendChild(a),a.onDOMresize(k.offsetWidth,k.offsetHeight);return a}}};k.split=function(a,b){k.innerHTML="";var c=k.appendChild(new SplitterSurface);c.style.border="none";k.style.overflow="hidden";k._items=c;k._items.split(a,b);k._items.DOManchors={width:function(a){return a+"px"},height:function(a,b){return b+"px"}};k._items.onDOMresize(k.offsetWidth,k.offsetHeight);k.__splits=k._items.__splits;k.cells=function(a){return typeof a!="undefined"?k.__splits[a]:
k.__splits};k.handles=function(a){return typeof a!="undefined"?k.__handles[a]:k.__handles};k.setSplitAt=function(a){return k._items.setSplitAt(a)}};return k}(i,c)};a.inner.DOManchors={width:function(a){return a+"px"},height:function(a,c){return c+"px"}};a.setSplitAt=function(b){for(var c=[],g=0;g<a.__splits.length;g++)c.push(g<b.length?b[g]:a.__splitMode=="V"?a.__splits[g]._width:a.__splits[g]._height);for(var b=a.__splitMode=="V"?a.offsetWidth:a.offsetHeight,i=0,h=0,g=0;g<c.length;g++)c[g]===false?
i++:h+=c[g];b=Math.floor((b-h)/i);for(g=0;g<c.length;g++)c[g]=c[g]===false?b:c[g],a.__splitMode=="V"?a.__splits[g]._width=c[g]:a.__splits[g]._height=c[g],a.__splits[g].onDOMresize(a.offsetWidth,a.offsetHeight)};return a}
function Splitter(c){var a=$("div","DomSplitter");EnableCustomEventListeners(a);a.splitter=a.appendChild(new SplitterSurface(c));a.splitter.DOManchors={width:function(a){return a-4+"px"},height:function(a,c){return c-4+"px"}};a.cells=function(b){return a.splitter.cells(b)};a.handles=function(b){return a.splitter.handles(b)};a.split=function(b,c){return a.splitter.split(b,c)};a.setSplitAt=function(b){return a.splitter.setSplitAt(b)};return a}
function printStackTrace(c){var c=c||{guess:true},a=c.e||null,c=!!c.guess,b=new printStackTrace.implementation,a=b.run(a);return c?b.guessAnonymousFunctions(a):a}if(typeof module!=="undefined"&&module.exports)module.exports=printStackTrace;printStackTrace.implementation=function(){};
printStackTrace.implementation.prototype={run:function(c,a){c=c||this.createException();a=a||this.mode(c);return a==="other"?this.other(arguments.callee):this[a](c)},createException:function(){try{this.undef()}catch(c){return c}},mode:function(c){if(c.arguments&&c.stack)return"chrome";else if(c.stack&&c.sourceURL)return"safari";else if(c.stack&&c.number)return"ie";else if(typeof c.message==="string"&&typeof window!=="undefined"&&window.opera)return!c.stacktrace?"opera9":c.message.indexOf("\n")>-1&&
c.message.split("\n").length>c.stacktrace.split("\n").length?"opera9":!c.stack?"opera10a":c.stacktrace.indexOf("called from line")<0?"opera10b":"opera11";else if(c.stack)return"firefox";return"other"},instrumentFunction:function(c,a,b){var c=c||window,f=c[a];c[a]=function(){b.call(this,printStackTrace().slice(4));return c[a]._instrumented.apply(this,arguments)};c[a]._instrumented=f},deinstrumentFunction:function(c,a){if(c[a].constructor===Function&&c[a]._instrumented&&c[a]._instrumented.constructor===
Function)c[a]=c[a]._instrumented},chrome:function(c){c=(c.stack+"\n").replace(/^\S[^\(]+?[\n$]/gm,"").replace(/^\s+(at eval )?at\s+/gm,"").replace(/^([^\(]+?)([\n$])/gm,"{anonymous}()@$1$2").replace(/^Object.<anonymous>\s*\(([^\)]+)\)/gm,"{anonymous}()@$1").split("\n");c.pop();return c},safari:function(c){return c.stack.replace(/\[native code\]\n/m,"").replace(/^(?=\w+Error\:).*$\n/m,"").replace(/^@/gm,"{anonymous}()@").split("\n")},ie:function(c){return c.stack.replace(/at Anonymous function /gm,
"{anonymous}()@").replace(/^(?=\w+Error\:).*$\n/m,"").replace(/^.*at (\w+) \(([^\)]+)\)$/gm,"$1@$2").split("\n")},firefox:function(c){return c.stack.replace(/(?:\n@:0)?\s+$/m,"").replace(/^[\(@]/gm,"{anonymous}()@").split("\n")},opera11:function(c){for(var a=/^.*line (\d+), column (\d+)(?: in (.+))? in (\S+):$/,c=c.stacktrace.split("\n"),b=[],f=0,g=c.length;f<g;f+=2){var i=a.exec(c[f]);if(i){var h=i[4]+":"+i[1]+":"+i[2],i=i[3]||"global code",i=i.replace(/<anonymous function: (\S+)>/,"$1").replace(/<anonymous function>/,
"{anonymous}");b.push(i+"@"+h+" -- "+c[f+1].replace(/^\s+/,""))}}return b},opera10b:function(c){for(var a=/^(.*)@(.+):(\d+)$/,c=c.stacktrace.split("\n"),b=[],f=0,g=c.length;f<g;f++){var i=a.exec(c[f]);i&&b.push((i[1]?i[1]+"()":"global code")+"@"+i[2]+":"+i[3])}return b},opera10a:function(c){for(var a=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i,c=c.stacktrace.split("\n"),b=[],f=0,g=c.length;f<g;f+=2){var i=a.exec(c[f]);i&&b.push((i[3]||"{anonymous}")+"()@"+i[2]+":"+i[1]+" -- "+c[f+
1].replace(/^\s+/,""))}return b},opera9:function(c){for(var a=/Line (\d+).*script (?:in )?(\S+)/i,c=c.message.split("\n"),b=[],f=2,g=c.length;f<g;f+=2){var i=a.exec(c[f]);i&&b.push("{anonymous}()@"+i[2]+":"+i[1]+" -- "+c[f+1].replace(/^\s+/,""))}return b},other:function(c){for(var a=/function\s*([\w\-$]+)?\s*\(/i,b=[],f,g;c&&c.arguments&&b.length<10;)f=a.test(c.toString())?RegExp.$1||"{anonymous}":"{anonymous}",g=Array.prototype.slice.call(c.arguments||[]),b[b.length]=f+"("+this.stringifyArguments(g)+
")",c=c.caller;return b},stringifyArguments:function(c){for(var a=[],b=Array.prototype.slice,f=0;f<c.length;++f){var g=c[f];g===void 0?a[f]="undefined":g===null?a[f]="null":g.constructor&&(g.constructor===Array?a[f]=g.length<3?"["+this.stringifyArguments(g)+"]":"["+this.stringifyArguments(b.call(g,0,1))+"..."+this.stringifyArguments(b.call(g,-1))+"]":g.constructor===Object?a[f]="#object":g.constructor===Function?a[f]="#function":g.constructor===String?a[f]='"'+g+'"':g.constructor===Number&&(a[f]=
g))}return a.join(",")},sourceCache:{},ajax:function(c){var a=this.createXMLHTTPObject();if(a)try{return a.open("GET",c,false),a.send(null),a.responseText}catch(b){}return""},createXMLHTTPObject:function(){for(var c,a=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}],b=0;b<a.length;b++)try{return c=a[b](),this.createXMLHTTPObject=a[b],c}catch(f){}},
isSameDomain:function(c){return typeof location!=="undefined"&&c.indexOf(location.hostname)!==-1},getSource:function(c){c in this.sourceCache||(this.sourceCache[c]=this.ajax(c).split("\n"));return this.sourceCache[c]},guessAnonymousFunctions:function(c){for(var a=0;a<c.length;++a){var b=/^(.*?)(?::(\d+))(?::(\d+))?(?: -- .+)?$/,f=c[a],g=/\{anonymous\}\(.*\)@(.*)/.exec(f);if(g){var i=b.exec(g[1]);i&&(b=i[1],g=i[2],i=i[3]||0,b&&this.isSameDomain(b)&&g&&(b=this.guessAnonymousFunction(b,g,i),c[a]=f.replace("{anonymous}",
b)))}}return c},guessAnonymousFunction:function(c,a){var b;try{b=this.findFunctionName(this.getSource(c),a)}catch(f){b="getSource failed with url: "+c+", exception: "+f.toString()}return b},findFunctionName:function(c,a){for(var b=/function\s+([^(]*?)\s*\(([^)]*)\)/,f=/['"]?([$_A-Za-z][$_A-Za-z0-9]*)['"]?\s*[:=]\s*function\b/,g=/['"]?([$_A-Za-z][$_A-Za-z0-9]*)['"]?\s*[:=]\s*(?:eval|new Function)\b/,i="",h,j=Math.min(a,20),k,l=0;l<j;++l)if(h=c[a-l-1],k=h.indexOf("//"),k>=0&&(h=h.substr(0,k)),h){i=
h+i;if((h=f.exec(i))&&h[1])return h[1];if((h=b.exec(i))&&h[1])return h[1];if((h=g.exec(i))&&h[1])return h[1]}return"(?)"}};
function TabPanel(c){var a=$("div","DomTabPanel");a.inner=a.appendChild($("div","DomTabPanelInner"));a.inner.DOManchors={width:function(a){return a+"px"},height:function(a,c){return c+"px"}};a.toolbar=a.inner.appendChild($("div","DomTabPanelToolbar"));a.__tabs=[];a.__sheets=[];a.__settings=c||{};a.__settings.layout=a.__settings.layout||"top";a.__settings.initTabs=a.__settings.initTabs||[];a.__isIE7=navigator.appName=="Microsoft Internet Explorer"&&navigator.appVersion.indexOf("MSIE 7")!=-1;a.getTabById=
function(b){for(var c=0;c<a.__tabs.length;c++)if(a.__tabs[c]._id==b)return a.__tabs[c];return null};EnableCustomEventListeners(a);a.toolbar.tabIndex=0;Keyboard.bindKeyboardHandler(a.toolbar,"space",function(){try{a.toolbar.querySelector(".DomTabPanelTab:focus").clickHandler()}catch(b){}});Keyboard.bindKeyboardHandler(a.toolbar,"left",function(){try{var b=a.toolbar.querySelector(".DomTabPanelTab.TabActive").previousSibling;b.focus();b.clickHandler()}catch(c){}});Keyboard.bindKeyboardHandler(a.toolbar,
"right",function(){try{var b=a.toolbar.querySelector(".DomTabPanelTab.TabActive").nextSibling;b.focus();b.clickHandler()}catch(c){}});a.addTab=function(b,c){if(typeof c=="undefined"){var g=a.toolbar.appendChild($("div","DomTabPanelTab"));EnableCustomEventListeners(g);var i=a.inner.appendChild($("div","DomTabPanelSheet"));a.__tabs.push(g);a.__sheets.push(i)}else g=a.toolbar.insertBefore($("div","DomTabPanelTab"),a.__tabs[c]),EnableCustomEventListeners(g),i=a.inner.insertBefore($("div","DomTabPanelSheet"),
a.__sheets[c]),a.__tabs.splice(c,0,g),a.__sheets.splice(c,0,i);g.tabIndex=0;i.__xPadding=4;i.__yPadding=4;i.inner=i.appendChild($("div","DomTabPanelSheetInner"));i.inner.DOManchors={width:function(a){return a+"px"},height:function(a,b){return b+"px"}};i.inner.redraw=function(){i.onDOMresize(a.inner.offsetWidth,a.inner.offsetHeight)};i.inner.insert=function(a){i.inner.appendChild(a).paint();return a};i.insert=function(a){i.inner.appendChild(a);a.onDOMresize(i.inner.offsetWidth,i.inner.offsetHeight);
return a};g.__sheet=i;i.getTab=function(){return g};disableSelection(g);g.style.display=a.__isIE7?"inline":"inline-block";g._left=g.appendChild($("div","DomTabLeft"));g._right=g.appendChild($("div","DomTabRight"));g._caption=g.appendChild($("span"));g._closeButton=g.appendChild($("div","TabCloseButton"));g._active=false;g._captionStr="";g._closeable=typeof b!="undefined"&&b.closeable?true:false;g._id=typeof b!="undefined"&&b.id?b.id:null;g.getActive=function(){return g._active};g.setActive=function(b){g._active=
!!b;for(var c=0;c<a.__tabs.length;c++)a.__tabs[c]==g?(addStyle(a.__tabs[c],"TabActive"),addStyle(a.__sheets[c],"active"),a.onCustomEvent("change",c),a.__tabs[c].onCustomEvent("activate")):(removeStyle(a.__tabs[c],"TabActive"),removeStyle(a.__sheets[c],"active"),a.__tabs[c]._active=b?false:a.__tabs[c]._active,a.__tabs[c].onCustomEvent("deactivate"));b&&g.__sheet.inner.redraw();try{getOwnerWindow(a).paint()}catch(f){}};g.getCaption=function(){return g._captionStr};g.setCaption=function(a){g._captionStr=
a;g._caption.innerHTML="";g._caption.appendChild(document.createTextNode(a))};g.getCloseable=function(){return g._closeable};g.setCloseable=function(a){g._closeable=a?true:false;g._closeable?addStyle(g,"closeable"):removeStyle(g,"closeable")};g.close=function(){if(!a.onCustomEvent("tab-close",g))return false;for(var b=false,c=0;c<a.__tabs.length;c++)if(a.__tabs[c]==g){b=c;break}g._active&&b!==false&&(b>0?a.__tabs[b-1].setActive(true):b<a.__tabs.length-1&&a.__tabs[b+1].setActive(true));b!==false&&
(a.toolbar.removeChild(a.__tabs[b]),a.inner.removeChild(a.__sheets[b]),a.__tabs.splice(b,1),a.__sheets.splice(b,1))};g.getId=function(){return g._id};g.setId=function(a){g._id=a};g.getSheet=function(){return g.__sheet.inner};a.__tabs.length==1&&g.setActive(true);g.clickHandler=function(a){g.setActive(true);cancelEvent(a);return false};g.closeButtonClick=function(a){cancelEvent(a);g.close();return false};g.addEventListener?(g.addEventListener("click",g.clickHandler,false),g._closeButton.addEventListener("click",
g.closeButtonClick,false)):(g.attachEvent("onclick",g.clickHandler),g._closeButton.attachEvent("onclick",g.closeButtonClick));g.setCaption(b.caption);g._closeable&&g.setCloseable(true);Object.defineProperty(g,"caption",{get:g.getCaption,set:g.setCaption});Object.defineProperty(g,"active",{get:g.getActive,set:g.setActive});Object.defineProperty(g,"tabId",{get:g.getId,set:g.setId});Object.defineProperty(g,"sheet",{get:g.getSheet});Object.defineProperty(g,"closeable",{get:g.getCloseable,set:g.setCloseable});
typeof b!="undefined"&&b.active&&g.setActive(true);return i};a.getTabs=function(b){return typeof b!="undefined"?a.__tabs[b]:a.__tabs};a.getSheets=function(b){if(typeof b!="undefined")return a.__sheets[b].inner;else{for(var b=[],c=0;c<a.__sheets.length;c++)b.push(a.__sheets[c].inner);return b}};a.getLayout=function(){return a.__settings.layout};a.setLayout=function(b){switch(b){case "top":a.__settings.layout="top";removeStyle(a,"ToolbarBottom");break;case "bottom":a.__settings.layout="bottom";addStyle(a,
"ToolbarBottom");break;default:throw'TabPanel: Allowed layouts are "top" and "bottom"!';}};a.setLayout(a.__settings.layout);for(c=0;c<a.__settings.initTabs.length;c++)a.addTab(a.__settings.initTabs[c]);a.__defineGetter__&&(a.__defineGetter__("tabs",a.getTabs),a.__defineGetter__("sheets",a.getSheets),a.__defineGetter__("layout",a.getLayout),a.__defineSetter__("layout",a.setLayout));return a}
function TagPicker(c){function a(){h.style.width=b.offsetWidth+"px";var a=getXY(b);h.style.top=a[1]+b.offsetHeight+1+"px";h.style.left=a[0]+"px";document.body.appendChild(h);h.style.display="block";console.log("show")}var b=$("div","DOMTagPicker"),f=b.appendChild($("div")),g=[],i=f.appendChild($("div","display")),h=$("div","DOMTagPickerOverlay");Keyboard.setFocusCycling(h);f.setAnchors({width:function(a){return a+"px"},height:function(a,b){return b+"px"}});Object.defineProperty(b,"value",{get:function(){return g.length?
"|"+g.join("|")+"|":""},set:function(a){i.innerHTML="";if(a){a=a.toString().split("|");g=[];for(var b=[],f=0;f<a.length;f++)a[f].toString().length&&typeof c[a[f]]!="undefined"&&(g.push(a[f]),b.push(c[a[f]]));i.appendChild($text(b.join(", ")))}else g=[]}});b.tabIndex=0;var j=function(a){try{if(!isChildOf(a.target||a.srcElement,b)&&!isChildOf(a.target||a.srcElement,h)){document.body.removeEventListener("click",j,true);try{document.body.removeChild(h)}catch(c){}h.style.display="none";h.innerHTML="";
console.log("hide")}}catch(f){}};b.addEventListener("mousedown",function(){if(h.style.display!="block"){a();h.innerHTML="";document.body.addEventListener("click",j,true);for(var f in c)c.propertyIsEnumerable(f)&&function(a,c){var f=$("label"),i=f.appendChild($("input").setAttr("type","checkbox"));f.appendChild($text(c));i.checked=g.indexOf(a)!=-1;h.appendChild(f);f.tabIndex=0;i.addEventListener("click",function(){console.log("c");switch(i.checked){case true:g.push(a.toString());b.value=g.join("|");
break;case false:g.splice(g.indexOf(a.toString()),1),b.value=g.join("|")}},true)}(f,c[f])}},true);Keyboard.bindKeyboardHandler(b,"esc",function(){j({target:document.body})});return b}
function PropertyGrid__tags(c,a){c.innerHTML="";c.input=c.appendChild(new TagPicker(a.values));addStyle(c.input,"DOMPropertyGrid__inputTags");typeof a.placeholder!="undefined"&&c.input.setAttr("placeholder",a.placeholder);c.__defineGetter__("value",function(){return c.input.value});c.__defineSetter__("value",function(a){c.input.value=a});c.value=typeof a.value=="undefined"?"":a.value}
function TagsEditor(c,a){c=c||[];c.length||(c=[c.toString()]);var a=a||{},b=$("div","DOMTagsEditor");b.tabIndex=0;var f=b.appendChild($("div").setAnchors({width:function(a){return a+"px"},height:function(a,b){return b+"px"}})),g=f.appendChild($("input").setAttr("type","text"));g.style.fontSize="12px";EnableCustomEventListeners(g);var i=" ",h=[];g.setWidth=function(a){if((!a||!([40,38,37,39,13].indexOf(a.keyCode||a.charCode)>=0&&b.overlay))&&i!=g.value)i=g.value,g.style.width=g.value.toString().visualWidth("12px")+
10+"px",f.style.width=f.offsetWidth+1+"px",f.style.width=f.offsetWidth-1+"px",g.onCustomEvent("change",i)};g.addEventListener("keydown",g.setWidth,true);g.addEventListener("keyup",g.setWidth,true);g.addEventListener("keypress",g.setWidth,true);g.setWidth();var j={};Object.defineProperty(b,"DOManchors",{get:function(){return j},set:function(a){var a=a||{},b;for(b in j)b!="native"&&j.propertyIsEnumerable(b)&&delete j[b];for(var c in a)if(a.propertyIsEnumerable(c)){if(c=="native")throw"Invalid anchor (used internally): 'native'";
j[c]=a[c]}}});b.createLabel=function(a){var c=$("div","keyword");c.appendChild($text(a));c.toString=function(){return a};c.closeB=c.appendChild($("div"));c.closeB.onclick=function(){b.remove(a)};c.value=a;Object.defineProperty(c,"label",{get:function(){return a}});c.typeOf="string";return c};b.createCheckedLabel=function(a,c){var f=$("div","keyword check"),i=f.appendChild(new DOMCheckBox);i.addCustomEventListener("change",function(){b.onCustomEvent("change");return true});f.appendChild($text(a));
Object.defineProperty(f,"value",{get:function(){return i.checked?a:null},set:function(a){i.checked=!!a}});f.value=!!c;Object.defineProperty(f,"label",{get:function(){return a}});f.typeOf="checkbox";f.onclick=function(a){if((a.srcElement||a.target)!=i&&!i.disabled&&!i.readOnly)i.checked=!i.checked,b.onCustomEvent("change")};return f};b.push=function(c){if(!c)return false;c=c.trim();if(c.length>256)return false;for(var c=a.lowerCase?c.toString().toLowerCase():c,i=0,j=h.length;i<j;i++)if(h[i].label==
c){if(h[i].typeOf=="checkbox")h[i].value=true;return true}h.push(f.insertBefore(new b.createLabel(c),g));return true};b.remove=function(c){if(c)for(var c=a.lowerCase?c.toString():c,f=0;f<h.length;f++)if(h[f].label==c){h[f].typeOf=="checkbox"?(b.onCustomEvent("change"),h[f].value=false):(h[f].parentNode.removeChild(h[f]),h.splice(f,1),b.onCustomEvent("change"));break}};Object.defineProperty(b,"value",{get:function(){for(var a=[],b=false,c=0;c<h.length;c++)h[c].typeOf=="string"?a.push(h[c].value):(b=
h[c].value)&&a.push(b);return a},set:function(a){if(!(a instanceof Array)&&typeof a!="string")throw"Must set an array or a string!";if(typeof a=="string"){for(var a=a.split(","),c=[],i=0;i<a.length;i++)a[i].trim()&&c.push(a[i]);a=c}for(c=h.length-1;c>=0;c--)h[c].typeOf=="checkbox"?h[c].value=false:(f.removeChild(h[c]),h.splice(c,1));for(c=0;c<a.length;c++)b.push(a[c])}});Object.defineProperty(b,"length",{get:function(){for(var a=0,b=0,a=h.length;b<a;b++)(h[b].typeOf=="string"||h[b].typeOf=="checkbox"&&
h[b].value)&&a++;return a}});Keyboard.bindKeyboardHandler(g,"enter",function(){if(g.value.toString().trim()!=""){if(b.push(g.value))b.onCustomEvent("change");g.value="";g.setWidth()}});a.sticky=a.sticky||[];a.sticky.sort(function(a,b){var c=a.toString().toLowerCase().trim(),f=b.toString().toLowerCase().trim();return c==f?0:c<f?-1:1});for(var k=0,l=a.sticky.length;k<l;k++)(function(c){c&&c.toString().trim()&&(c=new b.createCheckedLabel(a.lowerCase?c.toLowerCase():c,false),f.insertBefore(c,g),h.push(c))})(a.sticky[k]);
for(k=0;k<c.length;k++)b.push(c[k]);b.addEventListener("focus",function(){var a=f.scrollTop;setTimeout(function(){g.focus();f.scrollTop=a},100)},true);var m=null,o=b.showOverlay=function(){m||(m=$("div","DOMTagsEditorOverlay"));m.parentNode||document.body.appendChild(m);var a=getXY(g);m.style.left=a[0]+"px";m.style.bottom="";m.style.top=a[1]+g.offsetHeight+"px";if(m.offsetTop+m.offsetHeight>getMaxY())m.style.top="",m.style.bottom=a[0]+"px";m.style.minWidth=g.offsetWidth+30+"px"},n=b.hideOverlay=function(){m&&
m.parentNode&&document.body.removeChild(m)};Object.defineProperty(b,"overlay",{get:function(){return m&&m.parentNode?true:false},set:function(a){a?o():n()}});var q=null;b.getSearchText=function(){if(q)return q;else throw"Search aborted";};var p=function(c){c.trim()?(q===null&&setTimeout(function(){try{a.onSearch(b.getSearchText()),q=null}catch(c){a.debug&&console.log("Exception:",c)}},a.latency||500),q=c):(b.overlay=false,q=null)};a.onSearch&&(g.addCustomEventListener("change",function(a){if(b.overlay)b.overlay=
true;p(a)}),Keyboard.bindKeyboardHandler(g,"down",function(){if(b.overlay&&m.firstChild){var a=m.querySelector("div.focus,div:focus");a?a.nextSibling?a.nextSibling.focus():m.firstChild.focus():m.firstChild.focus();q=null}}),Keyboard.bindKeyboardHandler(g,"up",function(){if(b.overlay&&m.firstChild){var a=m.querySelector("div.focus,div:focus");a?a.previousSibling?a.previousSibling.focus():m.lastChild.focus():m.lastChild.focus();q=null}}),Keyboard.bindKeyboardHandler(g,"esc",function(){g.value="";p("")}));
b.setSuggestions=function(a,c){b.overlay=true;m.innerHTML="";for(var f=0;f<a.length;f++)(function(a){var f=$("div");f.appendChild($text(a));if(c){var i=c.htmlEntities();f.innerHTML=f.innerHTML.replace(i,"<b>"+i+"</b>")}m.appendChild(f);f.clickStr=a;f.tabIndex=0;f.onclick=function(){b.overlay=false;b.push(f.clickStr);g.value="";g.setWidth();g.onCustomEvent("change","");g.focus()};f.onfocus=function(){f.scrollIntoViewIfNeeded();for(var a=m.querySelectorAll("div"),b=0;b<a.length;b++)a[b].className="";
f.className="focus";g.value=f.clickStr;g.setWidth();g.focus()}})(a[f])};var r=false;Object.defineProperty(b,"readOnly",{get:function(){return r},set:function(a){a=!!a;(a?addStyle:removeStyle)(b,"readOnly");r=a;for(var c=0,f=b.querySelectorAll("input[type=checkbox]"),i=f?f.length:0;c<i;c++)f[c].readOnly=!!a}});var t=false;Object.defineProperty(b,"disabled",{get:function(){return t},set:function(a){a=!!a;(a?addStyle:removeStyle)(b,"disabled");t=a;for(var c=0,f=b.querySelectorAll("input[type=checkbox]"),
i=f?f.length:0;c<i;c++)f[c].disabled=!!a}});return b}
function PropertyGrid__strTags(c,a){c.innerHTML="";c.input=c.appendChild(new TagsEditor([],a.settings||{}));addStyle(c.input,"DOMPropertyGrid__textArea");c.__defineGetter__("value",function(){return c.input.value});c.__defineSetter__("value",function(a){c.input.value=a});c.parentNode.verticalResize=typeof a.resizeable!="undefined"?a.resizeable:true;if(typeof a.value!="undefined")c.value=a.value;c.parentNode.height=typeof a.height!="undefined"?a.height:50}
function TextDropDown(c){var a=$("div","DOMTextDropDown"),b=a.appendChild($("div","relative")),f=b.appendChild($("input","autoComplete").setAttr("type","text")),g=b.appendChild($("input").setAttr("type","text"));b.appendChild($("div","expander"));var i=-1,h=[],j=null,k=null;f.disabled=true;g.value="asd";window.drop=a;Object.defineProperty(a,"disabled",{get:function(){return g.disabled},set:function(a){g.disabled=!!a}});Object.defineProperty(a,"readOnly",{get:function(){return g.readOnly},set:function(a){g.readOnly=
!!a}});Object.defineProperty(a,"placeholder",{get:function(){return g.placeHolder},set:function(a){g.placeholder=a}});Object.defineProperty(a,"hintText",{get:function(){return f.value},set:function(a){f.value=a}});Object.defineProperty(a,"selectedIndex",{get:function(){return i},set:function(b){var c=a.value;if(i>=0&&i<h.length)h[i].selected=false;if(typeof b!="number"||b<-1||b>=h.length)throw"textDropDown.selectedIndex (setter): Bad selectedIndex value";g.value=b!=-1?h[b].text:"";f.value="";i=b;
if(i>=0)h[i].selected=true;if(h.length&&c!=a.value)a.onCustomEvent("change",h[i].value)}});Object.defineProperty(a,"options",{get:function(){return h}});a.createOptionElement=function(b){var c={},f=null,i=null,g=null,j=null,k=true,l=false;c.onAttach=function(){if(g===null)g=$("div"),g.style.display=k?"":"none",(l?addStyle:removeStyle)(g,"selected"),f!==null&&g.appendChild($text(f)),Object.defineProperty(g,"optionElement",{get:function(){return c}}),g.addEventListener("click",function(){for(var b=
0;b<h.length;b++)if(h[b]==c){a.selectedIndex=b;a.expanded=false;break}},true)};c.onDettach=function(){g!==null&&(g.parentNode&&g.parentNode.removeChild(g),g=null)};Object.defineProperty(c,"text",{get:function(){return f},set:function(a){f=a.toString();if(g!==null)g.innerHTML="",g.appendChild($text(f))}});Object.defineProperty(c,"value",{get:function(){return i},set:function(a){i=a.toString();f===null&&(f=i)}});Object.defineProperty(c,"visible",{get:function(){return k},set:function(a){k=!!a;if(g)g.style.display=
k?"":"none"}});Object.defineProperty(c,"textFilter",{get:function(){return j},set:function(a){if(a!=j&&(j=a,g!==null))c.visible=(a&&f.toString().toLowerCase().indexOf(a.toString().toLowerCase()))==0}});Object.defineProperty(c,"DOMElement",{get:function(){return g}});Object.defineProperty(c,"selected",{get:function(){return l},set:function(a){l=!!a;g&&(l?addStyle:removeStyle)(g,"selected")}});c.value=b.value;if(b.text)c.text=b.text;return c};a.add=function(b,c){var c=typeof c=="undefined"?h.length:
c,c=c<0?0:c>h.length?h.length:c,f=f=a.createOptionElement(b);j&&(f.onAttach(),c<h.length&&h.length>1?j.insertBefore(f.DOMElement,h[c].DOMElement):j.appendChild(f.DOMElement));h.splice(c,0,f);return f};a.remove=function(a){if(typeof a!="number")throw"textDropdown.remove(optionIndex): a 'number' should be provided @optionIndex param";if(a<0||a>=h.length)throw"textDropdown.remove(optionIndex): index out of range";h[a].onDettach();h.splice(a,1);i=i==a?-1:i>a?i-1:i};a.clear=function(){h=[];if(j)j.innerHTML=
"";a.expanded=false;i=-1;g.value="";f.value=""};Object.defineProperty(a,"multiple",{get:function(){return false}});Object.defineProperty(a,"size",{get:function(){return 1},set:function(){throw"Property 'size' is not implemented yet!";}});var l={_dummy:function(){if(j!==null)j.style.width=a.offsetWidth-6+"px",(new Pinner(a,j,"bottom")).setPinMode("bottom",true)}};Object.defineProperty(a,"DOManchors",{get:function(){return l},set:function(a){l={_dummy:l._dummy};if(a)for(var b in a)a.propertyIsEnumerable(b)&&
(l[b]=a[b])}});Object.defineProperty(a,"expanded",{get:function(){return j!==null},set:function(b){switch(!!b){case true:if(!j){j=$("div","DOMTextDropDown_Overlay");addStyle(a,"expanded");for(b=0;b<h.length;b++)h[b].onAttach(),j.appendChild(h[b].DOMElement);j.addEventListener("mousedown",function(a){cancelEvent(a)},true)}document.body.appendChild(j);j.style.width=a.offsetWidth-6+"px";(new Pinner(a,j,"bottom")).setPinMode("bottom",true);break;case false:j.parentNode&&j.parentNode.removeChild(j),removeStyle(a,
"expanded")}}});a.addEventListener("click",function(){if(h.length)a.expanded=true},true);a.addEventListener("blur",function(){a.expanded=false;a.onChangeKey()},true);EnableCustomEventListeners(a);g.addEventListener("keyup",function(){if(k!=g.value)k=g.value,a.onCustomEvent("textChange",g.value)},true);var m=function(b,c){var i=[];if(h.length&&b!=""){for(var j=0;j<h.length;j++)h[j].visible&&i.push(h[j].text);var k=b.toLowerCase(),l=-1,m=-1;i.sort(function(a,b){aS=a.toLowerCase();bS=b.toLowerCase();
l=aS.indexOf(k);m=bS.indexOf(k);switch(true){case aS==bS:return 0;case aS==k:return-1;case bS==k:return-1;case l==0&&m==0:return a.length<b.length?-1:1;case l==0:return-1;case m==0:return 1;default:return aS<bS?-1:1}});c?(g.value=typeof i[0]!="undefined"?i[0]:!c?"":g.value,f.value=""):a.hintText=typeof i[0]!="undefined"?g.value.concat(i[0].substr(g.value.length)):""}else if(!c)f.value=""};Keyboard.bindKeyboardHandler(g,"tab",function(){g.value&&m(g.value,true)});a.onChangeKey=function(){if(g.value)for(var b=
0;b<h.length;b++)if(h[b].text.toLowerCase()==g.value.toLowerCase()){a.selectedIndex=b;g.value=h[b].text;a.expanded=false;break}};Keyboard.bindKeyboardHandler(g,"enter",a.onChangeKey);a.addCustomEventListener("textChange",function(a){for(var b=true,c=0;c<h.length;c++)h[c].textFilter=a,h[c].visible&&(b=false);try{h[i].selected=false,i=-1}catch(g){}b?f.value="":m(a,false);if(j)j.style.display=b?"none":""});drop.addItem=function(a,b){var c={};c.value=a;c.text=typeof b!="undefined"?b:a;return drop.add(c)};
drop.setItems=function(a){i=-1;g.value="";f.value="";if(drop.options.length)for(;drop.options.length>0;)drop.remove(0);for(var b=0;b<a.length;b++)drop.addItem((typeof a[b].value!="undefined"?a[b].value:a[b].id).toString(),(a[b].name||a[b].text).toString());return drop};typeof c!="undefined"&&drop.setItems(c);Object.defineProperty(a,"value",{get:function(){if(i!=-1)try{return h[i].value}catch(a){return null}else return null},set:function(b){for(var c=0;c<h.length;c++)if(b.toString()==h[c].value){a.selectedIndex=
c;return}a.selectedIndex=-1}});Object.defineProperty(a,"textValue",{get:function(){return g.value},set:function(b){for(var c=false,f=0;f<h.length;f++)if(h[f].text==b){a.selectedIndex=f;c=true;warn("found");break}if(!c)a.selectedIndex=-1;g.value=b}});return a}
function TextBox(c,a,b){var f=$(!b?"input":b);(!b||b=="text")&&f.setAttribute("type","text");EnableCustomEventListeners(f);var g=true,a=a||{};Object.defineProperty(f,"icon",{get:function(){return icon},set:function(a){(a?addStyle:removeStyle)(f,"hasIcon");f.style.backgroundImage=a?"url("+a+")":"none";icon=!a?"":a}});Object.defineProperty(f,"hintText",{get:function(){return f.placeholder},set:function(a){f.placeholder=a}});Object.defineProperty(f,"editable",{get:function(){return g},set:function(a){((g=
!!a)?removeStyle:addStyle)(f,"non-editable")}});if(typeof c!="undefined")f.value=c;f.addEventListener("input",function(){f.onCustomEvent("change",f.value)});if(typeof a.editable!="undefined")f.editable=!!a.editable;f.addEventListener("keydown",function(a){g||cancelEvent(a)},true);f.addEventListener("mousedown",function(a){g||cancelEvent(a)},true);return f}function PasswordBox(c,a){var b=new TextBox(c,a);b.setAttribute("type","password");return b}
function TextArea(c,a){return new TextBox("",a,"textarea")}
function DateBox(c){var a=new TextBox(c.value||""),c=c||{};c.value=c.value||"";c.displayFormat=c.displayFormat||"%a, %d %b, %Y";c.valueFormat=c.valueFormat||"%Y-%m-%d";if(!c.value)a.value=(new Date).toString(c.displayFormat);var b=new DatePicker(a,c.displayFormat);switch(true){case b.isDate&&b.isTime:addStyle(a,"isDateTime");break;case b.isTime:addStyle(a,"isTime");break;case b.isDate:addStyle(a,"isDate")}a.readOnly=true;Object.defineProperty(a,"dateValue",{get:function(){return b.DT.toString(c.valueFormat)},
set:function(a){b.DT.fromString(a,c.valueFormat);b.DD.fromString(a,c.valueFormat);if(b.isDate)b.onCustomEvent("render-month");if(b.isTime)b.onCustomEvent("render-time")}});Object.defineProperty(a,"valueFormat",{get:function(){return c.valueFormat}});Object.defineProperty(a,"displayFormat",{get:function(){return c.displayFormat}});return a}
function canvasThumbnailer(){this.constants={"folder-16x16":{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAFKgAABSoBd8oRkAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAMdEVYdFRpdGxlAEZvbGRlcuNZL58AAAAUdEVYdEF1dGhvcgBKYWt1YiBTdGVpbmVy5vv3LwAAABh0RVh0Q3JlYXRpb24gVGltZQAyMDA1LTAyLTAxhIsTNAAAAZVJREFUOI2lk7tuU0EQhr/ZXQixIXEEoggEuUBIXCIhkZI6JSiU9DwA4iUQD0DJIyBRRkIKr0CJRAQJkSiSYMfEx/HZ3RkafDnm4CbT7Grmn29+jXbFzDhPyKdXD9+0brS3nPhKoegedU/2D55tvvv6Yx4gXFpZvdVq37s9PPxeKTSu3cctLr//+HJ9GwUwEAzVscZK/RBiKuVo9zOp6E66DWLaxYWFjcvX1zZMM5ozZhlMQRVMKU466yEOMzl3if0J4GJjmQdPXiA+VFxZLtF0hsUBWg74srP9KKRysHJlqUWzdXUsbD9+ip7uoRrBpmyNTgMB3AXvwtLq2p27m1vo8HQsSL8P0HQ2Fo+abQow0oaFZsuXnW/k4lftpGoOsCmYGQEMcgZNWI3wfwAwBAggmCVMU0VodYDZR+e9BBEnpjOAmebJGqbyAuI8IcXCNDYwjfPt28wixSHiJcSily01/zqYnWQ1udHd43wgpH43w01cWJw2XAOohogjpUg4/rn3vNzpvRUv/6rmhCnS73Vey3m/8x/TbeMuDD8JHAAAAABJRU5ErkJggg==",emblems:{online:{"min-width":16,
src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAFKgAABSoBd8oRkAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAMdEVYdFRpdGxlAEZvbGRlcuNZL58AAAAUdEVYdEF1dGhvcgBKYWt1YiBTdGVpbmVy5vv3LwAAABh0RVh0Q3JlYXRpb24gVGltZQAyMDA1LTAyLTAxhIsTNAAAAZVJREFUOI2lk7tuU0EQhr/ZXQixIXEEoggEuUBIXCIhkZI6JSiU9DwA4iUQD0DJIyBRRkIKr0CJRAQJkSiSYMfEx/HZ3RkafDnm4CbT7Grmn29+jXbFzDhPyKdXD9+0brS3nPhKoegedU/2D55tvvv6Yx4gXFpZvdVq37s9PPxeKTSu3cctLr//+HJ9GwUwEAzVscZK/RBiKuVo9zOp6E66DWLaxYWFjcvX1zZMM5ozZhlMQRVMKU466yEOMzl3if0J4GJjmQdPXiA+VFxZLtF0hsUBWg74srP9KKRysHJlqUWzdXUsbD9+ip7uoRrBpmyNTgMB3AXvwtLq2p27m1vo8HQsSL8P0HQ2Fo+abQow0oaFZsuXnW/k4lftpGoOsCmYGQEMcgZNWI3wfwAwBAggmCVMU0VodYDZR+e9BBEnpjOAmebJGqbyAuI8IcXCNDYwjfPt28wixSHiJcSily01/zqYnWQ1udHd43wgpH43w01cWJw2XAOohogjpUg4/rn3vNzpvRUv/6rmhCnS73Vey3m/8x/TbeMuDD8JHAAAAABJRU5ErkJggg=="},
offline:{"min-width":16,src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAQAAAC1+jfqAAAAAXNSR0IArs4c6QAAAAJiS0dEAP+Hj8y/AAAACXBIWXMAAAUqAAAFKgF3yhGQAAAAB3RJTUUH3QIBCjEhJ6sDbgAAAOBJREFUKM+Fkb1qAlEQhb/ZHUFs/MEiKUwV7KwipLW01dJnCaQNVlY+RsDS3vdIIYJNQCUq7N69Y+GFzcomTjXnno+Zwx0x/i95nz6OJIj9bjOerYuA1p86z99BtKh+vi0NwK6T04U6+eIMgOHQfrtvZBiGxzj0NMFxAqDGkDjMynA4ElYvmjRbNAB45YgnD21AJdKH7oAEgB9ceM4B0Fq8Cxko2FdlKHgsGLd/YoAS8pYBEImKeHzB/o1FaGrpDZB3goieM4cvtQFi9JQJWrofBIduJ6t5/MclvRw+5N65Ly0IVlnj94iUAAAAAElFTkSuQmCC"},
undiscovered:{"min-width":16,src:"data:image/gif;base64,R0lGODlhEAAQAIABAAAAAP///yH5BAEKAAEALAAAAAAQABAAAAIWjI+py+0Po5wGWGjzuxd3p3mU9G1JAQA7"},filter:{"min-width":16,src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAAFuAAABbgBZBNOQAAAAAd0SU1FB90CAQo5DKqt1RMAAACHSURBVDjL7dIxDgFRFIXhz0wjGo1kImEB1JRsYUrFtGq1lWgUlmAhNCb2MGohEZXmKSRPZCrN/OW5J/9pLg3/J41kHeRYYYw7LnWkC6zRxwRbdL+Vk0g2wx4VjjhhXkdQhuUkLI8wQDsmaEWyDEsMw/2MKW7Y4fBL8KaHK55BWuCBTfN7n7wA86ARsGKyDcEAAAAASUVORK5CYII="},
url:{"min-width":16,src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB90CAQo1DAYYmh8AAAEgSURBVDjLY2AYBQMPGLELX2I0id4x3VDjmcuf/zr/Tl74vefauswsIg2YzBhT/fSLjTk31/svEgz/mTT+q0uvZly2ifPz2u5OPnTVTOgCJtF/pvk7Lud68V6Y4etvCwYxoYeM3378ZIj12c5rGNk/haAB+mrX3Laerv1/74UOw/tPvxhkhFcx8HLeZXjzUYhBU+mLM0EDXn5w+MfDfpNBUXQdw6t33xjuPpZk+PPnC8O3H6wMH75q/CdowIMnL3dxc4owqkpsZZAR3MKw/pA/w6MXIgxfvxsx3H/0cDdBA66sLso+ekbm0+8/XAynbxr8//bjM8PX7xIMO49If7i+riSfyGhkYNCPmDhZTlLI9T8Dw787Dz/svrEuN39wpkQAd6J0nZ6l1EkAAAAASUVORK5CYII="}}},
_generic:{emblems:{undiscovered:{"min-width":16,src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAMKSURBVGiB7ZhPSBRRHMe/v5mNHUR30UCtDCRio9AIFDp0WqiDi86glIJ4WfIQHToLaacuIURQCB66CHqYQ6J42I5BQUFC2UHMMsr+IEG2ONLs+N7+uriyyuwk5O5DmM9p573fb/h+mPdmHkvMjMOMpjrA/xIKqCYUUE0ooJpDLxDZb2EymTRisVhCSnlO1/UTAD4x85JhGMu2bXtlzBgI/etLTERkmuZVANcTicTR1tbWuBCC5+fnf62urroAnHw+/2hubu5pRRLvzRck0NPTUy+lvGOa5uX+/v6EruvEzGBm1jSNpJQ8Ozv7cXJy8iuAV4Zh3LVt26lc/IA9QEQkhLitaVrLwMBAQtd12tzc9NLp9PPe3t5n09PTH3Vdp+7u7tMdHR0NAC66rnurgtkBBAh0dXX1ADgvpeRsNpsDgEwms+o4jgCAqampr4Wnl0qlTm63XbEs61KZM+/CdxMnk8lITU3NYOF6cHDwZXV1tea67s56MwyDiAgAUFVVdaQwzsw3ALwoX+Td+D6BWCzWDMAoHnMcJy+E2BFIpVLHCr9XVlZ+F5U2WZZVc8A5S1JqCZ0Jampra4v39fWdBgDP8+TY2NiH4nkpZeKA8v0T3yWUz+frC8ujGCKi0dHRC83NzXEAWFtb2xweHn6zvr6+VVynaVp9WdL64CtARCt+49FolArhR0ZGXi8uLvq+Mkv1lwPfJeR53vugJmZGQHjR2NioViCTyfwA8H3vuBCCl5aW1hcWFn6WuiEzvxsfH98qNX/QlDwLEdE9Zn4AYGczCCHYtu1PjuPIEj25SCRyvww5SxJ4lDBN8yaAa4XroaGhs+3t7Q0AYNv2sm3b33bdjOjhzMzMk3KF9SPwOG0YxjgRPWZmAQDxeDxamKurq4sWlf5h5vuVDg/s4zQKAJ2dnad0Xb9RW1t7IZ1Ot2xsbHgTExOfXdfNEtHbXC43tr1vKs6+BHaKiciyrCYAx13X/aIq9K5M4T9zigkFVBMKqCYUUE0ooJpQQDWhgGpCAdWEAqoJBVQTCqjmL73YJfB2hSYXAAAAAElFTkSuQmCC"},
cdn:{"min-width":16,src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAANMSURBVGiB7ZrdaxxVGIef98zOrAkmGyERNel2rXixFlowtnvThlrsndT6BxQ0YSuBYClCWyw2bgimEApeeKehNb0pXjWUgoXcJCAhSghbbdNgv2gtVWyipMlmm9mZ1wtplO6HKXF3KMwDhxnm48zvmTlnvjiiqjzNmKADrJdQIGhCgaAJBYImFAiaUCBoQoGgCQWCJhQImlAgaEKBoAkFgiYUCJqnXiCy1g1lQFpYIYmQBF7A4xoRruIzo72aq2LGyrn+69+oZOQZhDTKu4AAdCQ6nnWMY0ZvjC4Aiwhf6HG9WIO8xfkqCUi/vIpHBnjx0TJLLMkdy+10LMecuXTml66Rruuu7yowSSMZPaTLNci9Stk+IB9KFI/j/Cs8gKeeTt6d/ANg/5b9bRNdE1tbG1ttIMUCH1Q3bjHlO3EznUBbqVW7v97906npU3cA2l9qb5o6MNW+K7GrAdgrGXm9KknLULIJyRFpoJ6RE2+d2LgjviPm+q6uFFa0oAW/4BXU9V11PdePx+J1qdbUc5axxPM97RzpvDx8aXhMe7WnZgaqWlToY1vjQOO453u+PgHZ37J/8ikX+QarVL3VKKVvoz7JhYcLXveF7isdGzuaHMsRxzjGjthiG9s4lrM6jVgREzVREzERGfxu8DbgMEsCuF6LC1C6CfXJIZS966j3iPbq9+vYf82UvgLKz811zZGx98e2JpoSdflC3nd9Vwv+P33AU893Pffved/zl9wl/+C3B69lf80u87A2Z7+8AFzdENvgJFuSDYJQb9evqbKebT1L6fPpH/Qznfv/IlamtMBr3Jy+Mn1r9Mboy3s27WkBmFueWzn749l78/l517EcsS3b2MYW27LFFtvkC3nv5MTJe0BNms4jyj6JJSNvAIP9b/a3Hd159BVLLMm5uUL3he6Z4exwuTM8Tx3v6WF9ULXEj+es+CrRJx+hvL0vua/p9DunN8eiMVtVSZ9PXx6aHvq9aAfDx/qJTlQzcPEhK5Hkc2Do3My5+9u/3D41Ozf7QESIx+LRx7a8j+FwrcPDGt5GASQjm4CuqIluTsVTreO3xhcBBe4CU8BX2quL1Y1aJtuTDjWQAWlhmeexuBnkd8BqnnCsRMCEAkHzF97kyLsO8uAKAAAAAElFTkSuQmCC"},
hidden:{"min-width":16,src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAMYSURBVGiB7ZnfS2RlGMc/z/Gs69TQruE6RqeCsB3bFUQckMFURJCMuTDwyovIfyCim/oPiv4Ds4vdBS9EWC+8UOgmQUKmC2lGDUtnJ1RsKpsfkR46M/N04bjIMGawcN4VzvfufXme73k+533fc973HFFVrrMs0wU8qwIA0woATCsAMK0AwLQCANMKAEwrADCtAMC0AgDTCgBMKwAwrQDAtK49gG3y4iIiwFtAFLgLNAM7wE/Ajqp6V3qY+jYqIg7wGXD/kpB94HNV/fE/fUwAiMh7wEfAzStCq8BDVX10WYDva0BEosAn1BUfiURCtm3X12MB0yLyzqV+fo6AiDQDXwFvALS3t4d6e3vbu7q6Iq2trS9UKpVqLpcrHR4eFtfX14+Oj4/dWmoB+FBVi6YB3gU+BYjFYnfGx8ffbmpqajgLTk9P/1lYWEhnMpm/al0PVfVBfZzfUygKMDIy4iQSiXvnxefz+b+TyWR2a2vrqFQqnQKEQqHmqamp3r6+vjsXc+vl92M0Go/HO4aHhzsBPM+rLC0tbadSqeOLQaOjo68NDg6+adu2lUgk7ofD4Z9XV1fvNjL0ewRedhznJQDXdb3FxcXNbDZbqg9Kp9O/r62tPSmXy1URobu7uwO4JSJN9bF+j8DeysqKc3BwUNrd3S0MDAw4ExMT9+bn59N7e3slgM7OzluTk5PduVyuNDc3txGPx510Op0DflHVSr2h34v4A2D6vN3f3x8ZGxuLiojs7+//aVmWOI5z23XdyszMTLJQKFx8Ey+r6pf1nn5Poe+Bp3esp6fnlVQqdVitVqttbW0vtrS03CiXy+q6rheLxTrqcpONDH0FqG0LFs/bs7OzP5ycnHiZTOaPYrHobm5u/mpZlrW8vLyzsbHx24XU71T120aevm8lROQm8DXgANi2LSIiQ0NDr2az2WI4HL6xvb2d9zyvWkspAtOqmm/oZ2gvdBv4GBi+IjQFfKGqR5d6mfxTLyIjwPucbalbat0ekAG+AR7rFQUaBXhaxNm54HXOzgNPVLX8v3OfB4Bn0bU/UgYApvUvMxYtZc3ytXoAAAAASUVORK5CYII="},
locked:{"min-width":16,src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAK9SURBVGiB7ZdNSFRRFMd/d3yTGdmoIH4wiCmSYaC00IVCYAslWkgLd220zWyUQAiFhDZGIEgroXDnUgJJJEIY8SOMUkIzxjRIMcSP8CvNZpw5LcYe4/TGAuFdhPeHtzjn/e/h/OCde+9TIsJZlkt3A6eVA6BbDoBuOQC6deYBDN0NAKCUARQAHmAeka3/XaoXQKkq4C7R5o2Y/DrwBniGyP6JJbRcJZS6iNfbwvLyjRN9Hs8G+/uPCQanElnsnwGlFO3tL1hcbGdiopT09CRLX3NzFhsbdwgERvB6SxOV0zHE9eTmXsHlUlRUpDM6Wkpm5vFPuaUlh66uYgzDRXZ2MtvbD1Aq2bKaiNj3QKbAa8nIGJXp6W35o0BgR7KyxgT80to6J5FINH94GBGfb1bAL3DPqqbdADePmvFLWtqITE1tmhDz87vS2fnFjEOhiDQ2fjT90G1V094hVsoH1JtxamoSQ0PXKC9PP+YLhSI0NMzS2/s9JhsEbiESjrXaPQMFx6Ld3TDV1TMsLf00cyJw//5cXPMA5wBvfEG7Adb+ynR05JGXl2LGSkFbWz7FxefjnAKsxy+3G2DuWNTdfZmmpnwA9vbCTE5GT+Dc3BT8/jJKSlJi3MuWh5rNQ1xkDmVPz5I5sDs7Iamufi+GMSyDg6tmfm3tQMrK3h6tadW/C0UhHkpz8yezya2toFRVvTPBkpKGpb9/xXy/unogycmvBHKs6uk4yJ5SWBjd+jY3g9TWfmBs7If5NhwW6uoC9PWtAODxuHG7nyOyYlVMz12oqOg6lZVdjI+7WVj4ZelRCmpqLmEYLxkYeESCRvUAACh1AfABtxM4vgFPEJk5sYw2ALMDlQYUA1eJ/g98BgLAV0Qi/1yuHeCUOvO/lA6AbjkAuuUA6JYDoFsOgG45ALrlAOiWA6BbDoBuOQC69Rt+YcUCuSysTwAAAABJRU5ErkJggg=="},
shortcut:{"min-width":16,src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAFASURBVGiB7doxboMwFMbxD8SAQfZgsWYAdUiVShE3iJShbM0JGGHNkjP0CByBtedA3KBzsmTLAJEal86WmnTo8Iz0/qvf8H6yvNmbpglzzqde4L8xgDoGUMcA6hhAHQOoYwB1DKCOAdQxgDoGUMcA6hhAHQOoYwB1DKCOAdQxgLrZAwLqBX5LCPEuhHh7NGOM+b5cLnsnAWEYvlRV9VwUxd2Zw+Ew9n2fOAkAgOVyic1mAwA4n88wxgAA4jiGlBJaawPM5A1st1us12ssFgvUdW2dzQLQdR3yPMdqtUKSJNaZ84Dr9YrdbgcpJcqyhO/bKzv7BgB7+bZtMQwDbrebNeP0DZxOJ6RpirZtEQQBlFLQWlszTt9AlmVomubhjOfibxUp5UcURa9Kqa97M8fjMRzHsXQS4HneE4Dkz0Hg8wdWPUnhuli55AAAAABJRU5ErkJggg=="}}}};
this.addIconsPack=function(c,a,b){for(var b=typeof b=="undefined"?true:!!b,a=a.split("/"),f=this.constants,g=0;g<a.length-1;g++)f[a[g]]=f[a[g]]||{},f=f[a[g]];f[a[a.length-1]]=b?{}:f[a[a.length-1]];var f=f[a[a.length-1]],i;for(i in c)c.propertyIsEnumerable(i)&&(f[i]=c[i])};this.create=function(c,a,b,f){var g=document.createElement("canvas");g.width=b;g.height=f;var i=[],h=[],j=function(){for(var a=0;a<h.length;a++)h[a]()},k=function(a){var c=new Image;c.onload=function(){c.loaded=true;c.painted=false;
for(var a=true,h=0;h<i.length;h++){if(!i[h].loaded){a=false;break}if(!i[h].painted)l.drawImage(i[h],0,0,b,f),i[h].painted=true}a&&j()};c.onerror=function(){c.loaded=true;for(var a=c.painted=true,h=0;h<i.length;h++){if(!i[h].loaded){a=false;break}if(!i[h].painted)l.drawImage(i[h],0,0,b,f),i[h].painted=true}a&&j()};i.push(c);c.src=a},l=g.getContext("2d");this.constants[c]?k(this.constants[c].src):(k(c),c="_generic");for(var m in this.constants[c].emblems)this.constants[c].emblems.propertyIsEnumerable(m)&&
a.indexOf(m)>=0&&this.constants[c].emblems[m]["min-width"]<=b&&k(this.constants[c].emblems[m].src);g.setUrl=function(a){h.push(function(){a.style.backgroundImage="url("+g.toDataURL()+")"});return g};g.setHref=function(a){h.push(function(){a.src=g.toDataURL()});return g};return g}}(function(){var c=new canvasThumbnailer;Object.defineProperty(window,"thumbnailer",{get:function(){return c}})})();
function Tooltip(c,a){var b=$("div","DomTooltipOuter");b._align=c||"";b._pinElement=a||null;b._visible=false;b._pinner=new Pinner(b._pinElement,b);b.inner=b.appendChild($("div","DomTooltipInner"));b.inner.appendChild($("div","lt"));b.inner.appendChild($("div","t"));b.inner.appendChild($("div","rt"));b.inner.appendChild($("div","l"));b.inner.appendChild($("div","r"));b.inner.appendChild($("div","lb"));b.inner.appendChild($("div","b"));b.inner.appendChild($("div","rb"));b.inner.appendChild($("div",
"bg"));b.container=b.inner.appendChild($("div","content"));b.getBody=function(){return b.container};b.getAlignment=function(){return b._align};b.setAlignment=function(a){switch(a){case "":b.className="DomTooltipOuter";b._pinner.setPinMode("bottom");b.offsetTop+b.offsetHeight>getMaxY()&&b._pinner.setPinMode("top");break;case "top":b.className="DomTooltipOuter bottom";b._pinner.setPinMode("top");if(b.offsetTop<0)b.className="DomTooltipOuter top",b._pinner.setPinMode("bottom");break;case "bottom":b.className=
"DomTooltipOuter top";b._pinner.setPinMode("bottom");if(b.offsetTop+b.offsetHeight>getMaxY())b.className="DomTooltipOuter bottom",b._pinner.setPinMode("top");break;case "left":b.className="DomTooltipOuter right";b._pinner.setPinMode("left");if(b.offsetLeft<0)b.className="DomTooltipOuter left",b._pinner.setPinMode("right");break;case "right":b.className="DomTooltipOuter left";b._pinner.setPinMode("right");if(b.offsetLeft+b.offsetWidth>getMaxX())b.className="DomTooltipOuter right",b._pinner.setPinMode("left");
break;default:throw'Invalid tooltip alignment "'+a+'", allowed only: "", "top", "left", "right", "bottom"';}b._align=a};b.getVisible=function(){return b._visible};b.setVisible=function(a){a?(document.body.appendChild(b),b.setAlignment(b._align),b._visible=true):(b.parentNode&&b.parentNode.removeChild(b),b._visible=false)};b.setAlignment(b._align);b.getHtmlContent=function(){return b.container.innerHTML};b.setHtmlContent=function(a){b.container.innerHTML=a;b._visible&&b.setVisible(true)};b.redraw=
function(){b._visible&&b.setVisible(true)};Object.defineProperty?(Object.defineProperty(b,"alignment",{get:b.getAlignment,set:b.setAlignment}),Object.defineProperty(b,"visible",{get:b.getVisible,set:b.setVisible}),Object.defineProperty(b,"body",{get:b.getBody}),Object.defineProperty(b,"htmlContent",{get:b.getHtmlContent,set:b.setHtmlContent})):b.__defineGetter__&&(b.__defineGetter__("alignment",b.getAlignment),b.__defineSetter__("alignment",b.setAlignment),b.__defineGetter__("visible",b.getVisible),
b.__defineSetter__("visible",b.setVisible),b.__defineGetter__("body",b.getBody),b.__defineGetter__("htmlContent",b.getHtmlContent),b.__defineSetter__("htmlContent",b.setHtmlContent));return b}
function setupTooltip(c,a){if(typeof a=="undefined"){var b=c.getAttribute("title");if(b)a=b,c.title=""}if(typeof c.___toolTip=="undefined"){c.___toolTip=new Tooltip("top",c);c.___mouseMooveHandler=function(a){try{var b=new MouseBoundaryCrossing(a,c)}catch(f){return}switch(true){case b.leftLandmark:c.___toolTip.setVisible(false);break;case b.enteredLandmark:c.___toolTip.setVisible(true)}};try{c.addEventListener("mouseover",function(a){c.___mouseMooveHandler(a)},false),c.addEventListener("mouseout",
function(a){c.___mouseMooveHandler(a)},false)}catch(f){c.attachEvent("onmouseover",function(){c.___mouseMooveHandler()}),c.attachEvent("onmouseout",function(){c.___mouseMooveHandler()})}}typeof a!="undefined"&&c.___toolTip.setHtmlContent(a);return c.___toolTip}
function setupHint(c,a){if(typeof c.___hintTip=="undefined"){c.___hintTip=new Tooltip("right",c);c.___focusHandler=function(){c.___hintTip.setVisible(true)};c.___blurHandler=function(){c.___hintTip.setVisible(false)};try{c.addEventListener("focus",function(a){c.___focusHandler(a)},false),c.addEventListener("blur",function(a){c.___blurHandler(a)},false)}catch(b){c.attachEvent("onfocus",function(){c.___focusHandler()}),c.attachEvent("onblur",function(){c.___blurHandler()})}}typeof a!="undefined"&&c.___hintTip.setHtmlContent(a)}
var ___TREE_DEBUG_MODE___=false,___TREE_ANIMATION___=false,___TREE_ANIMATION_SPEED___=5,___TREE_ANIMATION_PRIORITY___=5;
function TreeConnector(){var c=$("div","DomTreeBranchConnector");c._ctype="none";c._expanded=null;c._last=false;c.getConnectorType=function(){return c._ctype};c.setConnectorType=function(a){switch(a){case "pipe":c.className="DomTreeBranchConnector pipe";break;case "node":c.className="DomTreeBranchConnector node";break;case "none":c.className="DomTreeBranchConnector";break;default:throw'Invalid connector type "'+a+'": allowed only "pipe", "node" or "none"';}c._ctype=a};c.getExpanded=function(){return c._expanded};
c.setExpanded=function(a){if(a===null)removeStyle(c,"expanded"),removeStyle(c,"collapsed");else if(a===true)removeStyle(c,"collapsed"),addStyle(c,"expanded");else if(a===false)removeStyle(c,"expanded"),addStyle(c,"collapsed");else throw'Invalid setter ["'+a+'"] expanded (allowed only null, true, or false)';c._expanded=a};c.getLast=function(){return c._last};c.setLast=function(a){if(a!=c._last)switch(c._last=a?true:false,c._last){case true:addStyle(c,"last");break;case false:removeStyle(c,"last")}};
try{c.__defineGetter__("connectorType",c.getConnectorType),c.__defineSetter__("connectorType",c.setConnectorType),c.__defineGetter__("expanded",c.getExpanded),c.__defineSetter__("expanded",c.setExpanded),c.__defineGetter__("last",c.getLast),c.__defineSetter__("last",c.setLast)}catch(a){Object.defineProperty?(Object.defineProperty(c,"connectorType",{get:c.getConnectorType,set:c.setConnectorType}),Object.defineProperty(c,"expanded",{get:c.getExpanded,set:c.setExpanded}),Object.defineProperty(c,"last",
{get:c.getLast,set:c.setLast})):console.log("Setters and getters are not implemented in your browser!")}return c}
function TreeBranch(c){if(c&&c.node){var a=c.node;try{a.getConnector().removeEventListener("click",a.toggleExpand,false),a.removeEventListener("focus",a.notifyFocus,false),a.removeEventListener("click",a.notifyActivate,false),a.iconHolder.removeEventListener("dblclick",a.toggleExpand,false)}catch(b){a.getConnector().detachEvent("onclick",a.toggleExpand),a.detachEvent("onfocus",a.notifyFocus),a.detachEvent("onclick",a.notifyActivate),a.iconHolder.detachEvent("ondblclick",a.toggleExpand)}a.innerHTML=
"";a._expanded=null;a.father=void 0;a._visible=void 0;a._firedReady=void 0;a._items=void 0;a.focus=a.___saveFocusFunc;a.connectorFootPrint=void 0}else a=$("div","DomTreeBranch");a.__saveData=c&&c.items&&c.expanded?{expanded:c.expanded}:{};a.inheritConnectors=a.appendChild($("div","DomTreeBranchGuidesHolder"));a.ownConnector=a.appendChild($("div","DomTreeBranchGuidesHolder"));a.iconHolder=a.appendChild($("div","DomTreeBranchIcon"));a.captionHolder=a.appendChild($("div","DomTreeBranchCaption"));a.inputHolder=
null;a._caption="";a._icon="";a._lastNode=true;a._expanded=false;a._visible=false;a._firedReady=false;a._inputType="";a._disabled=false;a._overlays=c.overlays||[];a._badges=c.badges||[];if(typeof a._checked=="undefined")a._checked=false;a.style.display="none";a.tabIndex=0;a.effectStack=[];a.effectThreadId=false;a.effectFunction=function(){if(!a.effectStack.length&&a.effectThreadId)window.clearInterval(a.effectThreadId),a.effectThreadId=false;else if(a.effectStack.length){var b=a.effectStack.shift();
a.style[b.property]=b.value}};a.startEffect=function(){if(!a.effectThreadId)a.effectThreadId=window.setInterval(a.effectFunction,___TREE_ANIMATION_PRIORITY___)};a.addEffectStep=function(b,c){a.effectStack.push({property:b,value:c})};a.effectMaximize=function(){a.addEffectStep("height","1px");a.addEffectStep("display","");for(var b=2;b<=20;b+=___TREE_ANIMATION_SPEED___)a.addEffectStep("height",b+"px");a.addEffectStep("height","");a.startEffect()};a.effectMinimize=function(){for(var b=20;b>=1;b-=___TREE_ANIMATION_SPEED___)a.addEffectStep("height",
b+"px");a.addEffectStep("display","none");a.startEffect()};a.updateMinWidth=function(){var b=20;b+=a._caption.toString().visualWidth();b+=parseInt(a.ownConnector.style.width);b+=parseInt(a.inheritConnectors.style.width);b+=a._icon?16:0;b+=a.inputHolder?20:0;a.style.minWidth=b+"px"};a.setConnectors=function(b,c){b.connectors=typeof b.connectors!="undefined"?b.connectors:[];var f=b.connectors.length;if(f>c){do{f--;var g=b.connectors[f];b.connectors.splice(f,1);b.removeChild(g)}while(f>c)}else if(f<
c){do b.connectors.push(b.appendChild(new TreeConnector)),f++;while(f<c)}b.style.width=b.connectors.length*16+1+"px";a.updateMinWidth()};a.getCaption=function(){return a._caption};a.setCaption=function(b){a.captionHolder.innerHTML="";if(typeof b=="string")a.captionHolder.appendChild($text(a._caption=b));else{var c=$("a");c.appendChild($text(b.anchorText));c.setAttribute("href",b.href);a.captionHolder.appendChild(c);a._caption=b}a.updateMinWidth()};a.getBadges=function(){return a._badges};a.setBadges=
function(b){a._badges=b;a.setIcon(a.getIcon());console.log("set badges: ",b)};a.getOverlays=function(){return a._overlays};a.setOverlays=function(b){a.iconHolder.innerHTML="";for(var c=0;c<b.length;c++)(function(){var f=document.createElement("img");f.addEventListener("load",function(){a.iconHolder.appendChild(f)});f.style.position="absolute";f.src=b[c]})(b[c])};a.rename=function(){var b=a._caption;a.captionHolder.innerHTML="";var c=a.captionHolder.appendChild((new TextBox(b)).setAttr("style","display: block; position: absolute; left: "+
a.captionHolder.offsetLeft+"px; top: 0px; right: 2px; bottom: 0px; border: none; padding: none; margin: none; background-color: white"));a.parentNode.isRenaming=true;try{c.focus(),c.select()}catch(f){}c.onRenameReady=function(){try{c.parentNode&&c.parentNode.removeChild(c);var f=c.value;f!=b?a.parentNode.onCustomEvent("rename",{node:a,oldCaption:b,newCaption:f})?a.setCaption(f):a.setCaption(b):a.setCaption(b);a.isRenaming=false;delete a.isRenaming;a.parentNode.isRenaming=false}catch(g){}};c.onCancelRename=
function(){a.setCaption(b);a.isRenaming=false;delete a.isRenaming;a.parentNode.isRenaming=false;a.focus()};try{c.addEventListener("click",function(){c.focus();c.select()},true),c.addEventListener("dblclick",function(a){a=a||window.event;c.select();cancelEvent(a)},true),c.addEventListener("blur",c.onRenameReady),c.addEventListener("keydown",function(a){a=a||window.event;switch(a.keyCode||a.charCode){case 13:c.onRenameReady();break;case 27:c.onCancelRename()}},true)}catch(g){}a.isRenaming=true};a.getIcon=
function(){return a._icon};a.setIcon=function(b){a._icon=b;a._badges.length?(a.iconHolder.style.backgroundImage="none",thumbnailer.create(a._icon,a._badges,16,16).setUrl(a.iconHolder)):a.iconHolder.style.backgroundImage=b?'url("'+b+'")':"none";a.iconHolder.style.width=b?"16px":""};a.getConnector=function(){return a.ownConnector.connectors[0]};a.getExpanded=function(){return a._expanded};a.setExpanded=function(b){if(typeof a._items!="undefined"){if(b){if(!a._expanded&&!a.parentNode.onCustomEvent("expand",
a))return}else if(a._expanded&&!a.parentNode.onCustomEvent("collapse",a))return;a._expanded=b?true:false;a.getConnector().setExpanded(!a._items.length?null:b);b&&a.father&&a.father.setExpanded(true);if(a._items)for(b=0;b<a._items.length;b++)a._items[b].setVisible(a._expanded);switch(a._expanded){case false:a.setIcon(a._icon.toString().replace("opened","closed").replace("collapsed","expanded"));break;case true:a.setIcon(a._icon.toString().replace("closed","opened").replace("expanded","collapsed"));
for(b=a;b.father;)b=b.father,b.getExpanded()||b.setExpanded(true)}}};a.getVisible=function(){return a._visible};a.setVisible=function(b){if(a._visible!=b){a._visible=b;if(a._items)if(b){if(a.getExpanded())for(c=0;c<a._items.length;c++)a._items[c].setVisible(true)}else for(var c=0;c<a._items.length;c++)a._items[c].setVisible(false);___TREE_ANIMATION___?b?a.effectMaximize():a.effectMinimize():a.style.display=b?"":"none"}};a.getIsFolder=function(){return typeof a._items=="undefined"?false:true};a.getParentNodeOrder=
function(){if(!a.father)return 0;for(var b=0;b<a.father._items.length;b++)if(a.father._items[b]==a)return b;return a.father._items.length};a.getItems=function(){return typeof a._items=="undefined"?null:a._items};a.setItems=function(b){if(typeof b=="undefined")return delete a._items,true;a._items=[];for(var c,f=0;f<b.length;f++)c=a.addSubItem(new TreeBranch(b[f])),b[f].type&&(c.setInputType(b[f].type),c.setChecked(b[f].checked||false)),typeof b[f].items!="undefined"&&c.setItems(b[f].items);a.setIcon(a._icon||
(a.getExpanded()?"img/16x16/folder-online-16x16.png":"img/folder-online-16x16.png"));if(a.__saveData&&a.__saveData.expanded)a.setExpanded(a.__saveData.expanded),a.__saveData=null};a.getLastNode=function(){return a._lastNode};a.setLastNode=function(b){a.getConnector().setLast(b);a._lastNode=b};a.getToObject=function(){var b={id:a.nodeID,name:a.getCaption(),icon:a.getIcon(),expanded:a.getExpanded(),node:a,overlays:a.getOverlays(),badges:a.getBadges()};if(a.getInputType())b.type=a.getInputType(),b.checked=
a.getChecked();if(a._items){b.items=[];for(var c=0;c<a._items.length;c++)b.items.push(a._items[c].getToObject())}return b};a.getMoveMarker=function(){return a.__moveMethod};a.setMoveMarker=function(b){if(a.father){if(a.parentNode.___markerElement&&a.parentNode.___markerElement!=a)a.parentNode.___markerElement.setMoveMarker(""),a.parentNode.___markerElement=a;switch(b){case "before":removeStyle(a,"markerAfter");addStyle(a,"markerBefore");a.style.backgroundPosition=a.iconHolder.offsetLeft-2+"px 0px";
addStyle(a.father,"dropElement");break;case "after":removeStyle(a,"markerBefore");addStyle(a,"markerAfter");a.style.backgroundPosition=a.iconHolder.offsetLeft-2+"px "+(a.offsetHeight-6)+"px";addStyle(a.father,"dropElement");break;default:removeStyle(a,"markerAfter"),removeStyle(a,"markerBefore"),a.style.backgroundPosition="",removeStyle(a.father,"dropElement")}a.parentNode.___markerElement=a;a.__moveMethod=b}else if(a.parentNode.___markerElement)a.parentNode.___markerElement.setMoveMarker(""),a.parentNode.___markerElement=
false};a.getInputType=function(){return a._inputType};a.inputTypeClickListener=function(b){if(a._disabled)cancelEvent(b||window.event);else if(a.setChecked(a.inputHolder._input.checked),a._items&&a.inputHolder._input.getAttribute("type")=="checkbox"&&a.parentNode.___clickPropagation.indexOf("children")!=-1)for(b=0;b<a._items.length;b++)a._items[b].setChecked(a.getChecked(),true,true);else if(a.father&&a.inputHolder._input.getAttribute("type")=="radio"&&a.inputHolder._input.checked)for(b=0;b<a.father._items.length;b++)a.father._items[b]!=
a&&a.father._items[b].setChecked(false)};a.setInputType=function(b){if(b!=a._inputType){if(!b&&a._inputType)a.removeChild(a.inputHolder),a.inputHolder=null,a._inputType=b;switch(b){case "checkbox":if(!a.inputHolder)a.inputHolder=$("div","DomTreeBranchInputHolder");a.insertBefore(a.inputHolder,a.captionHolder);a.inputHolder.innerHTML="";var c=$("input");c.setAttribute("type","checkbox");a.inputHolder._input=a.inputHolder.appendChild(c);try{a.inputHolder._input.addEventListener("click",a.inputTypeClickListener,
true),a.inputHolder._input.addEventListener("dblclick",function(a){cancelEvent(a);return false},true)}catch(f){a.inputHolder._input.attachEvent("onclick",a.inputTypeClickListener),a.inputHolder._input.attachEvent("ondblclick",function(a){cancelEvent(a);return false},true)}break;case "radio":if(!a.inputHolder)a.inputHolder=$("div","DomTreeBranchInputHolder");a.insertBefore(a.inputHolder,a.captionHolder);a.inputHolder.innerHTML="";c=$("input");c.setAttribute("type","radio");a.inputHolder._input=a.inputHolder.appendChild(c);
try{a.inputHolder._input.addEventListener("click",a.inputTypeClickListener,true),a.inputHolder._input.addEventListener("dblclick",function(a){cancelEvent(a);return false},true)}catch(g){a.inputHolder._input.attachEvent("onclick",a.inputTypeClickListener),a.inputHolder._input.attachEvent("ondblclick",function(a){cancelEvent(a);return false},true)}break;default:if(a.inputHolder)a.removeChild(a.inputHolder),a.inputHolder=null}a._inputType=b}};a.getChecked=function(){return a._checked};a.setChecked=function(b,
c,f){a._checked=b;if(a.inputHolder&&a.inputHolder._input)a.inputHolder._input.checked=b;if(c&&a._items&&a.parentNode.___clickPropagation.indexOf("children")!=-1)for(var g=0;g<a._items.length;g++)a._items[g].setChecked(b,c,true);if(!f&&a._inputType=="checkbox"&&a.father&&a.father._inputType=="checkbox"&&a.parentNode.___clickPropagation.indexOf("parent")!=-1){c=false;if(b)c=true;else for(g=0;g<a.father._items.length;g++)if(a.father._items[g]._inputType=="checkbox"&&a.father._items[g].getChecked()){c=
true;break}a.father.setChecked(c,false,false)}};a.getDisabled=function(){return a._disabled};a.setDisabled=function(b){a._disabled=b;(b?addStyle:removeStyle)(a,"DomTreeBranchDisabled");try{a.inputHolder._input.disabled=b}catch(c){}};try{a.__defineGetter__("caption",a.getCaption),a.__defineSetter__("caption",a.setCaption),a.__defineGetter__("icon",a.getIcon),a.__defineSetter__("icon",a.setIcon),a.__defineGetter__("connector",a.getConnector),a.__defineGetter__("expanded",a.getExpanded),a.__defineSetter__("expanded",
a.setExpanded),a.__defineGetter__("visible",a.getVisible),a.__defineSetter__("visible",a.setVisible),a.__defineGetter__("isFolder",a.getIsFolder),a.__defineGetter__("parentNodeOrder",a.getParentNodeOrder),a.__defineGetter__("items",a.getItems),a.__defineSetter__("items",a.setItems),a.__defineGetter__("lastNode",a.getLastNode),a.__defineSetter__("lastNode",a.setLastNode),a.__defineGetter__("toObject",a.getToObject),a.__defineGetter__("moveMarker",a.getMoveMarker),a.__defineSetter__("moveMarker",a.setMoveMarker),
a.__defineGetter__("inputType",a.getInputType),a.__defineSetter__("inputType",a.setInputType),a.__defineGetter__("checked",a.getChecked),a.__defineSetter__("checked",a.setChecked),a.__defineGetter__("disabled",a.getDisabled),a.__defineSetter__("disabled",a.setDisabled),a.__defineGetter__("overlays",a.getOverlays),a.__defineSetter__("overlays",a.setOverlays),a.__defineGetter__("badges",a.getBadges),a.__defineSetter__("badges",a.setBadges)}catch(f){Object.defineProperty?(Object.defineProperty(a,"caption",
{get:a.getCaption,set:a.setCaption}),Object.defineProperty(a,"icon",{get:a.getIcon,set:a.setIcon}),Object.defineProperty(a,"connector",{get:a.getConnector}),Object.defineProperty(a,"expanded",{get:a.getExpanded,set:a.setExpanded}),Object.defineProperty(a,"visible",{get:a.getVisible,set:a.setVisible}),Object.defineProperty(a,"isFolder",{get:a.getIsFolder}),Object.defineProperty(a,"parentNodeOrder",{get:a.getParentNodeOrder}),Object.defineProperty(a,"items",{get:a.getItems,set:a.setItems}),Object.defineProperty(a,
"lastNode",{get:a.getLastNode,set:a.setLastNode}),Object.defineProperty(a,"toObject",{get:a.getToObject}),Object.defineProperty(a,"moveMarker",{get:a.getMoveMarker,set:a.setMoveMarker}),Object.defineProperty(a,"inputType",{get:a.getInputType,set:a.setInputType}),Object.defineProperty(a,"checked",{get:a.getChecked,set:a.setChecked}),Object.defineProperty(a,"disabled",{get:a.getDisabled,set:a.setDisabled}),Object.defineProperty(a,"overlays",{get:a.getOverlays,set:a.setOverlays}),Object.defineProperty(a,
"badges",{get:a.getBadges,set:a.setBadges})):console.log("Getters and Setters functionality is not supported by your version of browser")}a.setConnectors(a.ownConnector,1);a.ownConnector.connectors[0].___expandConnector=true;a.getConnector().setConnectorType("node");a.setOverlays(a._overlays);a.getLastSibling=function(){return a._items&&a._items.length?a._items[a._items.length-1].getLastSibling():a};a.addSubItem=function(b){a._items=a._items||[];a._items.length&&a._items[a._items.length-1].setLastNode(false);
if(a.nextSibling){var c=a.getLastSibling();c.nextSibling?a.parentNode.insertBefore(b,c.nextSibling):a.parentNode.appendChild(b)}else a.parentNode.appendChild(b);a._items.push(b);a.getConnector().getExpanded()===null&&a.getConnector().setExpanded(false);a.setParentRelationship(b);b.setLastNode(true);try{a.parentNode.onCustomEvent("ready",b)}catch(f){}return b};a.insertBranchDataAt=function(b,c,f){a._items=a._items||[];var g=new TreeBranch(b);if(c>a._items.length)return a.addSubItem(g),typeof b.items!=
"undefined"&&g.setItems(b.items),a.setIcon(a._icon||(a.getExpanded()?"img/folder_opened.png":"img/folder_closed.png")),g;c=c<0?0:c;if(c==0)a.nextSibling?a.parentNode.insertBefore(g,a.nextSibling):a.parentNode.appendChild(g);else{var l=a._items[c-1].getLastSibling();l&&l.nextSibling?a.parentNode.insertBefore(g,l.nextSibling):a.parentNode.appendChild(g)}a._items.splice(c,0,g);g.setLastNode(c==a._items.length-1?true:false);a.getConnector().getExpanded()===null&&a.getConnector().setExpanded(b.expanded?
b.expanded:false);a.setParentRelationship(g);a.parentNode.onCustomEvent("ready",g);typeof b.items!="undefined"&&g.setItems(b.items);g.setVisible(a.getExpanded());typeof b.type!="undefined"&&(g.setInputType(b.type),g.setChecked(b.checked));for(b=0;b<a._items.length-1;b++)a._items[b].setLastNode(false);a._items.length>1&&a._items[a._items.length-1].setLastNode(true);(typeof f=="undefined"||f)&&a.repaintConnectors(a.connectorFootPrint);return g};a.swapChildBranches=function(b,c,f){var g=Math.min(b,c),
b=Math.max(b,c),c=b==a._items.length-1,l=a._items[g].toObject,m=a._items[b].toObject;a.parentNode.deleteNode(a._items[b],true);a.parentNode.deleteNode(a._items[g],true);f=typeof f=="undefined"?true:f;a.insertBranchDataAt(m,g,false);a.insertBranchDataAt(l,b,false);if(c){for(g=0;g<a._items.length-1;g++)a._items[g].setLastNode(false);a._items[a._items.length-1].setLastNode(true)}f&&a.repaintConnectors(a.connectorFootPrint)};if(typeof c!="undefined")a.setCaption(c.name||""),a.nodeID=c.id||-1,a.setIcon(typeof c.icon==
"undefined"?!c.items?"img/16x16/file.png":"img/16x16/folder-online-16x16.png":c.icon),a.setInputType(c.type||(a.father?a.father.getInputType():null)),a.setDisabled(c.disabled||false),typeof c.expanded!="undefined"&&a.setExpanded(c.expanded);a.setParentRelationship=function(b){b.father=a;b.setInputType(a.getInputType());b.setChecked(b._checked);b.repaintConnectors()};a.clearConnectors=function(){a.setConnectors(a.inheritConnectors,0);if(a._items&&a._items.length)for(var b=0;b<a._items.length;b++)a._items[b].clearConnectors()};
a.repaintConnectors=function(b){try{a.setConnectors(a.inheritConnectors,(a.father.inheritConnectors.connectors||[]).length+1)}catch(c){a.setConnectors(a.inheritConnectors,0)}a.connectorFootPrint=b;if(typeof b!="undefined"){for(var f=0;f<a.inheritConnectors.connectors.length;f++)b.charAt(f)=="0"?a.inheritConnectors.connectors[f].setConnectorType("none"):a.inheritConnectors.connectors[f].setConnectorType("pipe");if(typeof a._items!="undefined")for(f=0;f<a._items.length;f++)a._items[f].repaintConnectors(b.concat(a.getLastNode()?
"0":"1"))}};a.setVisible(false);a.toggleExpand=function(b){cancelEvent(b);a.setExpanded(!a.getExpanded());return false};a.toggleExpandClick=function(b){cancelEvent(b);a.setExpanded(!a.getExpanded());return false};a.___saveFocusFunc=a.focus;a.notifyFocus=function(){try{a.parentNode.setFocusedNode(a)}catch(b){console.warn("Tree.Node.notifyFocus: Could not focus node: "+a.nodeID)}};a.focus=function(){if(!a.isRenaming){for(var b=a;b.father;)b=b.father,b.setExpanded(true);a.___saveFocusFunc();a.notifyFocus()}};
a.notifyActivate=function(){a.parentNode.setSelectedNode(a)};a.deleteNode=function(){if(a._items&&a._items.length)for(;a._items.length;)a._items[0].deleteNode(),a._items.splice(0,1);a.parentNode.___deletedNodes.push(a);a.parentNode.removeChild(a)};try{a.getConnector().addEventListener("click",a.toggleExpandClick,false),a.addEventListener("focus",a.notifyFocus,false),a.addEventListener("click",a.notifyActivate,false),a.iconHolder.addEventListener("dblclick",a.toggleExpand,false)}catch(g){a.getConnector().attachEvent("onclick",
a.toggleExpand),a.attachEvent("onfocus",a.notifyFocus),a.attachEvent("onclick",a.notifyActivate),a.iconHolder.attachEvent("ondblclick",a.toggleExpand)}a.createClone=function(b){var c=false,f=0;if(!b){c=true;f=a.inheritConnectors.connectors.length;b=$("div","DomTreeBranchClone");b.items=[];b.__StatusBar=b.appendChild($("div","CloneStatusBar"));b.setCaption=function(a){this.__StatusBar.innerHTML="";this.__StatusBar.appendChild(document.createTextNode(a))};b.setOk=function(a){a?addStyle(b.__StatusBar,
"ok"):removeStyle(b.__StatusBar,"ok")};try{b.__defineSetter__("caption",b.setCaption),b.__defineSetter__("ok",b.setOk)}catch(g){Object.defineProperty?(Object.defineProperty(b,"caption",{set:b.setCaption}),Object.defineProperty(b,"ok",{set:b.setOk})):console.log("Your browser does not support getters and setters")}}if(!(b.items.length>10)){var l=a.cloneNode(true);removeStyle(l,"selectedItem");b.appendChild(l);b.items.push(l);if(a.getExpanded()&&a._items&&a._items.length)for(var m=0;m<a._items.length;m++)a._items[m].createClone(b);
if(c){for(m=0;m<b.items.length;m++){for(var c=b.items[m].firstChild,o=0;o<f;o++)c.removeChild(c.firstChild);if(c.firstChild)c.firstChild.className="DomTreeBranchConnector";c.style.width=parseInt(c.style.width)-16*f+"px"}l.firstChild.nextSibling.firstChild.className="DomTreeBranchConnector"}return b}};a.canAcceptElement=function(b){if(!a._items||b.father==a||b==a)return false;var c=a;if(c.father){do{if(c.father==b)return false;c=c.father}while(c.father)}return true};a.isChildOf=function(b){var c=a;
if(c==b)return true;for(;c.father;)if(c=c.father,c==b)return true;return false};a.getMoveMethod=function(b,c){return c<Math.floor((a.offsetTop+(a.offsetTop+a.offsetHeight))/2)?"before":"after"};a.__moveMethod="";a.addEventListener("dblclick",function(){try{a.parentNode.onCustomEvent("node-doubleclick",a)}catch(b){console.warn(b)}},true);return a}
function Tree(c,a){var b=$("div","DomTree");typeof a!="undefined"&&(c=a(c));try{b.onselectstart=function(){return false}}catch(f){}b.addCustomEventListener("drop",function(){console.warn("Warning: tree.onCustomEvent('drop') has been changed to: tree.onCustomEvent('internal-drop'), in order to make room for MakeDragable() feature");return true});b.tabIndex=0;b.rootNode=b.appendChild(new TreeBranch([]));b.rootNode.setCaption(c.name);b.rootNode.nodeID=c.id;b.rootNode._badges=c.badges||[];b.rootNode.setIcon(c.icon||
"img/folder_closed.png");b.rootNode.setInputType(c.type||null);c.items&&b.rootNode.setItems(c.items);b.rootNode.getConnector().setConnectorType("none");b.rootNode.setExpanded(false);b.rootNode.setVisible(true);b.rootNode.repaintConnectors("");b.___activeNode=null;b.___selectedNode=null;b.___dropElement=null;b.___deletedNodes=[];b.___dropAfterElement=null;b.___dropBeforeElement=null;b.___dragAndDrop=false;b.___kbDelete=false;b.___clickPropagation=["parent","children"];b.___isDragging=false;b.___originDragElement=
false;b.___dragClone=false;b.___firedDrag=false;b.___markerElement=false;b.getFocusedNode=function(){return b.___activeNode};b.setFocusedNode=function(a){if(b.___activeNode!=a)b.onCustomEvent("focus",a);b.___activeNode=a;b.___selectedNode===null&&b.setSelectedNode(a)};b.getSelectedNode=function(){return b.___selectedNode};b.setSelectedNode=function(a){if(b.___selectedNode!=a)b.onCustomEvent("change",a);b.___selectedNode&&removeStyle(b.___selectedNode,"selectedItem");b.___selectedNode=a;b.___selectedNode&&
addStyle(b.___selectedNode,"selectedItem");b.setFocusedNode(a);try{b.___activeNode.focus()}catch(c){}};b.getDropElement=function(){return b.___dropElement};b.setDropElement=function(a){b.___dropElement&&removeStyle(b.___dropElement,"dropElement");b.___dropElement=a?a:null;b.___dropElement&&addStyle(b.___dropElement,"dropElement")};b.getDragAndDrop=function(){return b.___dragAndDrop};b.setDragAndDrop=function(a){b.___dragAndDrop=a?true:false};b.getKbDelete=function(){return b.___kbDelete};b.setKbDelete=
function(a){b.___kbDelete=a?true:false};b.getClickPropagation=function(){return b.___clickPropagation};b.setClickPropagation=function(a){if(!a||!a.length)b.___clickPropagation=[];else{for(var c=[],f=0;f<a.length;f++)if(/^parent|children$/i.test(a[f])){var g=a[f].toLowerCase();c.indexOf(g)==-1&&c.push(g)}else throw"Invalid clickPropagation value: "+a[f];b.___clickPropagation=c}};Object.defineProperty(b,"focusedNode",{get:b.getFocusedNode,set:b.setFocusedNode});Object.defineProperty(b,"selectedNode",
{get:b.getSelectedNode,set:b.setSelectedNode});Object.defineProperty(b,"dropElement",{get:b.getDropElement,set:b.setDropElement});Object.defineProperty(b,"dragAndDrop",{get:b.getDragAndDrop,set:b.setDragAndDrop});Object.defineProperty(b,"kbDelete",{get:b.getKbDelete,set:b.setKbDelete});Object.defineProperty(b,"clickPropagation",{get:b.getClickPropagation,set:b.setClickPropagation});(function(){var a=true;Object.defineProperty(b,"internalDragTooltipVisible",{get:function(){return a},set:function(b){a=
!!b}})})();(function(){var a=false;Object.defineProperty(b,"acceptExternalData",{get:function(){return a},set:function(c){a=c=!!c;b.internalTooltip=!c;c?(MakeDropable(b,{dragInElements:true}),b.addCustomEventListener("dragenter",function(){a&&addStyle(b,"dragEnter")}),b.addCustomEventListener("dragleave",function(){a&&removeStyle(b,"dragEnter")}),b.addCustomEventListener("dragmove-in",function(a){b.selectedNode=a})):b.isDropable=false}})})();b.focusNextNode=function(){for(var a=b.___activeNode||b.rootNode;a.nextSibling;)if(a=
a.nextSibling,a.getVisible()){a.focus();break}};b.focusPreviousNode=function(){for(var a=b.___activeNode||b.rootNode;a.previousSibling;)if(a=a.previousSibling,a.getVisible()){a.focus();break}};b.expandNode=function(){b.___activeNode&&!b.___activeNode._items?b.focusNextNode():b.___activeNode&&typeof b.___activeNode._items!="undefined"&&(b.___activeNode.getExpanded()!=true?b.___activeNode.setExpanded(true):b.focusNextNode())};b.collapseNode=function(){b.___activeNode&&!b.___activeNode._items?b.focusPreviousNode():
b.___activeNode&&typeof b.___activeNode._items!="undefined"&&(b.___activeNode.getExpanded()!=false?b.___activeNode.setExpanded(false):b.focusPreviousNode())};b.deleteNode=function(a,c){if((a=a||b.___selectedNode)&&a!=b.rootNode&&(c||b.onCustomEvent("delete",a))){var f=a.getToObject();a.deleteNode();if(a.father)for(var g=0;g<a.father._items.length;g++)if(a.father._items[g]==a){a.father._items.splice(g,1);break}for(g=0;g<b.___deletedNodes.length;g++)b.___activeNode==b.___deletedNodes[g]&&b.setFocusedNode(a.father?
a.father:b.rootNode),b.___selectedNode==b.___deletedNodes[g]&&b.setSelectedNode(a.father?a.father:b.rootNode);b.___deletedNodes=[];a.getLastNode()&&a.father._items.length&&(g=a.father._items[a.father._items.length-1],g.setLastNode(true),g.repaintConnectors(g.connectorFootPrint));a.father._items.length==1&&a.father._items[0].setLastNode(true);return f}};b.keyDownListener=function(a){if(!b.isRenaming&&(a=a||window.event,charCode=Math.max(a.keyCode?a.keyCode:0,a.charCode?a.charCode:0),charCode!=0)){switch(charCode){case 40:b.focusNextNode();
cancelEvent(a);break;case 38:b.focusPreviousNode();cancelEvent(a);break;case 39:b.selectedNode.___isRenaming||(b.expandNode(),cancelEvent(a));break;case 37:b.selectedNode.___isRenaming||(b.collapseNode(),cancelEvent(a));break;case 32:b.setSelectedNode(b.getFocusedNode());cancelEvent(a);break;case 46:b.getKbDelete()&&(b.deleteNode(),cancelEvent(a));break;case 13:try{b.setSelectedNode(b.___activeNode),b.getSelectedNode().setExpanded(!b.getSelectedNode().getExpanded())}catch(c){}cancelEvent(a)}return false}};
b.getBranchElement=function(a){do{if(hasStyle(a,"DomTreeBranch"))return a;if(hasStyle(a,"DomTree"))break;a=a.parentNode}while(a);return false};b.mouseDownListener=function(a){if(!b.isRenaming&&b.___dragAndDrop&&(a=a||window.event,!((a.which||a.button)>1))){b.___eDragX=a.clientX;b.___eDragY=a.clientY;b.___isDragging=true;b.___originDragElement=b.getBranchElement(a.target?a.target:a.srcElement);if(b.___originDragElement==b.rootNode)b.___isDragging=false;else if(!b.___originDragElement)b.___isDragging=
false;cancelEvent(a)}};b.getOwnLayerPosition=function(a){for(var c=b.getBranchElement(a.target?a.target:a.srcElement),f=a.layerX||a.x,a=a.layerY||a.y;c&&c!=b;)f+=c.offsetLeft,a+=c.offsetTop,c=c.parentNode;return{x:f,y:a}};b.mouseMoveListener=function(a){if(!b.isRenaming&&(a=a||window.event,b.___isDragging&&(b.___firedDrag||!(Math.abs(a.clientX-b.___eDragX)<=3&&Math.abs(a.clientY-b.___eDragY)<=3))))if(!b.___firedDrag&&!b.onCustomEvent("internal-drag",b.___originDragElement))b.___originDragElement=
false,b.___isDragging=false;else{b.___firedDrag=true;if(!b.___dragClone)b.___dragClone=b.___originDragElement.createClone(),b.___dragClone.style.visibility=b.internalTooltipVisible?"visible":"hidden",b.appendChild(b.___dragClone);var c=b.getOwnLayerPosition(a);b.___dragClone.style.left=c.x+5+"px";b.___dragClone.style.top=c.y+5+"px";var f=b.getBranchElement(a.target?a.target:a.srcElement),g=false;if(f&&(hasStyle(a.target?a.target:a.srcElement,"DomTreeBranchCaption")||hasStyle(a.target?a.target:a.srcElement,
"DomTreeBranchIcon")))g=true;f&&(a.target?a.target:a.srcElement).___expandConnector&&f.setExpanded(true);f&&!f.isChildOf(b.___originDragElement)?g&&f._items&&f!=b.___originDragElement.father?(b.setDropElement(f.canAcceptElement(b.___originDragElement)?f:null),b.___dragClone.setCaption('Drop inside "'+f.getCaption()+'"'),b.___markerElement&&b.___markerElement.setMoveMarker(false),b.___dragClone.setOk(true)):(b.setDropElement(null),f!=b.rootNode?(b.moveMethod=f.getMoveMethod(c.x,c.y),b.___dragClone.setCaption("Drop "+
b.moveMethod+' "'+f.getCaption()+'"'),f.setMoveMarker(b.moveMethod),b.___dragClone.setOk(true)):(b.___dragClone.setOk(false),b.___dragClone.setCaption("Cannot move here"),b.___markerElement&&b.___markerElement.setMoveMarker(false))):(b.___dragClone.setOk(false),b.___dragClone.setCaption("Cannot move here"),b.___markerElement&&b.___markerElement.setMoveMarker(false));cancelEvent(a)}};b.mouseUpListener=function(){if(!b.isRenaming){if(b.___isDragging){if(b.___dragClone)b.removeChild(b.___dragClone),
b.___dragClone=false;if(b.getDropElement()!==null&&b.___originDragElement&&b.onCustomEvent("internal-drop",{src:b.___originDragElement,dest:b.getDropElement(),index:0})){var a=b.___originDragElement.getToObject();b.deleteNode(b.___originDragElement,true);a=b.getDropElement().insertBranchDataAt(a,0);b.setSelectedNode(a)}else if(b.___markerElement&&b.___originDragElement&&b.___markerElement.getMoveMarker()&&b.onCustomEvent("internal-drop",{src:b.___originDragElement,dest:b.___markerElement.father,index:(b.___markerElement.getMoveMarker()==
"before"?0:1)+b.___markerElement.getParentNodeOrder()})){a=b.___originDragElement.getToObject();b.deleteNode(b.___originDragElement,true);var c=b.___markerElement.getParentNodeOrder();switch(b.___markerElement.getMoveMarker()){case "before":a=b.___markerElement.father.insertBranchDataAt(a,c,true);break;case "after":a=b.___markerElement.father.insertBranchDataAt(a,c+1,true);break;default:throw alert("Invalid moveMarker: "+b.___markerElement.getMoveMarker()),"Invalid moveMarker: "+b.___markerElement.getMoveMarker();
}a&&b.setSelectedNode(a)}b.___firedDrag=false;b.___originDragElement=false;b.setDropElement(null)}if(b.___markerElement){try{b.___markerElement.setMoveMarker(false)}catch(f){}b.___markerElement=false}b.___isDragging=false}};try{b.addEventListener("keydown",b.keyDownListener,false),b.addEventListener("mousedown",b.mouseDownListener,false),b.addEventListener("mousemove",b.mouseMoveListener,false),b.addEventListener("mouseup",b.mouseUpListener,false)}catch(g){b.attachEvent("onkeydown",b.keyDownListener),
b.attachEvent("onmousedown",b.mouseDownListener),b.attachEvent("onmousemove",b.mouseMoveListener),b.attachEvent("onmouseup",b.mouseUpListener)}b.findNode=function(a,c,f){var c=c||"nodeID",f=f||b.rootNode,g;if(f[c]==a)return f;else if(f._items)for(var l=0;l<f._items.length;l++)if(g=b.findNode(a,c,f._items[l]),g!=null)return g;return null};b.matchProperty=function(a,b,c,f){switch(a){case "=":return f[c]==b;case "<":return f[c]<b;case ">":return f[c]>b;case "!":return f[c]!=b;case "[":return f[c].toString().indexOf(b)==
0;case "]":a=f[c].toString();b=b.toString();if(a.length<b.length)return false;a=a.substr(a.length-b.length);return a==b;case "[]":return f[c].toString().indexOf(b)!=-1;default:throw'Tree.matchProperty: invalid operator "'+a+'". Allowed only: =, <, >, !, [, ], [].';}};b.queryNodes=function(a,c,f,g,l){c=c||"nodeID";g=g||b.rootNode;l=l||[];f=f||"=";b.matchProperty(f,a,c,g)&&l.push(g);if(g._items)for(var m=0;m<g._items.length;m++)b.queryNodes(a,c,f,g._items[m],l);return l};b.expandAll=function(a){a=a||
b.rootNode;if(a._items){a.setExpanded(true);for(var c=0;c<a._items.length;c++)b.expandAll(a._items[c])}};b.collapseAll=function(a){a=a||b.rootNode;if(a._items){for(var c=0;c<a._items.length;c++)b.collapseAll(a._items[c]);a.setExpanded(false)}};Keyboard.setFocusCycling(b);b.onCustomEvent("ready",b.rootNode);typeof c.expanded!="undefined"&&c.expanded&&b.rootNode.setExpanded(true);return b}
function TreeLoaderUl(c){for(var c=c.childNodes,a={name:"",id:-1},b,f=0;f<c.length;f++)switch(c[f].nodeName){case "A":a.name={anchorText:c[f].innerText,href:c[f].getAttribute("href")};if(hasStyle(c[f],"expanded"))a.expanded=true;break;case "UL":a.items=[];for(var g=c[f].childNodes,i=0;i<g.length;i++)if(g[i].nodeName=="LI"&&(b=TreeLoaderUl(g[i]),a.items.push(b)),b&&b.expanded)a.expanded=true;break;case "SPAN":a.name=c[f].innerText}return a}
function XTemplate(c){function a(a,b){this.toString=function(){return b[a]||""};return this}function b(c,g,i,h,j){var k=/^<\!-- BEGIN: ([\S]+?) --\>/,l=/^<\!-- END: ([\S]+?) --\>/,m=/^\{([\S]+?)\}/,o=[],n={},q=0,p=g||0,r=c.length,t=i||"",w=[],h=h||{};Object.defineProperty(this,"items",{get:function(){return o}});this.assign=function(a,b){h[a]=b};this.text=function(){};this._init=function(){for(var g;p<r;)switch(true){case !!(g=k.exec(c.substr(p))):var i=g[1];p+=g[0].length;g=i;if(n[g])throw"ERR_DUPLICATE_BLOCK";
o.push(n[g]=new b(c,p,g,h,(j||"<root>")+"."+g));p=n[g]._init();q++;break;case !!(g=l.exec(c.substr(p))):p+=g[0].length;if(t!=g[1])throw"ILLEGAL_BLOCK_END: "+g[1];return p;case !!(g=m.exec(c.substr(p))):p+=g[0].length;o.push(new a(g[1],h));q++;break;default:g=c.charAt(p),q==0?(o.push(g),q=1):typeof o[q-1]=="string"?o[q-1]+=g:(q++,o.push(g)),p++}return p};Object.defineProperty(this,"childBlocks",{get:function(){return n}});this.block=function(a){if(!a)return this;for(var a=a.split("."),b=this,c=0,f=
a.length;c<f;c++)b=b.childBlocks[a[c]];return b};this.takeSnapshot=function(){for(var c=[],f=0,g=o.length;f<g;f++)c.push(typeof o[f]=="string"?o[f]:o[f]instanceof b?o[f].toString():o[f]instanceof a?o[f].toString():"");for(var h in n)n[h]instanceof b&&n[h].reset();w.push(c.join(""))};this.toString=function(){return w.join("")};Object.defineProperty(this,"text",{get:function(){return this.toString()}});this.reset=function(){w=[];for(var a in n)n[a]instanceof b&&n[a].reset()};this.parse=function(a){this.block(a).takeSnapshot()};
Object.defineProperty(this,"out",{get:function(){w.length||this.parse();var a=this.text;this.reset();return a}});this.parseLoop=function(a,b){for(var c=0,f=a.length;c<f;c++){var g=a[c],h=void 0;for(h in g)g.propertyIsEnumerable(h)&&g.hasOwnProperty(h)&&this.assign(h,b?String(g[h]).htmlEntities():String(g[h]));this.parse()}};p==0&&this._init()}return new b(c)};


//UNOPTIMIZED FILE: !object_editor.js
function ObjectEditor( sourceObject, objectName ) {
var holder = $('div', 'DOMObjectEditor');
EnableCustomEventListeners( holder );
var inner = holder.appendChild( 
$('div', 'inner').setAnchors({
"width": function(w,h) {
return w + "px";
},
"height": function(w,h) {
return h + "px";
}
})
);
var split = inner.appendChild(
( new Splitter() ).setAnchors({
"width": function(w,h) {
return w + "px";
},
"height": function(w,h) {
return h + "px";
}
}).setAttr(
"style", "margin: 0; padding: 0; border: none"
)
)
split.split( [ 150 ], 'H' );
var PATH_SEPARATOR = '\t';
Object.defineProperty( holder, 'pathSeparator', {
"get": function(){
return PATH_SEPARATOR + '';
}
});
var hasNodes = function( o ) {
if ( o instanceof Object ) {
switch ( true ) {
case typeof o == 'function':
return false;
default:
return true;
}
}
return false;
}
var getObjectIcon = function( o ) {
switch (true) {
case null === o:
return 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAE6gAABOoBCm256QAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAF3SURBVDiNpZMxSyNRFIW/d+cxJhiGFcJAmiAEU5nGxpWFpEoRU4k/YEt/g2xhYWGpjcI2W9n4CyaVS7YJ7JJWUBBJEwiEKZJB3FnmPQujaBxdjQcevHs553Dvfe8qIDM5ivfBAjcK+DSD+MFEPiAGUPIBMQB62rHZbB4CS0mS/Gq1WrsAjUZjX0SWjTG/gyD49pqBjaLoh+d5gYis1Gq1n67r+lrrr8D1cDjcmq7AAbKPE71er18qlbIisua67qrWel0pNR/H8Xa73T79rwHAeDzuFAqFdREpK6XmrbWnQRBsp80gdYiDwSAGru7jJEnO03gvGtTr9U0RaQI3QKK13qpWq2tp3GctVCoVP5/PnwDZOI53jDFnjuN8zmQyX4wxx2EY/nu1gmKxeAAsWGv/dDqd791udw+4BBbL5fLuNP/JM/q+PxdF0RFwFIbhxWg0MsDffr+/kcvlFpVS1vM8meSBu2+8kNbbWyHcbdWssM7koplxnW8BQyB4zoJTvnoAAAAASUVORK5CYII=';
break;
case typeof o == 'array' || o instanceof Array:
return 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAE6gAABOoBCm256QAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAADpSURBVDiNzZE9CsJAEIW/2axY+UNqFcEL2Np5CRsrbyAW1m7OYOc10mhp5TFEEHvdRkWNxRBS+RPT+GDhzc5+D2ZHoohJkhABFfLJizAL+n1WQDUnDFAGeuZHOFXVAhwOcL2CMdBqvSf2e7jdwFpoNMACxDEcj3oxHL4P2Gxgt4NSCcZjMGmj2fwMAwwG0OlktXn99Dv9acB6Dc6B9/rjzsFy+SHg8YDzWX2tBu22rkpEfRhq73KB+z0LsABBANstzOcwnUK3qyfVaJT5xUJXXq9rLc6R5Bj59QhFAk4F+JMRwQH+B9iL4J7TvzpRXNf14QAAAABJRU5ErkJggg==';
break;
case typeof o == 'function':
return 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAE6gAABOoBCm256QAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAEKSURBVDiNpdO7SkNBEMbx3zmJNwSNWigErSxELRTstFJLX8BCEHwv7X0DtdIiYKNgp4VYKOKNiBaJIMTibMJySLzEDwZ2Pmb+7Ay7CfpDJP6mBuoJSl00tyDpP5ohSduYw1jGUMgXg1fCQr44D1jBJXYxjXkcoBd9OMJMJ8AgNvGODVxgGyd4wgOOsdMJsBoAYzjFONZQiWoqWO8EOMQ+bsM1XzCJm6jmDmUU2wE+UMcnHsPcafCaqoXmnnaAvN7wjKnIK8v2UfsNAM4wF+WzOM8XjUSxJFtSM99CVbbQCbzKFt3qKWAgglVxH+XXGMWV7DEl2JP9A4Ix8sMY3yqNaV2oUQiHoi6/8xcugzAyNOba9gAAAABJRU5ErkJggg==';
break;
case typeof o == 'number':
return 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAE6gAABOoBCm256QAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAC7SURBVDiNY2RgYOCAYkYG0sB/BgaGH4wMDAwCZGiGG8JEgWYGBgYGRiYKNDMwMDAwYDEgmB2CpaFyWxQZGOaJ4zNEEIHTpRkY/v+H4DfVDAx/riH4n6aiqoVgPF4QbmRgYBRhYPj3FMLnzWJg2K9OhBdg4Pd5BoYsQwaGZW4IMVU9Egz4vI2BYeY3BobY5wwMDH8gYmwCJBjw5R6C/f8nLlW0iEY6G8DIAIlPilzwnwL9/5mhDBYGMrMzAFcEKETOfLW2AAAAAElFTkSuQmCC';
break;
case typeof o == 'string':
return 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAE6gAABOoBCm256QAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAEXSURBVDiNpdNBK4RhFAXg5/2+kaFmUCYls5AkO5b4BfIDbPwCK7OWjZQ/QDZ2srJRsrBTdkpY2SlJTRZqhgVNfZ/FIA2GGaduvffc95w6t25A9q2C1pDiOaC3DfGHSfQPMYToH2KQ+WmwyHQ3Y4Fswn2Z812u/2Swwm7M7Gcuhzz9VZKmBgsMx8ym1J4ovXDXzWgnc3+KUOExpRYIMf0vXG2wrV5fENDXSC6z1cH8e59wW2NvnbXGvzG6GskTDkc4yFINxDHjGabGODqj3DTCDLkJJnc4qbKaJyxxEVHsYRoXTQ2GyBfYL/GQchMYCAwiqXD6a4ReFClE5AJFhITLKiubHDcafLvEVhCpX1W7SOO3R0ab5/wKWBg9jHFT9+0AAAAASUVORK5CYII=';
break;
case typeof o == 'boolean':
return 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAE6gAABOoBCm256QAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAEDSURBVDiNndOhSoNhFMbx37tvqIM5JrJiEJmsWBSW1CAsGLwBEYvFvmqZXoDBbvEWLEbBsDA0eAMrC2IxKTiH22eZgtPN7/OBAwfe5/zPwwsnYGZYQTrF6EbIfw0XBLsqVs0r6OnoTQAEZDPfNq/IKWspa6mqJUgRMilj/9DfgH1l24rpAVMWNdyquLOu7UgjHSDnWDAQexQE0+rqdpID+m6c23CpKtYBeQfJAT3XHvTde/WuOXQvJwck1KRPrFkQWZOTtQkG2qO27FhAZMuhFmYFJfDiInmCrhOxnqAk1vfm1JmrUVvA3FgI7FnS8aTp+bfngKL0l/ipOBo22X9AYnQ/AF3ONKJ4QQfsAAAAAElFTkSuQmCC';
break;
case typeof o == 'object':
return 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAE6gAABOoBCm256QAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAFMSURBVDiNpZFPi0FRGIefc+YyyNyVjT+xRcnWLEiRfAoL32A+wVwfymImH0A2REoWSjaSEPmTLncWp+tO0xgxT9163/f2e3vOOaJW482yqAEv3MdGCN6f8nk+AP3OMMAz8CofDNvoml3t9zAYgKZBKgXbLVgWmCZ4POprtcDrhXgcXC6Vuyyo12E0glxO9Z0OHI+wWEAyCYkErFbQaMBsBoXCjwWTCaTTkMlc9y2VYLmE8diZaaBUDwelaROLwekEoRAEAs7c54P5/NuC3U5pmSZEo86PSOR3i1gM2m34/IRiEaRpqjNpGrjd1/VtPB4QAqZT1Utdh2oVzmd1ibcYDkHXoVIBKUGCKrxedQ+32O/B73d6aRfBIPT70OtdDzebyjIcdmaXZyyXodv92+JwgGxWPbeNMAys2+LXkcD6H/m1FAID2DwQ3giB8QUVk2FFtzHFnwAAAABJRU5ErkJggg==';
break;
case typeof o == 'undefined':
return 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAE6gAABOoBCm256QAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAE+SURBVDiNpZOxSgNBEIb/uSxhhV3ROobAXRkbIXCNcJAujZXvIL6GaGFhFSx9Azu9F5DjwhEsNaCNEkh3YG6bgwsTCy8hhD1I4g8Ly/DPtzOzDAGQ5SFspzmAnAAc7JC8hIiqZN/3XaXUMRHV8zwfRVH0ZrERAThcj/Z6vRshxOVqjJkfwzC8KEtfyrG9TkT7zPw+m83umfkFABzHOe92u8G6V9gAaZr2kyT5BDB3XVe32+0vACSEONoIkCTJx+Lued4Z/uY0N8a8rnutLSwUBMGplPIOAIqi6A8Gg9HGgGazuae1fgBQZ+anOI6vbL5KQKvVcokoBzBO0/Q6yzK2+azfCABa61qj0VAAMJlMTBXAOkQA6HQ6vlLquYSdDIfD761a2FSVFUyn07GU8hYAjDE/Vb5/L1NtpZKd1vkXUg9k7IIMIuoAAAAASUVORK5CYII=';
break;
default:
return o instanceof Object ? 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAE6gAABOoBCm256QAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAFMSURBVDiNpZFPi0FRGIefc+YyyNyVjT+xRcnWLEiRfAoL32A+wVwfymImH0A2REoWSjaSEPmTLncWp+tO0xgxT9163/f2e3vOOaJW482yqAEv3MdGCN6f8nk+AP3OMMAz8CofDNvoml3t9zAYgKZBKgXbLVgWmCZ4POprtcDrhXgcXC6Vuyyo12E0glxO9Z0OHI+wWEAyCYkErFbQaMBsBoXCjwWTCaTTkMlc9y2VYLmE8diZaaBUDwelaROLwekEoRAEAs7c54P5/NuC3U5pmSZEo86PSOR3i1gM2m34/IRiEaRpqjNpGrjd1/VtPB4QAqZT1Utdh2oVzmd1ibcYDkHXoVIBKUGCKrxedQ+32O/B73d6aRfBIPT70OtdDzebyjIcdmaXZyyXodv92+JwgGxWPbeNMAys2+LXkcD6H/m1FAID2DwQ3giB8QUVk2FFtzHFnwAAAABJRU5ErkJggg==' : 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAE6gAABOoBCm256QAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAABCSURBVDiN7dMhDsAwEAPBuTSgsP9/adiVROHNkYJYsmSyyxy4Z8O3JEbg2YCXpBVgiFaAwREcwX8EWeDzmqPbvPMLoZIHNO9z8/EAAAAASUVORK5CYII=';
break;
}
}
function getEvalPath( nodeID, fancy, maintainOriginal ) {
try {
fancy = !!fancy;
if ( !nodeID )
return !fancy ? "sourceObject" : ( objectName || "var" );
var parts = nodeID.split( PATH_SEPARATOR );
var node = sourceObject;
var path = !fancy ? "sourceObject" : ( maintainOriginal ? 'sourceObject' : ( objectName || "var" ) );
for ( var i=0, len = parts.length; i<len; i++) {
path = path.concat( !fancy 
? ( '[' + JSON.stringify( parts[i], { "keep_array_indentation": true } ) + ']' ) 
: (
node instanceof Array 
? '[' + parts[i] + ']'
: /^[a-z_]+([a-z\d\_])?$/i.test( parts[i] ) ? '.' + parts[i] : '[' + JSON.stringify( parts[i] ) + ']'
) 
);
node = node[ parts[i] ];
}
return path;
} catch (e) {
return null;
}
}
var nodeIdBinding = function( nodeID ) {
return eval( getEvalPath( nodeID ) );
}
var getObjectItems = function( o, rootPath ) {
if (!hasNodes( o ))
return null;
var out = [];
if ( o instanceof Array ) {
for( var i=0, len = o.length; i < len; i++ ) {
out.push({
"name": '[' + i.toString() + ']',
"icon": getObjectIcon( o[i] ),
"id" : rootPath == '' ? i.toString() : ( rootPath + PATH_SEPARATOR + i )
});
}
} else {
var t;
for ( var prop in o ) {
if ( o.propertyIsEnumerable( prop ) ) {
out.push({
"name": prop,
"icon": getObjectIcon( o[prop] ),
"id"  : rootPath == '' ? prop : ( rootPath + PATH_SEPARATOR + prop ),
"type": ( t = typeof o[prop] ) == 'object' ? 'zobject' : (
t == 'function' ? 'zfunction' : t
)
});
}
}
/* Sort object stuff */
out.sort( function( a, b ) {
var alower = a.name.toLowerCase();
var blower = b.name.toLowerCase();
return ( a instanceof Object && b instanceof Object )
? ( a.type == b.type ? (
alower == blower
? 0
: ( blower > alower ? -1 : 1 )
) : ( b.type > a.type ? 1 : -1 )
)
: ( a instanceof Object ? -1 : 1 );
} );
for ( var i=0, len = out.length; i<len; i++) 
delete out[i].type;
}
return out;
}
var tree = split.cells(0).insert(
( new Tree({
"name": objectName || 'Object',
"icon": getObjectIcon( sourceObject ),
'id': ''
}) ).setAnchors({
"width": function(w,h) {
return w + "px";
},
"height": function(w,h) {
return h + "px";
}
})
);
var prop = split.cells(1).insert(
( new PropertyGrid([
{
"name": "name",
"label": "Name",
"type": "Generic",
"value": ""
},
{
"name": "type",
"label": "Type",
"type": "dropdown",
"values": [
{
"id": "",
"name": "Auto"
},
{
"id": "number",
"name": "number"
},
{
"id": "string",
"name": "string"
},
{
"id": "boolean",
"name": "boolean"
},
{
"id": "array",
"name": "array"
},
{
"id": "object",
"name": "object"
},
{
"id": "null",
"name": "null"
},
{
"id": "undefined",
"name": "undefined"
},
{
"id": "function",
"name": "function"
}
],
"value": ""
},
{
"name": "value",
"label": "Value",
"type": "OneDB_AceEditor",
"value": "",
"height": 70
}
])).setAnchors({
"width": function( w,h ) {
return w + "px";
},
"height": function(w,h) {
return h - 40 + "px";
}
})
);
prop.splitPosition = 100;
var setNodeDetails = function( nodeID ) {
var root = nodeIdBinding( nodeID );
prop.values.name = getEvalPath( nodeID, true );
prop.values.type = ( function() {
switch ( true ) {
case root === null:
return 'null';
break;
case typeof root == 'undefined':
return 'undefined';
break;
case typeof root == 'object':
if( root instanceof Array )
return 'array';
if ( root instanceof Function )
return 'function';
return 'object';
break;
default:
return typeof root;
break;
}
} )();
try {
if (typeof root != 'string' ) {
var str = JSON.beautify( JSON.stringify( root ) );
} else var str = root;
prop.values.value = str;
} catch (e) {
prop.values.value = root + '';
}
};
var deleteProperty = function( propertyID ) {
var path = getEvalPath( propertyID, true, true );
path = path.replace( /^sourceObject(\.)?/, '' );
remove( path );
}
tree.addCustomEventListener('focus', function( node ) {
setNodeDetails( node.nodeID );
applyBtn.disabled = node == tree.rootNode;
if (node.items && node.items.length )
return true;
//console.log( node.nodeID );
var realMapping = nodeIdBinding( node.nodeID );
if ( hasNodes( realMapping ) ) {
node.items = getObjectItems( realMapping, node.nodeID );
tree.rootNode.repaintConnectors('');
holder.onCustomEvent('change');
for ( var i=0, len = node.items.length; i<len; i++) {
( function( nodeItem ) {
nodeItem.addContextMenu([
{
"caption": "Delete",
"handler": function() {
deleteProperty( nodeItem.nodeID );
}
}
]);
})( node.items[i] );
}
}
return true;
});
var applyValue = function( value, nodeId, leaveRest ) {
var evald;
if ( !leaveRest )
eval( evald = ( getEvalPath( nodeId ) + '= value;' ) );
else {
var setter = getEvalPath( nodeId );
//console.log( "Setter: ", setter, 'nodeID', nodeId );
eval( evald = (
"switch (true) {"
+"    case " + setter + " instanceof Array:"
+"         " + setter + ".push( value );"
+"         break;"
+"    case typeof value == 'object' && typeof " + setter + " == 'object':"
+"         for ( var key in value ) {"
+"            if (value.propertyIsEnumerable(key)) {"
+"                " + setter + "[ key ] = value[key];"
+"            }"
+"         }"
+"         break;"
+"     default:"
+"         "+ setter + " = value;"
+"         break;"
+"}"
) );
}
//console.log( 'eval: ', evald );
var parts = nodeId.split( PATH_SEPARATOR );
parts = parts.length ? parts.slice( 0, parts.length - 1 ).join( PATH_SEPARATOR ) : '';
var node = tree.findNode( parts, 'nodeID' );
if (!node)
node = tree.rootNode;
if ( node.items && node.items.length ) {
while ( node.items.length > 0 ){
tree.deleteNode( node.items[0], true );
}
}
node.items = getObjectItems( nodeIdBinding( node.nodeID ), node.nodeID );
for ( var i=0, len = node.items.length; i<len; i++) {
( function( nodeItem ) {
nodeItem.addContextMenu([
{
"caption": "Delete",
"handler": function() {
deleteProperty( nodeItem.nodeID );
}
}
]);
})( node.items[i] );
}
try {
( tree.selectedNode = node ).focus();
tree.selectedNode.expanded = !tree.selectedNode.expanded;
tree.selectedNode.expanded = !tree.selectedNode.expanded;
} catch (e) {
}
tree.rootNode.repaintConnectors( '' );
holder.onCustomEvent( 'change' );
};
Object.defineProperty( holder, "set", {
"get": function() { 
return applyValue;
}
} );
function getParentPath( path ) {
var out = path.replace(/(\.[a-z_]([a-z0-9\_]+)?|\[(.*)\])$/i, '' );
return out;
}
function getArrayKey( path ) {
var match = /\[([\s]+)?([\d]+)([\s]+)?\]$/.exec( path );
//console.log( path );
if ( match )
return parseInt( match[2] );
else
return null;
}
var remove = function( valuePath ) {
setTimeout( function() {
holder.onCustomEvent('change');
}, 1 );
var deleteName = '';
try {
var exists = !valuePath ? false : ( function() {
return eval( "typeof " + ( deleteName = "sourceObject" + ( valuePath.charAt(0) == '[' ? '' : '.') + valuePath ) + " != 'undefined'" )
} )();
} catch (e) {
return false;
}
try {
var parentPath = getParentPath( deleteName );
var isParentArray = eval( parentPath + " instanceof Array");
} catch (e) {
console.error( e );
var isParentArray = false;
}
try {
if (!isParentArray) {
eval("if (!delete " + deleteName + ") throw 'error';");
} else {
var arrayKey = getArrayKey( deleteName );
if ( arrayKey !== null ) {
eval( parentPath + ".splice(" + arrayKey + ", 1);" );
}
}
} catch (e) {
return false;
}
/* Delete unsetted nodes */
var nodes = tree.queryNodes(undefined, 'nodeID', '!'), evalPath;
var repaintNode = null;
if ( parentPath == 'sourceObject')
repaintNode = tree.rootNode;
else {
for ( var i=0, len=nodes.length; i<len; i++) {
if ( ( evalPath = getEvalPath( nodes[i].nodeID, true, true ) ) == parentPath ) {
repaintNode = nodes[i];
} else {
//console.log( evalPath + " != " + parentPath );
}
}
}
if ( repaintNode ) {
if ( repaintNode.items ) {
while (repaintNode.items.length) {
tree.deleteNode( repaintNode.items[0] );
}
}
repaintNode.items = getObjectItems( nodeIdBinding( repaintNode.nodeID ), repaintNode.nodeID );
repaintNode.expanded = !repaintNode.expanded;
repaintNode.expanded = !repaintNode.expanded;
for ( var i=0, len = repaintNode.items.length; i<len; i++) {
( function( nodeItem ) {
nodeItem.addContextMenu([
{
"caption": "Delete",
"handler": function() {
deleteProperty( nodeItem.nodeID );
}
}
]);
})( repaintNode.items[i] );
}
}
tree.rootNode.repaintConnectors('');
return true;
}
Object.defineProperty( holder, "remove", {
"get": function() { return remove; }
});
var applyBtn = split.cells(1).insert(
(new Button('Apply', function() {
try{
switch ( prop.values.type ) {
case 'function':
DialogBox("Cannot apply function!", {
"type": "error",
"caption": "Not allowed",
"childOf": getOwnerWindow( holder ),
"details": "Because of security reasons,\nthis type of data cannot be modified!"
});
return;
break;
case 'number':
var numberData = prop.values.value;
if (!numberData.toString().isDecimal())
throw "Bad number format";
applyValue( numberData.isInteger() ? parseInt( numberData ) : parseFloat( numberData ), tree.selectedNode.nodeID );
break;
case 'string':
applyValue( prop.values.value, tree.selectedNode.nodeID );
break;
case 'boolean':
var boolValue = prop.values.value;
if (!/^(true|false|0|1)?$/i.test( boolValue ))
throw "Bad boolean format. Use : true, false, 0, 1 or empty string only";
//break;
applyValue( ['true', '1' ].indexOf( boolValue.toString().toLowerCase() ) == -1 ? false : true,
tree.selectedNode.nodeID );
break;
case 'array':
try {
var arr = JSON.parse( prop.values.value );
if (!(arr instanceof Array ) )
throw "Not array!";
applyValue( arr, tree.selectedNode.nodeID );
} catch (e) {
throw "String could not be decoded as a JSON array";
}
break;
case 'object':
try {
var obj = JSON.parse( prop.values.value );
if (!(obj instanceof Object))
throw "Not an object!";
applyValue( obj, tree.selectedNode.nodeID );
} catch (e) {
throw "String could not be decoded as a JSON object: " + e;
}
break;
case 'null':
if (!/^(null)?$/i.test(prop.values.value))
throw "Bad NULL format. Use : null or empty string!";
applyValue( null, tree.selectedNode.nodeID );
break;
case 'undefined':
if (!/^(undefined)?$/i.test( prop.values.value ))
throw "Bad Undefined format. Use : undefined or empty string!";
applyValue( undefined, tree.selectedNode.nodeID );
break;
case '':
default:
try {
var auto = JSON.parse( prop.values.value );
applyValue( auto, tree.selectedNode.nodeID );
} catch (e) {
applyValue( prop.values.value, tree.selectedNode.nodeID );
}
break;
}
} catch (Exception) {
DialogBox( Exception.toString(), {
"type": "error",
"caption": "Error applying value",
"childOf": getOwnerWindow( holder )
});
}
}))
.setAttr(
"style", "display: block; position: absolute; left: 5px; bottom: 5px"
)
);
tree.selectedNode = tree.rootNode;
Object.defineProperty( holder, 'tree', {
"get": function( ) { return tree; }
});
Object.defineProperty( holder, 'split', {
"get": function() {
return split;
}
} );
tree.rootNode.addContextMenu([{"caption": "Root"}]);
return holder;
}
